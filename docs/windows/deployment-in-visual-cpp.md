---
title: Развертывание в Visual C++
ms.date: 05/11/2018
helpviewer_keywords:
- deploying applications [C++]
- application deployment [C++]
ms.assetid: d4b4ffc0-d2bd-4e4a-84a6-62f1c26f6a09
ms.openlocfilehash: 67d5c7b0772eda55d1b653bd73f95ac93e31e644
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69514808"
---
# <a name="deployment-in-visual-c"></a>Развертывание в Visual C++

Установка приложения на компьютере, отличном от вашего компьютера-разработчика, называется *развертыванием*. При развертывании приложения Visual C++ на другом компьютере нужно установить как само приложение, так и файлы всех библиотек, от которых оно зависит. Visual Studio предоставляет три способа развертывания библиотек Visual C++ вместе с приложением: *централизованное развертывание*, *локальное развертывание* и *статическое связывание*. При централизованном развертывании файлы библиотеки помещаются в каталог Windows, где служба Центра обновления Windows может обновить их автоматически. При локальном развертывании файлы библиотек помещаются в тот же каталог, что и приложение. Вам нужно повторно развернуть все локально развернутые библиотеки, чтобы обновить их. Статическое связывание привязывает код библиотеки к приложению. При использовании статического связывания вам нужно перекомпилировать и повторно развернуть приложение, чтобы воспользоваться преимуществами обновлений библиотек.

В Visual Studio 2015 библиотека времени выполнения C корпорации Майкрософт посредством рефакторинга была разделена на компоненты локальной библиотеки для конкретной версии и новую универсальную библиотеку среды выполнения C, которая теперь входит в состав Windows. Сведения о развертывании универсальной CRT см. в разделе [Развертывание универсальной библиотеки CRT](universal-crt-deployment.md).

## <a name="central-deployment"></a>Центральное развертывание

При централизованном развертывании файлы библиотеки DLL устанавливаются в каталог Windows\System32, а файлы библиотеки 32-разрядных файлов библиотеки на системах x64 — в каталог Windows\SysWow64. Microsoft автоматически обновляет свои библиотеки, развернутые централизованно. Обновления для локально развернутых или статически связанных библиотек Visual C++ нужно предоставлять вам.

Для централизованного развертывания библиотек Visual C++ можно использовать один из двух источников устанавливаемых файлов:

- Файлы *распространяемого пакета*, которые представляют собой автономные исполняемые файлы командной строки, содержащие все распространяемые библиотеки Visual C++ в сжатом виде.

- *Распространяемые модули слияния* (MSM-файлы), которые можно использовать для развертывания определенных библиотек и которые включены в файл установщика Windows (MSI) вашего приложения.

Файл распространяемого пакета устанавливает все библиотеки Visual C++ для конкретной системной архитектуры. Например, если ваше приложение создано для x64, можно использовать распространяемый пакет vcredist_x64.exe для установки всех библиотек Visual C++, используемых вашим приложением. Вы можете запрограммировать установщик приложения для обязательного запуска распространяемого пакета перед установкой приложения.

Модуль слияния обеспечивает включение логики установки для конкретной библиотеки Visual C++ в файле настройки приложения установщика Windows. Можно включить столько модулей слияния, сколько требуется приложению. Модули слияния следует использовать, когда нужно минимизировать размер двоичных файлов развертывания.

Так как централизованное развертывание с использованием распространяемого пакета или модулей слияния позволяет Центру обновления Windows автоматически обновлять библиотеки Visual C++, мы рекомендуем использовать в приложении библиотеки DLL вместо статических, а также использовать централизованное развертывание вместо локального.

## <a name="local-deployment"></a>Локальное развертывание

В локальном развертывании файлы библиотек устанавливаются в папку приложения вместе с исполняемым файлом. Разные версии распространяемых библиотек Visual C++ можно устанавливать в одну папку, так как имя файла для каждой версии включает в себя номер версии. Например, версия 12 библиотеки времени выполнения C++ имеет имя msvcp120.dll, а версия 14 — имя msvcp140.dll.

Библиотека может быть распределена по нескольким дополнительным библиотекам DLL, называемым *точечными*. Например, некоторые функциональные возможности в стандартной библиотеке, выпущенной в Visual Studio 2017 версии 15.6, были добавлены в msvcp140_1.dll, чтобы сохранить совместимость msvcp140.dll с ABI. Если вы используете Visual Studio 2017 версии 15.6 (набор инструментов 14.13) или набор инструментов более поздней версии из Visual Studio 2017, вам может потребоваться локально развернуть эти точечные библиотеки, как и основную библиотеку. Эти отдельные точечные библиотеки затем объединяются в следующий основной номер версии базовой библиотеки при изменении ABI.

Так как корпорация Майкрософт не может автоматически обновлять локально развернутые библиотеки Visual C++, мы не рекомендуем применять локальное развертывание этих библиотек. Если вы решите использовать локальное развертывание распространяемых библиотек, мы рекомендуем реализовать собственный метод автоматического обновления локально разворачиваемых библиотек.

## <a name="static-linking"></a>Статическое связывание

Наряду с библиотеками динамической компоновки Visual Studio предоставляет основную часть своих библиотек в виде статических библиотек. Вы можете статически связать статическую библиотеку с приложением, то есть связать объектный код библиотеки непосредственно с приложением. При этом создается отдельный двоичный файл без зависимости от библиотеки DLL, чтобы вам не требовалось отдельно развертывать файлы библиотеки Visual C++. Однако не рекомендуется использовать такой подход, так как статически связанные библиотеки не могут обновляться на месте. Если используется статическое связывание и необходимо обновить связанную библиотеку, потребуется выполнить повторную компиляцию и повторное развертывание приложения.

## <a name="troubleshooting-deployment-issues"></a>Устранение неполадок развертывания

Порядок загрузки библиотек Visual C++ зависит от системы. Чтобы выявить причины неполадок загрузчика, используйте средство depends.exe или where.exe. Дополнительные сведения см. в разделе [Порядок поиска библиотеки динамической компоновки (Windows)](/windows/win32/Dlls/dynamic-link-library-search-order).

## <a name="see-also"></a>См. также

- [Развертывание классических приложений](deploying-native-desktop-applications-visual-cpp.md)
- [Развертывание универсальной библиотеки CRT](universal-crt-deployment.md)
