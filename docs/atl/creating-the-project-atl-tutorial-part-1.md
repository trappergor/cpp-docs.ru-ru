---
title: Создание проекта (учебник ATL, часть 1)
ms.custom: get-started-article
ms.date: 08/19/2019
ms.assetid: f6b727d1-390a-4b27-b82f-daadcd9fc059
ms.openlocfilehash: 9f7f62ec94d5ac6d6076763853aa19297cf310e6
ms.sourcegitcommit: 9d4ffb8e6e0d70520a1e1a77805785878d445b8a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2019
ms.locfileid: "69630693"
---
# <a name="creating-the-project-atl-tutorial-part-1"></a>Создание проекта (учебник ATL, часть 1)

В этом руководстве описывается пошаговое руководство по неатрибутивному проекту ATL, создающему объект ActiveX, отображающий многоугольник. Объект включает параметры, позволяющие пользователю изменить число сторон, образующих многоугольник, и код для обновления экрана.

> [!NOTE]
> Библиотеки ATL и MFC в большинстве случаев не поддерживаются в выпусках Visual Studio Express.

> [!NOTE]
> В этом руководстве создается тот же исходный код, что и в примере многоугольника. Если вы не хотите вводить исходный код вручную, можно скачать его с помощью [примера "многоугольник](https://github.com/Microsoft/VCSamples/tree/master/VC2008Samples/ATL/Controls/Polygon)". Затем можно ссылаться на исходный код многоугольника по мере работы с руководством или использовать его для проверки ошибок в вашем проекте.
> Для компиляции откройте *PCH. h* (*stdafx. h* в Visual Studio 2017 и более ранних версиях) и замените:
> ```
> #ifndef WINVER
> #define WINVER 0x0400
> #endif
> ```
> на
> ```
> #ifndef WINVER
> #define WINVER 0x0500
> #define _WIN32_WINNT 0x0500
> #endif
> ```
> Компилятор по-прежнему будет сообщать о `regsvr32` неправильном выходе, но все равно следует иметь встроенную и доступную библиотеку DLL элемента управления.

### <a name="to-create-the-initial-atl-project-using-the-atl-project-wizard"></a>Создание исходного проекта ATL с помощью мастера проектов ATL

1. В Visual Studio 2017 и более ранних версий: **Файл** > создатьпроект > . Откройте вкладку **визуальный C++**  элемент и выберите **MFC/ATL**. Выберите **проект ATL**.

   В Visual Studio 2019: Выберите **файл** > **создать**проект, введите "ATL" в поле поиска и выберите проект ATL. > 

1. В качестве имени проекта введите *Polygon* .

    Расположение исходного кода обычно по умолчанию равно \Users\\\<username > \саурце\репос, а новая папка будет создана автоматически.

1. В Visual Studio 2019 примите значения по умолчанию и нажмите кнопку **ОК**. 
   В Visual Studio 2017 нажмите кнопку **ОК** , чтобы открыть мастер **проектов ATL** . Щелкните **Параметры приложения** , чтобы просмотреть доступные параметры. Так как этот проект создает элемент управления, а элемент управления должен быть сервером обработки, оставьте **Тип приложения** DLL. Нажмите кнопку **ОК**.

Visual Studio создаст проект, создав несколько файлов. Эти файлы можно просмотреть в **Обозреватель решений** , развернув `Polygon` объект. Файлы перечислены ниже.

::: moniker range="<=vs-2017"

|Файл|Описание|
|----------|-----------------|
|Многоугольник. cpp|Содержит `DllMain`реализацию методов, `DllGetClassObject` ,,`DllRegisterServer`и .`DllUnregisterServer` `DllCanUnloadNow` Также содержит карту объектов, которая представляет собой список объектов ATL в проекте. Это поле изначально пустое.|
|Polygon. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых для вашей библиотеки DLL.|
|Polygon. idl|Языковой файл определения интерфейса, описывающий интерфейсы, характерные для объектов.|
|Polygon. RGS|Этот сценарий реестра содержит сведения для регистрации библиотеки DLL программы.|
|Polygon. RC|Файл ресурсов, который изначально содержит сведения о версии и строку, содержащую имя проекта.|
|Resource.h|Файл заголовка для файла ресурсов.|
|Полигонпс. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых прокси-серверу, и код заглушки, поддерживающий вызовы в апартаментах.|
|stdafx.cpp|Файл, который будет `#include` файлом *stdafx. h*.|
|stdafx.h|Файл, который будет `#include` выполнять предварительную компиляцию файлов заголовков ATL.|

::: moniker-end

::: moniker range=">=vs-2019"

|Файл|Описание|
|----------|-----------------|
|Многоугольник. cpp|Содержит `DllMain`реализацию методов, `DllGetClassObject` ,,`DllRegisterServer`и .`DllUnregisterServer` `DllCanUnloadNow` Также содержит карту объектов, которая представляет собой список объектов ATL в проекте. Это поле изначально пустое.|
|Polygon. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых для вашей библиотеки DLL.|
|Polygon. idl|Языковой файл определения интерфейса, описывающий интерфейсы, характерные для объектов.|
|Polygon. RGS|Этот сценарий реестра содержит сведения для регистрации библиотеки DLL программы.|
|Polygon. RC|Файл ресурсов, который изначально содержит сведения о версии и строку, содержащую имя проекта.|
|Resource.h|Файл заголовка для файла ресурсов.|
|Полигонпс. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых прокси-серверу, и код заглушки, поддерживающий вызовы в апартаментах.|
|PCH. cpp|Файл, который будет `#include` *PCH. h*.|
|PCH. h|Файл, который будет `#include` выполнять предварительную компиляцию файлов заголовков ATL.|

::: moniker-end

1. В **обозревателе решений** щелкните правой кнопкой мыши проект `Polygon`.

1. В контекстном меню выберите пункт **Свойства**.

1. Щелкните **Компоновщик**. Измените значение параметра **per-усерредиректион** на **Да**.

1. Нажмите кнопку **ОК**.

На следующем шаге в проект будет добавлен элемент управления.

[На шаг 2](../atl/adding-a-control-atl-tutorial-part-2.md)

## <a name="see-also"></a>См. также

[Руководство](../atl/active-template-library-atl-tutorial.md)
