---
title: Создание проекта (учебник ATL, часть 1)
ms.custom: get-started-article
ms.date: 08/19/2019
ms.assetid: f6b727d1-390a-4b27-b82f-daadcd9fc059
ms.openlocfilehash: 8a0374fcaf9a18c82e90bde2abc032158ecc537a
ms.sourcegitcommit: 9c2b3df9b837879cd17932ae9f61cdd142078260
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2020
ms.locfileid: "92923873"
---
# <a name="creating-the-project-atl-tutorial-part-1"></a>Создание проекта (учебник ATL, часть 1)

В этом руководстве описывается пошаговое руководство по проекту ATL без атрибута, который создает объект ActiveX, отображающий многоугольник. Объект включает параметры, позволяющие пользователю изменить число сторон, образующих многоугольник, и код для обновления экрана.

> [!NOTE]
> В этом руководстве создается тот же исходный код, что и в примере многоугольника. Если вы не хотите вводить исходный код вручную, можно скачать его с помощью [примера "многоугольник](https://github.com/Microsoft/VCSamples/tree/master/VC2008Samples/ATL/Controls/Polygon)". Затем можно ссылаться на исходный код многоугольника по мере работы с руководством или использовать его для проверки ошибок в вашем проекте.
> Для компиляции откройте *PCH. h* ( *stdafx. h* в Visual Studio 2017 и более ранних версиях) и замените:
>
> ```
> #ifndef WINVER
> #define WINVER 0x0400
> #endif
> ```
>
> на
>
> ```
> #ifndef WINVER
> #define WINVER 0x0500
> #define _WIN32_WINNT 0x0500
> #endif
> ```
>
> Компилятор по-прежнему будет сообщать о `regsvr32` неправильном выходе, но все равно следует иметь встроенную и доступную библиотеку DLL элемента управления.

### <a name="to-create-the-initial-atl-project-using-the-atl-project-wizard"></a>Создание исходного проекта ATL с помощью мастера проектов ATL

1. В Visual Studio 2017 и более ранних версий: **файл**  >  **Новый**  >  **проект** . Откройте вкладку **Visual C++** и выберите **MFC/ATL** . Выберите **проект ATL** .

   В Visual Studio 2019: выберите **файл**  >  **создать**  >  **проект** , введите "ATL" в поле поиска и выберите **проект ATL** .

1. В качестве имени проекта введите *Polygon* .

    Расположение исходного кода обычно будет по умолчанию \Users \\ \<username> \саурце\репос, а новая папка будет создана автоматически.

1. В Visual Studio 2019 примите значения по умолчанию и нажмите кнопку **ОК** .
   В Visual Studio 2017 нажмите кнопку **ОК** , чтобы открыть мастер **проектов ATL** . Щелкните **Параметры приложения** , чтобы просмотреть доступные параметры. Так как этот проект создает элемент управления, а элемент управления должен быть сервером обработки, оставьте **Тип приложения** DLL. Нажмите кнопку **ОК** .

Visual Studio создаст проект, создав несколько файлов. Эти файлы можно просмотреть в **Обозреватель решений** , развернув `Polygon` объект. Файлы перечислены ниже.

::: moniker range="<=msvc-150"

|Файл|Описание|
|----------|-----------------|
|Многоугольник. cpp|Содержит реализацию методов `DllMain` , `DllCanUnloadNow` , `DllGetClassObject` , `DllRegisterServer` и `DllUnregisterServer` . Также содержит карту объектов, которая представляет собой список объектов ATL в проекте. Это поле изначально пустое.|
|Polygon. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых для вашей библиотеки DLL.|
|Polygon. idl|Языковой файл определения интерфейса, описывающий интерфейсы, характерные для объектов.|
|Polygon. RGS|Этот сценарий реестра содержит сведения для регистрации библиотеки DLL программы.|
|Polygon. RC|Файл ресурсов, который изначально содержит сведения о версии и строку, содержащую имя проекта.|
|Resource.h|Файл заголовка для файла ресурсов.|
|Полигонпс. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых прокси-серверу, и код заглушки, поддерживающий вызовы в апартаментах.|
|stdafx.cpp|Файл, который будет файлом `#include` *stdafx. h* .|
|stdafx.h|Файл, который будет выполнять `#include` предварительную компиляцию файлов заголовков ATL.|

::: moniker-end

::: moniker range=">=msvc-160"

|Файл|Описание|
|----------|-----------------|
|Многоугольник. cpp|Содержит реализацию методов `DllMain` , `DllCanUnloadNow` , `DllGetClassObject` , `DllRegisterServer` и `DllUnregisterServer` . Также содержит карту объектов, которая представляет собой список объектов ATL в проекте. Это поле изначально пустое.|
|Polygon. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых для вашей библиотеки DLL.|
|Polygon. idl|Языковой файл определения интерфейса, описывающий интерфейсы, характерные для объектов.|
|Polygon. RGS|Этот сценарий реестра содержит сведения для регистрации библиотеки DLL программы.|
|Polygon. RC|Файл ресурсов, который изначально содержит сведения о версии и строку, содержащую имя проекта.|
|Resource.h|Файл заголовка для файла ресурсов.|
|Полигонпс. def|Этот файл определения модуля предоставляет компоновщику сведения о экспортах, необходимых прокси-серверу, и код заглушки, поддерживающий вызовы в апартаментах.|
|PCH. cpp|Файл, который будет `#include` *PCH. h* .|
|PCH. h|Файл, который будет выполнять `#include` предварительную компиляцию файлов заголовков ATL.|

::: moniker-end

1. В **Обозреватель решений** щелкните правой кнопкой мыши `Polygon` проект.

1. В контекстном меню выберите пункт **Свойства** .

1. Щелкните **Компоновщик** . Измените значение параметра **per-усерредиректион** на **Да** .

1. Нажмите кнопку **ОК** .

На следующем шаге в проект будет добавлен элемент управления.

[На шаг 2](../atl/adding-a-control-atl-tutorial-part-2.md)

## <a name="see-also"></a>См. также статью

[Руководство](../atl/active-template-library-atl-tutorial.md)
