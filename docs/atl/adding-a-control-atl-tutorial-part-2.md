---
title: Добавление элемента управления (учебник ATL, часть 2) | Документация Майкрософт
ms.custom: get-started-article
ms.date: 09/26/2018
ms.technology:
- cpp-atl
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 2d4918887e36e405c5efb0d5280cea5976f14bb9
ms.sourcegitcommit: a738519aa491a493a8f213971354356c0e6a5f3a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/05/2018
ms.locfileid: "48821296"
---
# <a name="adding-a-control-atl-tutorial-part-2"></a>Добавление элемента управления (учебник ATL, часть 2)

На этом шаге будет добавление элемента управления в проект, выполнить его сборку и протестировать его на веб-страницы.

## <a name="procedures"></a>Процедуры

### <a name="to-add-an-object-to-an-atl-project"></a>Чтобы добавить объект в проект ATL

1. В **обозревателе решений**, щелкните правой кнопкой мыши `Polygon` проекта.

1. Пункты **добавить** в контекстном меню, а затем нажмите кнопку **новый элемент** в подменю.

    Откроется диалоговое окно **Добавление нового элемента**. Разные категории объектов перечислены в структуре дерева слева.

1. Нажмите кнопку **ATL** папки.

1. В списке шаблонов справа выберите **управления ATL**. Нажмите кнопку **Добавить**. **Управления ATL** будет открыт мастер, и можно настроить элемент управления.

1. Тип `PolyCtl` качестве короткого имени и обратите внимание, что другие поля заполняются автоматически. Не нажимайте кнопку **Готово** еще, так как вам нужно внести некоторые изменения.

**Управления ATL** мастера **имена** страница содержит следующие поля:

|Поле|Описание|
|-----------|--------------|
|**Короткое имя**|Имя, введенное для элемента управления.|
|**Класс**|Имя класса C++, созданные для реализации элемента управления.|
|**H-файл**|Созданный файл, который содержит определение класса C++.|
|**CPP-файл**|Созданный файл, который содержит реализацию класса C++.|
|**Компонентный класс**|Имя класса компонентов для данного элемента управления.|
|**Interface**|Имя интерфейса, на котором этот элемент управления будет реализовывать его пользовательских методов и свойств.|
|**Type**|Описание для элемента управления.|
|**Идентификатор progID**|Читаемое имя, которое может использоваться для поиска CLSID элемента управления.|

Когда необходимо выполнить несколько дополнительных параметров в **управления ATL** мастера.

### <a name="to-enable-support-for-rich-error-information-and-connection-points"></a>Чтобы включить поддержку для подробных сведений об ошибках сведения и точки подключения

1. Нажмите кнопку **параметры** открыть **параметры** страницы.

1. Выберите **точек подключения** "флажок". Это создаст поддержка исходящий интерфейс в IDL-файле.

Можно также добавить интерфейсы для расширения функциональных возможностей элемента управления.

### <a name="to-extend-the-controls-functionality"></a>Для расширения функциональных возможностей элемента управления

1. Нажмите кнопку **интерфейсы** открыть **интерфейсы** страницы.

1. Выберите `IProvideClassInfo2` и нажмите кнопку **вверх** стрелку, чтобы перенести его **поддерживаемые** списка.

1. Выберите `ISpecifyPropertyPages` и нажмите кнопку **вверх** стрелку, чтобы перенести его **поддерживаемые** списка.

Можно также сделать элемент управления пригодным для вставки; это означает, что его можно встраивать в приложения, которые поддерживают внедренные объекты, например Excel или Word.

### <a name="to-make-the-control-insertable"></a>Чтобы сделать элемент управления пригодным для вставки

1. Нажмите кнопку **внешний вид** открыть **внешний вид** страницы.

1. Выберите **Insertable** "флажок".

Многоугольник, отображаемый в объекте у цвет сплошной заливки, поэтому необходимо добавить `Fill Color` свойство склада.

### <a name="to-add-a-fill-color-stock-property-and-create-the-control"></a>Добавление стандартного свойства цвета заливки и создание элемента управления

1. Нажмите кнопку **свойства запасов** открыть **стандартные свойства** страницы.

1. В разделе **не поддерживается**, прокрутите вниз список возможных стандартных свойств. Выберите `Fill Color` и нажмите кнопку **вверх** стрелку, чтобы перенести его **поддерживаемые** списка.

1. На этом завершается параметры для элемента управления. Нажмите кнопку **Готово**.

Мастер создания элемента управления, как произошло несколько изменений кода и добавление файлов. Были созданы следующие файлы:

|Файл|Описание:|
|----------|-----------------|
|PolyCtl.h|Содержит большую часть реализации класса C++ `CPolyCtl`.|
|PolyCtl.cpp|Содержит оставшиеся части `CPolyCtl`.|
|PolyCtl.rgs|Текстовый файл, содержащий скрипт реестра, используемый для регистрации элемента управления.|
|Файл PolyCtl.htm|Веб-страница, содержащая ссылку на только что созданный элемент управления.|

Мастер также выполняются следующие изменения кода.

- Добавлен `#include` инструкцию, чтобы файлы stdafx.h и stdafx.cpp для включения ATL файлы, необходимые для поддержки элементов управления.

- Polygon.idl изменен для включения сведений о новом элементе управления.

- Добавить новый элемент управления в сопоставление объекта в Polygon.cpp.

Теперь можно создать элемент управления, чтобы увидеть это в действии.

## <a name="building-and-testing-the-control"></a>Построение и тестирование элемента управления

### <a name="to-build-and-test-the-control"></a>Сборка и тестирование элемента управления

1. На **построения** меню, щелкните **собрать полигон**.

    После завершения создания элемента управления щелкните правой кнопкой мыши файл PolyCtl.htm в **обозревателе решений** и выберите **просмотреть в браузере**. Отображается HTML-страницы, содержащей элемент управления. Должна появиться страница с заголовком «Тестовая страница ATL 8.0 для объекта PolyCtl» и текст PolyCtl. Это ваш элемент управления.

> [!NOTE]
> Если элемент управления не отображается, знаете, что некоторые браузеры требуют корректировки параметров запускать элементы ActiveX. Обратитесь к документации браузера о том, как включить элементы управления ActiveX.

> [!NOTE]
> При прохождении этого руководства, если появится сообщение об ошибке, где невозможно создать файл DLL, закройте файл PolyCtl.htm и тестовый элемент управления ActiveX контейнер и повторно выполните сборку решения. Если вы по-прежнему не удается создать библиотеку DLL, перезагрузите компьютер, или выполните выход (Если вы используете службы терминалов).

Далее вы добавите пользовательское свойство к элементу управления.

[Вернитесь к шагу 1](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [перейти к шагу 3](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)

## <a name="see-also"></a>См. также

[Учебник](../atl/active-template-library-atl-tutorial.md)
