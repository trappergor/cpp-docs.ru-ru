---
title: Общие сведения о MSBuild (Visual C++) | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-tools
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- MSBuild overview
ms.assetid: dd258f6f-ab51-48d9-b274-f7ba911d05ca
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: ae6e6d826f4bc1e8c9ab6cc28686e4ad1e6e3b02
ms.sourcegitcommit: be2a7679c2bd80968204dee03d13ca961eaa31ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
ms.locfileid: "32379267"
---
# <a name="msbuild-visual-c-overview"></a>Общие сведения о MSBuild (Visual C++)  
  
MSBuild — стандартный система сборки для проектов Visual C++. При построении проекта в среде разработки Visual Studio (IDE), он использует средство msbuild.exe, XML файла проекта и файлы дополнительных параметров. Несмотря на то, что с помощью msbuild.exe и файл проекта в командной строке, интегрированная среда Разработки предоставляет пользовательский интерфейс, чтобы пользователь мог легко настроить параметры и построить проект. В этом обзоре описывается использование системы MSBuild в Visual C++.  
  
## <a name="prerequisites"></a>Предварительные требования  
  
Прочитайте следующие документы о MSBuild.  
  
- [MSBuild](/visualstudio/msbuild/msbuild)  
 Обзор понятий MSBuild.  
  
- [Справочные сведения о MSBuild](/visualstudio/msbuild/msbuild-reference)  
 Справочные сведения о системе MSBuild.  
  
- [Справочник по схеме файла проекта](/visualstudio/msbuild/msbuild-project-file-schema-reference)  
 Список элементов схемы XML MSBuild, и их атрибутов и родительских и дочерних элементов. Обратите внимание, особенно [ItemGroup](/visualstudio/msbuild/itemgroup-element-msbuild), [PropertyGroup](/visualstudio/msbuild/propertygroup-element-msbuild), [целевой](/visualstudio/msbuild/target-element-msbuild), и [задачи](/visualstudio/msbuild/task-element-msbuild) элементы.  
  
- [Справочник по командной строке](/visualstudio/msbuild/msbuild-command-line-reference)  
 Описывает аргументы командной строки и параметры, которые можно использовать с помощью msbuild.exe.  
  
- [Справочные сведения о задачах](/visualstudio/msbuild/msbuild-task-reference)  
 Описывает задачи MSBuild. Особое внимание уделите эти задачи, которые относятся к Visual C++: [Задача BscMake](/visualstudio/msbuild/bscmake-task), [CL-задача](/visualstudio/msbuild/cl-task), [CPPClean-задача](/visualstudio/msbuild/cppclean-task), [LIB-задача](/visualstudio/msbuild/lib-task), [связывания задачи](/visualstudio/msbuild/link-task), [задача MIDL](/visualstudio/msbuild/midl-task), [MT-задача](/visualstudio/msbuild/mt-task), [Задача RC](/visualstudio/msbuild/rc-task), [Задача SetEnv](/visualstudio/msbuild/setenv-task), [VCMessage-задача](/visualstudio/msbuild/vcmessage-task), [Задача XDCMake](/visualstudio/msbuild/xdcmake-task), [XSD-задача](/visualstudio/msbuild/xsd-task).  
  
## <a name="msbuild-on-the-command-line"></a>MSBuild в командной строке  
  
Следующий отрывок из [Справочник по командной строке MSBuild](/visualstudio/msbuild/msbuild-command-line-reference) показывает, что средство msbuild.exe принимает явный или неявный *project_file* аргумента (файл с расширением VCXPROJ для проектов Visual C++) и ноль или более командной строки *параметры* аргументы.  
  
> **MSBuild.exe** [ *project_file* ] [ *параметры* ]  
  
Используйте **/target-** (или **/t**) и **/property** (или **/p**) параметры командной строки, чтобы изменить определенные свойства и целевые объекты, которые являются указанный в файле проекта.  
  
Важная функция файла проекта является указание *целевой*, который является конкретной операцией, применяемой для проекта и входов и выходов, которые требуются для выполнения этой операции. Файл проекта можно указать один или несколько целевых объектов, включая целевой объект по умолчанию.  
  
Каждый целевой объект состоит из последовательности из одной или нескольких *задачи*. Каждая задача представляется классом .NET Framework, содержащим одну исполняемую команду. Например [CL-задача](/visualstudio/msbuild/cl-task) содержит [cl.exe](../build/reference/compiling-a-c-cpp-program.md) команды.  
  
A *параметр задачи* свойство класса задачи, обычно представляет параметр командной строки исполняемой команды. Например `FavorSizeOrSpeed` параметр `CL` Задача соответствует **/Os** и **/Ot** Параметры компилятора.  
  
Дополнительные параметры задачи поддерживают инфраструктуру MSBuild. Например `Sources` параметр задачи указывает набор задач, которые могут быть использованы другими задачами. Дополнительные сведения о задачах MSBuild см. в разделе [Справочные сведения о задачах](/visualstudio/msbuild/msbuild-task-reference).  
  
Для большинства задач требуются входные и выходные данные, такие как имена файлов, пути и строки, числовые или логические параметры. Например часто к входным данным — имя исходного CPP-файла для компиляции. Важные входного параметра является строка, указывающая конфигурации сборки и платформы, например, «отладка\|Win32». Входные и выходные данные задаются один или несколько определяемых пользователем XML `Item` элементов, содержащихся в `ItemGroup` элемент.  
  
Файл проекта можно также указать пользовательские *свойства* и `ItemDefinitionGroup` *элементы*. Свойства и элементы формируют пары имя/значение, которые можно использовать в качестве переменных при построении. Компонент имени пары определяет *макрос*, а компонент значения объявляет *значение макроса*. Макрос свойств осуществляется с помощью $(*имя*) нотации и макрос элемента осуществляется с помощью %(*имя*) нотации.  
  
Другие элементы XML в файле проекта можно тестировать макросы и затем условно значение любого макроса или контролировать выполнение построения. Имена макросов и строковые литералы можно сцепить для создания конструкций, таких как путь и имя файла. В командной строке **/property** Задает или переопределяет свойства проекта. Элементы нельзя ссылаться в командной строке.  
  
Система MSBuild может условно выполнить целевой объект до или после другого целевого объекта. Кроме того эта система может построить целевой объект на основании ли целевой объект использует файлы новее, чем выдаваемые им файлы.  
  
## <a name="msbuild-in-the-ide"></a>Использование MSBuild в Интегрированной среде разработки  
  
При задании свойств проекта в Интегрированной среде разработки и сохраните проект Visual C++ записывает параметры проекта в файл проекта. Файл проекта содержит параметры, уникальные для данного проекта, но не содержит все параметры, необходимые для построения проекта. Файл проекта содержит `Import` элементы, включающие в себя набор дополнительных *файлы поддержки.* Файлы поддержки содержат оставшиеся свойства, целевые объекты и параметры, необходимые для построения проекта.  
  
Большинство целевых объектов и свойств в файлах поддержки существуют исключительно для реализации системы построения. В следующем разделе описываются некоторые полезные целевые объекты и свойства, которые можно указать в командной строке MSBuild. Чтобы найти дополнительные целевые объекты и свойства, просмотрите файлы в каталогах файлов поддержки.  
  
### <a name="support-file-directories"></a>Каталоги файлов поддержки  
  
По умолчанию основные файлы поддержки Visual C++ расположены в следующих каталогах. Каталоги в Microsoft Visual Studio используются Visual Studio 2017 г. и более поздних версий, пока каталоги в MSBuild используются Visual Studio 2015 и более ранних версий.  
  
|Каталог|Описание|  
|---------------|-----------------|  
|*диск*: \Program Files *(x86)* \Microsoft Visual Studio\\*года*\\*edition*\Common7\IDE\VC\VCTargets\ <br /><br />*диск*: \Program Files *(x86)* \v4.0 \MSBuild\Microsoft.Cpp (x86)\\*версии*\ |Содержит основные файлы целевых (с расширением TARGETS) и файлы свойств (с расширением PROPS), используемые целевыми объектами. По умолчанию макрос $(VCTargetsPath) ссылается на этот каталог.|  
|*диск*: \Program Files *(x86)* \Microsoft Visual Studio\\*года*\\*edition*\Common7\IDE\VC\VCTargets\ Платформы\\*платформы*\ <br /><br />*диск*: \Program Files *(x86)* \MSBuild\Microsoft.Cpp\v4.0\\*версии*\Platforms\\*платформы*\ |Содержит файлы цель и свойство платформы, которые переопределяют целевые объекты и свойства в родительском каталоге. Эта папка также содержит библиотеку DLL, которая определяет задачи, которые используются в целевые объекты в этом каталоге.<br /><br /> *Платформы* представляет заполнитель, ARM, Win32 или x64 подкаталог.|  
|*диск*: \Program Files *(x86)* \Microsoft Visual Studio\\*года*\\*edition*\Common7\IDE\VC\VCTargets\ Платформы\\*платформы*\PlatformToolsets\\*набора инструментов*\ <br /><br />*диск*: \Program Files *(x86)* \MSBuild\Microsoft.Cpp\v4.0\\*версии*\Platforms\\*платформы*\ PlatformToolsets\\*набора инструментов*\ <br /><br />*диск*: \Program Files *(x86)* \MSBuild\Microsoft.Cpp\v4.0\Platforms\\*платформы*\PlatformToolsets\\*набора инструментов*\ |Содержит каталоги, которые обеспечивают построение приложений Visual C++ с помощью заданного *набор инструментов*.<br /><br /> *Года* и *выпуск* заполнители используются Visual Studio 2017 г. и более поздней версии. *Версии* заполнителем является V110 для Visual Studio 2012, V120 для Visual Studio 2013 или V140 для Visual Studio 2015. *Платформы* представляет заполнитель, ARM, Win32 или x64 подкаталог. *Набор инструментов* заполнитель представляет подкаталог набора инструментов, например, v140 для создания приложений Windows с помощью набора инструментов Visual Studio 2015, v120_xp для создания приложений для Windows XP, с помощью набора средств Visual Studio 2013 или v110_wp80 для Создание приложений Windows Phone 8.0 с помощью набора инструментов Visual Studio 2012.<br /><br />Путь, содержащий каталоги, которые обеспечивают построение приложений Visual C++ 2008 или Visual C++ 2010 не включает *версии*и *платформы* заполнитель Itanium, Win32 или x64 подкаталог. *Набор инструментов* заполнитель представляет подкаталог v90 или v100 набор инструментов.|  
  
### <a name="support-files"></a>Файлы поддержки  
  
Каталоги файлов поддержки содержит файлы с такими расширениями:  
  
|Расширение|Описание|  
|---------------|-----------------|  
|.targets|Содержит `Target` элементы XML, которые задают задачи, выполняемые целевым объектом. Может также содержать `PropertyGroup`, `ItemGroup`, `ItemDefinitionGroup`, и определяемых пользователем `Item` элементов, используемых для назначения параметров задачи файлы и параметры командной строки.<br /><br /> Дополнительные сведения см. в разделе [элемент Target (MSBuild)](/visualstudio/msbuild/target-element-msbuild).|  
|.props|Содержит `Property Group` и определяемых пользователем `Property` XML-элементов, укажите файл и параметры, которые используются во время построения.<br /><br /> Может также содержать `ItemDefinitionGroup` и определяемых пользователем `Item` XML-элементы, задающие Дополнительные параметры. Элементы, определенные в группу определений элемента напоминают свойства, но нельзя получить доступ из командной строки. Файлы проекта Visual C++ часто вместо свойств используются элементы для представления параметров.<br /><br /> Дополнительные сведения см. в разделе [элемент ItemGroup (MSBuild)](/visualstudio/msbuild/itemgroup-element-msbuild), [элемент ItemDefinitionGroup (MSBuild)](/visualstudio/msbuild/itemdefinitiongroup-element-msbuild), и [элемент Item (MSBuild)](/visualstudio/msbuild/item-element-msbuild).|  
|XML|Содержит XML-элементы, объявления и инициализации элементов пользовательского интерфейса интегрированной среды Разработки, например вкладки свойств и страницы свойств и поле и список текстовых полей.<br /><br /> XML-файлы непосредственно поддерживают интегрированную среду Разработки, не MSBuild. Тем не менее присваиваются значения свойств интегрированной среды Разработки для создания свойств и элементов.<br /><br /> Большинство XML-файлы хранятся в подкаталоге языковому стандарту. Например, файлы для региона английский (США) находятся в $(VCTargetsPath) \1033\\.|  
  
## <a name="user-targets-and-properties"></a>Пользовательские целевые объекты и свойства  
  
Для наиболее эффективного использования MSBuild в командной строке, полезно знать, какие свойства и целевые объекты являются полезным и нужным. Большинство свойств и целевых объектов упрощают реализацию системы построения Visual C++ и поэтому не связаны с пользователем. В этом разделе описаны некоторые оправданной свойства, ориентированные на пользователей и целевых объектов.  

### <a name="platformtoolset-property"></a>Свойство PlatformToolset  
  
`PlatformToolset` Свойство определяет, какой набор инструментов Visual C++, используемых в построении. По умолчанию используется текущий набор инструментов. Если это свойство имеет значение, значение свойства сцепляется со строковыми литералами для формирования пути к каталогу, содержащему файлы свойств и целевых объектов, которые необходимы для построения проекта для определенной платформы. Необходимо установить набор инструментов платформы для построения с помощью этой версии набора инструментов платформы.  
  
Например, задать `PlatformToolset` свойства `v140` использовать инструменты Visual C++ 2015 и библиотеки для построения приложения:  
  
`msbuild myProject.vcxproj /p:PlatformToolset=v140`  
  
### <a name="preferredtoolarchitecture-property"></a>Свойство PreferredToolArchitecture  
  
`PreferredToolArchitecture` Свойство определяет 32-разрядной или 64-разрядных компилятора и средств, используются ли в сборке. Это свойство не влияет на вывод архитектура платформы или конфигурации. По умолчанию MSBuild использует x86 версию компилятора и инструментов, если это свойство не задано.  
  
Например, задать `PreferredToolArchitecture` свойства `x64` использовать 64-разрядный компилятор и средства для построения приложения:  
  
`msbuild myProject.vcxproj /p:PreferredToolArchitecture=x64`  
  
### <a name="useenv-property"></a>UseEnv-свойство  
  
По умолчанию параметры платформы для текущего проекта переопределение переменных среды PATH, INCLUDE, LIB, LIBPATH, КОНФИГУРАЦИИ и ПЛАТФОРМЫ. Задать `UseEnv` Свойства `true` гарантировать, что переменные среды не переопределен.  
  
`msbuild myProject.vcxproj /p:UseEnv=true`  
  
### <a name="targets"></a>Целевые объекты  
  
Существуют сотни целевых объектов в файлах поддержки Visual C++. Однако большинство являются целевых объектов, ориентированных на системы, пользователь может их игнорировать. Большинство целевых объектов системы имеют префикс в виде символа подчеркивания (_) или иметь имя, которое начинается с «PrepareFor», «Вычисления», «До», «После», «Pre» или «Post».  
  
В следующей таблице перечислены несколько полезных целей, ориентированные на пользователей.  
  
|целевого объекта|Описание|  
|------------|-----------------|  
|BscMake|Выполняет программу Microsoft Обзор программы управления информацией bscmake.exe.|  
|Построить|Выполняет построение проекта.<br /><br /> Это является целевым объектом по умолчанию для проекта.|  
|ClCompile|Выполняет программу Visual C++ компилятор cl.exe.|  
|Очистить|Удаляет временные и промежуточные файлы сборки.|  
|LIB|Выполняет программу Microsoft 32-разрядной библиотеки диспетчера lib.exe.|  
|Ссылка|Запускает средство компоновщик Visual C++ link.exe.|  
|ManifestResourceCompile|Извлекает список ресурсов из манифеста и затем запускает средство компилятор ресурсов Microsoft Windows rc.exe.|  
|MIDL|Запускает средство компилятора Microsoft интерфейс определения языка MIDL midl.exe.|  
|Перестроить|Выполняет очистку, а затем выполняет построение проекта.|  
|ResourceCompile|Запускает средство компилятор ресурсов Microsoft Windows rc.exe.|  
|Программа XdcMake|Выполняет программу XML-документации xdcmake.exe.|  
|XSD|Запускает средство определения схемы XML xsd.exe.|  
  
## <a name="see-also"></a>См. также  
  
[MSBuild (Visual C++)](../build/msbuild-visual-cpp.md)
