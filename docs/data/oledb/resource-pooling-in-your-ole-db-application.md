---
title: Создание пулов ресурсов в приложениях OLE DB | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- OLE DB services [OLE DB], resource pooling
- resource pooling [OLE DB], services
- OLE DB, resource pooling
- OLE DB providers, resource pooling
ms.assetid: 2ead1bcf-bbd4-43ea-a307-bb694b992fc1
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 0302f35c7de78088d1c5e662f65daf467cb1dfa2
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50069702"
---
# <a name="resource-pooling-in-your-ole-db-application"></a>Создание пулов ресурсов в приложениях OLE DB

Пулов в приложении, необходимо убедиться в том, вызваны получение источника данных через службы OLE DB `IDataInitialize` или `IDBPromptInitialize`. При непосредственном использовании `CoCreateInstance` для вызова поставщика на основе его CLSID, вызываются службы OLE DB.

Службы OLE DB Ведение кластеров из подключенных источников данных при условии, ссылку на `IDataInitialize` или `IDBPromptInitialize` публичной или условии, что имеется соединение используется. Пулы также будут автоматически обновлены в среде служб COM + 1.0 и Internet Information Services (IIS). Если приложение использует преимущества пулов вне среды служб COM + 1.0 или IIS, следует хранить ссылку на `IDataInitialize` или `IDBPromptInitialize` или поддерживать по крайней мере одно подключение. Чтобы убедиться в том, что пул не удалялся при выпуске последнего подключения приложением, сохранять ссылку на или хранения соединению в течение жизненного цикла приложения.

Службы OLE DB определите пул, из которого берется подключение, во время, `Initialize` вызывается. После подключения из пула, ее нельзя переместить в другой пул. Таким образом, не следует изменять в приложении, которые изменяют сведения об инициализации, например, вызов `UnInitialize` или вызова `QueryInterface` для интерфейса поставщика перед вызовом `Initialize`. Кроме того что установленных соединений с prompt значение, отличное от DBPROMPT_NOPROMPT, не помещаются в пул. Тем не менее Строка инициализации, извлеченная из соединения, установленного через запрос можно использовать для установки дополнительных пула подключений к тому же источнику данных.

Некоторым поставщикам необходимо создавать отдельное подключение для каждого сеанса. Эти дополнительные подключения необходимо отдельно прикрепляется к распределенной транзакции, если он существует. Службы OLE DB кэширует и повторно использует один сеанс на каждый источник данных, но если приложение запрашивает несколько сеансов за раз из одного источника данных, поставщик может оказаться, что создание дополнительных подключений и выполнении зачисления дополнительных транзакций, которые являются не в составе пула. Это более эффективный способ — создать отдельный источник данных для каждого сеанса в составе пула среду, чем создание нескольких сеансов из одного источника данных.

Наконец поскольку ADO автоматически использует OLE DB для служб, можно использовать ADO для установки соединений и пулы и зачисление происходит автоматически.

## <a name="see-also"></a>См. также

[Создание пулов ресурсов и служб OLE DB](../../data/oledb/ole-db-resource-pooling-and-services.md)