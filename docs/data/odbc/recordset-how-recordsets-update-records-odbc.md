---
title: Набор записей. Порядок обновления записей в наборе (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- records, updating
- ODBC recordsets, updating
- recordsets, editing records
- updating recordsets
- recordsets, updating
ms.assetid: 5ceecc06-7a86-43b1-93db-a54fb1e717c7
ms.openlocfilehash: 578b3b39d90b3beb80dbd201d4982fee30dc6bce
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80212879"
---
# <a name="recordset-how-recordsets-update-records-odbc"></a>Набор записей. Порядок обновления записей в наборе (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

Помимо возможности выбора записей из источника данных, наборы записей могут (при необходимости) обновлять или удалять выбранные записи или добавлять новые. Возможность обновления набора записей определяется тремя факторами: разрешено ли обновление подключенного источника данных, параметры, заданные при создании объекта набора записей, и созданный SQL.

> [!NOTE]
>  SQL, на котором основан объект `CRecordset`, может влиять на возможность обновления набора записей. Например, если SQL содержит предложение Join или **Group By** , MFC устанавливает для обновления значение false.

> [!NOTE]
>  Этот раздел относится к объектам, производным от `CRecordset`, в которых пакетное получение строк не реализовано. Если используется многострочная выборка строк, см. раздел [набор записей: групповая выборка записей (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

В этом разделе рассматриваются следующие вопросы.

- [Ваша роль в обновлении набора записей](#_core_your_role_in_recordset_updating) и о том, что делает платформа.

- [Набор записей в качестве буфера редактирования](#_core_the_edit_buffer) и [различия между динамическими подмножествами и моментальными снимками](#_core_dynasets_and_snapshots).

[Набор записей. как операции AddNew, Edit и Delete (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md) описывают действия этих функций с точки зрения набора записей.

[Набор записей. Дополнительные сведения об обновлениях (ODBC)](../../data/odbc/recordset-more-about-updates-odbc.md) завершает историю обновления набора записей, объясняя, как транзакции влияют на обновления, как закрытие набора записей или прокрутки влияет на выполняемые обновления и как обновления взаимодействуют с обновлениями других пользователей.

##  <a name="your-role-in-recordset-updating"></a><a name="_core_your_role_in_recordset_updating"></a>Ваша роль в обновлении набора записей

В следующей таблице показана роль в использовании наборов записей для добавления, изменения и удаления записей, а также действий, выполняемых платформой.

### <a name="recordset-updating-you-and-the-framework"></a>Обновление набора записей. Вы и платформа

|Вы|Платформа|
|---------|-------------------|
|Определите, является ли источник данных обновляемым (или добавив его).|Предоставляет функции элементов [CDatabase](../../mfc/reference/cdatabase-class.md) для проверки возможности обновления или присоединения источника данных.|
|Откройте обновляемый набор записей (любого типа).||
|Определите, можно ли обновить набор записей, вызвав `CRecordset` функции обновления, такие как `CanUpdate` или `CanAppend`.||
|Вызывайте функции элементов набора записей для добавления, изменения и удаления записей.|Управляет механизмом обмена данными между объектом Recordset и источником данных.|
|При необходимости используйте транзакции для управления процессом обновления.|Предоставляет `CDatabase` функции элементов для поддержки транзакций.|

Дополнительные сведения о транзакциях см. в разделе [Transaction (ODBC)](../../data/odbc/transaction-odbc.md).

##  <a name="the-edit-buffer"></a><a name="_core_the_edit_buffer"></a>Буфер редактирования

В совокупности элементы данных поля набора записей служат в качестве буфера редактирования, который содержит одну запись — текущую запись. Операции обновления используют этот буфер для работы с текущей записью.

- При добавлении записи используется буфер редактирования для создания новой записи. По завершении добавления записи запись, которая ранее стала текущей, снова станет текущей.

- При обновлении (изменении) записи, буфер редактирования используется для задания элементов данных поля набора записей в новых значениях. После завершения обновления обновленная запись остается актуальной.

При вызове метода [AddNew](../../mfc/reference/crecordset-class.md#addnew) или [Edit](../../mfc/reference/crecordset-class.md#edit)текущая запись сохраняется, поэтому ее можно восстановить позже по мере необходимости. При вызове [Delete](../../mfc/reference/crecordset-class.md#delete)текущая запись не сохраняется, но помечается как удаленная, поэтому необходимо выполнить прокрутку до другой записи.

> [!NOTE]
>  Буфер редактирования не играет роли при удалении записи. При удалении текущей записи запись помечается как удаленная, а набор записей — "не на запись", пока вы не выполните прокрутку до другой записи.

##  <a name="dynasets-and-snapshots"></a><a name="_core_dynasets_and_snapshots"></a>Динамические наборы данных и моментальные снимки

[Динамические подмножества](../../data/odbc/dynaset.md) обновляют содержимое записи при переходе к записи. [Моментальные снимки](../../data/odbc/snapshot.md) — это статические представления записей, поэтому содержимое записи не обновляется, пока не будет вызван метод [Refresh](../../mfc/reference/crecordset-class.md#requery). Чтобы использовать все функции динамических подмножеств, необходимо работать с драйвером ODBC, который соответствует правильному уровню поддержки API ODBC. Дополнительные сведения см. в разделе [ODBC](../../data/odbc/odbc-basics.md) и [динамический](../../data/odbc/dynaset.md)набор.

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Наборы записей. Принципы работы функций AddNew, Edit и Delete (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md)
