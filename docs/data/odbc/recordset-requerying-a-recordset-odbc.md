---
title: 'Набор записей: Выполнение обновления наборов записей (ODBC) | Документация Майкрософт'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- recordsets, requerying
- requerying recordsets
- Requery method
- ODBC recordsets, requerying
- refreshing recordsets
ms.assetid: 4ebc3b5b-5b91-4f51-a967-245223c6b8e1
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 7d228fb97cad2fba426aa6415564d3b7f60363b5
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50062688"
---
# <a name="recordset-requerying-a-recordset-odbc"></a>Набор записей. Выполнение обновления наборов записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

В этом разделе объясняется, как можно использовать объект набора записей для запроса (обновления) сам из базы данных, и когда может потребоваться сделать с помощью [Requery](../../mfc/reference/crecordset-class.md#requery) функция-член.

К основным причинам выполнение обновления наборов записей, чтобы:

- Открыть набор записей в актуальном состоянии с точки зрения записи, добавленные вами или другими пользователями и записи, удаленные другими пользователями (те, которые можно удалить, уже отражаются в наборе записей).

- Обновление набора записей, в зависимости от изменяющихся значений параметров.

##  <a name="_core_bringing_the_recordset_up_to_date"></a> Обновление набора записей с начала

Часто требуется объекта набора записей для обеспечения ее в актуальном состоянии. В среде многопользовательской базы данных другие пользователи могут вносить изменения в данные в течение жизни набора записей. Дополнительные сведения о при набор записей отражает изменения, внесенные другими пользователями, и наборы записей других пользователей отражают изменения, см. в разделе [набор записей: принцип наборы записей обновления записей (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) и [динамический набор](../../data/odbc/dynaset.md).

##  <a name="_core_requerying_based_on_new_parameters"></a> Выполнение обновления наборов на основе новых параметров

Часто и что не менее важно — использование [Requery](../../mfc/reference/crecordset-class.md#requery) заключается в выборе нового набора записей на основе изменения значений параметров.

> [!TIP]
>  Скорость запросов может быть значительно выше, при вызове метода `Requery` с измененными параметрами, по сравнению с вызовом `Open` еще раз.

##  <a name="_core_requerying_dynasets_vs.._snapshots"></a> Обновление vs динамических подмножеств данных. Моментальные снимки

Поскольку динамические наборы предназначены для представления набора записей с динамическим актуальность данных, требуется requery динамических подмножеств данных, часто в том случае, если требуется в соответствии с другими пользователями. Моментальные снимки, с другой стороны, полезны, поскольку можно уверенно полагаться на статическое содержимое во время подготовки отчетов, вычисления итогов и т. д. Тем не менее иногда может потребоваться повторный запрос и моментальные снимки. В многопользовательской среде данные моментального снимка могут потерять синхронизацию с источником данных, как другим пользователям изменить базу данных.

#### <a name="to-requery-a-recordset-object"></a>Для запроса объекта набора записей

1. Вызовите [Requery](../../mfc/reference/crecordset-class.md#requery) функции-члена объекта.

Кроме того можно закрыть и снова открыть первоначальный набор записей. В любом случае новый набор записей представляет текущее состояние источника данных.

Например, см. в разделе [представления записей: заполнение списка из второго набора записей](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md).

> [!TIP]
>  Для оптимизации `Requery` производительность, избегайте вносить изменения в набор записей [фильтра](../../data/odbc/recordset-filtering-records-odbc.md) или [сортировки](../../data/odbc/recordset-sorting-records-odbc.md). Измените значение параметра перед вызовом `Requery`.

Если `Requery` вызов завершается ошибкой, можно повторить попытку вызова; в противном случае приложение должно корректно прекращено. Вызов `Requery` или `Open` может завершиться с ошибкой по ряду причин. Возможно возникает ошибка сети; или во время вызова, после выпуска существующих данных, но до получения новых данных другой пользователь мог получить монопольный доступ; или может быть удален, таблицы, от которого зависит набор записей.

## <a name="see-also"></a>См. также

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Динамическая привязка столбцов данных (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)<br/>
[Набор записей. Создание и закрытие наборов записей (ODBC)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)