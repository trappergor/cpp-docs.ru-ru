---
title: 'Набор записей: Фильтрация записей (ODBC) | Документация Майкрософт'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- data [MFC], filtering
- recordsets [C++], filtering
- filtering recordsets
- ODBC recordsets [C++], filtering records
- filters [C++], recordset object
ms.assetid: 5c075f37-c837-464d-90c1-d028a9d1c175
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 5feb97d2bf3cbd3787ed2253b3b2dd4a257b5315
ms.sourcegitcommit: 913c3bf23937b64b90ac05181fdff3df947d9f1c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2018
ms.locfileid: "46040795"
---
# <a name="recordset-filtering-records-odbc"></a>Набор записей. Фильтрация записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.  
  
В этом разделе объясняется, как для фильтрации набора записей, который позволяет только конкретному подмножеству доступных записей. Например может потребоваться выбрать только класс разделы для определенного курса, например MATH101. Фильтр — условия поиска, определенного по содержимому SQL **ГДЕ** предложение. Если платформа добавляет его в инструкции SQL набора записей, **ГДЕ** предложение ограничивает выбор.  
  
Установите фильтр для объекта набора записей после создания объекта, но перед вызовом его `Open` функция-член (или перед вызовом метода `Requery` функция-член для существующего набора записей объекта, `Open` имеет функцию-член был вызван ранее).  
  
#### <a name="to-specify-a-filter-for-a-recordset-object"></a>Для указания фильтра для объекта набора записей  
  
1. Создайте новый объект набора записей (или вызовите `Requery` для существующего объекта).  
  
1. Установите для параметра объекта [m_strFilter](../../mfc/reference/crecordset-class.md#m_strfilter) элемент данных.  
  
     Фильтр является нулем строка, содержащая содержимое SQL **ГДЕ** предложение, но не ключевое слово **ГДЕ**. Например используйте:  
  
    ```  
    m_pSet->m_strFilter = "CourseID = 'MATH101'";  
    ```  
  
     not  
  
    ```  
    m_pSet->m_strFilter = "WHERE CourseID = 'MATH101'";  
    ```  
  
    > [!NOTE]
    >  Строковый литерал «MATH101» отображается в одинарные кавычки выше. В спецификации ODBC SQL одинарные кавычки используются для обозначения символа строкового литерала. Обратитесь к документации драйвера ODBC для кавычек требования СУБД в этой ситуации. Этот синтаксис также рассматривается дальнейшей почти в конце этого раздела.  
  
1. Задайте другие параметры, необходимые, например, порядок сортировки, режим блокировки или параметры. Указание параметра особенно полезно. Сведения о параметризации фильтра см. в разделе [набор записей: Параметризация набора записей (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).  
  
1. Вызовите `Open` для нового объекта (или `Requery` для уже открытого объекта).  
  
> [!TIP]
>  Использование параметров в фильтре потенциально является наиболее эффективный метод для извлечения записей.  
  
> [!TIP]
>  Фильтры набора записей можно использовать для [присоединение](../../data/odbc/recordset-performing-a-join-odbc.md) таблиц и по использованию [параметры](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) зависимости от данных, полученных или вычисляется во время выполнения.  
  
Набор записей выбирает только те записи, которые удовлетворяют условию поиска, которую вы указали. Например, для указания фильтра курс описанные выше (при условии, что переменная `strCourseID` в настоящий момент установлена, например, «MATH101»), выполните следующие действия:  
  
```  
// Using the recordset pointed to by m_pSet  
  
// Set the filter  
m_pSet->m_strFilter = "CourseID = " + strCourseID;   
  
// Run the query with the filter in place  
if ( m_pSet->Open( CRecordset::snapshot, NULL, CRecordset::readOnly ) )  
  
// Use the recordset  
```  
  
Набор записей содержит записи для всех разделов класса за MATH101.  
  
Обратите внимание на то, как строку фильтра, заданное в приведенном выше примере, используя строковую переменную. Это типичный сценарий использования. Однако предположим, что необходимо задать значение литерала 100 для идентификатор курса. Ниже показано, как задать строку фильтра правильно с литеральным значением:  
  
```  
m_strFilter = "StudentID = '100'";   // correct  
```  
  
Обратите внимание на использование одинарных кавычек; Если выбрать строку фильтра непосредственно строку фильтра является **не**:  
  
```  
m_strFilter = "StudentID = 100";   // incorrect for some drivers  
```  
  
Функция кавычек, представленная выше соответствует спецификации ODBC, но некоторые СУБД требуют других символов кавычек. Дополнительные сведения см. в разделе [SQL: инструкция SQL Настройка набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  
  
> [!NOTE]
>  Если вы решили переопределить строку SQL набора записей по умолчанию, передав строку SQL для `Open`, не нужно устанавливать фильтр, если Настраиваемая строка имеет **ГДЕ** предложение. Дополнительные сведения о переопределении SQL по умолчанию, см. в разделе [SQL: инструкция SQL Настройка набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).  
  
## <a name="see-also"></a>См. также  

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Сортировка записей (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md)<br/>
[Набор записей. Порядок выборки записей в наборе (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md)<br/>
[Набор записей. Порядок обновления записей в наборе (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)<br/>
[Набор записей. Блокировка (ODBC)](../../data/odbc/recordset-locking-records-odbc.md)