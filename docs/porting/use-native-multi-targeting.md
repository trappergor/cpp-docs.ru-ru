---
title: Использование собственного многоплатформенного нацеливания в Visual Studio для сборки старых проектов
ms.date: 11/04/2016
helpviewer_keywords:
- C++ native multi-targeting
- upgrading Visual C++ applications, retargeting
ms.assetid: b115aabe-a9dc-4525-90d3-367d97ea20c9
ms.openlocfilehash: 35f6ac980a451b375d5005c20853fdd29c78d96d
ms.sourcegitcommit: 7d64c5f226f925642a25e07498567df8bebb00d4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2019
ms.locfileid: "65448942"
---
# <a name="use-native-multi-targeting-in-visual-studio-to-build-old-projects"></a>Использование собственного многоплатформенного нацеливания в Visual Studio для сборки старых проектов

Как правило, при установке последней версии Visual Studio рекомендуется обновить проекты. Затраты на обновление проектов и кода обычно с избытком компенсируются преимуществами новой интегрированной среды разработки, компилятора, библиотек и инструментов. Однако мы знаем, что некоторые проекты обновить не удастся. У вас могут быть двоичные файлы, которые привязаны к старым библиотекам или платформам, которые нельзя обновить по причинам, связанным с обслуживанием. В коде могут использоваться нестандартные языковые конструкции, которые могут перестать работать при переходе на более новую версию компилятора. Ваш код может использовать библиотеки сторонних производителей, скомпилированных для конкретной версии Visual C++. Или вы можете создать библиотеки для других пользователей, которые должны быть предназначены для конкретной более старой версии Visual C++.

К счастью, Visual Studio 2017 и Visual Studio 2015 можно использовать для построения проектов, нацеленных на старые наборы инструментов компилятора и библиотеки. Не нужно обновлять проект Visual Studio 2010, Visual Studio 2012, Visual Studio 2013 или Visual Studio 2015, чтобы воспользоваться преимуществами новых функций в интегрированной среде разработки.

  - Новые возможности рефакторинга кода C++ и экспериментальные функции редактора
  - Новое окно отладчика "Средства диагностики" и окно "Список ошибок"
  - Переработанные точки останова, окно исключений и новые советы для повышения производительности
  - Новые средства навигации и поиска в коде
  - Новые быстрые исправления C++ и расширения Productivity Power Tools

Можно также работать с проектами Visual Studio 2008, но их нельзя использовать без изменений. Дополнительные сведения см. в разделе **инструкций по Visual Studio 2008**.

Последние версии Visual Studio поддерживают собственное многоплатформенное нацеливание и совместимость проектов. Собственное многоплатформенное нацеливание представляет собой возможность новейшей версии интегрированной среды разработки выполнять сборку с помощью наборов инструментов, установленных предыдущими версиями Visual Studio. Циклическая обработка также является преимуществом последней версии IDE, которое заключается в загрузке проектов, созданных в предыдущей версии, без внесения изменений в проект. Установив последнюю версию Visual Studio параллельно с существующей версией, вы можете использовать новую версию IDE для сборки проектов, обращаясь к компилятору и инструментам из предыдущих версий. Другие участники команды могут продолжать использовать проекты в старой версии Visual Studio.

При работе со старым набором инструментов вам доступны преимущества многих современных функций интегрированной среды разработки, однако это не относится к новым возможностям компилятора C++, библиотеки и средств сборки. Например, вы не сможете использовать новые улучшения соответствия языковым стандартам, новые возможности отладки и анализа кода или более высокую скорость сборки, обеспечиваемую новейшим набором инструментов. Кроме того, некоторые функции интегрированной среды разработки несовместимы с более старыми наборами инструментов. Например, в профилировщике памяти могут отсутствовать сведения о типе, а операция рефакторинга **Преобразовать в необработанные строковые литералы** может генерировать код, совместимый с C++11, который не будет компилироваться при использовании Visual Studio 2012 или более старых наборов инструментов.

## <a name="how-to-use-native-multi-targeting-in-visual-studio"></a>Как использовать собственное многоплатформенное нацеливание в Visual Studio

После установки Visual Studio параллельно с более старой версией откройте существующий проект в новой версии Visual Studio. После загрузки проекта Visual Studio предложит обновить его для использования последней версии компилятора C++ и библиотек. Так как требуется, чтобы в проекте использовались более старые версии компилятора и библиотек, нажмите кнопку **Отмена**.

Visual Studio будет постоянно выводить запрос на обновление проекта. Чтобы это диалоговое окно не появлялось при каждой загрузке проекта, можно определить следующее свойство в проектах или импортируемых PROPS- и TARGETS-файлах:

`<VCProjectUpgraderObjectName>NoUpgrade</VCProjectUpgraderObjectName>`

Если необходимо обновить проекты, это свойство следует удалить.

Если вы решили не выполнять обновление, Visual Studio не внесет никаких изменений в файлы решения или проекта. При сборке проекта созданные двоичные файлы полностью совместимы с теми, которые построены в более старой версии Visual Studio. Это связано с тем, что Visual Studio использует тот же компилятор C++ и связывает те же библиотеки, которые входили в состав более старой версии интегрированной среды разработки. Именно поэтому в диалоговом окне обновления выводится предупреждение о необходимости сохранить старую версию Visual Studio, если вы хотите нажать кнопку **Отмена**.

## <a name="instructions-for-visual-studio-2008"></a>Инструкции по Visual Studio 2008

В Visual Studio 2008 существовала собственная выделенная система сборки для C++, которая называлась **VCBuild**. Начиная с Visual Studio 2010 проекты Visual Studio C++ были изменены для использования **MSBuild**. Это означает, что для сборки проектов Visual Studio 2008 в последней версии Visual Studio необходимо пройти этап обновления. Обновленный проект по-прежнему создает двоичные файлы, которые полностью совместимы с двоичными файлами, созданными в интегрированной среде разработки Visual Studio 2008.

Сначала в дополнение к текущей версии Visual Studio необходимо установить Visual Studio 2010 на одном компьютере с Visual Studio 2008. Скрипты **MSBuild**, которые требуются для проектов Visual Studio 2008, может установить только Visual Studio 2010.

Затем нужно обновить решение и проекты Visual Studio 2008 до текущей версии Visual Studio. Перед обновлением рекомендуется создать резервную копию файлов проектов и решений. Чтобы начать процесс обновления, откройте решение в текущей версии Visual Studio. При выводе запроса на обновление просмотрите сведения и нажмите кнопку **ОК**, чтобы запустить обновление. Если в решении имеется несколько проектов, которые требуется обновить, мастер создаст VCXPROJ-файлы проекта параллельно с существующими VCPROJ-файлами. Пока в вашем распоряжении находится копия исходного SLN-файла, обновление не оказывает влияние на существующие проекты Visual Studio 2008.

Если по завершении обновления в журнале ошибок появятся ошибки или предупреждения по проектам, внимательно изучите их. Преобразование из **VCBuild** в **MSBuild** может привести к возникновению проблем. Вы должны понимать и уметь применять все элементы действий, приведенные в отчете. Дополнительные сведения об отчете по журналу обновлений и проблемах, которые могут возникнуть при преобразовании **VCBuild** в **MSBuild**, см. в записи блога [Собственное многоплатформенное нацеливание C++](https://blogs.msdn.microsoft.com/vcblog/2009/12/08/c-native-multi-targeting/).

После завершения обновления проекта и исправления проблем в файле журнала ваше решение будет нацелено на последний набор инструментов. На завершающем этапе измените свойства для каждого проекта в решение так, чтобы использовался набор инструментов Visual Studio 2008. Загрузите решение в текущей версии Visual Studio. Для каждого проекта в решении откройте диалоговое окно **Страницы свойств**. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Свойства**. В диалоговом окне **Страницы свойств** измените значение **Конфигурация** на **Все конфигурации**. В разделе **Свойства конфигурации** выберите **Общие**, а затем измените **Набор инструментов платформы** на **Visual Studio 2008 (v90)** .

После этого изменения библиотеки и компилятор Visual Studio 2008 будут использоваться для создания двоичных файлов проекта при сборке решения в текущей версии Visual Studio.

## <a name="install-an-older-visual-studio-toolset"></a>Установка старого набора инструментов Visual Studio

У вас может быть старый проект Visual Studio C++, который нельзя или не требуется обновлять, но у вас нет той версии набора инструментов платформы, которая соответствует проекту. Чтобы получить набор инструментов, можно установить бесплатный выпуск Visual Studio Community или Express нужной версии. Каждая версия Visual Studio из Visual Studio 2008 может установить компилятор, инструменты и библиотеки, необходимые для этой версии, из текущего выпуска Visual Studio. В Центре загрузки Майкрософт найдите и скачайте конкретную версию Visual Studio. Убедитесь, что во время установки выбраны параметры установки C++. После завершения установки запустите эту версию Visual Studio, чтобы установить обновления. Также проверьте наличие необходимых изменений в Центре обновления Windows. Этот процесс проверки обновлений может потребоваться повторить несколько раз для получения каждого обновления.

Доступные для скачивания версии можно найти на [странице скачивания старых версий Visual Studio](https://visualstudio.microsoft.com/vs/older-downloads/).

При установке этих продуктов раскрывающееся меню свойств **Набор инструментов платформы** в диалоговом окне **Страницы свойств** автоматически обновляется для отображения доступных наборов инструментов. Теперь можно использовать последнюю версию Visual Studio для сборки проектов для предыдущих версий набора инструментов без их преобразования или обновления.

## <a name="see-also"></a>См. также

[Обновление проектов, созданных в предыдущих версиях Visual C++](upgrading-projects-from-earlier-versions-of-visual-cpp.md)<br/>
[Улучшения соответствия C++ в Visual Studio](../overview/cpp-conformance-improvements.md)
