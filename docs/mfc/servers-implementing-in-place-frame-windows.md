---
title: Серверы. Реализация окон фрейма на месте
ms.date: 09/09/2019
helpviewer_keywords:
- frame windows [MFC], implementing
- OLE server applications [MFC], frame windows
- servers, in-place frame windows
- frame windows [MFC], in-place
- in-place frame windows
ms.assetid: 09bde4d8-15e2-4fba-8d14-9b954d926b92
ms.openlocfilehash: a082afe141a21e4175886f13a26043694ac0d426
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87230471"
---
# <a name="servers-implementing-in-place-frame-windows"></a>Серверы. Реализация окон фрейма на месте

В этой статье объясняется, что необходимо сделать для реализации встроенных окон фрейма в приложении Visual Editing Server, если не используется мастер приложений для создания серверного приложения. Вместо выполнения процедуры, описанной в этой статье, можно использовать существующий класс окна фрейма на месте из приложения, созданного с помощью мастера приложений, или образца, предоставленного Visual C++.

#### <a name="to-declare-an-in-place-frame-window-class"></a>Объявление класса фрейма окна на месте

1. Создайте производный класс окна фрейма на месте из `COleIPFrameWnd` .

   - Используйте макрос DECLARE_DYNCREATE в файле заголовка класса.

   - Используйте макрос IMPLEMENT_DYNCREATE в файле реализации класса (. cpp). Это позволяет платформе создавать объекты этого класса.

1. Объявите `COleResizeBar` элемент в классе фреймового окна. Это необходимо, если требуется поддержка изменения размера на месте в серверных приложениях.

   Объявите `OnCreate` обработчик сообщений (с помощью [мастера классов](reference/mfc-class-wizard.md)) и вызовите `Create` свой `COleResizeBar` член, если он определен.

1. Если у вас есть панель инструментов, объявите `CToolBar` элемент в классе фреймового окна.

   Переопределите `OnCreateControlBars` функцию-член, чтобы создать панель инструментов, когда сервер активен. Пример:

   [!code-cpp[NVC_MFCOleServer#1](../mfc/codesnippet/cpp/servers-implementing-in-place-frame-windows_1.cpp)]

   См. Описание этого кода, приведенного на шаге 5.

1. Включите файл заголовка для этого класса встроенного фрейма окна в основной CPP-файл.

1. В `InitInstance` для класса приложения вызовите `SetServerInfo` функцию объекта шаблона документа, чтобы указать ресурсы и окно фрейма на месте, которое будет использоваться при открытии и редактировании на месте.

Последовательность вызовов функций в **`if`** инструкции создает панель инструментов на основе ресурсов, предоставленных сервером. На этом этапе панель инструментов является частью иерархии окон контейнера. Поскольку эта панель инструментов является производной от `CToolBar` , она передает ей свои сообщения владельцу, окно фрейма приложения контейнера, если владелец не изменен. Именно поэтому вызов `SetOwner` необходим. Этот вызов изменяет окно, куда отправляются команды, в окно размещения на сервере, в результате чего сообщения передаются на сервер. Это позволяет серверу реагировать на операции на панели инструментов, которые он предоставляет.

Идентификатор точечного рисунка панели инструментов должен быть таким же, как и другие ресурсы на месте, определенные в серверном приложении. Дополнительные сведения см. в разделе [меню и ресурсы: дополнения сервера](../mfc/menus-and-resources-server-additions.md) .

Дополнительные сведения см. в разделе [COleIPFrameWnd](../mfc/reference/coleipframewnd-class.md), [колересизебар](../mfc/reference/coleresizebar-class.md)и [CDocTemplate:: Сетсерверинфо](../mfc/reference/cdoctemplate-class.md#setserverinfo) в *справочнике по библиотеке классов*.

## <a name="see-also"></a>См. также раздел

[Серверы](../mfc/servers.md)<br/>
[Серверы: реализация сервера](../mfc/servers-implementing-a-server.md)<br/>
[Серверы: реализация серверных документов](../mfc/servers-implementing-server-documents.md)<br/>
[Серверы: элементы сервера](../mfc/servers-server-items.md)
