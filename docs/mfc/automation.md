---
title: Автоматизация
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers, about Automation servers
- clients, Automation
- programmatic control [MFC]
- properties [MFC], Automation
- MFC, COM support
- OLE Automation
- Automation
- servers [MFC], Automation
- Automation clients
- sample applications [MFC], Automation
- methods [MFC]
- passing parameters, Automation
- Automation method [MFC]
- Automation, passing parameters
- Automation property [MFC]
- MFC COM, Automation
- methods [MFC], Automation
ms.assetid: 329117f0-c1aa-4680-a901-bfb71277dfba
ms.openlocfilehash: e5790be14f26f59c2b51b339c8bee7c5eca7d692
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84616516"
---
# <a name="automation"></a>Автоматизация

Автоматизация (ранее известная как OLE-автоматизация) позволяет одному приложению управлять объектами, реализованными в другом приложении, или выделять объекты для управления.

[Сервер автоматизации](automation-servers.md) — это приложение (тип COM-сервера), предоставляющее свои функции через COM-интерфейсы другим приложениям, называемым [клиентами автоматизации](automation-clients.md). Это позволяет клиентам автоматизировать некоторые функции путем прямого доступа к объектам и использования предоставляемых ими возможностей.

Серверы и клиенты автоматизации используют COM-интерфейсы, которые всегда являются производными от `IDispatch` , и принимают и возвращают определенный набор типов данных, называемых типами автоматизации. Предоставив методы и свойства, доступные из других приложений, можно автоматизировать любой объект, который позволяет обращаться к интерфейсу автоматизации. Автоматизация доступна для OLE- и COM-объектов. Автоматизированный объект может быть локальным или удаленным (на другом компьютере, доступном по сети), поэтому существует две категории автоматизации.

- Автоматизация (локальная).

- Удаленная автоматизация (через сеть с использованием DCOM).

Предоставление доступа к объектам полезно в том случае, когда приложения предлагают функциональные возможности, полезные для других приложений. Например элемент управления ActiveX — это тип сервера автоматизации. Приложение, в котором размещается элемент управления ActiveX, является клиентом автоматизации этого элемента управления.

Другой пример: текстовый процессор может предоставлять свои функции по проверке орфографии другим программам. Благодаря доступу к объектам поставщики способны совершенствовать свои приложения с помощью готовых функциональных возможностей других приложений. Таким образом, автоматизация применяет некоторые принципы объектно-ориентированного программирования, такие как возможность многократного использования и инкапсуляции, на уровне самих приложений.

Особое значение имеет поддержка, предоставляемая автоматизацией пользователям и поставщикам решений. За счет доступа к функциональным возможностям приложений через стандартный и четко определенный интерфейс автоматизации позволяет создавать комплексные решения на одном общем языке программирования, например Visual Basic, а не прибегать к различным связанным с конкретными приложениями макроязыкам.

Многие коммерческие приложения, например Microsoft Excel и Microsoft Visual C++, допускают автоматизацию большей части своих функциональных возможностей. Например, в Visual C++, можно написать макросы VBScript для автоматизации построений, аспектов редактирования кода или задач отладки.

## <a name="passing-parameters-in-automation"></a><a name="_core_passing_parameters_in_automation"></a> Передача параметров в автоматизации

Одна из сложностей при создании методов автоматизации заключается в обеспечении согласованного безопасного механизма для передачи данных между серверами и клиентами автоматизации. Для передачи данных автоматизация использует тип **VARIANT** . Тип **VARIANT** является помеченным объединением. У него есть элемент данных для значения (это анонимное объединение C++) и элемент данных, указывающий тип сведений, хранящихся в объединении. Тип **VARIANT** поддерживает ряд стандартных типов данных: 2- и 4-байтовые целые числа, 4- и 8-байтовые числа с плавающей запятой, строки и логические значения. Кроме того, он поддерживает значения **HRESULT** (коды ошибок OLE), **валюты** (числовой тип с фиксированной запятой) и **даты** (абсолютных дат и времени), а также указатели на `IUnknown` `IDispatch` интерфейсы и.

Тип **VARIANT** инкапсулирован в класс [COleVariant](reference/colevariant-class.md) . Поддерживаемые классы **CURRENCY** и **DATE** инкапсулированы в классы [COleCurrency](reference/colecurrency-class.md) и [COleDateTime](../atl-mfc-shared/reference/coledatetime-class.md) .

## <a name="automation-samples"></a>Примеры автоматизации

- [AUTOCLIK](../overview/visual-cpp-samples.md) Используйте этот пример, чтобы освоить приемы автоматизации и изучить основы удаленной автоматизации.

- [ACDUAL](../overview/visual-cpp-samples.md) Добавляет сдвоенные интерфейсы в приложение сервера автоматизации.

- [CALCDRIV](../overview/visual-cpp-samples.md) Приложение клиента автоматизации для реализации MFCCALC.

- [INPROC](../overview/visual-cpp-samples.md) Демонстрирует приложение внутрипроцессного сервера автоматизации.

- [CALCDRIV](../overview/visual-cpp-samples.md) Приложение клиента автоматизации для реализации INPROC.

- [MFCCALC](../overview/visual-cpp-samples.md) Демонстрирует приложение клиента автоматизации.

## <a name="what-do-you-want-to-know-more-about"></a>Что вы хотите узнать подробнее

- [Automation Clients](automation-clients.md)

- [Серверы автоматизации](automation-servers.md)

- [OLE](ole-in-mfc.md)

- [Active - технология](mfc-com.md)

## <a name="what-do-you-want-to-do"></a>Что Вы хотите делать

- [Добавление класса автоматизации](automation-servers.md)

- [Использование библиотек типов](automation-clients-using-type-libraries.md)

- [Доступ к серверам автоматизации](automation-servers.md)

- [Написание клиентов автоматизации на C++](automation-clients.md)

## <a name="see-also"></a>См. также раздел

[MFC COM](mfc-com.md)
