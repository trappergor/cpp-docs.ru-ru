---
title: Контейнеры элементов ActiveX. Обработка событий из элемента управления ActiveX
ms.date: 09/12/2018
helpviewer_keywords:
- event handlers [MFC], ActiveX controls
- ActiveX control containers [MFC], event sinks
- event handling [MFC], ActiveX controls
- ON_EVENT macro [MFC]
- ActiveX controls [MFC], events [MFC]
- END_EVENTSINK_MAP macro, using
- events [MFC], ActiveX controls
- BEGIN_EVENTSINK_MAP macro
ms.assetid: f9c106db-052f-4e32-82ad-750646aa760b
ms.openlocfilehash: 8087d84d2203e4f910200acdd1b00e58d14f920e
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57293567"
---
# <a name="activex-control-containers-handling-events-from-an-activex-control"></a>Контейнеры элементов ActiveX. Обработка событий из элемента управления ActiveX

В этой статье обсуждаются в окне «Свойства» для установки обработчики событий для элементов управления ActiveX в контейнере элементов управления ActiveX. Обработчики событий используются для получения уведомлений об определенных событиях (из элемента управления) и выполнять какие-либо действия в ответ. Это уведомление вызывается событие «запуск».

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которая не следует использовать для разработки новых приложений. Дополнительные сведения о современных технологий, заменяющие ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

> [!NOTE]
>  В этой статье используется на базе диалогового окна проекта элемента управления ActiveX контейнер с именем контейнера и внедренный элемент управления с именем Кр в качестве примеров в процедурах и кода.

С помощью кнопки событий в окне «Свойства», можно создать карту событий, которые могут возникнуть в приложение контейнера элемента управления ActiveX. Эта схема, называемая «картой приемника событий,'' создается и поддерживается Visual C++ при добавлении обработчиков событий в класс элемента управления контейнера. Каждый обработчик событий, реализовано с помощью записи карты, определенное событие сопоставляется функции-члена обработчика событий контейнера. Эта функция обработчика событий вызывается при возникновении указанного события в объекте элемента управления ActiveX.

Дополнительные сведения о схемы приемников событий, см. в разделе [схемы приемников событий](../mfc/reference/event-sink-maps.md) в *Справочник по библиотеке классов*.

##  <a name="_core_event_handler_modifications_to_the_project"></a> Обработчик событий изменения проекта

При использовании окна «Свойства» для добавления обработчиков событий, картой приемника событий объявляется и определяется в проекте. Следующие инструкции, добавляются к элементу управления. CPP-файл при первом добавлении обработчика событий. Этот код объявляет картой приемника событий для класса диалогового окна (в этом случае `CContainerDlg`):

[!code-cpp[NVC_MFC_AxCont#8](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_1.cpp)]
[!code-cpp[NVC_MFC_AxCont#9](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_2.cpp)]

При использовании окна «Свойства» для добавления событий событие сопоставить запись (`ON_EVENT`) добавляется схема приемника событий и обработчик событий будет добавлена функция реализацию контейнера (. Файл CPP).

В следующем примере объявляется обработчик событий, называемый `OnClickInCircCtrl`, для элемента управления Кр `ClickIn` событий:

[!code-cpp[NVC_MFC_AxCont#10](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_3.cpp)]

Кроме того, добавляется следующий шаблон `CContainerDlg` реализацию класса (. Файл CPP) для функции-члена обработчика событий:

[!code-cpp[NVC_MFC_AxCont#11](../mfc/codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_4.cpp)]

Дополнительные сведения о макросов в качестве приемника событий, см. в разделе [схемы приемников событий](../mfc/reference/event-sink-maps.md) в *Справочник по библиотеке классов*.

#### <a name="to-create-an-event-handler-function"></a>Чтобы создать функцию обработчика событий

1. Представление классов выберите класс диалогового окна, которое содержит элемент управления ActiveX. В этом примере используйте `CContainerDlg`.

1. В окне «Свойства» щелкните **события** кнопки.

1. В окне «Свойства» выберите идентификатор элемента управления внедренного элемента управления ActiveX. В этом примере используйте `IDC_CIRCCTRL1`.

   В окне свойств отображаются список событий, которые можно создать с помощью внедренного элемента управления ActiveX. Любую функцию-член отображаются полужирным шрифтом, уже имеет функции обработчика, назначенные ему.

1. Выберите событие, класс диалогового окна для обработки. В этом примере выберите **щелкните**.

1. В раскрывающемся списке справа выберите  **\<Добавить > ClickCircctrl1**.

1. Дважды щелкните новую функцию обработчика из представления классов, чтобы перейти к коду обработчика событий в реализации (. Файл CPP) `CContainerDlg`.

## <a name="see-also"></a>См. также

[Контейнеры для элементов ActiveX](../mfc/activex-control-containers.md)
