---
title: Контейнеры элементов управления ActiveX. Обработка событий из элемента управления ActiveX
ms.date: 09/12/2018
helpviewer_keywords:
- event handlers [MFC], ActiveX controls
- ActiveX control containers [MFC], event sinks
- event handling [MFC], ActiveX controls
- ON_EVENT macro [MFC]
- ActiveX controls [MFC], events [MFC]
- END_EVENTSINK_MAP macro, using
- events [MFC], ActiveX controls
- BEGIN_EVENTSINK_MAP macro
ms.assetid: f9c106db-052f-4e32-82ad-750646aa760b
ms.openlocfilehash: 4b7bc78a2937c010a4d2f1fb000ae0fe8ca2416c
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84625128"
---
# <a name="activex-control-containers-handling-events-from-an-activex-control"></a>Контейнеры элементов управления ActiveX. Обработка событий из элемента управления ActiveX

В этой статье рассматривается использование окна **свойств** (в **представление классов**) для установки обработчиков событий для элементов управления ActiveX в контейнере элементов управления ActiveX. Обработчики событий используются для получения уведомлений (от элемента управления) определенных событий и выполнения некоторых действий в ответе. Это уведомление называется "срабатыванием" события.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которую не следует использовать для новой разработки. Дополнительные сведения о современных технологиях, которые заменяют ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

> [!NOTE]
> В этой статье используется проект контейнера элемента управления ActiveX с именем container и внедренный элемент управления с именем Circ в качестве примеров в процедурах и коде.

С помощью кнопки события в окне **Свойства** (в **представление классов**) можно создать карту событий, которые могут возникнуть в приложении-контейнере элемента управления ActiveX. Эта схема, называемая "картой приемника событий", создается и обслуживается Visual C++ при добавлении обработчиков событий в класс контейнера элемента управления. Каждый обработчик событий, реализованный с записью сопоставления событий, сопоставляет конкретное событие с функцией-членом обработчика событий контейнера. Эта функция обработчика событий вызывается, когда заданное событие инициируется объектом управления ActiveX.

Дополнительные сведения о картах приемников событий см. в разделе [карты приемников событий](reference/event-sink-maps.md) в *справочнике по библиотеке классов*.

## <a name="event-handler-modifications-to-the-project"></a><a name="_core_event_handler_modifications_to_the_project"></a>Изменения обработчика событий в проекте

При использовании окна **Свойства** для добавления обработчиков событий в проекте объявляется и определяется схема приемника событий. В элемент управления добавляются следующие инструкции. CPP-файл при первом добавлении обработчика событий. Этот код объявляет карту приемника событий для класса диалогового окна (в данном случае `CContainerDlg` ):

[!code-cpp[NVC_MFC_AxCont#8](codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_1.cpp)]
[!code-cpp[NVC_MFC_AxCont#9](codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_2.cpp)]

При использовании окна **Свойства** для добавления событий в `ON_EVENT` карту приемников событий добавляется запись схемы событий (), а в реализацию контейнера добавляется функция обработчика событий (. CPP).

В следующем примере объявляется обработчик событий, вызываемый `OnClickInCircCtrl` для события элемента управления Circ `ClickIn` :

[!code-cpp[NVC_MFC_AxCont#10](codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_3.cpp)]

Кроме того, в реализацию класса добавляется следующий шаблон `CContainerDlg` (. CPP) для функции-члена обработчика событий:

[!code-cpp[NVC_MFC_AxCont#11](codesnippet/cpp/activex-control-containers-handling-events-from-an-activex-control_4.cpp)]

Дополнительные сведения о макросах приемника событий см. в разделе [карты приемников событий](reference/event-sink-maps.md) в *справочнике по библиотеке классов*.

#### <a name="to-create-an-event-handler-function"></a>Создание функции обработчика событий

1. В представление классов выберите класс диалогового окна, содержащего элемент управления ActiveX. В этом примере используйте `CContainerDlg` .

1. В окне **Свойства** нажмите кнопку **События** .

1. В окне **Свойства** выберите идентификатор элемента управления внедренного элемента управления ActiveX. В этом примере используйте `IDC_CIRCCTRL1` .

   В окне **Свойства** отображается список событий, которые могут быть вызваны внедренным элементом управления ActiveX. Любая функция – член, показанная жирным шрифтом, уже имеет назначенные ей функции обработчика.

1. Выберите событие, которое должен быть обрабатываем классом диалогового окна. В этом примере выберите **Click**(выбрать).

1. В раскрывающемся списке справа выберите ** \<Add> ClickCircctrl1**.

1. Дважды щелкните новую функцию обработчика из представление классов, чтобы перейти к коду обработчика событий в реализации (. CPP) файла `CContainerDlg` .

## <a name="see-also"></a>См. также раздел

[Контейнеры элементов управления ActiveX](activex-control-containers.md)
