---
title: TN024. Сообщения и ресурсы, определенные MFC
ms.date: 11/04/2016
helpviewer_keywords:
- resources [MFC]
- Windows messages [MFC], MFC-defined
- messages [MFC], MFC
- TN024
ms.assetid: c65353ce-8096-454b-ad22-1a7a1dd9a788
ms.openlocfilehash: 9ad6827e4a46bb9f2ff3b02986a01737772e0858
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88839222"
---
# <a name="tn024-mfc-defined-messages-and-resources"></a>TN024. Сообщения и ресурсы, определенные MFC

> [!NOTE]
> Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.

Это примечание описывает внутренние сообщения Windows и форматы ресурсов, используемые MFC. Эта информация объясняет реализацию платформы и поможет вам в отладке приложения. Для рискнуть, несмотря на то, что все эти сведения официально не поддерживаются, эти сведения можно использовать для расширенных реализаций.

Это Примечание содержит сведения о закрытой реализации MFC. все содержимое может быть изменено в будущем. Сообщения частного Windows в MFC имеют значение только в области одного приложения, но в будущем будут изменены, чтобы они содержали сообщения на уровне системы.

Диапазон частных сообщений и типов ресурсов Windows MFC находится в зарезервированном диапазоне "System", установленном в Microsoft Windows. Сейчас используются не все числа в диапазонах, и в будущем можно использовать новые числа в диапазоне. Используемые в настоящий момент числа могут быть изменены.

Сообщения частного Windows в MFC находятся в диапазоне 0x360->0x37F.

Типы частных ресурсов MFC находятся в диапазоне 0xF0->0xFF.

**Частные сообщения Windows в MFC**

Эти сообщения Windows используются вместо виртуальных функций C++, где между объектами окна требуется относительно слабая связь, и если виртуальная функция C++ не будет подходящей.

Эти частные сообщения Windows и связанные структуры параметров объявляются в закрытом заголовке MFC "АФКСПРИВ". H ". Следует предупреждать о том, что любой код, включающий этот заголовок, может полагаться на Недокументированное поведение и, скорее всего, будет прерываться в будущих версиях MFC.

В редких случаях, когда требуется обработать одно из этих сообщений, следует использовать макрос схемы сообщения ON_MESSAGE и обработайте сообщение в универсальном формате LRESULT/WPARAM/LPARAM.

**WM_QUERYAFXWNDPROC**

Это сообщение отправляется в создаваемое окно. Это происходит очень рано в процессе создания, как метод определения того, является ли WndProc **афксвндпрок. Афксвндпрок** возвращает 1.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется|
|lParam|Не используется|
|возвращает|1, если обрабатывается **афксвндпрок**|

**WM_SIZEPARENT**

Это сообщение отправляется из окна фрейма в его непосредственные дочерние элементы во время изменения размера ( `CFrameWnd::OnSize` вызывает вызов `CFrameWnd::RecalcLayout` , который вызывает `CWnd::RepositionBars` ) для изменения расположения панелей элементов управления по отношению к краю рамки. Структура AFX_SIZEPARENTPARAMS содержит текущий доступный клиентский прямоугольник для родителя и ХДВП (который может иметь значение NULL), с помощью которого вызывается `DeferWindowPos` для сворачивания перерисовки.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется|
|lParam|Адрес структуры AFX_SIZEPARENTPARAMS|
|возвращает|Не используется (0)|

Игнорирование сообщения означает, что окно не принимает часть в макете.

**WM_SETMESSAGESTRING**

Это сообщение отправляется в окно фрейма, чтобы запросить обновление строки сообщения в строке состояния. Можно указать либо строковый идентификатор, либо LPCSTR (но не оба).

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Идентификатор строки (или ноль)|
|lParam|LPCSTR для строки (или NULL)|
|возвращает|Не используется (0)|

**WM_IDLEUPDATECMDUI**

Это сообщение отправляется в режиме простоя для реализации обновления обработчиков пользовательского интерфейса команды обновления во время простоя. Если окно (обычно панель элементов управления) обрабатывает сообщение, оно создает `CCmdUI` объект (или объект производного класса) и вызывает `CCmdUI::DoUpdate` для каждого из элементов в окне. В этом случае проверяется наличие обработчика ON_UPDATE_COMMAND_UI для объектов в цепочке обработчиков команд.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|BOOL Бдисаблеифнохандлер|
|lParam|Не используется (0)|
|возвращает|Не используется (0)|

*бдисаблеифнохандлер* не является нулевым для отключения объекта пользовательского интерфейса, если не существует ни ON_UPDATE_COMMAND_UI, ни обработчика ON_COMMAND.

**WM_EXITHELPMODE**

Это сообщение отправляется в `CFrameWnd` , чтобы выйти из контекстно-зависимого режима справки. Получение этого сообщения завершает модальный цикл, запущенный `CFrameWnd::OnContextHelp` .

| Параметр и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется (0)|
|lParam|Не используется (0)|
|возвращает|Не используется|

**WM_INITIALUPDATE**

Это сообщение отправляется шаблоном документа всем потомкам окна фрейма, когда он является надежным для выполнения начального обновления. Он сопоставляется с вызовом функции, `CView::OnInitialUpdate` но может использоваться в других `CWnd` производных классах для другого однофакторного обновления.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется (0)|
|lParam|Не используется (0)|
|возвращает|Не используется (0)|

**WM_RECALCPARENT**

Это сообщение отправляется представлением в его родительское окно (получено через `GetParent` ) для принудительного пересчета макета (как правило, родительский вызов вызывает `RecalcLayout` ). Он используется в приложениях OLE Server, где размер фрейма должен увеличиваться по мере роста общего размера представления.

Если родительское окно обрабатывает это сообщение, оно должно возвращать значение TRUE и заполнять объект RECT, переданный в lParam, на новый размер клиентской области. Используется в `CScrollView` для правильной работы полос прокрутки (при их добавлении в дополнение к окну), когда объект сервера активируется на месте.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется (0)|
|lParam|ЛПРЕКТ Ректклиент, может иметь значение NULL|
|возвращает|Значение TRUE, если возвращен новый клиентский прямоугольник; в противном случае — значение FALSE|

**WM_SIZECHILD**

Это сообщение отправляется `COleResizeBar` в окно его владельца (через `GetOwner` ), когда пользователь изменяет размер строки изменения размера с помощью маркеров изменения размера. `COleIPFrameWnd` реагирует на это сообщение, пытаясь изменить расположение окна фрейма по запросу пользователя.

Новый прямоугольник, заданный в клиентских координатах относительно окна фрейма, содержащего строку изменения размера, указывает lParam.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется (0)|
|lParam|ЛПРЕКТ Ректнев|
|возвращает|Не используется (0)|

**WM_DISABLEMODAL**

Это сообщение отправляется во все всплывающие окна, владельцем которых является деактивируемое окно фрейма. Окно фрейма использует результат, чтобы определить, следует ли отключить всплывающее окно.

Его можно использовать для выполнения специальной обработки во всплывающем окне, когда фрейм переходит в модальное состояние, или для предотвращения отключения определенных всплывающих окон. Подсказки используют это сообщение для уничтожения себя при переходе окна фрейма в модальное состояние, например.

| Параметры и возвращаемое значение | Описание |
|-|-|
|wParam|Не используется (0)|
|lParam|Не используется (0)|
|возвращает|Ненулевое значение **для отключения** окна. 0 означает, что окно будет отключено|

**WM_FLOATSTATUS**

Это сообщение отправляется во все всплывающие окна, принадлежащие окну фрейма, когда кадр активируется или деактивируется другим окном фрейма верхнего уровня. Он используется реализацией MFS_SYNCACTIVE в `CMiniFrameWnd` , чтобы предотвратить синхронизацию этих всплывающих окон с активацией окна рамки верхнего уровня.

| Параметры | Описание |
|-|-|
|wParam|— может иметь одно из следующих значений.<br /><br /> FS_SHOW<br /><br /> FS_HIDE<br /><br /> FS_ACTIVATE<br /><br /> FS_DEACTIVATE<br /><br /> FS_ENABLEFS_DISABLE<br /><br /> FS_SYNCACTIVE|
|lParam|Не используется (0)|

Возвращаемое значение должно быть ненулевым, если задано FS_SYNCACTIVE и окно синкронизес его активацию с родительским фреймом. `CMiniFrameWnd` Возвращает ненулевое значение, если стиль задан как MFS_SYNCACTIVE.

Дополнительные сведения см. в описании реализации `CMiniFrameWnd` .

## <a name="wm_activatetoplevel"></a>WM_ACTIVATETOPLEVEL

Это сообщение отправляется в окно верхнего уровня, когда окно в его группе верхнего уровня либо активируется, либо деактивируется. Окно является частью группы верхнего уровня, если оно является окном верхнего уровня (без родителя или владельцем) или принадлежит такому окну. Это сообщение аналогично использованию для WM_ACTIVATEAPP, но работает в ситуациях, когда Windows, принадлежащих различным процессам, смешана в одной иерархии окон (обычно в приложениях OLE).

## <a name="wm_commandhelp-wm_helphittest-wm_exithelpmode"></a>WM_COMMANDHELP, WM_HELPHITTEST WM_EXITHELPMODE

Эти сообщения используются в реализации контекстно-зависимой справки. Дополнительные сведения см. в [технической заметке 28](../mfc/tn028-context-sensitive-help-support.md) .

## <a name="mfc-private-resource-formats"></a>Форматы частных ресурсов MFC

В настоящее время MFC определяет два формата частных ресурсов: RT_TOOLBAR и RT_DLGINIT.

## <a name="rt_toolbar-resource-format"></a>Формат ресурсов RT_TOOLBAR

Панель инструментов по умолчанию, предоставляемая помощью мастера, основана на RT_TOOLBAR настраиваемом ресурсе, который появился в MFC 4,0. Этот ресурс можно изменить с помощью редактора панелей инструментов.

## <a name="rt_dlginit-resource-format"></a>Формат ресурсов RT_DLGINIT

Для хранения дополнительных сведений об инициализации диалогового окна используется один формат частных ресурсов MFC. Сюда входят первоначальные строки, хранящиеся в поле со списком. Формат этого ресурса не предназначен для изменения вручную, но обрабатывается Visual C++.

Visual C++ и этот RT_DLGINIT ресурс не обязательно должен использовать связанные функции MFC, так как для использования сведений в ресурсе используется альтернативный интерфейс API. Использование Visual C++ значительно упрощает написание, Обслуживание и перевод приложения в долгосрочное выполнение.

Базовая структура ресурса RT_DLGINIT выглядит следующим образом:

```
+---------------+    \
| Control ID    |   UINT             |
+---------------+    |
| Message #     |   UINT             |
+---------------+    |
|length of data |   DWORD            |
+---------------+    |   Repeated
|   Data        |   Variable Length  |   for each control
|   ...         |   and Format       |   and message
+---------------+    /
|     0         |   BYTE
+---------------+
```

Повторяющийся раздел содержит идентификатор элемента управления, в который отправляется сообщение, отправляемый номер сообщения (стандартное сообщение Windows) и переменную длину данных. Сообщение Windows отправляется в виде:

```
SendDlgItemMessage(<Control ID>, <Message #>, 0, &<Data>);
```

Это очень общий формат, разрешающий сообщения Windows и содержимое данных. Редактор ресурсов Visual C++ и MFC поддерживают только ограниченное подмножество сообщений Windows: CB_ADDSTRING для начального списка, для полей со списком (данные являются текстовой строкой).

## <a name="see-also"></a>См. также раздел

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)<br/>
[Технические примечания по категориям](../mfc/technical-notes-by-category.md)
