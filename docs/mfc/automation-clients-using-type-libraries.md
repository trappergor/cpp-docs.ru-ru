---
title: Клиенты автоматизации. Использование библиотек типов
ms.date: 11/04/2016
f1_keywords:
- MkTypLib
helpviewer_keywords:
- clients, Automation
- dispatch class [MFC]
- Automation clients, type libraries
- type libraries, Automation clients
- ODL (Object Description Language)
- ODL files
- classes [MFC], dispatch
- MkTypLib tool
- .odl files
ms.assetid: d405bc47-118d-4786-b371-920d035b2047
ms.openlocfilehash: e5f9ffcebc3725851c599e7b21369f45d0029d81
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84626093"
---
# <a name="automation-clients-using-type-libraries"></a>Клиенты автоматизации. Использование библиотек типов

Клиенты автоматизации должны иметь сведения о свойствах и методах объектов сервера, если клиенты должны управлять объектами серверов. Свойства имеют типы данных; методы часто возвращают значения и принимают параметры. Клиенту требуются сведения о типах данных всех этих объектов для статической привязки к типу объекта сервера.

Эта информация о типе может быть известна несколькими способами. Рекомендуемый способ — создать библиотеку типов.

Дополнительные сведения о [MkTypLib](/windows/win32/Midl/differences-between-midl-and-mktyplib)см. в Windows SDK.

Visual C++ можете считать файл библиотеки типов и создать класс диспетчеризации, производный от [COleDispatchDriver](reference/coledispatchdriver-class.md). Объект этого класса имеет свойства и операции, которые дублируют объекты объекта Server. Приложение вызывает свойства и операции этого объекта, и функциональные возможности, унаследованные от `COleDispatchDriver` маршрутов, направляют эти вызовы в систему OLE, которая, в свою очередь, направляет их в объект сервера.

Visual C++ автоматически поддерживает этот файл библиотеки типов, если вы решили включить автоматизацию при создании проекта. В рамках каждой сборки TLB файл будет построен с помощью MkTypLib.

### <a name="to-create-a-dispatch-class-from-a-type-library-tlb-file"></a>Создание класса диспетчеризации из файла библиотеки типов (. tlb)

1. В представление классов или обозреватель решений щелкните правой кнопкой мыши проект и выберите команду **Добавить** , а затем в контекстном меню выберите команду **Добавить класс** .

1. В диалоговом окне **Добавление класса** выберите папку **Visual C++/МФК** в левой области. Выберите **класс MFC из** значка typelib в правой области и нажмите кнопку **Открыть**.

1. В диалоговом окне **Мастер добавления класса из typelib** выберите библиотеку типов из раскрывающегося списка **Доступные библиотеки типов** . В поле **интерфейсы** отображаются интерфейсы, доступные для выбранной библиотеки типов.

    > [!NOTE]
    >  Можно выбрать интерфейсы более чем из одной библиотеки типов.

   Чтобы выбрать интерфейсы, дважды щелкните их или нажмите кнопку " **Добавить** ". При этом имена для классов диспетчеризации будут отображаться в поле **созданные классы** . Имена классов можно изменить в `Class` поле.

   В поле **файл** отображается файл, в котором будет объявлен класс. (также можно изменить это имя файла). Можно также нажать кнопку Обзор, чтобы выбрать другие файлы, если вы предпочитаете, чтобы информация о заголовке и реализации была написана в существующих файлах или в каталоге, отличном от каталога проекта.

    > [!NOTE]
    >  Все классы диспетчеризации для выбранных интерфейсов будут размещены в файле, указанном здесь. Если требуется, чтобы интерфейсы были объявлены в отдельных заголовках, необходимо запустить этот мастер для каждого файла заголовка, который требуется создать.

    > [!NOTE]
    >  Некоторые сведения о библиотеке типов могут храниться в файлах с помощью. DLL,. OCX или. Расширения файлов OLB.

1. Нажмите кнопку **Готово**.

   Затем мастер запишет код для классов диспетчеризации, используя указанные классы и имена файлов.

## <a name="see-also"></a>См. также раздел

[Automation Clients](automation-clients.md)
