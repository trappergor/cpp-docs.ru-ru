---
title: Верхние и нижние колонтитулы
ms.date: 11/04/2016
helpviewer_keywords:
- printing [MFC], multipage documents
- page headers [MFC], printing
- headers [MFC], printing
- footers [MFC], printing
- page footers [MFC], printing
- page headers [MFC]
- printing [MFC], headers and footers
- page footers [MFC]
ms.assetid: b0be9c53-5773-4955-a777-3c15da745128
ms.openlocfilehash: 7024c57dbe41a579582d409d0536db0ca0bc46d6
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84620108"
---
# <a name="headers-and-footers"></a>Верхние и нижние колонтитулы

В этой статье объясняется, как добавить верхние и нижние колонтитулы в печатный документ.

При просмотре документа на экране имя документа и текущее расположение в документе обычно отображаются в строке заголовка и строке состояния. При просмотре печатной копии документа полезно иметь имя и номер страницы, отображаемые в верхнем или нижнем колонтитуле. Это распространенный способ, при котором даже программы WYSIWYG отличаются тем, как они выполняют печать и отображение экрана.

Функция-член [OnPrint](reference/cview-class.md#onprint) — это подходящее место для печати верхних и нижних колонтитулов, так как она вызывается для каждой страницы и вызывается только для печати, а не для отображения на экране. Можно определить отдельную функцию для печати верхнего или нижнего колонтитула и передать ему контекст устройства печати из `OnPrint` . Возможно, потребуется скорректировать происхождение или экстент окна перед вызовом [OnDraw](reference/cview-class.md#ondraw) , чтобы избежать перекрытия текста страницы верхнего или нижнего колонтитула. Также может потребоваться изменить, `OnDraw` так как объем документа, который умещается на странице, может быть уменьшен.

Одним из способов компенсации области, занятой верхним или нижним колонтитулом, является использование **m_rectDraw** элемента [CPrintInfo](reference/cprintinfo-structure.md). Каждый раз при печати страницы этот элемент инициализируется с помощью области, используемой на странице. При печати верхнего или нижнего колонтитула перед печатью текста страницы можно уменьшить размер прямоугольника, хранящегося в **m_rectDraw** , чтобы учитывать область, занятую верхним или нижним колонтитулом. Затем `OnPrint` можно обратиться к **m_rectDraw** , чтобы узнать, сколько области осталось для печати текста страницы.

Невозможно напечатать заголовок или любой другой элемент из [онпрепаредк](reference/cview-class.md#onpreparedc), так как он вызывается до `StartPage` вызова функции-члена [CDC](reference/cdc-class.md) . На этом этапе контекст устройства печати считается на границе страницы. Печать может осуществляться только из `OnPrint` функции члена.

## <a name="what-do-you-want-to-know-more-about"></a>Что вы хотите узнать подробнее

- [Печать многостраничных документов](multipage-documents.md)

- [Выделение ресурсов GDI для печати](allocating-gdi-resources.md)

## <a name="see-also"></a>См. также раздел

[Вывод на печать](printing.md)
