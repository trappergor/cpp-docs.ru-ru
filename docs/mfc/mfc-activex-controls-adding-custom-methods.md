---
title: Элементы управления ActiveX в MFC. Добавление пользовательских методов
ms.date: 09/12/2018
helpviewer_keywords:
- MFC ActiveX controls [MFC], methods
- PtInCircle custom method [MFC]
ms.assetid: 8f8dc344-44a0-4021-8db5-4cdd3d700e18
ms.openlocfilehash: e32a1c372d89fc4ade414b20a0f77fa162807250
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84626163"
---
# <a name="mfc-activex-controls-adding-custom-methods"></a>Элементы управления ActiveX в MFC. Добавление пользовательских методов

Пользовательские методы отличаются от стандартных методов тем, что они еще не реализованы в `COleControl` . Необходимо предоставить реализацию для каждого пользовательского метода, добавляемого в элемент управления.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которую не следует использовать для новой разработки. Дополнительные сведения о современных технологиях, которые заменяют ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

Пользователь элемента управления ActiveX может в любое время вызывать пользовательский метод для выполнения действий, связанных с управлением. Запись диспетчеризации для пользовательских методов имеет форму DISP_FUNCTION.

## <a name="adding-a-custom-method-with-the-add-method-wizard"></a><a name="_core_adding_a_custom_method_with_classwizard"></a>Добавление пользовательского метода с помощью мастера добавления метода

Следующая процедура демонстрирует добавление пользовательского метода ПтинЦиркле в скелет кода элемента управления ActiveX. ПтинЦиркле определяет, находятся ли координаты, передаваемые элементу управления, внутри или снаружи окружности. Эту же процедуру можно также использовать для добавления других пользовательских методов. Замените имя пользовательского метода и его параметры на имя и параметры метода ПтинЦиркле.

> [!NOTE]
> В этом примере используется `InCircle` функция из событий статьи. Дополнительные сведения об этой функции см. в статье [элементы управления ActiveX в MFC: Добавление пользовательских событий в элемент управления ActiveX](mfc-activex-controls-adding-custom-events.md).

#### <a name="to-add-the-ptincircle-custom-method-using-the-add-method-wizard"></a>Добавление пользовательского метода ПтинЦиркле с помощью мастера добавления метода

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. В контекстном меню выберите команду **Добавить** , а затем нажмите кнопку **Добавить метод**.

   Откроется мастер добавления метода.

1. В поле **имя метода** введите *птинЦиркле*.

1. В поле **внутреннее имя** введите имя внутренней функции метода или используйте значение по умолчанию (в данном случае *птинЦиркле*).

1. В поле **тип возвращаемого** значения щелкните **VARIANT_BOOL** для возвращаемого типа метода.

1. Используя **тип параметра** и элементы **управления именами параметров** , добавьте параметр с именем *кскурд* (Type *OLE_XPOS_PIXELS*).

1. Используя **тип параметра** и элементы **управления именами параметров** , добавьте параметр с именем *икурд* (Type *OLE_YPOS_PIXELS*).

1. Нажмите кнопку **Готово**.

## <a name="add-method-wizard-changes-for-custom-methods"></a><a name="_core_classwizard_changes_for_custom_methods"></a>Изменение мастера добавления метода для пользовательских методов

При добавлении пользовательского метода мастер добавления метода вносит некоторые изменения в заголовок класса Control (. H) и реализация (. CPP) файлы. Следующая строка добавляется в объявление схемы диспетчеризации в заголовке класса Control (. H) файл:

[!code-cpp[NVC_MFC_AxUI#18](codesnippet/cpp/mfc-activex-controls-adding-custom-methods_1.h)]

Этот код объявляет обработчик метода диспетчеризации с именем `PtInCircle` . Эту функцию может вызывать пользователь элемента управления, использующий внешнее имя `PtInCircle` .

Следующая строка добавляется в элемент управления. IDL-файл:

[!code-cpp[NVC_MFC_AxUI#19](codesnippet/cpp/mfc-activex-controls-adding-custom-methods_2.idl)]

Эта строка присваивает `PtInCircle` методу КОНКРЕТНЫЙ идентификационный номер, расположение метода в списке методы и свойства мастера добавления метода. Так как мастер добавления метода использовался для добавления пользовательского метода, запись для него была автоматически добавлена в проект. IDL-файл.

Кроме того, следующая строка, расположенная в реализации (. CPP) файла элемента управления добавляется в карту диспетчеризации элемента управления:

[!code-cpp[NVC_MFC_AxUI#20](codesnippet/cpp/mfc-activex-controls-adding-custom-methods_3.cpp)]

Макрос DISP_FUNCTION сопоставляет метод `PtInCircle` с функцией обработчика элемента управления, `PtInCircle` , объявляет тип возвращаемого значения **VARIANT_BOOL**и объявляет два параметра типа **VTS_XPOS_PIXELS** и **VTS_YPOSPIXELS** для передачи `PtInCircle` .

Наконец, мастер добавления метода добавляет функцию-заглушку `CSampleCtrl::PtInCircle` в нижнюю часть реализации элемента управления (. CPP). Для `PtInCircle` функции, как указано выше, ее необходимо изменить следующим образом:

[!code-cpp[NVC_MFC_AxUI#21](codesnippet/cpp/mfc-activex-controls-adding-custom-methods_4.cpp)]

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](mfc-activex-controls.md)<br/>
[Значки представление классов и обозревателя объектов](/visualstudio/ide/class-view-and-object-browser-icons)
