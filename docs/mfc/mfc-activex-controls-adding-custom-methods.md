---
title: Элементы ActiveX в MFC. Добавление пользовательских методов
ms.date: 09/12/2018
helpviewer_keywords:
- MFC ActiveX controls [MFC], methods
- PtInCircle custom method [MFC]
ms.assetid: 8f8dc344-44a0-4021-8db5-4cdd3d700e18
ms.openlocfilehash: 4f5a7dc844d80ae94df8af7c0b2eea141376f9e9
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62160150"
---
# <a name="mfc-activex-controls-adding-custom-methods"></a>Элементы ActiveX в MFC. Добавление пользовательских методов

Пользовательские методы отличаются от стандартных методов, что они уже не реализованы в `COleControl`. Необходимо предоставить реализацию для каждого пользовательского метода, который можно добавить в элемент управления.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которая не следует использовать для разработки новых приложений. Дополнительные сведения о современных технологий, заменяющие ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

Пользователю элемента управления ActiveX можно вызвать пользовательский метод в любое время для выполнения действий элемента управления. Запись сопоставления диспетчеризации для пользовательских методов имеет форму DISP_FUNCTION.

##  <a name="_core_adding_a_custom_method_with_classwizard"></a> Добавление пользовательского метода с мастер добавления метода

В следующей процедуре показано добавление пользовательского метода PtInCircle скелетный код элемента управления ActiveX. PtInCircle определяет, являются ли координаты передаваться элементу управления внутри или вне круга. Эту процедуру можно также использоваться для добавления других пользовательских методов. Подставьте имя пользовательского метода и его параметры для PtInCircle имя метода и параметров.

> [!NOTE]
>  В этом примере используется `InCircle` функции из статьи события. Дополнительные сведения по этой функции см. в статье [элементы управления MFC ActiveX: Добавление пользовательских событий в элемент управления ActiveX](../mfc/mfc-activex-controls-adding-custom-events.md).

#### <a name="to-add-the-ptincircle-custom-method-using-the-add-method-wizard"></a>Чтобы добавить ptincircle-пользовательский метод, с помощью мастера добавления метода

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. В контекстном меню, щелкните **добавить** и нажмите кнопку **добавить метод**.

   Откроется мастер добавления метода.

1. В **имя метода** введите *PtInCircle*.

1. В **внутреннее имя** введите имя функции внутреннего метода или использовать значение по умолчанию (в этом случае *PtInCircle*).

1. В **тип возвращаемого значения** выберите **VARIANT_BOOL** для возвращаемого типа метода.

1. С помощью **тип параметра** и **имя параметра** элементы управления, добавьте параметр с именем *xCoord* (тип *OLE_XPOS_PIXELS*).

9. С помощью **тип параметра** и **имя параметра** элементы управления, добавьте параметр с именем *yCoord* (тип *OLE_YPOS_PIXELS*).

10. Нажмите кнопку **Готово**.

##  <a name="_core_classwizard_changes_for_custom_methods"></a> Добавьте метод мастер изменения для пользовательских методов

При добавлении пользовательского метода, мастер добавления метода вносит изменения в заголовок класса элемента управления (. H) и реализации (. Файлы CPP). Следующая строка добавляется к объявлению карты распределения в заголовке класса control (. H) файла.

[!code-cpp[NVC_MFC_AxUI#18](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_1.h)]

Этот код объявляет, вызывается метод обработчика диспетчеризации `PtInCircle`. Эту функцию можно вызывать с помощью внешнего имени элемента управления `PtInCircle`.

Следующая строка добавляется к элементу управления. IDL-файла:

[!code-cpp[NVC_MFC_AxUI#19](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_2.idl)]

Эта строка назначает `PtInCircle` метод с определенным номером идентификатора, метод позиции в списке мастера добавления метода методы и свойства. Так как мастер добавления метода был использован для добавления пользовательского метода, запись для него автоматически добавлен в проект. IDL-файла.

Кроме того, следующую строку, расположенный в реализации (. Файл CPP) класса элемента управления, добавляется схема подготовки к отправке элемента управления:

[!code-cpp[NVC_MFC_AxUI#20](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_3.cpp)]

Disp_function-макрос сопоставляет метод `PtInCircle` функции обработчика элемента управления, `PtInCircle`, объявляет тип возвращаемого **VARIANT_BOOL**и объявляет два параметра типа **VTS_XPOS_PIXELS** и **VTS_YPOSPIXELS** передается `PtInCircle`.

Наконец, мастер добавления метода добавляется функция заглушки `CSampleCtrl::PtInCircle` в нижнюю часть реализации элемента управления (. Файл CPP). Для `PtInCircle` работать, как уже говорилось ранее, его необходимо изменить следующим образом:

[!code-cpp[NVC_MFC_AxUI#21](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_4.cpp)]

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Значки представления классов и обозревателя объектов](/visualstudio/ide/class-view-and-object-browser-icons)
