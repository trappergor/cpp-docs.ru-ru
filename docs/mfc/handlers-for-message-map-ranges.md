---
title: Обработчики для диапазонов схем сообщений
ms.date: 11/04/2016
helpviewer_keywords:
- message handlers [MFC]
- handlers [MFC], message-map ranges
- message maps [MFC], message handler functions
- message maps [MFC], ranges
- control-notification messages [MFC]
- command IDs [MFC], message mapping
- message-map ranges [MFC]
- handlers [MFC]
- message handling [MFC], message handler functions
- mappings [MFC], message ranges
- command handling [MFC], command update handlers
- controls [MFC], notifications
- handler functions [MFC], message-map ranges
- handler functions [MFC]
- command update handlers [MFC]
- command routing [MFC], command update handlers
- message ranges [MFC]
- handler functions [MFC], declaring
- message ranges [MFC], mapping
ms.assetid: a271478b-5e1c-46f5-9f29-e5be44b27d08
ms.openlocfilehash: 0ff9178679792929bbd6eb92bb6148cfa008dcad
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84621694"
---
# <a name="handlers-for-message-map-ranges"></a>Обработчики для диапазонов схем сообщений

В этой статье объясняется, как сопоставить диапазон сообщений с одной функцией обработчика сообщений (вместо сопоставления одного сообщения только одной функции).

Иногда приходится обрабатывать несколько сообщений или управляющих уведомлений точно так же, как и одно уведомление. В таких случаях может потребоваться связать все сообщения с одной функцией обработчика. Диапазоны карт сообщений позволяют сделать это для непрерывного диапазона сообщений:

- Диапазоны идентификаторов команд можно сопоставлять следующим образом:

  - Функция обработчика команд.

  - Функция обработчика обновления команд.

- Вы можете сопоставлять сообщения управления и уведомления для диапазона идентификаторов элементов управления функции обработчика сообщений.

В этой статье рассматриваются следующие темы:

- [Запись записи схемы сообщений](#_core_writing_the_message.2d.map_entry)

- [Объявление функции обработчика](#_core_declaring_the_handler_function)

- [Пример для диапазона идентификаторов команд](#_core_example_for_a_range_of_command_ids)

- [Пример для диапазона идентификаторов элементов управления](#_core_example_for_a_range_of_control_ids)

## <a name="writing-the-message-map-entry"></a><a name="_core_writing_the_message.2d.map_entry"></a>Запись записи схемы сообщений

В. CPP-файл, добавьте запись схемы сообщений, как показано в следующем примере:

[!code-cpp[NVC_MFCMessageHandling#6](codesnippet/cpp/handlers-for-message-map-ranges_1.cpp)]

Запись схемы сообщений состоит из следующих элементов:

- Макрос диапазона схемы сообщений:

  - [ON_COMMAND_RANGE](reference/message-map-macros-mfc.md#on_command_range)

  - [ON_UPDATE_COMMAND_UI_RANGE](reference/message-map-macros-mfc.md#on_update_command_ui_range)

  - [ON_CONTROL_RANGE](reference/message-map-macros-mfc.md#on_control_range)

- Параметры макроса:

  Первые два макроса принимают три параметра:

  - Идентификатор команды, запускающей диапазон

  - Идентификатор команды, завершающей диапазон

  - Имя функции обработчика сообщений

  Диапазон идентификаторов команд должен быть непрерывным.

  Третий макрос, `ON_CONTROL_RANGE` , принимает дополнительный первый параметр: сообщение уведомления элемента управления, например **EN_CHANGE**.

## <a name="declaring-the-handler-function"></a><a name="_core_declaring_the_handler_function"></a>Объявление функции обработчика

Добавьте объявление функции обработчика в. H файл. В следующем коде показано, как это может выглядеть, как показано ниже:

[!code-cpp[NVC_MFCMessageHandling#7](codesnippet/cpp/handlers-for-message-map-ranges_2.h)]

Функции обработчика для отдельных команд обычно не принимают параметров. За исключением функций обработчика обновления, функции обработчика для диапазонов карт сообщений должны иметь дополнительный параметр *NID*типа **uint**. Этот параметр является первым параметром. Дополнительный параметр включает дополнительный идентификатор команды, необходимый для указания, какая именно команда выбрана пользователем.

Дополнительные сведения о требованиях к параметрам для обновления функций обработчика см. [в разделе пример для диапазона идентификаторов команд](#_core_example_for_a_range_of_command_ids).

## <a name="example-for-a-range-of-command-ids"></a><a name="_core_example_for_a_range_of_command_ids"></a>Пример для диапазона идентификаторов команд

Когда вы можете использовать диапазоны, один из примеров состоит в обработке команд, таких как команда ZOOM в образце MFC в библиотеке [HIERSVR](../overview/visual-cpp-samples.md). Эта команда позволяет увеличить масштаб представления, масштабировать его от 25% до 300% от обычного размера. Класс представления HIERSVR использует диапазон для обработки команд Zoom с записью схемы сообщения, похожей на следующую:

[!code-cpp[NVC_MFCMessageHandling#8](codesnippet/cpp/handlers-for-message-map-ranges_3.cpp)]

При написании записи схемы сообщений необходимо указать:

- Два идентификатора команды, начиная с и заканчивая непрерывным диапазоном.

   Здесь они **ID_VIEW_ZOOM25** и **ID_VIEW_ZOOM300**.

- Имя функции обработчика для команд.

   Вот и все `OnZoom` .

Объявление функции будет выглядеть следующим образом:

[!code-cpp[NVC_MFCMessageHandling#9](codesnippet/cpp/handlers-for-message-map-ranges_4.h)]

Функции обработчика обновлений похожи и, скорее всего, будут более широко полезны. Очень часто написание `ON_UPDATE_COMMAND_UI` обработчиков для нескольких команд и поиск, копирование и повторное создание одного и того же кода. Решение заключается в сопоставлении диапазона идентификаторов команд с одной функцией обработчика обновлений с помощью `ON_UPDATE_COMMAND_UI_RANGE` макроса. Идентификаторы команд должны образовывать непрерывный диапазон. Пример см. в описании `OnUpdateZoom` обработчика и его `ON_UPDATE_COMMAND_UI_RANGE` записи о схеме сообщений в классе представления примера HIERSVR.

Функции обработчика обновления для отдельных команд обычно принимают один параметр типа *пкмдуи* `CCmdUI*` . В отличие от функций обработчика, функции обработчика обновления для диапазонов карт сообщений не требует дополнительного параметра *NID*типа **uint**. Идентификатор команды, необходимый для указания, какая именно команда выбрана пользователем, находится в `CCmdUI` объекте.

## <a name="example-for-a-range-of-control-ids"></a><a name="_core_example_for_a_range_of_control_ids"></a>Пример для диапазона идентификаторов элементов управления

Еще один интересный случай — сопоставление сообщений управляющих уведомлений для диапазона идентификаторов элементов управления с одним обработчиком. Предположим, пользователь может щелкнуть любую из 10 кнопок. Чтобы связать все 10 кнопок с одним обработчиком, запись схемы сообщений будет выглядеть следующим образом:

[!code-cpp[NVC_MFCMessageHandling#10](codesnippet/cpp/handlers-for-message-map-ranges_5.cpp)]

При написании `ON_CONTROL_RANGE` макроса в схеме сообщений необходимо указать:

- Конкретное сообщение с уведомлением об управлении.

   Здесь **BN_CLICKED**.

- Значения идентификатора элемента управления, связанные с непрерывным диапазоном элементов управления.

   Ниже приведены **IDC_BUTTON1** и **IDC_BUTTON10**.

- Имя функции обработчика сообщений.

   Вот и все `OnButtonClicked` .

При написании функции обработчика укажите дополнительный параметр **uint** , как показано ниже:

[!code-cpp[NVC_MFCMessageHandling#11](codesnippet/cpp/handlers-for-message-map-ranges_6.cpp)]

`OnButtonClicked`Обработчик для одного **BN_CLICKED** сообщения не принимает параметров. Один и тот же обработчик для диапазона кнопок принимает одно значение **uint**. Дополнительный параметр позволяет идентифицировать конкретный элемент управления, отвечающий за создание сообщения **BN_CLICKED** .

Код, показанный в примере, является типичным: преобразование значения, переданного в `int` в пределах диапазона сообщений, и утверждение того, что это так. В зависимости от того, какая кнопка была нажата, может потребоваться некоторое другое действие.

## <a name="see-also"></a>См. также раздел

[Объявление функций обработчика сообщений](declaring-message-handler-functions.md)
