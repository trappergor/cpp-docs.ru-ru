---
title: Элементы управления ActiveX в MFC. Страницы свойств
ms.date: 11/19/2018
helpviewer_keywords:
- DDP_ functions [MFC]
- MFC ActiveX controls [MFC], properties
- property pages [MFC], MFC ActiveX controls
- DoDataExchange method [MFC]
- OLEIVERB_PROPERTIES
- CPropertyPageDialog class [MFC]
- MFC ActiveX controls [MFC], property pages
ms.assetid: 1506f87a-9fd6-4505-8380-0dbc9636230e
ms.openlocfilehash: 3d22085daa503a7c778111718445920f98b98a89
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84615441"
---
# <a name="mfc-activex-controls-property-pages"></a>Элементы управления ActiveX в MFC. Страницы свойств

Страницы свойств позволяют пользователю элемента управления ActiveX просматривать и изменять свойства элементов управления ActiveX. Доступ к этим свойствам осуществляется путем вызова диалогового окна Свойства элемента управления, которое содержит одну или несколько страниц свойств, предоставляющих пользовательский графический интерфейс для просмотра и редактирования свойств элемента управления.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которую не следует использовать для новой разработки. Дополнительные сведения о современных технологиях, которые заменяют ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

Страницы свойств элемента управления ActiveX отображаются двумя способами:

- При вызове команды свойств элемента управления (**OLEIVERB_PROPERTIES**) элемент управления открывает модальное диалоговое окно свойств, которое содержит страницы свойств элемента управления.

- В контейнере может отображаться собственное немодальное диалоговое окно, в котором отображаются страницы свойств выбранного элемента управления.

Диалоговое окно Свойства (показано на следующем рисунке) состоит из области отображения текущей страницы свойств, вкладок для переключения между страницами свойств и коллекции кнопок, выполняющих стандартные задачи, такие как закрытие диалогового окна страницы свойств, отмена всех внесенных изменений или немедленное применение изменений к элементу управления ActiveX.

![Диалоговое окно “Свойства” Circ3](../mfc/media/vc373i1.gif "Диалоговое окно “Свойства” Circ3") <br/>
Диалоговое окно «Свойства»

В этой статье рассматриваются темы, связанные с использованием страниц свойств в элементе управления ActiveX. Сюда входит следующее.

- [Реализация страницы свойств по умолчанию для элемента управления ActiveX](#_core_implementing_the_default_property_page)

- [Добавление элементов управления на страницу свойств](#_core_adding_controls_to_a_property_page)

- [Настройка функции DoDataExchange](#_core_customizing_the_dodataexchange_function)

Дополнительные сведения об использовании страниц свойств в элементе управления ActiveX см. в следующих статьях:

- [Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств](mfc-activex-controls-adding-another-custom-property-page.md)

- [Элементы ActiveX в MFC. Использование стандартных страниц свойств](mfc-activex-controls-using-stock-property-pages.md)

Сведения об использовании страниц свойств в приложении MFC, отличном от элемента управления ActiveX, см. в разделе [страницы свойств](property-sheets-mfc.md).

## <a name="implementing-the-default-property-page"></a><a name="_core_implementing_the_default_property_page"></a>Реализация страницы свойств по умолчанию

При использовании мастера элементов управления ActiveX для создания проекта элемента управления мастер элементов управления ActiveX предоставляет класс страницы свойств по умолчанию для элемента управления, производного от [класса COlePropertyPage](reference/colepropertypage-class.md). Изначально эта страница свойств пуста, но можно добавить в нее любой элемент управления диалогового окна или набор элементов управления. Поскольку мастер элементов управления ActiveX создает по умолчанию только один класс страницы свойств, необходимо создать дополнительные классы страниц свойств (также производные от `COlePropertyPage` ) с помощью представление классов. Дополнительные сведения об этой процедуре см. в разделе [элементы ActiveX MFC: Добавление другой настраиваемой страницы свойств](mfc-activex-controls-adding-another-custom-property-page.md).

Реализация страницы свойств (в данном случае по умолчанию) состоит из трех этапов:

#### <a name="to-implement-a-property-page"></a>Реализация страницы свойств

1. Добавьте `COlePropertyPage` производный класс в проект элемента управления. Если проект был создан с помощью мастера элементов управления ActiveX (как в данном случае), то класс страницы свойств по умолчанию уже существует.

1. Используйте редактор диалоговых окон, чтобы добавить любые элементы управления в шаблон страницы свойств.

1. Настройте `DoDataExchange` функцию `COlePropertyPage` производного класса для обмена значениями между элементом управления страницы свойств и элементом управления ActiveX.

Например, в следующих процедурах используется простой элемент управления (с именем Sample). Образец был создан с помощью мастера элементов управления ActiveX и содержит только свойство "заголовок акции".

## <a name="adding-controls-to-a-property-page"></a><a name="_core_adding_controls_to_a_property_page"></a>Добавление элементов управления на страницу свойств

#### <a name="to-add-controls-to-a-property-page"></a>Добавление элементов управления на страницу свойств

1. Откройте проект элемента управления и откройте представление ресурсов.

1. Дважды щелкните значок каталога **диалогового окна** .

1. Откройте диалоговое окно IDD_PROPPAGE_SAMPLE.

   Мастер элементов управления ActiveX добавляет имя проекта в конец идентификатора диалогового окна, в данном случае — Sample.

1. Перетащите выбранный элемент управления из области элементов в область диалогового окна.

1. В этом примере достаточно элемента управления надписью "Caption:" и элементом управления "поле ввода" с идентификатором IDC_CAPTION.

1. Нажмите кнопку **сохранить** на панели инструментов, чтобы сохранить изменения.

Теперь, когда пользовательский интерфейс был изменен, необходимо связать поле редактирования со свойством Caption. Это делается в следующем разделе, изменив `CSamplePropPage::DoDataExchange` функцию.

## <a name="customizing-the-dodataexchange-function"></a><a name="_core_customizing_the_dodataexchange_function"></a>Настройка функции DoDataExchange

Страница свойств [CWnd::D одатаексчанже](reference/cwnd-class.md#dodataexchange) позволяет связывать значения страницы свойств с фактическими значениями свойств в элементе управления. Чтобы установить ссылки, необходимо связать соответствующие поля страницы свойств с соответствующими свойствами элементов управления.

Эти сопоставления реализуются с помощью страницы свойств **DDP_** функции. Функции **DDP_** работают подобно функциям **DDX_** , используемым в стандартных диалоговых окнах MFC, за одним исключением. Помимо ссылки на переменную-член, **DDP_** функции принимают имя свойства элемента управления. Ниже приведена типичная запись в `DoDataExchange` функции для страницы свойств.

[!code-cpp[NVC_MFC_AxUI#31](codesnippet/cpp/mfc-activex-controls-property-pages_1.cpp)]

Эта функция связывает переменную-член *m_Caption* страницы свойств с заголовком с помощью `DDP_TEXT` функции.

После вставки элемента управления страницы свойств необходимо установить связь между элементом управления страницы свойств, IDC_CAPTION и фактическим свойством элемента управления, заголовком, с помощью `DDP_Text` функции, как описано выше.

[Страницы свойств](reference/property-pages-mfc.md) доступны для других типов элементов управления диалогового окна, например флажков, переключателей и списков. В таблице ниже приведен полный набор функций **DDP_** страниц свойств, а также их назначение.

### <a name="property-page-functions"></a>Функции страницы свойств

|Имя функции|Используйте эту функцию для связывания|
|-------------------|-------------------------------|
|`DDP_CBIndex`|Индекс выбранной строки в поле со списком со свойством элемента управления.|
|`DDP_CBString`|Выбранная строка в поле со списком со свойством элемента управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью совпадать с ней.|
|`DDP_CBStringExact`|Выбранная строка в поле со списком со свойством элемента управления. Выбранная строка и строковое значение свойства должны точно совпадать.|
|`DDP_Check`|Флажок со свойством элемента управления.|
|`DDP_LBIndex`|Индекс выбранной строки в поле со списком со свойством элемента управления.|
|`DDP_LBString`|Выбранная строка в поле со списком со свойством элемента управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью совпадать с ней.|
|`DDP_LBStringExact`|Выбранная строка в поле со списком со свойством элемента управления. Выбранная строка и строковое значение свойства должны точно совпадать.|
|`DDP_Radio`|Переключатель со свойством элемента управления.|
|`DDP_Text`|Текст со свойством элемента управления.|

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](mfc-activex-controls.md)<br/>
[Класс COlePropertyPage](reference/colepropertypage-class.md)
