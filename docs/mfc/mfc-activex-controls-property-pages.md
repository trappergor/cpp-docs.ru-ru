---
title: Элементы управления ActiveX в MFC. Страницы свойств
ms.date: 09/12/2018
helpviewer_keywords:
- DDP_ functions [MFC]
- MFC ActiveX controls [MFC], properties
- property pages [MFC], MFC ActiveX controls
- DoDataExchange method [MFC]
- OLEIVERB_PROPERTIES
- CPropertyPageDialog class [MFC]
- MFC ActiveX controls [MFC], property pages
ms.assetid: 1506f87a-9fd6-4505-8380-0dbc9636230e
ms.openlocfilehash: 764590b5d7162d7f10a60dda24649adde9e090c7
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50656187"
---
# <a name="mfc-activex-controls-property-pages"></a>Элементы управления ActiveX в MFC. Страницы свойств

Страницы свойств позволяют пользователю элемента управления ActiveX для просмотра и изменения свойств элемента управления ActiveX. Эти свойства осуществляется путем вызова диалогового окна свойств элемента управления, которое содержит один или несколько страниц свойств, предоставляющих настраиваемый графический интерфейс для просмотра и редактирования свойств элемента управления.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которая не следует использовать для разработки новых приложений. Дополнительные сведения о современных технологий, заменяющие ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

Страницы свойств элемента управления ActiveX отображаются двумя способами:

- Когда команда свойства элемента управления (**OLEIVERB_PROPERTIES**) является вызове, элемент управления открывает свойства модальное диалоговое окно, которое содержит страницы свойств элемента управления.

- Контейнер может отображать свой собственный немодальное диалоговое окно, которое показаны страницы свойств выбранного элемента управления.

Диалоговое окно свойств (как показано на рисунке ниже) состоит из области для отображения текущей страницы свойств, вкладки для переключения между страницы свойств, а коллекция кнопок, общие задачи, например, закрыть диалоговое окно страницы свойств, Отмена изменения, выполненные или немедленно, применяя любые изменения в элемент управления ActiveX.

![Диалоговое окно свойств для Circ3](../mfc/media/vc373i1.gif "vc373i1") диалоговое окно «Свойства»

В этой статье рассматриваются темы, связанные с помощью страниц свойств в элементе управления ActiveX. Сюда входит следующее.

- [Реализация страницы свойств по умолчанию для элемента управления ActiveX](#_core_implementing_the_default_property_page)

- [Добавление элементов управления на страницу свойств](#_core_adding_controls_to_a_property_page)

- [Настройка функции DoDataExchange](#_core_customizing_the_dodataexchange_function)

Дополнительные сведения об использовании страницы свойств в элементе управления ActiveX см. в разделе со следующими статьями:

- [Элементы ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)

- [Элементы ActiveX в MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)

Сведения об использовании свойств в приложении MFC, отличный от элемента управления ActiveX, см. в разделе [свойств](../mfc/property-sheets-mfc.md).

##  <a name="_core_implementing_the_default_property_page"></a> Реализация страницы свойств по умолчанию

Если вы используете мастер элементов управления ActiveX для создания проекта элемента управления, мастер элементов управления ActiveX предоставляет класс страницы свойств по умолчанию для элемента управления, производных от [класс COlePropertyPage](../mfc/reference/colepropertypage-class.md). Изначально эта страница свойств является пустым, но к нему можно добавить любой управления диалогового окна или набор элементов управления. Так как мастер элементов управления ActiveX создает класс страницы только одно свойство по умолчанию классы страницы дополнительных свойств (также является производным от `COlePropertyPage`) должен быть создан с помощью представления классов. Дополнительные сведения об этой процедуре см. в разделе [элементы ActiveX в MFC: Добавление другую страницу свойства Custom](../mfc/mfc-activex-controls-adding-another-custom-property-page.md).

Реализация свойства страницы (в данном случае, значение по умолчанию) — это три этапа:

#### <a name="to-implement-a-property-page"></a>Реализация страницы свойств

1. Добавление `COlePropertyPage`-производный класс в проект элемента управления. Если проект был создан с помощью мастера элементов управления ActiveX (как в данном случае), класс страницы свойств по умолчанию уже существует.

1. Использование редактора диалоговых окон для добавления любых элементов управления в шаблон страницы свойств.

1. Настройка `DoDataExchange` функции `COlePropertyPage`-производный класс для обмена значений между элементом управления страницы свойств и элемент управления ActiveX.

Например целей, в следующих процедурах использовать простой элемент управления (с именем «Образец»). Пример был создан с помощью мастера элементов управления ActiveX и содержит только стандартное свойство Caption.

##  <a name="_core_adding_controls_to_a_property_page"></a> Добавление элементов управления на страницу свойств

#### <a name="to-add-controls-to-a-property-page"></a>Для добавления элементов управления на страницу свойств

1. Проект управления открыт откройте представление ресурсов.

1. Дважды щелкните **диалоговое окно** значок directory.

1. Откройте диалоговое окно IDD_PROPPAGE_SAMPLE.

   Мастер элементов управления ActiveX добавляет в конец идентификатора диалоговое окно, в этом случае пример имя проекта.

1. Перетащите выбранный элемент управления из области элементов в область диалогового окна.

1. В этом примере текст метки элемента управления «заголовок:» и поле ввода с идентификатором IDC_CAPTION достаточно.

1. Нажмите кнопку **Сохранить** на панели инструментов, чтобы сохранить изменения.

Теперь, когда пользовательский интерфейс был изменен, необходимо связать с свойство Caption "Изменить". Это делается в следующем разделе, изменив `CSamplePropPage::DoDataExchange` функции.

##  <a name="_core_customizing_the_dodataexchange_function"></a> Настройка функции DoDataExchange

Страницы свойств [CWnd::DoDataExchange](../mfc/reference/cwnd-class.md#dodataexchange) функция позволяет связывать значения свойств страницы с фактическими значениями свойств в элементе управления. Для установления связи, необходимо сопоставить поля страницы соответствующее свойство их соответствующим свойствам элемента управления.

Эти сопоставления реализуются с помощью страницы свойств **DDP_** функции. **DDP_** функции работают как **DDX_** функций, используемых в стандартных диалоговых окон MFC, за одним исключением. В дополнение к ссылку на переменную-член **DDP_** функции принимают имя свойства элемента управления. Ниже приведен типичный записи на `DoDataExchange` функции для страницы свойств.

[!code-cpp[NVC_MFC_AxUI#31](../mfc/codesnippet/cpp/mfc-activex-controls-property-pages_1.cpp)]

Эта функция связывает странице свойств *m_caption* переменную-член с заголовком, с помощью `DDP_TEXT` функции.

После того, как у вас есть вставить управления страницы свойств, необходимо установить связь между элемента управления страницы свойств, IDC_CAPTION и свойство фактического элемента управления, заголовок, с помощью `DDP_Text` работать так, как описано выше.

[Страницы свойств](../mfc/reference/property-pages-mfc.md) доступны для других типов элементов управления диалогового окна, например флажки, переключатели и списки. В следующей таблице перечислены весь набор страницу свойств **DDP_** функций и их цели:

### <a name="property-page-functions"></a>Свойство страничных функций

|Имя функции|Эта функция используется для связывания|
|-------------------|-------------------------------|
|`DDP_CBIndex`|Индекс выбранной строки в поле со списком со свойством элемента управления.|
|`DDP_CBString`|Выбранной строки в поле со списком со свойством элемента управления. Можно начать с того же буквы как значение свойства выбранной строки, но не должны совпадать, он полностью.|
|`DDP_CBStringExact`|Выбранной строки в поле со списком со свойством элемента управления. Выбранной строки и значения свойства строки должны точно совпадать.|
|`DDP_Check`|Типа "флажок" со свойством элемента управления.|
|`DDP_LBIndex`|Индекс выбранной строки в поле со списком со свойством элемента управления.|
|`DDP_LBString`|Выбранной строки в поле со списком со свойством элемента управления. Можно начать с того же буквы как значение свойства выбранной строки, но не должны совпадать, он полностью.|
|`DDP_LBStringExact`|Выбранной строки в поле со списком со свойством элемента управления. Выбранной строки и значения свойства строки должны точно совпадать.|
|`DDP_Radio`|Типа "переключатель" со свойством элемента управления.|
|`DDP_Text`|Текст со свойством элемента управления.|

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Класс COlePropertyPage](../mfc/reference/colepropertypage-class.md)
