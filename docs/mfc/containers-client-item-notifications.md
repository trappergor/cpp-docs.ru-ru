---
title: Контейнеры. Уведомления элементов клиентов
ms.date: 11/04/2016
helpviewer_keywords:
- notifications [MFC], container client item
- OLE containers [MFC], client-item notifications
- client items and OLE containers
ms.assetid: e1f1c427-01f5-45f2-b496-c5bce3d76340
ms.openlocfilehash: 54b1b2a64685b00fb265e0f80c1f6ad878a7da85
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84623015"
---
# <a name="containers-client-item-notifications"></a>Контейнеры. Уведомления элементов клиентов

В этой статье рассматриваются переопределяемые функции, которые платформа MFC вызывает, когда серверные приложения изменяют элементы в документе клиентского приложения.

[COleClientItem](reference/coleclientitem-class.md) определяет несколько переопределяемых функций, которые вызываются в ответ на запросы от приложения компонента, которое также называется серверным приложением. Эти оверридаблес обычно действуют как уведомления. Они сообщают приложению-контейнеру различные события, такие как прокрутка, активация или изменение позиции, а также изменения, вносимые пользователем при редактировании или управлении элементом другим способом.

Платформа уведомляет приложение-контейнер об изменениях с помощью вызова `COleClientItem::OnChange` , переопределяемой функции, для которой требуется реализация. Эта защищенная функция получает два аргумента. Первый указывает причину, по которой сервер изменил элемент:

|Уведомление|Значение|
|------------------|-------------|
|**OLE_CHANGED**|Внешний вид элемента OLE изменился.|
|**OLE_SAVED**|Элемент OLE был сохранен.|
|**OLE_CLOSED**|Элемент OLE был закрыт.|
|**OLE_RENAMED**|Серверный документ, содержащий элемент OLE, был переименован.|
|**OLE_CHANGED_STATE**|Элемент OLE был изменен с одного состояния на другое.|
|**OLE_CHANGED_ASPECT**|Аспект рисования элемента OLE был изменен платформой.|

Эти значения относятся к перечислению **OLE_NOTIFICATION** , которое определено в афксоле. Высоты.

Второй аргумент этой функции указывает, как изменился элемент или какое состояние было введено:

|Если первым аргументом является|Второй аргумент|
|----------------------------|---------------------|
|**OLE_SAVED** или **OLE_CLOSED**|Не используется.|
|**OLE_CHANGED**|Задает аспект объекта OLE, который был изменен.|
|**OLE_CHANGED_STATE**|Описывает входное состояние (*емптистате*, *лоадедстате*, *опенстате*, *activeState*или *активеуистате*).|

Дополнительные сведения о состояниях, которые может предположить клиентский элемент, см. в разделе [контейнеры: состояния клиентских элементов](containers-client-item-states.md).

Платформа вызывает, `COleClientItem::OnGetItemPosition` когда элемент активируется для редактирования на месте. Для приложений, поддерживающих редактирование на месте, требуется реализация. Мастер приложений MFC предоставляет базовую реализацию, которая назначает координаты элемента `CRect` объекту, который передается в качестве аргумента в `OnGetItemPosition` .

Если позиция или размер объекта OLE изменяется во время редактирования на месте, необходимо обновить сведения о контейнере, посвященном положению элемента и прямоугольникам обрезки, и сервер должен получить сведения об этих изменениях. `COleClientItem::OnChangeItemPosition`Для этой цели платформа вызывает. Мастер приложений MFC предоставляет переопределение, которое вызывает функцию базового класса. Необходимо изменить функцию, которую мастер приложений запишет для `COleClientItem` класса, производного от, чтобы функция обновляет все данные, сохраняемые объектом клиентского элемента.

## <a name="see-also"></a>См. также раздел

[Контейнеры](containers.md)<br/>
[Контейнеры. Состояния элементов клиентов](containers-client-item-states.md)<br/>
[COleClientItem:: OnChangeItemPosition](reference/coleclientitem-class.md#onchangeitemposition)
