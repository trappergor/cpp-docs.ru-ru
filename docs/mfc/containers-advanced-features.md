---
title: 'Контейнеры: Дополнительные возможности | Документация Майкрософт'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- links [MFC], to embedded OLE objects
- containers [MFC], links to embedded OLE objects
- containers [MFC], advanced features
- container/server applications [MFC]
- embedded objects [MFC]
- OLE controls [MFC], containers
- OLE containers [MFC], advanced features
- server/container applications [MFC]
- containers [MFC], container applications
ms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 51dee27c69d42bde83f8eb6925e96d0dad80dca6
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50081252"
---
# <a name="containers-advanced-features"></a>Контейнеры. Дополнительные возможности

В этой статье описываются действия, необходимые для включения необязательно расширенных возможностей в существующие приложения-контейнеры. Эти компоненты входят:

- [Приложение, — это контейнер и сервер](#_core_creating_a_container_server_application)

- [Связь с внедренный объект](#_core_links_to_embedded_objects)

##  <a name="_core_creating_a_container_server_application"></a> Создание контейнера и сервера приложений

Приложение контейнера и сервера — это приложение, выступает в качестве контейнера и сервера. Примером этого используется Microsoft Word для Windows. Документы Word для Windows можно внедрять в другие приложения и элементов также можно внедрять в документы Word для Windows. Процесс изменения ваше приложение контейнера и контейнером, так и полного сервера, (нельзя создать это приложение контейнера/miniserver сочетания) похожа на процедуру для создания полного сервера.

Статья [серверы: реализация сервера](../mfc/servers-implementing-a-server.md) рассматривается ряд задач, необходимых для реализации серверного приложения. При преобразовании приложения-контейнера в контейнер или серверное приложение, потребуется для выполнения некоторых эти же задачи, добавив код в контейнер. В следующем списке перечислены важные аспекты, которые следует учитывать:

- Контейнер код, создаваемый мастером приложений, уже инициализирует подсистемы OLE. Не нужно будет изменить или добавить никакие параметры для такой поддержки.

- Везде, где базовым классом класса документа является `COleDocument`, измените базовый класс для `COleServerDoc`.

- Переопределить `COleClientItem::CanActivate` во избежание изменения элементов в месте, пока сам сервер используется для редактирования на месте.

   Например, MFC OLE образец [OCLIENT](../visual-cpp-samples.md) внедренными элемент, созданный приложением контейнера и сервера. При открытии приложения OCLIENT и на месте изменить элемент, созданный приложением контейнера и сервера. Во время редактирования элемента в приложении, вы решите, требуется внедрить элемента, созданного MFC OLE образцом [HIERSVR](../visual-cpp-samples.md). Чтобы сделать это, нельзя использовать активацию на месте. Необходимо полностью открыть HIERSVR для активации этого элемента. Так как библиотеки классов Microsoft Foundation не поддерживает эту функцию OLE, переопределяя `COleClientItem::CanActivate` позволяет проверить, случилось ли и предотвращения возможных ошибок времени выполнения в приложении.

Если вы создаете новое приложение и его в качестве контейнера или серверного приложения, выберите, что параметр в диалоговом окне OLE параметры в мастере приложений и эта поддержка будет создана автоматически. Дополнительные сведения см. в статье [Обзор: создание контейнеров элементов управления ActiveX](../mfc/reference/creating-an-mfc-activex-control-container.md). Сведения об образцах MFC см. в разделе примеры MFC.

Обратите внимание на то, что отсутствует возможность вставки MDI-приложения в саму себя. Приложение, — это контейнер/сервер нельзя будет вставлен в сам, если оно является приложением SDI.

##  <a name="_core_links_to_embedded_objects"></a> Ссылки на внедренные объекты

Ссылки на внедренные объекты компонентов позволяет пользователю создать документ с связь с внедренного объекта внутри приложения-контейнера. Например создайте документ в текстовом процессоре, содержащий внедренные электронную таблицу. Если приложение поддерживает ссылки на внедренные объекты, он может вставить ссылку в электронную таблицу, содержащихся в документе word процессора. Эта функция позволяет приложению использовать сведения, содержащиеся в электронной таблице, не зная, где текстовый процессор изначально правильно.

#### <a name="to-link-to-embedded-objects-in-your-application"></a>Чтобы связать внедренные объекты в приложении

1. Наследование класса документов от `COleLinkingDoc` вместо `COleDocument`.

1. Создайте идентификатор класса OLE (**CLSID**) для вашего приложения с помощью генератора идентификатор класса, включенные с помощью средств разработки OLE.

1. Зарегистрируйте приложение с OLE.

1. Создание `COleTemplateServer` как член класса приложения.

1. В классе приложения `InitInstance` член функции, выполните следующие действия:

   - Подключиться к `COleTemplateServer` объекта на шаблоны документов путем вызова объекта `ConnectTemplate` функция-член.

   - Вызовите `COleTemplateServer::RegisterAll` функцию-член для регистрации всех объектов класса в системе OLE.

   - Вызовите метод `COleTemplateServer::UpdateRegistry`. Единственным параметром, который `UpdateRegistry` должно быть *OAT_CONTAINER* Если приложение не запускается с параметром «/ Embedded». Это регистрирует приложение как контейнер, который может поддерживать ссылки на внедренные объекты.

         If the application is launched with the "/Embedded" switch, it should not show its main window, similar to a server application.

Пример MFC OLE [OCLIENT](../visual-cpp-samples.md) реализовала эту функцию. Пример того, как это можно сделать, см. в разделе `InitInstance` работать в *OCLIENT. CPP* файл этого примера приложения.

## <a name="see-also"></a>См. также

[Контейнеры](../mfc/containers.md)<br/>
[Серверы](../mfc/servers.md)

