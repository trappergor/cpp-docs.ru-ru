---
title: Контейнеры активных документов
ms.date: 11/19/2018
helpviewer_keywords:
- active documents [MFC], containers
- active document containers [MFC]
- containers [MFC], active document
- MFC COM, active document containment
ms.assetid: ba20183a-8b4c-440f-9031-e5fcc41d391b
ms.openlocfilehash: dc7017a205bedd716e5c87aa23ac96b257af2e16
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84626024"
---
# <a name="active-document-containers"></a>Контейнеры активных документов

Контейнер активного документа, например Microsoft Office BINDER или Internet Explorer, позволяет работать с несколькими документами различных типов приложений в пределах одного кадра (вместо того, чтобы создавать и использовать несколько кадров приложения для каждого типа документа).

MFC обеспечивает полную поддержку контейнеров активных документов в `COleDocObjectItem` классе. С помощью мастера приложений MFC можно создать контейнер активного документа, установив флажок **Контейнер активного документа** на странице **Поддержка составных документов** мастера приложений MFC. Дополнительные сведения см. в разделе [Создание приложения контейнера активного документа](creating-an-active-document-container-application.md).

Дополнительные сведения о контейнерах активных документов см. в следующих статьях:

- [Требования к контейнеру](#container_requirements)

- [Объекты сайта документов](#document_site_objects)

- [Просмотр объектов сайта](#view_site_objects)

- [Объект кадра](#frame_object)

- [Слияние меню "Справка"](help-menu-merging.md)

- [Программная печать](programmatic-printing.md)

- [Целевые объекты команд](message-handling-and-command-targets.md)

## <a name="container-requirements"></a><a name="container_requirements"></a>Требования к контейнеру

Поддержка активных документов в контейнере активного документа подразумевает не только реализации интерфейса, но также и знание интерфейсов автономного объекта. То же самое относится к расширениям Active Document, где контейнер должен также уметь использовать эти интерфейсы расширений в самих документах.

Активный контейнер документа, который интегрирует активные документы, должен:

- Возможность обработки хранилища объектов через `IPersistStorage` интерфейс, то есть он должен предоставлять `IStorage` экземпляр каждому активному документу.

- Поддерживают базовые функции внедрения документов OLE, требующие "site" объектов (по одному на документ или внедрение), которые реализуют `IOleClientSite` и `IAdviseSink` .

- Поддержка встроенных объектов или активных документов на месте. Объекты сайта контейнера должны реализовываться `IOleInPlaceSite` , а объект фрейма контейнера должен предоставляться `IOleInPlaceFrame` .

- Поддержка расширений активных документов путем реализации `IOleDocumentSite` для предоставления контейнеру механизма взаимодействия с документом. При необходимости контейнер может реализовать интерфейсы активных документов `IOleCommandTarget` и `IContinueCallback` выбрать простые команды, такие как печать или сохранение.

При необходимости можно реализовать объект Frame, объекты представления и объект контейнера `IOleCommandTarget` для поддержки диспетчеризации определенных команд, как описано в разделе [целевые объекты команды](message-handling-and-command-targets.md). Объекты представления и контейнера могут также реализовывать `IPrint` и `IContinueCallback` , для поддержки программной печати, как описано в разделе [Программная печать](programmatic-printing.md).

На следующем рисунке показаны концептуальные связи между контейнером и его компонентами (слева), а также активным документом и его представлениями (справа). Активный документ управляет хранилищем и данными, а представление отображает или при необходимости выводит эти данные. Выделенные жирным шрифтом интерфейсы необходимы для участия в активном документе; Эти полужирные и курсивные начертания являются необязательными. Все остальные интерфейсы являются обязательными.

![Интерфейсы контейнера активного документа](../mfc/media/vc37gj1.gif "Интерфейсы контейнера активного документа")

Документ, поддерживающий только одно представление, может реализовать как представление, так и компоненты документа (то есть их соответствующие интерфейсы) в одном конкретном классе. Кроме того, сайт контейнера, который поддерживает только одно представление за раз, может объединять сайт документа и сайт представления в один конкретный класс сайта. Однако объект фрейма контейнера должен оставаться неизменным, а компонент документа контейнера просто включается здесь, чтобы дать полную картину архитектуры. на это не влияет архитектура включения в активный документ.

## <a name="document-site-objects"></a><a name="document_site_objects"></a>Объекты сайта документов

В архитектуре включения активного документа сайт документа совпадает с объектом клиентского сайта в OLE-документах с добавлением `IOleDocument` интерфейса:

```cpp
interface IOleDocumentSite : IUnknown
{
    HRESULT ActivateMe(IOleDocumentView *pViewToActivate);
}
```

Сайт документа по сути является контейнером для одного или нескольких объектов "View Site". Каждый объект сайта представления связан с отдельными объектами представления документа, которым управляет сайт документа. Если контейнер поддерживает только одно представление для каждого сайта документа, он может реализовать сайт документа и сайт представления с одним конкретным классом.

## <a name="view-site-objects"></a><a name="view_site_objects"></a>Просмотр объектов сайта

Объект сайта представления контейнера управляет пространством отображения для конкретного представления документа. Помимо поддержки стандартного `IOleInPlaceSite` интерфейса, сайт представления также обычно реализуется `IContinueCallback` для программного управления печатью. (Обратите внимание, что объект представления никогда не запрашивается, `IContinueCallback` поэтому его можно реализовать на любом объекте, запрашивающем контейнер.)

Контейнер, поддерживающий несколько представлений, должен иметь возможность создавать объекты сайта нескольких представлений в пределах сайта документа. Это обеспечивает каждое представление с отдельными службами активации и деактивации, предоставляемыми через `IOleInPlaceSite` .

## <a name="frame-object"></a><a name="frame_object"></a>Объект Frame

Объект фрейма контейнера — это, по большей части, тот же кадр, который используется для активации на месте в документах OLE, то есть для обработки согласования меню и панели инструментов. Объект представления имеет доступ к этому объекту Frame через `IOleInPlaceSite::GetWindowContext` , который также предоставляет доступ к объекту контейнера, представляющему документ-контейнер (который может выполнять согласование панели инструментов на уровне панели и перечисление объектов).

Контейнер активного документа может дополнить фрейм путем добавления `IOleCommandTarget` . Это позволяет ему получать команды, происходящие в пользовательском интерфейсе активного документа, так же, как этот интерфейс позволяет контейнеру отправлять одни и те же команды (например, **файл создать**, **Открыть**, **Сохранить как**, **Печать**; **Изменить копию**, **Вставить**, **отменить**и другие) в активный документ. Дополнительные сведения см. в разделе [целевые объекты команды](message-handling-and-command-targets.md).

## <a name="see-also"></a>См. также раздел

[Вложение активного документа](active-document-containment.md)
