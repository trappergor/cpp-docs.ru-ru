---
title: Контейнеры активных документов | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- active documents [MFC], containers
- active document containers [MFC]
- containers [MFC], active document
- MFC COM, active document containment
ms.assetid: ba20183a-8b4c-440f-9031-e5fcc41d391b
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 2f2d8dcc81a8e9843ffa84651a6404ba91c9ef3d
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46394256"
---
# <a name="active-document-containers"></a>Контейнеры активных документов

Контейнер активного документа, например Microsoft Office Binder или Internet Explorer позволяет работать с несколькими документами из разных типов приложений в один кадр (вместо вас от необходимости создавать и использовать несколько кадров приложения для каждого Тип документа).

MFC предоставляет полную поддержку для активных контейнеров документов в `COleDocObjectItem` класса. Можно использовать мастер приложений MFC создает контейнер активного документа, выбрав **контейнер активного документа** флажок на **поддержка составных документов** страницы мастера приложений MFC. Дополнительные сведения см. в разделе [Создание приложения с контейнером активных документов](../mfc/creating-an-active-document-container-application.md).

Дополнительные сведения о контейнерах активных документов см. в разделе:

- [Требования к контейнеру](#container_requirements)

- [Объекты сайтов документа](#document_site_objects)

- [Просмотр объектов сайта](#view_site_objects)

- [Объект кадра](#frame_object)

- [Слияние меню "Справка"](../mfc/help-menu-merging.md)

- [Программная печать](../mfc/programmatic-printing.md)

- [Целевые объекты команд](../mfc/message-handling-and-command-targets.md)

##  <a name="container_requirements"></a> Требования к контейнеру

Поддержка активного документа в контейнер активного документа подразумевает не только для реализации интерфейса: также требуются знания с помощью интерфейсов объект внутри контейнера. Это же относится к расширениям активного документа, где контейнер необходимо также знать, как использовать эти интерфейсы модуля в самих документах active.

Контейнер активного документа, который интегрирует активные документы должны:

- Иметь возможность обработки объекта хранилища с помощью `IPersistStorage` интерфейс, то есть он должен предоставлять `IStorage` экземпляр для каждого активного документа.

- Поддерживают базовые возможности внедрения документов OLE, создавая объекты «сайт» (по одному на документ или внедрение), реализующие `IOleClientSite` и `IAdviseSink`.

- Поддерживает активацию на месте внедренные объекты или активных документов. Объекты сайта контейнера должны реализовывать `IOleInPlaceSite` и необходимо предоставить объект кадра контейнера `IOleInPlaceFrame`.

- Поддержка расширений активных документов путем реализации `IOleDocumentSite` для обеспечения механизма для контейнера обращаться к документу. При необходимости контейнера можно реализовать интерфейсы активного документа `IOleCommandTarget` и `IContinueCallback` овладеть простые команды, такие как печать или сохранение.

Объект кадра, просмотр объектов и объект-контейнер можно при необходимости реализовать `IOleCommandTarget` для поддержки отправки определенных команд, как описано в [целей команды](../mfc/message-handling-and-command-targets.md). Представления и контейнер объектов можно также реализовать `IPrint` и `IContinueCallback`, для поддержки программная печать, как описано в [программный печати](../mfc/programmatic-printing.md).

На следующем рисунке показана концептуальная отношения между контейнером и его компоненты (слева) и активный документ и его представлений (справа). Активный документ управляет данными и хранилищами и отображает представление, или при необходимости выводит эти данные. Интерфейсы полужирным шрифтом, которые требуется для участия в активный документ; Эти полужирного шрифта и курсива являются необязательными. Все другие интерфейсы являются обязательными.

![Интерфейсы контейнера активного документа](../mfc/media/vc37gj1.gif "vc37gj1")

Документ, который поддерживает только одно представление можно реализовать компоненты документа и представление (то есть соответствующие интерфейсы) на один конкретный класс. Кроме того узел контейнера, который поддерживает только одно представление за раз можно объединить сайта документов и Просмотр сайта в класс одного конкретного сайта. Объект кадра контейнера, однако нельзя объединять и контейнера документа просто включен компонент здесь предоставить полную картину архитектуры; он не зависит от архитектуры вложения активного документа.

##  <a name="document_site_objects"></a> Объекты сайтов документа

В архитектуре вложения активного документа, узлом документа совпадает со значением объект сайта клиента в OLE-документы с добавлением `IOleDocument` интерфейса:

```cpp
interface IOleDocumentSite : IUnknown
{
    HRESULT ActivateMe(IOleDocumentView *pViewToActivate);
}
```

На сайте документов по существу является контейнером для одного или нескольких объектов «Просмотр сайта». Каждый объект узла представления связаны с объектами отдельного представления документа, управляет сайт документа. Контейнер поддерживает только одно представление каждого узла документа, затем его можно реализовать на сайте документов и Просмотр сайта с один конкретный класс.

##  <a name="view_site_objects"></a> Просмотр объектов сайта

Объект узла представления контейнера управляет места на экране для определенного представления документа. В дополнение к поддержке стандарте `IOleInPlaceSite` также обычно реализует интерфейс, Просмотр сайта `IContinueCallback` для программного управления печати. (Обратите внимание, что объект представления, никогда не запрашивает `IContinueCallback` , она действительно может быть реализована на любой объект контейнера желания акционеров.)

Контейнер, который поддерживает несколько представлений, необходимо создать несколько представление объектов сайта на сайте документа. Это обеспечивает каждого представления с отдельной службы активации и деактивации, как предоставляются через `IOleInPlaceSite`.

##  <a name="frame_object"></a> Объект кадра

Объект кадра контейнера является, по большей части одного кадра, который используется для активации на месте в документах OLE, то есть, по одному, который обрабатывает согласование меню и панели инструментов. Объект представления имеет доступ к этим объектом кадр через `IOleInPlaceSite::GetWindowContext`, который также предоставляет доступ к объект-контейнер, представляющий документе-контейнере (который может обрабатывать согласование уровня панели инструментов и содержащийся объект перечисления).

Контейнер активного документа можно дополнить кадр, добавив `IOleCommandTarget`. Это позволяет ему получать команды, которые создаются в активный документ пользовательского интерфейса таким же образом, что этот интерфейс можно разрешить контейнера для отправки те же команды (такие как **новый файл**, **откройте**,  **Сохранить как**, **печати**; **Правка копии**, **вставить**, **отменить**и другие) в активном документе. Дополнительные сведения см. в разделе [целей команды](../mfc/message-handling-and-command-targets.md).

## <a name="see-also"></a>См. также

[Вложение активного документа](../mfc/active-document-containment.md)

