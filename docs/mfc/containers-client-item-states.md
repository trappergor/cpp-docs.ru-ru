---
title: Контейнеры. Состояния элементов клиентов
ms.date: 11/04/2016
helpviewer_keywords:
- OLE containers [MFC], client-item states
- states, OLE container client-item
- lifetime, lifetime states and OLE container client items
- client items and OLE containers
ms.assetid: e7021caa-bd07-4adb-976e-f5f3d025bc53
ms.openlocfilehash: 927211ccec35d8ec26e2f76b971c59b80248ab96
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84625991"
---
# <a name="containers-client-item-states"></a>Контейнеры. Состояния элементов клиентов

В этой статье объясняются различные состояния, через которые проходит клиентский элемент во время его существования.

Клиентский элемент проходит через несколько состояний при его создании, активации, изменении и сохранении. При каждом изменении состояния элемента инфраструктура вызывает [COleClientItem:: OnChange](reference/coleclientitem-class.md#onchange) с уведомлением **OLE_CHANGED_STATE** . Второй параметр — это значение из `COleClientItem::ItemState` перечисления. Может принимать одно из следующих значений:

- *COleClientItem:: Емптистате*

- *COleClientItem:: Лоадедстате*

- *COleClientItem:: Опенстате*

- *COleClientItem:: activeState*

- *COleClientItem:: Активеуистате*

В пустом состоянии клиентский элемент пока не является полностью элементом. Память была выделена для нее, но еще не инициализирована данными элемента OLE. Это состояние, в котором находится клиентский элемент, когда он был создан с помощью вызова **New** , но еще не перестал быть вторым этапом стандартного создания в два этапа.

На втором шаге, выполненном с помощью вызова `COleClientItem::CreateFromFile` или другой функции `CreateFrom` *XXXX* , элемент полностью создается. Данные OLE (из файла или другого источника, такого как буфер обмена) связаны с `COleClientItem` объектом, производным от. Теперь элемент находится в загруженном состоянии.

Если элемент был открыт в окне сервера, а не открыт на месте в документе контейнера, он находится в открытом (или полностью открытом) состоянии. В этом состоянии Перекрестная штриховка обычно рисуется над представлением элемента в окне контейнера, чтобы показать, что элемент активен в другом расположении.

Когда элемент был активирован на месте, он передается, обычно только ненадолго, через активное состояние. Затем он переходит в активное состояние пользовательского интерфейса, в котором сервер объединяет меню, панели инструментов и другие компоненты пользовательского интерфейса с контейнерами. Наличие этих компонентов пользовательского интерфейса отличает активное состояние пользовательского интерфейса от активного состояния. В противном случае активное состояние напоминает состояние активного пользовательского интерфейса. Если сервер поддерживает операцию отмены, сервер должен хранить сведения о состоянии отмены элемента OLE, пока не достигнет загруженного или открытого состояния.

## <a name="see-also"></a>См. также раздел

[Контейнеры](containers.md)<br/>
[Активация](activation-cpp.md)<br/>
[Контейнеры. Уведомления элементов клиентов](containers-client-item-notifications.md)<br/>
[Средства отслеживания](trackers.md)<br/>
[Класс CRectTracker](reference/crecttracker-class.md)
