---
title: 'Элементы ActiveX в MFC: Добавление пользовательских свойств | Документация Майкрософт'
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- MFC ActiveX controls [MFC], properties
- properties [MFC], custom
ms.assetid: 85af5167-74c7-427b-b8f3-e0d7b73942e5
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 98cf8a0532c3b1f2044ba0338d3f2f2bf8e73813
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46390993"
---
# <a name="mfc-activex-controls-adding-custom-properties"></a>Элементы управления ActiveX в MFC. Добавление пользовательских свойств

Пользовательские свойства отличаются от стандартных свойств, что пользовательские свойства уже не реализованы в `COleControl` класса. Пользовательское свойство используется для предоставления состояние или внешний вид элемента управления ActiveX, программисту, использование элемента управления.

В этой статье описывается, как добавить пользовательское свойство к элементу управления ActiveX, используя мастер добавления свойств и описываются результирующие изменения кода. Ниже приведен список разделов.

- [Использование мастера добавления свойства для добавления пользовательского свойства](#_core_using_classwizard_to_add_a_custom_property)

- [Добавьте изменения мастер свойств для пользовательских свойств](#_core_classwizard_changes_for_custom_properties)

Пользовательские свойства бывают четыре вида реализация: переменной-члена, переменной-члена с уведомлением, методы Get и Set и параметризованные.

- Реализация переменной члена

     Эта реализация представляет состояние свойства в виде переменной-члена класса элемента управления. Используйте реализацию переменной-члена, если не очень важно знать, когда изменяется значение свойства. Из трех типов эта реализация создает наименьший объем код поддержки для свойства. Запись макроса карты диспетчеризации для реализации переменной члена [DISP_PROPERTY](../mfc/reference/dispatch-maps.md#disp_property).

- Переменная-член с реализация уведомление

     Эта реализация состоит из переменной-члена и функции уведомления, создаваемые с помощью мастера добавления свойства. Функция уведомлений автоматически вызывается платформой, после изменения значений свойств. Использование переменной-члена реализация уведомление при необходимости получать уведомления после изменения значения свойства. Эта реализация требует больше времени, поскольку она требует вызова функции. Макроса карты диспетчеризации для этой реализации является [DISP_PROPERTY_NOTIFY](../mfc/reference/dispatch-maps.md#disp_property_notify).

- Реализация методов get и Set

     Эта реализация состоит из пары функций-членов класса элемента управления. Реализация методы Get и Set автоматически вызывает Get-member функция при запросе пользователем элемента управления текущее значение свойства и функция-член набора при запросе пользователем элемента управления, изменить свойство. Эту реализацию следует используйте, когда это необходимо для вычисления значения свойства во время выполнения, проверить это значение, передаваемое пользователем элемента управления, прежде чем изменять Фактическое свойство, или реализации типа свойства или записи — только для чтения. Макроса карты диспетчеризации для этой реализации является [DISP_PROPERTY_EX](../mfc/reference/dispatch-maps.md#disp_property_ex). Следующий раздел: [с помощью мастера добавления свойства для добавления настраиваемого свойства](#_core_using_classwizard_to_add_a_custom_property), использует пользовательское свойство CircleOffset для демонстрации этой реализации.

- Параметризованные реализации

     Мастер добавления свойств поддерживает параметризованные реализации. Свойства с параметрами (иногда называется массива свойств) может использоваться для доступа к набор значений через одно свойство элемента управления. Макроса карты диспетчеризации для этой реализации является DISP_PROPERTY_PARAM. Дополнительные сведения о реализации этого типа см. в разделе [реализации параметризованные свойства](../mfc/mfc-activex-controls-advanced-topics.md) в этой статье элементы управления ActiveX: Дополнительные разделы.

##  <a name="_core_using_classwizard_to_add_a_custom_property"></a> Используя мастер добавления свойства для добавления пользовательского свойства

В следующей процедуре показано добавление пользовательского свойства CircleOffset, который использует реализацию методы Get и Set. Пользовательское свойство CircleOffset позволяет пользователю элемента управления смещения круг в центре ограничивающего прямоугольника элемента управления. Процедура добавления пользовательских свойств с реализацией Кроме методы Get и Set очень похож.

Эту процедуру можно также добавить другие настраиваемые свойства, которые нужно. Замените на имя пользовательского свойства CircleOffset имя свойства и параметры.

#### <a name="to-add-the-circleoffset-custom-property-using-the-add-property-wizard"></a>Чтобы добавить пользовательское свойство CircleOffset с помощью мастера добавления свойства

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. В контекстном меню, щелкните **добавить** и нажмите кнопку **добавить свойство**.

     Откроется [мастер добавления свойств](../ide/names-add-property-wizard.md).

1. В **имя свойства** введите *CircleOffset*.

1. В поле **Тип реализации**выберите **Методы Get/Set**.

1. В **тип свойства** выберите **короткие**.

1. Введите уникальные имена для вашей функций Get и Set, или примите имена по умолчанию.

9. Нажмите кнопку **Готово**.

##  <a name="_core_classwizard_changes_for_custom_properties"></a> Добавить мастер изменения свойств для пользовательских свойств

При добавлении настраиваемого свойства CircleOffset, мастер добавления свойств вносит изменения в заголовок (. H) и реализации (. Файлы CPP) класса элемента управления.

Добавляются следующие строки. H-файл для объявления двух функций, вызываемых `GetCircleOffset` и `SetCircleOffset`:

[!code-cpp[NVC_MFC_AxUI#25](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_1.h)]

Следующая строка добавляется в элемент управления. IDL-файла:

[!code-cpp[NVC_MFC_AxUI#26](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_2.idl)]

Эта строка назначает свойство CircleOffset с определенным номером идентификатора, взятое из метода положение в списке методов и свойств, мастер добавления свойств.

Кроме того, добавляется следующая строка диспетчерскую карту (в. CPP-файл класса элемента управления) для сопоставления свойства CircleOffset два обработчика функции элемента управления:

[!code-cpp[NVC_MFC_AxUI#27](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_3.cpp)]

Наконец, реализации `GetCircleOffset` и `SetCircleOffset` функции добавляются в конец элемента управления. CPP-файл. В большинстве случаев вы измените функцию Get для возврата значения свойства. Функция Set обычно будет содержать код, который должен быть выполнен до или после изменения свойств.

[!code-cpp[NVC_MFC_AxUI#28](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_4.cpp)]

Обратите внимание, что мастер добавления свойств автоматически добавляет вызов, в коллекцию [SetModifiedFlag](../mfc/reference/colecontrol-class.md#setmodifiedflag), в тело функции Set. Вызов этой функции помечает элемент управления, как измененный. Если элемент управления был изменен, его новое состояние сохраняется при сохранении контейнера. Эта функция должна вызываться при каждом изменении значения свойства, сохраняются как часть устойчивое состояние элемента управления.

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Элементы ActiveX в MFC. Свойства](../mfc/mfc-activex-controls-properties.md)<br/>
[Элементы ActiveX в MFC. Методы](../mfc/mfc-activex-controls-methods.md)<br/>
[Класс COleControl](../mfc/reference/colecontrol-class.md)
