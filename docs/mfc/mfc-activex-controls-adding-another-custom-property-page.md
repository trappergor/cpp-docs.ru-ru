---
title: 'Элементы управления ActiveX в MFC: Добавление другой страницы настраиваемых свойств'
ms.date: 11/04/2016
helpviewer_keywords:
- property pages [MFC], MFC ActiveX controls
- custom property pages [MFC]
- ActiveX controls [MFC], property pages
- MFC ActiveX controls [MFC], property pages
ms.assetid: fcf7e119-9f29-41a9-908d-e9b1607e08af
ms.openlocfilehash: 09d85d69efc4c6cf0bf253099bae78c1e570f8a5
ms.sourcegitcommit: 3caf5261b3ea80d9cf14038c116ba981d655cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2019
ms.locfileid: "70907380"
---
# <a name="mfc-activex-controls-adding-another-custom-property-page"></a>Элементы управления ActiveX в MFC: Добавление другой страницы настраиваемых свойств

Иногда элемент управления ActiveX будет иметь больше свойств, чем может помещаться на одной странице свойств. В этом случае можно добавить страницы свойств в элемент управления ActiveX, чтобы отобразить эти свойства.

В этой статье рассматривается добавление новых страниц свойств в элемент управления ActiveX, который уже содержит по крайней мере одну страницу свойств. Дополнительные сведения о добавлении страниц свойств запасов (шрифт, изображение или цвет) см. в статье [элементы управления ActiveX в MFC. Использование страниц](../mfc/mfc-activex-controls-using-stock-property-pages.md)свойств запасов.

В следующих процедурах используется пример платформы элементов управления ActiveX, созданный мастером элементов управления ActiveX. Поэтому имена и идентификаторы классов являются уникальными для этого примера.

Дополнительные сведения об использовании страниц свойств в элементе управления ActiveX см. в следующих статьях:

- [Элементы управления ActiveX MFC. Страницы свойств](../mfc/mfc-activex-controls-property-pages.md)

- [Элементы управления ActiveX MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)

    > [!NOTE]
    >  Настоятельно рекомендуется, чтобы новые страницы свойств соответствовали стандарту size для страниц свойств элементов управления ActiveX. Страницы свойств "изображение и цвет" на бирже измеряют единицы диалогового окна 250x62 (ДЛУ). Стандартная страница свойств шрифта — 250x110 Длус. Страница свойств по умолчанию, созданная мастером элементов управления ActiveX, использует стандарт 250x62 ДЛУ.

### <a name="to-insert-a-new-property-page-template-into-your-project"></a>Вставка нового шаблона страницы свойств в проект

1. Откройте проект элемента управления, откройте представление ресурсов в рабочей области проекта.

1. Щелкните правой кнопкой мыши представление ресурсов, чтобы открыть контекстное меню, и выберите команду **Добавить ресурс**.

1. Разверните узел **диалогового окна** и выберите **IDD_OLE_PROPPAGE_SMALL**.

1. Нажмите кнопку **создать** , чтобы добавить ресурс в проект.

1. Выберите новый шаблон страницы свойств, чтобы обновить окно **свойств** (в **представление ресурсов**).

1. Введите новое значение для свойства **ID** . В этом примере используется **IDD_PROPPAGE_NEWPAGE**.

1. На панели инструментов нажмите кнопку **сохранить** .

### <a name="to-associate-the-new-template-with-a-class"></a>Связывание нового шаблона с классом

1. Откройте представление классов.

1. Щелкните правой кнопкой мыши представление классов, чтобы открыть контекстное меню.

1. В контекстном меню выберите команду **Добавить**, а затем — **Добавить класс**.

   Откроется диалоговое окно [Добавление класса](../ide/add-class-dialog-box.md) .

1. Дважды щелкните шаблон **класса MFC** .

1. В поле **имя класса** в [мастере классов MFC](../mfc/reference/mfc-add-class-wizard.md)введите имя нового класса диалогового окна. (В этом примере — `CAddtlPropPage`.)

1. Если вы хотите изменить имена файлов, нажмите кнопку **изменить**. Введите имена для файлов реализации и заголовков или примите имена по умолчанию.

1. В поле **базовый класс** выберите `COlePropertyPage`.

1. В поле **идентификатор диалогового окна** выберите **IDD_PROPPAGE_NEWPAGE**.

9. Нажмите кнопку **Готово** , чтобы создать класс.

Чтобы разрешить пользователям элемента управления доступ к этой новой странице свойств, внесите следующие изменения в раздел макроса идентификаторов страниц свойств элемента управления (находится в файле реализации элемента управления):

[!code-cpp[NVC_MFC_AxUI#32](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_1.cpp)]

Обратите внимание, что необходимо увеличить второй параметр макроса BEGIN_PROPPAGEIDS (число страниц свойств) с 1 до 2.

Необходимо также изменить файл реализации элемента управления (. CPP) для включения заголовка (. H) файл нового класса страницы свойств.

Следующий шаг состоит в создании двух новых строковых ресурсов, которые будут предоставлять имя типа и заголовок для новой страницы свойств.

#### <a name="to-add-new-string-resources-to-a-property-page"></a>Добавление новых строковых ресурсов на страницу свойств

1. Откройте проект элемента управления и откройте представление ресурсов.

1. Дважды щелкните папку **таблицы строк** , а затем дважды щелкните существующий ресурс таблицы строк, в который необходимо добавить строку.

   При этом таблица строк открывается в окне.

1. Выберите пустую строку в конце таблицы строк и введите текст или заголовок строки: например, "дополнительная страница свойств".

   Откроется страница **свойства строки** , в которой отображаются поля **заголовок** и **идентификатор** . Поле **Caption (заголовок** ) содержит введенную строку.

1. В поле **идентификатор** выберите или введите идентификатор строки. По завершении нажмите клавишу ВВОД.

   В этом примере используется **IDS_SAMPLE_ADDPAGE** для имени типа новой страницы свойств.

1. Повторите шаги 3 и 4 с помощью **IDS_SAMPLE_ADDPPG_CAPTION** для идентификатора и "дополнительную страницу свойств" для заголовка.

1. В. CPP-файл нового класса страницы свойств (в этом примере `CAddtlPropPage`) `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` измените таким образом, чтобы IDS_SAMPLE_ADDPAGE передавался [афксолерегистерпропертипажекласс](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass), как показано в следующем примере:

   [!code-cpp[NVC_MFC_AxUI#33](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_2.cpp)]

1. Измените конструктор `CAddtlPropPage` таким образом, чтобы IDS_SAMPLE_ADDPPG_CAPTION передавался `COlePropertyPage` в конструктор, как показано ниже.

   [!code-cpp[NVC_MFC_AxUI#34](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_3.cpp)]

После внесения необходимых изменений перестройте проект и используйте тестовый контейнер для тестирования новой страницы свойств. Сведения о том, как получить доступ к Контейнеру для тестирования, см. в разделе [Тестирование свойств и событий в Контейнере для тестирования](../mfc/testing-properties-and-events-with-test-container.md) .

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)
