---
title: Элементы ActiveX в MFC | Документация Майкрософт
ms.custom: ''
ms.date: 09/12/2018
ms.technology:
- cpp-mfc
ms.topic: conceptual
f1_keywords:
- MFC ActiveX Controls (MFC)
dev_langs:
- C++
helpviewer_keywords:
- COleControl class [MFC], MFC ActiveX controls
- ActiveX controls [MFC], MFC
- containers [MFC], MFC ActiveX controls
- MFC ActiveX controls [MFC], serializing
- MFC ActiveX controls [MFC], containers
- serialization [MFC], MFC ActiveX controls
- dispatch maps [MFC], for MFC ActiveX controls
- MFC ActiveX controls [MFC], active/inactive state
- events [MFC], ActiveX controls
- MFC ActiveX controls [MFC]
ms.assetid: c911fb74-3afc-4bf3-a0f5-7922b14d9a1b
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 33c79dc8c83f40d0b553a2c44cf22fa107f5ef34
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50065594"
---
# <a name="mfc-activex-controls"></a>Элементы управления ActiveX MFC

Элемент управления ActiveX — это многоразовый программный компонент, основанный на модели COM, который поддерживает широкий набор функциональных возможностей OLE и может быть настроен под различные потребности программного обеспечения.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которая не следует использовать для разработки новых приложений. Дополнительные сведения см. в разделе [элементы управления ActiveX](activex-controls.md).

Элементы управления ActiveX предназначены для использования в обычные контейнеры элементов управления ActiveX, а также в Интернете, в веб-страницы. Можно создать элементы управления ActiveX с MFC, описанные здесь, или с [Active Template Library (ATL)](../atl/active-template-library-atl-concepts.md).

Элемент управления ActiveX может нарисовать сам в отдельном окне реагировать на события (например на щелчки мыши) и управлять через интерфейс, который включает свойства и методы, аналогичные доступным в объекты автоматизации.

Эти элементы управления могут разрабатываться для различных целей, таких как доступ к базе данных, данные мониторинга и построения диаграмм. Помимо их переносимость элементы управления ActiveX поддерживают функции, ранее недоступные для элементов управления ActiveX, такие как совместимость с существующими контейнерами OLE и возможность интеграции их меню с меню контейнера OLE. Кроме того элемент управления ActiveX, полностью поддерживает автоматизации, которая позволяет элементу управления предоставить свойства также и набор методов, которые могут вызываться пользователем элемента управления.

Можно создать элементы управления ActiveX без окон и элементов управления, которые только создать окно, когда они становятся активными. Элементы управления без окон ускорить отображение приложения и сделать его может быть прозрачным и создания непрямоугольных элементов управления. Свойства элемента управления ActiveX также можно загрузить асинхронно.

Элемент управления ActiveX реализован как внутрипроцессный сервер (обычно маленьких объектов), который может использоваться в OLE-контейнер. Обратите внимание, что все функции элемента управления ActiveX доступны только в том случае, при использовании в OLE-контейнер, предназначены для элементов управления ActiveX. См. в разделе [порт элементов управления ActiveX для других приложений](../mfc/containers-for-activex-controls.md) список контейнеров, которые поддерживают элементы управления ActiveX. Этот тип контейнера, именуемые «контейнер элемента управления», могут работать элемент управления ActiveX с помощью свойств и методов элемента управления и получает уведомления из элемента управления ActiveX в форме событий. На следующем рисунке показано это взаимодействие.

![Взаимодействие элемента контейнера элементов управления ActiveX и управления](../mfc/media/vc37221.gif "vc37221") взаимодействия между контейнера элементов управления ActiveX и оконного элемента управления ActiveX

Некоторые последние сведения по оптимизации элементов управления ActiveX, см. в разделе [элементы ActiveX в MFC: оптимизация](../mfc/mfc-activex-controls-optimization.md).

Чтобы создать элемент управления ActiveX в MFC, см. в разделе [Создание проекта элемента управления ActiveX](../mfc/reference/mfc-activex-control-wizard.md).

Дополнительные сведения:

- [Контейнеры для элементов ActiveX](../mfc/activex-control-containers.md)

- [Активные документы](../mfc/active-documents.md)

- [Основные сведения об элементах управления ActiveX](/windows/desktop/com/activex-controls)

- [Обновление существующего элемента управления ActiveX для использования в Интернете](../mfc/upgrading-an-existing-activex-control.md)

##  <a name="_core_basic_components_of_an_activex_control"></a> Основные компоненты элемента управления ActiveX

Элемент управления ActiveX использует несколько программные элементы, эффективно взаимодействовать с контейнер элемента управления и пользователь. Это класс [COleControl](../mfc/reference/colecontrol-class.md), набор функций обработки событий и диспетчеризации карты.

Каждый объект элемента управления ActiveX, разрабатываемых наследует набор мощных функций от своего базового класса MFC, `COleControl`. Эти функции включают встроенной активации и логики автоматизации. `COleControl` объект элемента управления можно предоставить ту же функциональность, что объект окна MFC, а также возможность запускать события. `COleControl` Можно также предоставить [элементы управления без окон](../mfc/providing-windowless-activation.md), которой зависят от их контейнера для получения справки по некоторые функциональные возможности окна предоставляет (захват мыши, фокус клавиатуры, прокрутка), но предоставляют намного быстрее, отображаемое.

Так как класс элемента управления является производным от `COleControl`, он наследует возможность для отправки или «пожар,» сообщений, вызываемых событий, в контейнер элемента управления при соблюдении определенных условий. Эти события используются для уведомления о том, что контейнер элементов управления, когда что-то важное в элементе управления. Дополнительные сведения о событии, можно отправить в контейнер элемента управления путем присоединения параметров к событию. Дополнительные сведения о событиях элемента управления ActiveX см. в статье [элементы ActiveX в MFC: события](../mfc/mfc-activex-controls-events.md).

Последний элемент — диспетчерскую карту, которая используется для предоставления набора функций, (вызываемые методы) и атрибутов (называемые свойства) для элемента управления пользователя. Свойства позволяют контейнера элемента управления или элемента управления пользователя работать с элементом управления различными способами. Пользователь может изменить внешний вид элемента управления, изменить некоторые значения элемента управления или запрашивают элемента управления, например для доступа к определенной части данных, для которого элемент управления поддерживает. Этот интерфейс определяется разработчиком элемента управления и определяется с помощью **представление классов**. Дополнительные сведения о свойства и методы элемента управления ActiveX, см. в статьях [элементы ActiveX в MFC: методы](../mfc/mfc-activex-controls-methods.md) и [свойства](../mfc/mfc-activex-controls-properties.md).

##  <a name="_core_interaction_between_controls_with_windows_and_activex_control_containers"></a> Взаимодействие между элементами управления с Windows и контейнеры элементов управления ActiveX

Когда элемент управления используется в контейнере элемента управления, он использует два механизма для обмена данными: он предоставляет свойства и методы, и он инициирует события. На следующем рисунке показано, как реализованы двух этих механизмов.

![Элемент управления ActiveX взаимодействует со своим контейнером](../mfc/media/vc37222.gif "vc37222") обмен данными между контейнера элементов управления ActiveX и элемент управления ActiveX

Кроме того, на рисунке выше показаны обработке других интерфейсов OLE (помимо, автоматизации и события) элементов управления.

Все взаимодействия элемента управления с контейнером осуществляется `COleControl`. Для обработки некоторых запросов контейнера `COleControl` будет вызов функций-членов, которые реализованы в классе элемента управления. Все методы и некоторые свойства, обрабатываются таким образом. Класс элемента управления также может инициировать соединение с контейнером, путем вызова функции-члены `COleControl`. События запускаются таким образом.

##  <a name="_core_active_and_inactive_states_of_an_activex_control"></a> Активного и неактивного состояний элемента управления ActiveX

Элемент управления имеет два основных состояний: активных и неактивных. В большинстве случаев эти состояния были различаются по ли элемент управления содержит окно. Активный элемент управления был окно. элемент управления неактивным, этого не сделали. С появлением активации без окна это различие, больше не является универсальным, но при этом по-прежнему применяется к многим элементам управления.

Когда [безоконный элемент управления](../mfc/providing-windowless-activation.md) возникает неполадка, active, он вызывает захват мыши, фокус клавиатуры, прокрутка и другие службы окно из своего контейнера. Вы также можете [обеспечивают взаимодействие мыши, чтобы неактивные элементы управления](../mfc/providing-mouse-interaction-while-inactive.md), а также создавать элементы управления, [Подождите, пока не активирована для создания окна](../mfc/turning-off-the-activate-when-visible-option.md).

Когда элемент управления с окно становится активным, полностью взаимодействовать с контейнера элемента управления, пользователя и Windows. На рисунке ниже показано путей взаимодействие элемента управления ActiveX, контейнер элементов управления и операционной системы.

![Обработка сообщений в active оконного элемента управления ActiveX](../mfc/media/vc37223.gif "vc37223") обработки сообщения Windows в оконного элемента управления ActiveX с (когда активно)

##  <a name="_core_serializing_activex_elements"></a> Сериализация

Возможность сериализации данных, иногда называют сохраняемости, позволяет элементу управления для записи значения его свойств в постоянное хранилище. Затем элементы управления можно воссоздать путем считывания состояния объекта из хранилища.

Обратите внимание на то, что элемент управления не несет ответственности за получение доступа к среде хранения. Вместо этого контейнера элемента управления отвечает за предоставление управления носителя для использования в нужное время. Дополнительные сведения о сериализации см. в статье [элементы ActiveX в MFC: сериализация](../mfc/mfc-activex-controls-serializing.md). Сведения об оптимизации сериализации см. в разделе [оптимизация постоянства и инициализации](../mfc/optimizing-persistence-and-initialization.md) в элементах управления ActiveX: оптимизации.

##  <a name="_core_installing_activex_control_classes_and_tools"></a> Установка классы элементов управления ActiveX и инструментов

При установке Visual C++, MFC ActiveX управлять классов или в розничной торговле и отладка элемента управления ActiveX, библиотек DLL среды выполнения устанавливаются автоматически в том случае, если выбранные элементы управления ActiveX в программу установки (они выбираются по умолчанию).

По умолчанию классы элементов управления ActiveX и средства устанавливаются в следующие подкаталоги по \Program Files\Microsoft Visual Studio .NET:

- **\Common7\Tools**

   Содержит файлы тестового контейнера (TstCon32.exe, а также файлы справки).

- **\Vc7\atlmfc\include**

   Содержит включаемые файлы, необходимые для разработки элементов управления ActiveX MFC

- **\Vc7\atlmfc\src\mfc**

   Содержит исходный код для конкретных классов элементов управления ActiveX в MFC

- **\Vc7\atlmfc\lib**

   Содержит библиотеки, необходимые для разработки элементов управления ActiveX MFC

Кроме того, существуют также примеры для элементов управления ActiveX в MFC. Дополнительные сведения об этих образцах см. в разделе [Примеры элементов управления: элементы управления ActiveX MFC-Based](../visual-cpp-samples.md)

## <a name="see-also"></a>См. также

[Элементы пользовательского интерфейса](../mfc/user-interface-elements-mfc.md)
