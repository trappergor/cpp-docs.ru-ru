---
title: Класс Кмфкриббонгаллери
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: 5a723af1e32a7a2e78bfb099680dce3e9b710838
ms.sourcegitcommit: bd7ddc044f9083246614b602ef6a758775313214
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/09/2019
ms.locfileid: "68866212"
---
# <a name="cmfcribbongallery-class"></a>Класс Кмфкриббонгаллери

Реализует коллекции лент в стиле Office 2007.
Дополнительные сведения см. в исходном коде, расположенном в папке **VC\\atlmfc\\src\\mfc** каталога установки Visual Studio.

## <a name="syntax"></a>Синтаксис

```
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кмфкриббонгаллери:: Кмфкриббонгаллери](#cmfcribbongallery)|Создает и инициализирует объект `CMFCRibbonGallery`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кмфкриббонгаллери:: AddGroup](#addgroup)|Добавляет новую группу в коллекцию.|
|[Кмфкриббонгаллери:: Аддсубитем](#addsubitem)|Добавляет новый пункт меню в раскрывающееся меню.|
|[Кмфкриббонгаллери:: Clear](#clear)|Очищает содержимое коллекции.|
|[Кмфкриббонгаллери:: Енаблеменуресизе](#enablemenuresize)|Включает или отключает изменение размера панели меню.|
|[Кмфкриббонгаллери:: Енаблеменусидебар](#enablemenusidebar)|Включает или отключает боковую панель слева от всплывающего меню.|
|[Кмфкриббонгаллери:: Жеткомпактсизе](#getcompactsize)|(Переопределяет [CMFCRibbonButton:: жеткомпактсизе](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize).)|
|[Кмфкриббонгаллери:: Жетдроппеддовн](#getdroppeddown)|(Переопределяет [метод CMFCRibbonBaseElement:: жетдроппеддовн](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown).)|
|[Кмфкриббонгаллери:: Жетграупнаме](#getgroupname)|Возвращает имя группы, расположенной по указанному индексу.|
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||
|[Кмфкриббонгаллери:: Жетиконсинров](#geticonsinrow)|Возвращает число элементов в строке коллекции лент.|
|[Кмфкриббонгаллери:: Жетитемтултип](#getitemtooltip)|Возвращает текст подсказки, связанный с элементом в коллекции.|
|[Кмфкриббонгаллери:: Жетластселектедитем](#getlastselecteditem)|Возвращает индекс последнего элемента в коллекции, выбранного пользователем.|
|[Кмфкриббонгаллери:: Жетпалеттеид](#getpaletteid)|Возвращает идентификатор текущей коллекции.|
|[Кмфкриббонгаллери:: Жетрегуларсизе](#getregularsize)|(Переопределяет [CMFCRibbonButton:: жетрегуларсизе](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize).)|
|[Кмфкриббонгаллери:: Жетселектедитем](#getselecteditem)||
|[Кмфкриббонгаллери:: Хасмену](#hasmenu)|(Переопределяет [CMFCRibbonButton:: хасмену](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu).)|
|[Кмфкриббонгаллери:: Исбуттонмоде](#isbuttonmode)|Указывает, содержится ли коллекция в кнопке коллекции.|
|[Кмфкриббонгаллери:: Исменуресизинаблед](#ismenuresizeenabled)|Указывает, включена или отключена возможность изменения размера меню.|
|[Кмфкриббонгаллери:: Исменуресизевертикал](#ismenuresizevertical)||
|[Кмфкриббонгаллери:: Исменусидебар](#ismenusidebar)|Указывает, включена ли боковая панель.|
|[Кмфкриббонгаллери:: Онафтерчанжерект](#onafterchangerect)|(Переопределяет `CMFCRibbonButton::OnAfterChangeRect`.)|
|[Кмфкриббонгаллери:: OnDraw](#ondraw)|(Переопределяет [CMFCRibbonButton:: OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw).)|
|[Кмфкриббонгаллери:: OnEnable](#onenable)|(Переопределяет `CMFCRibbonBaseElement::OnEnable`.)|
|[Кмфкриббонгаллери:: Онртлчанжед](#onrtlchanged)|(Переопределяет [метод CMFCRibbonBaseElement:: онртлчанжед](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged).)|
|[Кмфкриббонгаллери:: Редравиконс](#redrawicons)|Перерисовывает галерею.|
|[Кмфкриббонгаллери:: Ремовеитемтултипс](#removeitemtooltips)|Удаляет подсказки из всех элементов коллекции.|
|[Кмфкриббонгаллери:: Селектитем](#selectitem)||
|[Кмфкриббонгаллери:: Сетаккдата](#setaccdata)|(Переопределяет [CMFCRibbonButton:: сетаккдата](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata).)|
|[Кмфкриббонгаллери:: Сетбуттонмоде](#setbuttonmode)|Указывает, следует ли отображать коллекцию лент в виде раскрывающейся кнопки или палитры непосредственно на ленте.|
|[Кмфкриббонгаллери:: Сетграупнаме](#setgroupname)|Задает имя группы.|
|[Кмфкриббонгаллери:: Сетиконсинров](#seticonsinrow)|Определяет количество элементов в строке коллекции.|
|[Кмфкриббонгаллери:: Сетитемтултип](#setitemtooltip)|Задает текст подсказки для элемента в коллекции.|
|[Кмфкриббонгаллери:: Сетпалетте](#setpalette)|Присоединяет палитру к коллекции лент.|
|[Кмфкриббонгаллери:: Сетпалеттеид](#setpaletteid)|Определяет идентификатор команды, который отправляется в сообщении WM_COMMAND при выборе элемента коллекции.|

### <a name="protected-methods"></a>Защищенные методы

|name|Описание|
|----------|-----------------|
|[Кмфкриббонгаллери:: Ондравпалеттеикон](#ondrawpaletteicon)|Вызывается структурой при прорисовке значка галереи.|

## <a name="remarks"></a>Примечания

Кнопка коллекция ведет себя так же, как обычная кнопка меню, за исключением того, что она отображает коллекцию, когда пользователь открывает ее. При выборе элемента в коллекции платформа отправляет сообщение WM_COMMAND вместе с ИДЕНТИФИКАТОРом команды кнопки. При обработке сообщения следует вызвать метод [кмфкриббонгаллери:: жетластселектедитем](#getlastselecteditem) , чтобы определить, какой элемент был выбран из коллекции.

## <a name="example"></a>Пример

В следующем примере показано, как использовать различные методы в `CMFCRibbonGallery` классе для `CMFCRibbonGallery` настройки объекта. В примере показано, как указать количество элементов на строку в коллекции, разрешить изменение размера панели меню, открыть боковую панель слева от всплывающего меню и отобразить коллекцию Ribbon в виде палитры непосредственно на ленте. Этот фрагмент кода входит в состав [примера Draw Client](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)\
└&nbsp;[Метод CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;[Кмфкриббонгаллери](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>Требования

**Заголовок:** афксриббонпалеттегаллери. h

##  <a name="addgroup"></a>Кмфкриббонгаллери:: AddGroup

Добавляет новую группу в коллекцию.

```
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>Параметры

*лпсзграупнаме*<br/>
окне Указывает имя группы.

*уиимажеспалеттересид*<br/>
окне Указывает идентификатор ресурса для списка изображений, который содержит изображения для группы.

*ккспалеттеимаже*<br/>
окне Задает ширину изображения в пикселях.

*имажесграуп*<br/>
окне Ссылка на список изображений, содержащий изображения группы.

*никонснум*<br/>
окне Указывает число значков в группе. Этот параметр должен быть указан только для пользовательских групп (рисуемых владельцем).

### <a name="remarks"></a>Примечания

Можно разделить элементы коллекции ленты на несколько групп, вызвав этот метод. Каждая группа может иметь заголовок.

##  <a name="addsubitem"></a>Кмфкриббонгаллери:: Аддсубитем

Добавляет новый пункт меню в раскрывающееся меню.

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>Параметры

*псубитем*<br/>
окне Указатель на элемент, добавляемый в меню.

*ниндекс*<br/>
окне Указывает отсчитываемый от нуля индекс места вставки элемента.

*бонтоп*<br/>
окне Значение TRUE, чтобы указать, что элемент должен быть вставлен перед коллекцией Ribbon; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Можно объединить всплывающие коллекции с элементами всплывающего меню, вызвав этот метод. Пункты меню можно разместить до или после коллекции.

Чтобы вставить элемент перед коллекцией, установите для *бонтоп* значение true. Задайте для *бонтоп* значение false, чтобы вставить элемент под галереей.

> [!NOTE]
>  Параметр *ниндекс* задает индекс вставки как в верхней части коллекции, так и в нижней части коллекции. Например, если необходимо вставить элемент в одну позицию перед коллекцией, установите для *ниндекс* значение 1, а для *бонтоп* — значение true. Аналогичным образом, если необходимо вставить элемент на одну позицию под галереей, установите для *ниндекс* значение 1, а для *БОНТОП* — значение false.

##  <a name="clear"></a>Кмфкриббонгаллери:: Clear

Очищает содержимое коллекции.

```
virtual void Clear();
```

### <a name="remarks"></a>Примечания

Вызовите этот метод, чтобы удалить все содержимое из коллекции лент. Это необходимо сделать до присоединения новой коллекции лент или набора групп к коллекции лент.

##  <a name="cmfcribbongallery"></a>Кмфкриббонгаллери:: Кмфкриббонгаллери

Создает и инициализирует объект [кмфкриббонгаллери](../../mfc/reference/cmfcribbongallery-class.md) .

```
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Указывает идентификатор команды, выполняемой при нажатии пользователем кнопки.

*lpszText*<br/>
Задает текст, отображаемый на кнопке.

*нсмаллимажеиндекс*<br/>
Отсчитываемый от нуля индекс мелкого изображения, отображаемого на кнопке.

*нларжеимажеиндекс*<br/>
Отсчитываемый от нуля индекс крупного изображения, отображаемого на кнопке.

*имажеспалетте*<br/>
Ссылка на объект [кмфктулбаримажес](../../mfc/reference/cmfctoolbarimages-class.md) , содержащий изображения, которые должны отображаться в коллекции.

*уиимажеспалеттересид*<br/>
Идентификатор ресурса списка изображений, отображаемых в коллекции.

*ккспалеттеимаже*<br/>
Задает ширину (в пикселях) изображения в коллекции.

*сизеикон*<br/>
Задает размер изображения коллекции в пикселях.

*никонснум*<br/>
Указывает число значков в коллекции.

*бдефаултбуттонстиле*<br/>
Указывает, следует ли использовать стиль кнопки по умолчанию или рисуемый владельцем.

### <a name="remarks"></a>Примечания

##  <a name="enablemenuresize"></a>Кмфкриббонгаллери:: Енаблеменуресизе

Включает или отключает изменение размера панели меню.

```
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
окне Значение TRUE, чтобы разрешить изменение размера меню; в противном случае — значение FALSE.

*бверткалонли*<br/>
окне Значение TRUE, чтобы указать, что размер коллекции можно изменять только по вертикали; Значение FALSE, чтобы указать, что размер коллекции можно изменить как по вертикали, так и по горизонтали.

### <a name="remarks"></a>Примечания

Этот метод используется для включения или отключения изменения размера коллекции лент. Если изменение размера включено, в коллекции лент отображается область захвата, которую пользователь может использовать для изменения его размера.

##  <a name="enablemenusidebar"></a>Кмфкриббонгаллери:: Енаблеменусидебар

Включает или отключает боковую панель слева от всплывающего меню.

```
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
окне Значение TRUE, чтобы указать, что боковая панель включена; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Вызовите этот метод, чтобы включить или отключить боковую панель в стиле Office XP в левой части меню.

##  <a name="getcompactsize"></a>Кмфкриббонгаллери:: Жеткомпактсизе

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="getdroppeddown"></a>Кмфкриббонгаллери:: Жетдроппеддовн

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="getgroupname"></a>Кмфкриббонгаллери:: Жетграупнаме

Возвращает имя группы, расположенной по указанному индексу.

```
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>Параметры

*нграупиндекс*<br/>
окне Указывает отсчитываемый от нуля индекс для группы, имя которой необходимо получить.

### <a name="return-value"></a>Возвращаемое значение

Имя группы, расположенной по указанному индексу. Передача недопустимого индекса приведет к неудачному утверждению.

### <a name="remarks"></a>Примечания

##  <a name="getgroupoffset"></a>Кмфкриббонгаллери:: Жетграупоффсет

```
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="geticonsinrow"></a>Кмфкриббонгаллери:: Жетиконсинров

Возвращает число элементов в строке коллекции лент.

```
int GetIconsInRow() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число элементов в строке.

### <a name="remarks"></a>Примечания

##  <a name="getitemtooltip"></a>Кмфкриббонгаллери:: Жетитемтултип

Возвращает текст подсказки, связанный с элементом в коллекции.

```
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>Параметры

*нитеминдекс*<br/>
окне Указывает отсчитываемый от нуля индекс элемента, для которого требуется получить текст подсказки.

### <a name="return-value"></a>Возвращаемое значение

Указатель на строку подсказки, назначенную элементу в коллекции лент. Может иметь значение NULL, если этому элементу не назначена подсказка.

### <a name="remarks"></a>Примечания

##  <a name="getlastselecteditem"></a>Кмфкриббонгаллери:: Жетластселектедитем

Возвращает индекс последнего элемента в коллекции ленты, выбранного пользователем.

```
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>Параметры

*уикмдид*<br/>
окне Указывает идентификатор команды для пункта меню, который открыл коллекцию лент.

### <a name="return-value"></a>Возвращаемое значение

Когда пользователь выбирает любой элемент в коллекции лент, Библиотека отправляет сообщение WM_COMMAND вместе с ИДЕНТИФИКАТОРом команды кнопки меню, открывшей коллекцию лент.

### <a name="remarks"></a>Примечания

##  <a name="getpaletteid"></a>Кмфкриббонгаллери:: Жетпалеттеид

Возвращает идентификатор команды текущей палитры.

```
int GetPaletteID() const;
```

### <a name="return-value"></a>Возвращаемое значение

Идентификатор команды текущей выбранной палитры.

### <a name="remarks"></a>Примечания

##  <a name="getregularsize"></a>Кмфкриббонгаллери:: Жетрегуларсизе

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="getselecteditem"></a>Кмфкриббонгаллери:: Жетселектедитем

```
int GetSelectedItem() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="hasmenu"></a>Кмфкриббонгаллери:: Хасмену

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="isbuttonmode"></a>Кмфкриббонгаллери:: Исбуттонмоде

Указывает, содержится ли палитра в кнопке коллекции.

```
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если палитра отображается в виде кнопки раскрывающегося меню; Значение FALSE, если палитра отображается непосредственно на ленте.

### <a name="remarks"></a>Примечания

##  <a name="ismenuresizeenabled"></a>Кмфкриббонгаллери:: Исменуресизинаблед

Указывает, включен ли режим изменения размера меню.

```
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если изменение размера меню включено. в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

##  <a name="ismenuresizevertical"></a>Кмфкриббонгаллери:: Исменуресизевертикал

```
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="ismenusidebar"></a>Кмфкриббонгаллери:: Исменусидебар

Указывает, включена ли боковая панель.

```
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если боковая панель стиля Office XP отображается в левой части всплывающего меню; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

##  <a name="onafterchangerect"></a>Кмфкриббонгаллери:: Онафтерчанжерект

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="remarks"></a>Примечания

##  <a name="ondraw"></a>Кмфкриббонгаллери:: OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="remarks"></a>Примечания

##  <a name="ondrawpaletteicon"></a>Кмфкриббонгаллери:: Ондравпалеттеикон

Вызывается структурой при прорисовке значка галереи.

```
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
окне Указатель на контекст устройства, используемый для рисования.

*ректикон*<br/>
окне Задает ограничивающий прямоугольник значка для рисования.

*никониндекс*<br/>
окне Указывает отсчитываемый от нуля индекс в списке изображений значков коллекции значка для рисования.

*пикон*<br/>
окне Указатель на рисуемый значок.

*клртекст*<br/>
окне Задает цвет текста элемента для рисования.

### <a name="remarks"></a>Примечания

Этот метод можно переопределить в производном классе, чтобы настроить внешний вид коллекции Ribbon.

##  <a name="onenable"></a>Кмфкриббонгаллери:: OnEnable

```
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>Параметры

окне *бенабле*<br/>

### <a name="remarks"></a>Примечания

##  <a name="onrtlchanged"></a>Кмфкриббонгаллери:: Онртлчанжед

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>Параметры

окне *бисртл*<br/>

### <a name="remarks"></a>Примечания

##  <a name="redrawicons"></a>Кмфкриббонгаллери:: Редравиконс

Перерисовывает галерею.

```
void RedrawIcons();
```

### <a name="remarks"></a>Примечания

Вызовите эту функцию для перерисовки коллекции. Этот метод следует вызывать, если содержимое коллекции было изменено во время выполнения.

##  <a name="removeitemtooltips"></a>Кмфкриббонгаллери:: Ремовеитемтултипс

Удаляет подсказки из всех элементов коллекции.

```
void RemoveItemToolTips();
```

### <a name="remarks"></a>Примечания

##  <a name="selectitem"></a>Кмфкриббонгаллери:: Селектитем

```
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>Параметры

окне *нитеминдекс*<br/>

### <a name="remarks"></a>Примечания

##  <a name="setaccdata"></a>Кмфкриббонгаллери:: Сетаккдата

Заполняет указанный объект `CAccessibilityData` , используя данные специальных возможностей из галереи ленты.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Параметры

*ппарент*<br/>
окне Родительское окно в окне коллекции лент.

*data*<br/>
заполняет `CAccessibilityData` Объект, который получает данные о специальных возможностях из коллекции лент.

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

Значение TRUE, если метод успешно выполнен; в противном случае — значение FALSE.

##  <a name="setbuttonmode"></a>Кмфкриббонгаллери:: Сетбуттонмоде

Определяет, отображать ли коллекцию лент как раскрывающиеся кнопки или как палитру непосредственно на ленте.

```
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Параметры

*Управляемое bSet*<br/>
окне Значение TRUE, если коллекция Ribbon отображается в виде раскрывающегося меню. Значение FALSE, чтобы отобразить содержимое коллекции ленты непосредственно на ленте.

### <a name="remarks"></a>Примечания

##  <a name="setgroupname"></a>Кмфкриббонгаллери:: Сетграупнаме

Задает имя группы.

```
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>Параметры

*нграупиндекс*<br/>
окне Указывает отсчитываемый от нуля индекс для группы, для которой изменяется имя.

*лпсзграупнаме*<br/>
окне Указывает новое имя для группы.

### <a name="remarks"></a>Примечания

Группа, имя которой изменяется, должна быть добавлена с помощью метода [кмфкриббонгаллери:: addgroup](#addgroup) .

##  <a name="seticonsinrow"></a>Кмфкриббонгаллери:: Сетиконсинров

Указывает количество элементов в строке коллекции.

```
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>Параметры

*никонсинров*<br/>
окне Указывает количество элементов, отображаемых в каждой строке коллекции.

### <a name="remarks"></a>Примечания

Используйте этот метод, чтобы указать ширину коллекции лент.

##  <a name="setitemtooltip"></a>Кмфкриббонгаллери:: Сетитемтултип

Задает текст подсказки для элемента в коллекции.

```
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>Параметры

*нитеминдекс*<br/>
окне Отсчитываемый от нуля индекс элемента Palette, с которым необходимо связать подсказку.

*лпсзтултип*<br/>
окне Текст, отображаемый в подсказке.

### <a name="remarks"></a>Примечания

##  <a name="setpalette"></a>Кмфкриббонгаллери:: Сетпалетте

Присоединяет палитру к коллекции лент.

```
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>Параметры

*имажеспалетте*<br/>
окне Указывает список изображений, содержащий значки, которые будут отображаться в коллекции.

*уиимажеспалеттересид*<br/>
окне Указывает идентификатор ресурса для списка изображений, который содержит значки, отображаемые в коллекции.

*ккспалеттеимаже*<br/>
окне Задает ширину (в пикселях) изображения в коллекции.

### <a name="remarks"></a>Примечания

##  <a name="setpaletteid"></a>Кмфкриббонгаллери:: Сетпалеттеид

Определяет идентификатор команды, который отправляется в сообщении WM_COMMAND, когда пользователь выбирает элемент коллекции.

```
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
окне Указывает идентификатор команды, который отправляется в сообщении WM_COMMAND, когда пользователь выбирает элемент коллекции.

### <a name="remarks"></a>Примечания

Чтобы определить конкретный элемент, выбранный пользователем из коллекции, вызовите статический метод [кмфкриббонгаллери:: жетластселектедитем](#getlastselecteditem) .

## <a name="see-also"></a>См. также

[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Классы](../../mfc/reference/mfc-classes.md)<br/>
[Класс CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[Класс CMFCRibbonGalleryMenuButton](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
