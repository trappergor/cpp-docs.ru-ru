---
title: Класс CRichEditCtrl
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 1c601d036d05048bff9b60f837140e8f7a873964
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754429"
---
# <a name="cricheditctrl-class"></a>Класс CRichEditCtrl

Предоставляет функции элемента управления форматированным редактированием.

## <a name="syntax"></a>Синтаксис

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CrichEditCtrl:CrichEditCtrl](#cricheditctrl)|Формирует объект `CRichEditCtrl`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[CRichEditCtrl:CanPaste](#canpaste)|Определяет, можно ли ввести содержимое Clipboard в этот богатый элемент управления правки.|
|[CrichEditCtrl::CanRedo](#canredo)|Определяет, есть ли какие-либо действия в очереди повтора управления.|
|[CrichEditCtrl::CanUndo](#canundo)|Определяет, может ли операция редактирования быть отменена.|
|[CrichEditCtrl:CharFromPos](#charfrompos)|Извлекает информацию о персонаже, близком к указанной точке в области управления редактирования клиента.|
|[CrichEditCtrl::Ясно](#clear)|Очищает текущее выделение.|
|[CrichEditCtrl:Copy](#copy)|Копирует текущий выбор в Clipboard.|
|[CrichEditCtrl::Создание](#create)|Создает управление с богатым элементом управления `CRichEditCtrl` дейтевом Windows и связывает его с этим объектом.|
|[CrichEditCtrl:CreateEx](#createex)|Создает управление с богатым элементами управления windows с указанными расширенными стилями Windows и связывает его с этим `CRichEditCtrl` объектом.|
|[CrichEditCtrl:Cut](#cut)|Сокращает текущий выбор в Clipboard.|
|[CRichEditCtrl::DisplayBand](#displayband)|Отображает часть содержимого этого `CRichEditCtrl` объекта.|
|[CrichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|Сброс (очищает) отменить флаг `CRichEditCtrl` этого объекта.|
|[CrichEditCtrl:FindText](#findtext)|Находит текст внутри `CRichEditCtrl` этого объекта.|
|[CrichEditCtrl:FindWordBreak](#findwordbreak)|Находит следующий разрыв слова до или после указанного положения символа или получает информацию о персонаже в этом положении.|
|[CrichEditCtrl:ФорматРандж](#formatrange)|Форматирует диапазон текста для целевого устройства вывода.|
|[CrichEditCtrl:GetCharPos](#getcharpos)|Определяет местоположение данного символа `CRichEditCtrl` в пределах этого объекта.|
|[CrichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|Извлекает текущие атрибуты форматирования `CRichEditCtrl` символов по умолчанию в этом объекте.|
|[CrichEditCtrl:GetEventMask](#geteventmask)|Извлекает маску события `CRichEditCtrl` для этого объекта.|
|[CrichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|Определяет наиболее видимую `CRichEditCtrl` линию в этом объекте.|
|[CrichEditCtrl:GetIRichEditole](#getiricheditole)|Извлекает указатель на `IRichEditOle` интерфейс для этого богатого управления речт.|
|[CrichEditCtrl:GetLimitText](#getlimittext)|Получает ограничение на количество текста, в которое пользователь может войти в этот `CRichEditCtrl` объект.|
|[CrichEditCtrl:GetLine](#getline)|Извлекает строку текста `CRichEditCtrl` с этого объекта.|
|[CrichEditCtrl:GetLineCount](#getlinecount)|Извлекает количество строк в `CRichEditCtrl` этом объекте.|
|[CrichEditCtrl:GetModify](#getmodify)|Определяет, изменилось ли `CRichEditCtrl` содержимое этого объекта после последнего сохранения.|
|[CrichEditCtrl:GetOptions](#getoptions)|Получает богатые параметры управления реитрием.|
|[CrichEditCtrl:GetParaFormat](#getparaformat)|Извлекает атрибуты форматирования параграфа в `CRichEditCtrl` текущем выборе в этом объекте.|
|[CrichEditCtrl:GetPunctuation](#getpunctuation)|Извлекает текущие знаки знаков препинания для управления богатым редактированием. Это сообщение доступно только в версиях операционной системы на азиатском языке.|
|[CRichEditCtrl:GetRect](#getrect)|Извлекает прямоугольник форматирования `CRichEditCtrl` для этого объекта.|
|[CrichEditCtrl::GetRedoName](#getredoname)|Извлекает тип следующего действия, если таковое, в очереди повтора элемента управления.|
|[CrichEditCtrl:GetSel](#getsel)|Получает начальные и заканчивающиеся `CRichEditCtrl` позиции текущего выбора в этом объекте.|
|[CrichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|Извлекает атрибуты форматирования символов в `CRichEditCtrl` текущем выделении в этом объекте.|
|[CRichEditCtrl:GetSelectionType](#getselectiontype)|Извлекает тип содержимого в текущем `CRichEditCtrl` выборе в этом объекте.|
|[CrichEditCtrl:GetSelText](#getseltext)|Получает текст текущего выбора `CRichEditCtrl` в этом объекте|
|[CrichEditCtrl:GetTextДлина](#gettextlength)|Извлекает длину текста, в символах, `CRichEditCtrl` в этом объекте. Не включает в себя прекращение нулевого характера.|
|[CrichEditCtrl::GetTextLengthEx](#gettextlengthex)|Извлекает количество символов или байтов в богатом представлении редактирования. Принимает список флагов, чтобы указать метод определения длины текста в богатом элементауправления редактирования|
|[CrichEditCtrl:GetTextMode](#gettextmode)|Извлекает текущий текстовый режим и отменяет уровень богатого управления редактированием.|
|[CrichEditCtrl:GetTextRange](#gettextrange)|Извлекает указанный диапазон текста.|
|[CrichEditCtrl::GetUndoName](#getundoname)|Извлекает тип следующего действия отменить, если таковые имеется.|
|[CrichEditCtrl:GetWordWrapMode](#getwordwrapmode)|Извлекает текущее слово упаковка и слово нарушение вариантов для богатых управления ревертритом. Это сообщение доступно только в версиях операционной системы на азиатском языке.|
|[CrichEditCtrl:HideSelection](#hideselection)|Показывает или скрывает текущий выбор.|
|[CrichEditCtrl::LimitText](#limittext)|Ограничивает количество текста, в которое `CRichEditCtrl` пользователь может ввести объект.|
|[CrichEditCtrl:LineFromChar](#linefromchar)|Определяет, какая строка содержит данный символ.|
|[CrichEditCtrl:LineIndex](#lineindex)|Извлекает индекс символов данной `CRichEditCtrl` строки в этом объекте.|
|[CrichEditCtrl:LineLength](#linelength)|Извлекает длину заданной линии в этом `CRichEditCtrl` объекте.|
|[CrichEditCtrl:LineScroll](#linescroll)|Прокрутки текста `CRichEditCtrl` в этом объекте.|
|[CRichEditCtrl::Paste](#paste)|Вставляет содержимое Clipboard в этот богатый элемент управления правки.|
|[CRichEditCtrl::PasteSpecial](#pastespecial)|Вставляет содержимое Clipboard в этот богатый элемент управления правки в указанном формате данных.|
|[CrichEditCtrl::PosFromChar](#posfromchar)|Извлекает координаты области клиента указанного символа в элементуправления редактирования.|
|[CrichEditCtrl:Redo](#redo)|Повторное действие в очереди повторов элемента управления.|
|[CrichEditCtrl:ReplaceSel](#replacesel)|Заменяет текущий выбор `CRichEditCtrl` в этом объекте на указанный текст.|
|[CrichEditCtrl:RequestResize](#requestresize)|Принуждает `CRichEditCtrl` этот объект отправлять уведомления о повторном размере запроса.|
|[CrichEditCtrl:SetAutoURLDetect](#setautourldetect)|Указывает, активен ли автоматическое обнаружение URL-адреса в богатом элементаре управления.|
|[CrichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|Устанавливает цвет фона `CRichEditCtrl` в этом объекте.|
|[CrichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|Устанавливает текущие атрибуты форматирования `CRichEditCtrl` символов по умолчанию в этом объекте.|
|[CrichEditCtrl::SetEventМаск](#seteventmask)|Устанавливает маску события `CRichEditCtrl` для этого объекта.|
|[CrichEditCtrl::Установка](#setmodify)|Устанавливает или очищает флаг модификации для этого `CRichEditCtrl` объекта.|
|[CrichEditCtrl:SetOLECallback](#setolecallback)|Устанавливает `IRichEditOleCallback` объект COM для этого богатого управления редемикатором.|
|[CrichEditCtrl:SetOptions](#setoptions)|Устанавливает параметры для `CRichEditCtrl` этого объекта.|
|[CrichEditCtrl:SetParaFormat](#setparaformat)|Устанавливает атрибуты форматирования параграфа в `CRichEditCtrl` текущем выборе в этом объекте.|
|[CrichEditCtrl:SetPunctuation](#setpunctuation)|Устанавливает знаки препинания для управления богатым редактированием. Это сообщение доступно только в версиях операционной системы на азиатском языке.|
|[CrichEditCtrl:SetOnly](#setreadonly)|Устанавливает опцию только для `CRichEditCtrl` чтения для этого объекта.|
|[CRichEditCtrl:SetRect](#setrect)|Устанавливает прямоугольник форматирования `CRichEditCtrl` для этого объекта.|
|[CrichEditCtrl:Set](#setsel)|Устанавливает выделение `CRichEditCtrl` в этом объекте.|
|[CrichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|Устанавливает атрибуты форматирования символов в `CRichEditCtrl` текущем выделении в этом объекте.|
|[CrichEditCtrl:SetTargetDevice](#settargetdevice)|Устанавливает целевое устройство `CRichEditCtrl` вывода для этого объекта.|
|[CrichEditCtrl:SetTextMode](#settextmode)|Устанавливает текстовый режим или отменить уровень богатого управления редактированием. Сообщение выходит из строя, если элемент управления содержит текст.|
|[CrichEditCtrl:SetUndoLimit](#setundolimit)|Устанавливает максимальное количество действий, которые могут храниться в очереди отменить.|
|[CrichEditCtrl::SetWordCharFormat](#setwordcharformat)|Устанавливает атрибуты форматирования символов в `CRichEditCtrl` текущем слове в этом объекте.|
|[CrichEditCtrl:SetWordWrapMode](#setwordwrapmode)|Устанавливает параметры обертывания слов и разрыва слов для управления богатым истечением. Это сообщение доступно только в версиях операционной системы на азиатском языке.|
|[CrichEditCtrl:StopGroupTyping](#stopgrouptyping)|Останавливает элемент управления от сбора дополнительных действий ввода в текущее действие отменить. Элемент управления хранит следующее действие ввода, если таковой имеется, в новое действие в очереди отменить.|
|[CrichEditCtrl:StreamIn](#streamin)|Вставляет текст из вхотоза в этот `CRichEditCtrl` объект.|
|[CrichEditCtrl::StreamOut](#streamout)|Хранит текст `CRichEditCtrl` с этого объекта в выходной поток.|
|[CrichEditCtrl::Undo](#undo)|Обратный последнюю операцию редактирования.|

## <a name="remarks"></a>Remarks

"Богатый элемент управления редактированием" — это окно, в котором пользователь может вводить и отстранять текст. Текст может быть назначен символ и форматирование абзацев, и может включать встроенные объекты OLE. Управление богатым редактированием обеспечивает интерфейс программирования для форматирования текста. Однако приложение должно реализовать все компоненты пользовательского интерфейса, необходимые для того, чтобы операции форматирования были доступны пользователю.

Этот общий элемент управления `CRichEditCtrl` Windows (и, следовательно, класс) доступен только для программ, работающих под Windows 95/98 и Windows NT версии 3.51 и позже. Класс `CRichEditCtrl` поддерживает версии 2.0 и 3.0 управления с богатым исправления Windows SDK.

> [!CAUTION]
> Если вы используете богатый элемент управления правкой в диалоговом поле (независимо от того, является ли ваше приложение SDI, MDI или диалоговой основе), вы должны позвонить [в AfxInitRichEdit](application-information-and-management.md#afxinitrichedit) один раз, прежде чем диалоговая будка отображается. Типичное место для вызова этой функции `InitInstance` находится в функции участника программы. Вам не нужно называть его для каждого показа диалогового окна, только в первый раз. Вам не нужно `AfxInitRichEdit` звонить, если `CRichEditView`вы работаете с .

Для получения дополнительной `CRichEditCtrl`информации об использовании см.:

- [Элементы управления](../../mfc/controls-mfc.md)

- [Использование CRichEditCtrl](../../mfc/using-cricheditctrl.md)

Например, с помощью богатого элемента управления метрикой в приложении MFC можно ознакомиться с примером приложения [WORDPAD.](../../overview/visual-cpp-samples.md)

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>Требования

**Заголовок:** afxcmn.h

## <a name="cricheditctrlcanpaste"></a><a name="canpaste"></a>CRichEditCtrl:CanPaste

Определяет, может ли богатый элемент управления правки вставить указанный формат Clipboard.

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>Параметры

*nФормат*<br/>
Формат данных Clipboard для запроса. Этот параметр может быть одним из предопределенных форматов Clipboard или значением, возвращенным [RegisterClipboardFormat.](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если формат Clipboard может быть вставлен; в противном случае 0.

### <a name="remarks"></a>Remarks

Если *nFormat* 0, `CanPaste` попробует любой формат в настоящее время на Clipboard.

Для получения дополнительной информации смотрите [EM_CANPASTE](/windows/win32/Controls/em-canpaste) сообщение и функцию [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

## <a name="cricheditctrlcanredo"></a><a name="canredo"></a>CrichEditCtrl::CanRedo

Определяет, содержит ли очередь повтора какие-либо действия.

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если очередь повтора содержит действия, в противном случае 0.

### <a name="remarks"></a>Remarks

Чтобы узнать название операции в очереди повторов, позвоните [cRichEditCtrl::GetRedoName](#getredoname). Чтобы переделать самую недавнюю операцию Отменить, позвоните [в Redo](#redo).

Для получения дополнительной информации см. [EM_CANREDO](/windows/win32/Controls/em-canredo) в Windows SDK.

## <a name="cricheditctrlcanundo"></a><a name="canundo"></a>CrichEditCtrl::CanUndo

Определяет, может ли последняя операция редактирования быть отменена.

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если последняя операция по правлению может быть отменена вызовом к [функции отменить функцию отменить;](#undo) 0, если это не может быть отменено.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации смотрите [EM_CANUNDO](/windows/win32/Controls/em-canundo) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

## <a name="cricheditctrlcharfrompos"></a><a name="charfrompos"></a>CrichEditCtrl:CharFromPos

Извлекает информацию о персонаже в точке, указанной параметром *pt.*

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>Параметры

*пт*<br/>
Объект [CPoint,](../../atl-mfc-shared/reference/cpoint-class.md) содержащий координаты указанной точки.

### <a name="return-value"></a>Возвращаемое значение

Индекс символов на нулевой основе символа, ближайшего к указанной точке. Если указанная точка находится за пределами последнего символа в элементе управления, значение возврата указывает последний символ в элементе управления.

### <a name="remarks"></a>Remarks

Эта функция элемента работает с богатым элементом управления реитриетом. Чтобы получить информацию для управления рекретом, позвоните [cEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos).

Для получения дополнительной информации смотрите [EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos) в SDK Windows.

## <a name="cricheditctrlclear"></a><a name="clear"></a>CrichEditCtrl::Ясно

Удаляет (очищает) текущий выбор (если таковые) в управлении богатым истов.

```cpp
void Clear();
```

### <a name="remarks"></a>Remarks

Удаление, выполняемые `Clear` может быть отменено, позвонив в функцию участника [Undo.](#undo)

Чтобы удалить текущий выбор и поместить удаленное содержимое на Clipboard, позвоните в функцию участника [Cut.](#cut)

Для получения дополнительной информации смотрите [WM_CLEAR](/windows/win32/dataxchg/wm-clear) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

## <a name="cricheditctrlcopy"></a><a name="copy"></a>CrichEditCtrl:Copy

Копирует текущий выбор (если таковой имеется) в богатом элемента управления для редектовного управления в Clipboard.

```cpp
void Copy();
```

### <a name="remarks"></a>Remarks

Для получения дополнительной информации см. [WM_COPY](/windows/win32/dataxchg/wm-copy) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

## <a name="cricheditctrlcreate"></a><a name="create"></a>CrichEditCtrl::Создание

Создает управление с богатым элементом управления `CRichEditCtrl` дейтевом Windows и связывает его с этим объектом.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*dwStyle*<br/>
Определяет стиль управления изменением. Примените комбинацию стилей окон, перечисленных в разделе **Remarks** ниже, и [отсвадайте стили управления,](/windows/win32/Controls/edit-control-styles)описанные в SDK Windows.

*rect*<br/>
Определяет размер и положение элемента управления отсечения. Может быть объект [CRect](../../atl-mfc-shared/reference/crect-class.md) или структура [RECT.](/windows/win32/api/windef/ns-windef-rect)

*pParentWnd*<br/>
Определяет родительское окно элемента управления (часто [CDialog).](../../mfc/reference/cdialog-class.md) Она не должна быть NULL.

*nID*<br/>
Упоняет идентификатор элемента управления элемента мисеи.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если инициализация является успешной; в противном случае, 0.

### <a name="remarks"></a>Remarks

Вы строите `CRichEditCtrl` объект в два этапа. Сначала позвоните в конструктор [CRichEditCtrl,](#cricheditctrl) затем позвоните, `Create`который создает управление `CRichEditCtrl` отсеивателяМи Windows и прикрепляет его к объекту.

При создании богатого элемента управления элементами управления с помощью этой функции сначала необходимо загрузить необходимую общую библиотеку управления. Чтобы загрузить библиотеку, позвоните в глобальную функцию [AfxInitRichEdit,](application-information-and-management.md#afxinitrichedit)которая, в свою очередь, инициализирует общую библиотеку управления. Вы должны `AfxInitRichEdit` позвонить только один раз в процессе.

При `Create` выполнении Windows отправляет [WM_NCCREATE,](../../mfc/reference/cwnd-class.md#onnccreate) [WM_NCCALCSIZE,](../../mfc/reference/cwnd-class.md#onnccalcsize) [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)и [WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) сообщения в управление отсеиваем.

Эти сообщения обрабатываются по умолчанию [onNcCreate,](../../mfc/reference/cwnd-class.md#onnccreate) [OnNcCalcSize,](../../mfc/reference/cwnd-class.md#onnccalcsize) [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)и [OnGetMinMaxInfo,](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) функционируют участники базового `CWnd` класса. Чтобы расширить обработку сообщений по `CRichEditCtrl`умолчанию, вывемите класс из, добавьте карту сообщений в новый класс и переизбавьте вышеуказанные функции обработчика сообщений. Переопределить, `OnCreate`например, для выполнения необходимой инициализации для нового класса.

Примените следующие [стили окна](../../mfc/reference/styles-used-by-mfc.md#window-styles) для управления отсеивание.

- WS_CHILD всегда.

- WS_VISIBLE обычно.

- WS_DISABLED редко.

- WS_GROUP к управлению группой.

- WS_TABSTOP Включить элементуправления в порядок внесения табулентизмов.

Для получения дополнительной информации [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) о стилях окон см.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

## <a name="cricheditctrlcreateex"></a><a name="createex"></a>CrichEditCtrl:CreateEx

Создает элемент управления (детское окно) и `CRichEditCtrl` связывает его с объектом.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*dwExStyle*<br/>
Определяет расширенный стиль создаваемого элемента управления. Список расширенных стилей Windows можно узнать [в](/windows/win32/api/winuser/nf-winuser-createwindowexw) *SDK* Windows см.

*dwStyle*<br/>
Определяет стиль управления изменением. Примените комбинацию стилей окон, перечисленных в разделе **Remarks** [Create](#create) and [edit control styles,](/windows/win32/Controls/edit-control-styles)описанном в SDK Windows.

*rect*<br/>
Ссылка на структуру [RECT,](/windows/win32/api/windef/ns-windef-rect) описывающую размер и положение создаваемого окна, в клиентских координатах *pParentWnd*.

*pParentWnd*<br/>
Указатель на окно, которое является родителем элемента управления.

*nID*<br/>
Идентификатор окна ребенка элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Используйте `CreateEx` `Create` вместо того, чтобы применять расширенные стили Windows, указанные в предисловии расширенного стиля Windows **WS_EX_.**

## <a name="cricheditctrlcricheditctrl"></a><a name="cricheditctrl"></a>CrichEditCtrl:CrichEditCtrl

Формирует объект `CRichEditCtrl`.

```
CRichEditCtrl();
```

### <a name="remarks"></a>Remarks

Используйте [Create](#create) для создания управления с богатыми обновлениями Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

## <a name="cricheditctrlcut"></a><a name="cut"></a>CrichEditCtrl:Cut

Удалить (вырезает) текущий выбор (если таковой имеется) в богатом элементе управления редактированием и копирует удаленный текст в Clipboard.

```cpp
void Cut();
```

### <a name="remarks"></a>Remarks

Удаление, выполняемые `Cut` может быть отменено, позвонив в функцию участника [Undo.](#undo)

Чтобы удалить текущий выбор без размещения удаленного текста в Clipboard, позвоните в функцию [участника Clear.](#clear)

Для получения дополнительной информации см. [WM_CUT](/windows/win32/dataxchg/wm-cut) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

## <a name="cricheditctrldisplayband"></a><a name="displayband"></a>CRichEditCtrl::DisplayBand

Отображает часть содержимого богатого элемента редактирования (текст и элементы OLE), как ранее отформатировано [FormatRange](#formatrange).

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>Параметры

*pDisplayRect*<br/>
Указатель на объект [RECT](/windows/win32/api/windef/ns-windef-rect) или [CRect,](../../atl-mfc-shared/reference/crect-class.md) определяющий область устройства для отображения текста.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если отображение отформатированный текст удается, в противном случае, 0.

### <a name="remarks"></a>Remarks

Элементы текста и OLE обрезаются в область, указанную указателем *pDisplayRect.*

Для получения дополнительной информации см. [EM_DISPLAYBAND](/windows/win32/Controls/em-displayband) в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [CRichEditCtrl::FormatRange](#formatrange).

## <a name="cricheditctrlemptyundobuffer"></a><a name="emptyundobuffer"></a>CrichEditCtrl::EmptyUndoBuffer

Сбрасывает (ясно) отменить флаг этого богатого управления редектовным управлением.

```cpp
void EmptyUndoBuffer();
```

### <a name="remarks"></a>Remarks

Теперь элемент управления не сможет отменить последнюю операцию редактирования. Флаг отменить устанавливается всякий раз, когда операция в рамках управления богатым элементом реверсировки может быть отменена.

Отменить флаг автоматически очищается всякий раз, когда вы звоните функции члена [CWnd](../../mfc/reference/cwnd-class.md) [SetWindowText.](../../mfc/reference/cwnd-class.md#setwindowtext)

Для получения дополнительной информации [EM_EMPTYUNDOBUFFER](/windows/win32/Controls/em-emptyundobuffer) см.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

## <a name="cricheditctrlfindtext"></a><a name="findtext"></a>CrichEditCtrl:FindText

Находит текст в рамках богатого управления редактированием.

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>Параметры

*dwFlags*<br/>
Список возможных значений можно узнать [EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex) в *EM_FINDTEXTEXT* в SDK Windows.

*pFindText*<br/>
Указатель на структуру [FINDTEXTEX,](/windows/win32/api/richedit/ns-richedit-findtextexw) дающий параметры поиска и возвращающийся диапазон, где был найден совпадение.

### <a name="return-value"></a>Возвращаемое значение

Нулевая позиция характера следующего матча; - 1, если больше нет совпадений.

### <a name="remarks"></a>Remarks

Вы можете искать вверх или вниз, установив правильные параметры диапазона `FINDTEXTEX` в структуре [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) внутри структуры.

Для получения дополнительной информации, см [EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex) сообщение и [FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw) структуры в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

## <a name="cricheditctrlfindwordbreak"></a><a name="findwordbreak"></a>CrichEditCtrl:FindWordBreak

Находит следующий разрыв слов до или после позиции, указанной *nStart*.

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>Параметры

*nКод*<br/>
Указывает действие, необходимое для принятия. Список возможных значений можно узнать *code* в EM_FINDWORDBREAK в SDK Windows.

*nСтарт*<br/>
Положение символов с нулевым уровнем, с которого можно начать.

### <a name="return-value"></a>Возвращаемое значение

На основе параметра *nCode*. Для получения дополнительной информации см. [EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak) в Windows SDK.

### <a name="remarks"></a>Remarks

Эту функцию участника можно использовать для получения информации о персонаже в заданном положении.

## <a name="cricheditctrlformatrange"></a><a name="formatrange"></a>CrichEditCtrl:ФорматРандж

Форматирует диапазон текста в богатом элемента управления редактированием для конкретного устройства.

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>Параметры

*Pfr*<br/>
Указатель на структуру [FORMATRANGE,](/windows/win32/api/richedit/ns-richedit-formatrange) содержащую информацию о устройстве вывода. NULL указывает на то, что кэшированная информация в рамках богатого элемента управления правкой может быть освобождена.

*bДисплей*<br/>
Указывает, должен ли быть отображен текст. Если FALSE, текст просто измеряется.

### <a name="return-value"></a>Возвращаемое значение

Индекс последнего персонажа, который вписывается в регион плюс один.

### <a name="remarks"></a>Remarks

Как правило, за этим вызовом следует вызов [На DisplayBand.](#displayband)

Для получения дополнительной информации смотрите [EM_FORMATRANGE](/windows/win32/Controls/em-formatrange) сообщение и [структуру FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

## <a name="cricheditctrlgetcharpos"></a><a name="getcharpos"></a>CrichEditCtrl:GetCharPos

Получает положение (вверху в левом углу) `CRichEditCtrl` данного персонажа в пределах этого объекта.

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>Параметры

*lChar*<br/>
Нулевой индекс персонажа.

### <a name="return-value"></a>Возвращаемое значение

Расположение верхнего левого угла персонажа, указанного *lChar*.

### <a name="remarks"></a>Remarks

Символ определяется путем предоставления значения индекса с нулевым уровнем. Если *lChar* больше индекса последнего символа в этом `CRichEditCtrl` объекте, значение возврата определяет координаты положения `CRichEditCtrl` символа, только мимо последнего символа в этом объекте.

Для получения дополнительной информации см. [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) в Windows SDK.

## <a name="cricheditctrlgetdefaultcharformat"></a><a name="getdefaultcharformat"></a>CrichEditCtrl::GetDefaultCharFormat

Получает атрибуты форматирования символов `CRichEditCtrl` по умолчанию этого объекта.

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии указатель `CHARFORMAT` на структуру, удерживающий атрибуты форматирования символов по умолчанию.

Во второй версии указатель `CHARFORMAT2` на структуру, которая является расширением Rich `CHARFORMAT` Edit 2.0 к структуре, удерживая атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Член `dwMask` данных *cf*. Он уточнил атрибуты форматирования символов по умолчанию.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации смотрите `CHARFORMAT` `CHARFORMAT2` сообщение EM_GETCHARFORMAT и структуры в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [SetDefaultCharFormat](#setdefaultcharformat).

## <a name="cricheditctrlgeteventmask"></a><a name="geteventmask"></a>CrichEditCtrl:GetEventMask

Получает маску события `CRichEditCtrl` для этого объекта.

```
long GetEventMask() const;
```

### <a name="return-value"></a>Возвращаемое значение

Маска события для `CRichEditCtrl` этого объекта.

### <a name="remarks"></a>Remarks

Маска события определяет, какие сообщения `CRichEditCtrl` уведомлений объект отправляет в родительское окно.

Для получения дополнительной информации смотрите [EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask) в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [CRichEditCtrl::SetEventMask](#seteventmask).

## <a name="cricheditctrlgetfirstvisibleline"></a><a name="getfirstvisibleline"></a>CrichEditCtrl::GetFirstVisibleLine

Определяет наиболее видимую `CRichEditCtrl` линию в этом объекте.

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>Возвращаемое значение

Нулевой индекс верхней видимой линии в этом `CRichEditCtrl` объекте.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации смотрите [EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

## <a name="cricheditctrlgetiricheditole"></a><a name="getiricheditole"></a>CrichEditCtrl:GetIRichEditole

Доступ к `IRichEditOle` интерфейсу `CRichEditCtrl` для этого объекта.

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс [IRichEditOle,](/windows/win32/api/richole/nn-richole-iricheditole) который может `CRichEditCtrl` быть использован для доступа к функциональности OLE этого объекта; NULL, если интерфейс недоступен.

### <a name="remarks"></a>Remarks

Используйте этот интерфейс `CRichEditCtrl` для доступа к функциональности OLE этого объекта.

Для получения дополнительной информации смотрите [EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface) сообщение и интерфейс [IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole) в Windows SDK.

## <a name="cricheditctrlgetlimittext"></a><a name="getlimittext"></a>CrichEditCtrl:GetLimitText

Получает ограничение текста `CRichEditCtrl` для этого объекта.

```
long GetLimitText() const;
```

### <a name="return-value"></a>Возвращаемое значение

Текущий текст предел, в байтах, для этого `CRichEditCtrl` объекта.

### <a name="remarks"></a>Remarks

Ограничение текста - это максимальное количество текста, в байтах, богатый элемент управления редактированием может принять.

Для получения дополнительной информации смотрите [EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

## <a name="cricheditctrlgetline"></a><a name="getline"></a>CrichEditCtrl:GetLine

Извлекает строку текста `CRichEditCtrl` с этого объекта.

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Нулевой индекс линии для извлечения.

*lpszBuffer*<br/>
Указывает на буфер для получения текста. Первое слово буфера должно указывать максимальное количество байтов, которые могут быть скопированы в буфер.

*nMaxДлина*<br/>
Максимальное количество символов, которые могут быть скопированы в *lpszBuffer*. Вторая форма `GetLine` помещает это значение в первое слово буфера, указанного *lpszBuffer*.

### <a name="return-value"></a>Возвращаемое значение

Количество символов, скопированных в *lpszBuffer*.

### <a name="remarks"></a>Remarks

Скопированная строка не содержит термина null.

> [!NOTE]
> Поскольку первое слово буфера хранит количество символов, которые должны быть скопированы, убедитесь, что ваш буфер длиной не менее 4 байт.

Для получения дополнительной информации см. [EM_GETLINE](/windows/win32/Controls/em-getline) в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [GetLineCount](#getlinecount).

## <a name="cricheditctrlgetlinecount"></a><a name="getlinecount"></a>CrichEditCtrl:GetLineCount

Извлекает количество строк в `CRichEditCtrl` объекте.

```
int GetLineCount() const;
```

### <a name="return-value"></a>Возвращаемое значение

Количество строк в `CRichEditCtrl` этом объекте.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации [EM_GETLINECOUNT](/windows/win32/Controls/em-getlinecount) см.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

## <a name="cricheditctrlgetmodify"></a><a name="getmodify"></a>CrichEditCtrl:GetModify

Определяет, было ли `CRichEditCtrl` изменено содержимое этого объекта.

```
BOOL GetModify() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если текст `CRichEditCtrl` в этом объекте был изменен; в противном случае 0.

### <a name="remarks"></a>Remarks

Windows поддерживает внутренний флаг, указывающий, было ли изменено содержимое управления богатым исправления. Этот флаг очищается при первом создании элемента управления правки, а также может быть очищен, позвонив в функцию участника [SetModify.](#setmodify)

Для получения дополнительной информации [EM_GETMODIFY](/windows/win32/Controls/em-getmodify) см.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

## <a name="cricheditctrlgetoptions"></a><a name="getoptions"></a>CrichEditCtrl:GetOptions

Извлекает параметры, установленные в настоящее время для управления богатым истечением.

```
UINT GetOptions() const;
```

### <a name="return-value"></a>Возвращаемое значение

Комбинация значений флага текущего параметра. Список этих значений можно узнать в *EM_SETOPTIONS* [сообщении,](/windows/win32/Controls/em-setoptions) описанном в SDK Windows.

## <a name="cricheditctrlgetparaformat"></a><a name="getparaformat"></a>CrichEditCtrl:GetParaFormat

Получает параграф, обформатирующий атрибуты текущего выбора.

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>Параметры

*Pf*<br/>
В первой версии указатель на структуру [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) для удержания атрибутов форматирования абзацев текущего выбора.

Во второй версии указатель на структуру [PARAFORMAT2,](/windows/win32/api/richedit/ns-richedit-paraformat2) которая представляет собой расширение `PARAFORMAT` Rich Edit 2.0 к структуре, удерживая атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Член `dwMask` данных *pf*. В нем оговариваются атрибуты форматирования параграфа, которые согласованы на протяжении всего текущего выбора.

### <a name="remarks"></a>Remarks

Если выбрано несколько абзацев, *pf* получает атрибуты первого выбранного абзаца. Значение возврата определяет, какие атрибуты согласованы на протяжении всего выбора.

Для получения дополнительной информации смотрите `PARAFORMAT` `PARAFORMAT2` [EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat) сообщение и структуры в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [CRichEditCtrl::SetParaFormat](#setparaformat).

## <a name="cricheditctrlgetpunctuation"></a><a name="getpunctuation"></a>CrichEditCtrl:GetPunctuation

Получает текущие знаки препинания в богатом элемента управления редактированием.

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>Параметры

*fType*<br/>
Флаг типа препинания, описанный в параметре *fType* [EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation) в Windows SDK.

*lpPunc*<br/>
Указатель на структуру [PUNCTUATION,](/windows/win32/api/richedit/ns-richedit-punctuation) как описано в SDK Windows.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если операция удалась, в противном случае 0.

### <a name="remarks"></a>Remarks

Эта функция участника доступна только с азиатско-языковыми версиями операционной системы.

## <a name="cricheditctrlgetrect"></a><a name="getrect"></a>CRichEditCtrl:GetRect

Извлекает прямоугольник форматирования `CRichEditCtrl` для этого объекта.

```cpp
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md) или указатель на [RECT,](/windows/win32/api/windef/ns-windef-rect) чтобы получить прямоугольник форматирования этого `CRichEditCtrl` объекта.

### <a name="remarks"></a>Remarks

Прямоугольник форматирования является связующим прямоугольником для текста. Это значение не зависит от `CRichEditCtrl` размера объекта.

Для получения дополнительной информации смотрите [EM_GETRECT](/windows/win32/Controls/em-getrect) в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [для LimitText](#limittext).

## <a name="cricheditctrlgetredoname"></a><a name="getredoname"></a>CrichEditCtrl::GetRedoName

Извлекает тип следующего доступного действия в очереди повторов, если таковые имеются.

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>Возвращаемое значение

В случае `GetRedoName` успеха возвращается тип перечисления [UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid) с указанием типа следующего действия в очереди повторов элемента управления. Если очередь redo пуста, или если действие повтора в очереди неизвестного типа, `GetRedoName` возвращается 0.

### <a name="remarks"></a>Remarks

Типы действий, которые могут быть отменены или передислона включают ввод, удаление, перетаскивание, вырез и операции вставки. Эта информация может быть полезна для приложений, обеспечивающих расширенный пользовательский интерфейс для операций Undo и Redo, таких как окно списка повторяемых действий.

## <a name="cricheditctrlgetsel"></a><a name="getsel"></a>CrichEditCtrl:GetSel

Извлекает границы текущего выбора `CRichEditCtrl` в этом объекте.

```cpp
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>Параметры

*Cr*<br/>
Ссылка на структуру [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) для получения границ текущего выбора.

*nStartChar*<br/>
Индекс на нулевой основе первого символа в текущем выборе.

*nEndChar*<br/>
Индекс на нулевой основе последнего символа в текущем выборе.

### <a name="remarks"></a>Remarks

Две формы этой функции предоставляют альтернативные способы получения границ для выбора. Краткие описания этих форм следуют:

- **GetSel** `cr` **()** Эта форма `CHARRANGE` использует структуру с ее `cpMin` и `cpMax` членами, чтобы вернуть границы.

- **GetSel** `nStartChar` **(,** `nEndChar` **)** Эта форма возвращает границы в параметрах *nStartChar* и *nEndChar*.

Выбор включает в себя`cpMin` все, если начало (или *nStartChar*) составляет 0 и конец (или`cpMax` *nEndChar*) является - 1.

Для получения дополнительной информации смотрите [EM_EXGETSEL](/windows/win32/Controls/em-exgetsel) сообщение и структуру [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

## <a name="cricheditctrlgetselectioncharformat"></a><a name="getselectioncharformat"></a>CrichEditCtrl::GetSelectionCharFormat

Получает атрибуты форматирования символов текущего выбора.

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии указатель на структуру [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) для получения атрибутов форматирования символов текущего выбора.

Во второй версии указатель на структуру [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) которая является расширением `CHARFORMAT` Rich Edit 2.0 к структуре для получения атрибутов форматирования символов текущего выбора.

### <a name="return-value"></a>Возвращаемое значение

Член `dwMask` данных *cf*. В нем оговариваются атрибуты форматирования символов, которые согласованы на протяжении всего текущего выбора.

### <a name="remarks"></a>Remarks

Параметр *cf* получает атрибуты первого символа в текущем выборе. Значение возврата определяет, какие атрибуты согласованы на протяжении всего выбора.

Для получения дополнительной информации смотрите `CHARFORMAT` `CHARFORMAT2` [EM_GETCHARFORMAT](/windows/win32/Controls/em-getcharformat) сообщение и структуры в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [SetSelectionCharFormat](#setselectioncharformat).

## <a name="cricheditctrlgetselectiontype"></a><a name="getselectiontype"></a>CRichEditCtrl:GetSelectionType

Определяет тип выбора в `CRichEditCtrl` этом объекте.

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>Возвращаемое значение

Флаги с указанием содержимого текущего выбора. Сочетание следующих флагов:

- SEL_EMPTY указывает на отсутствие текущего выбора.

- SEL_TEXT указывает на то, что текущий выбор содержит текст.

- SEL_OBJECT указывает на то, что текущий выбор содержит по крайней мере один элемент OLE.

- SEL_MULTICHAR указывает на то, что текущий выбор содержит более одного символа текста.

- SEL_MULTIOBJECT указывает на то, что текущий выбор содержит более одного объекта OLE.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации [EM_SELECTIONTYPE](/windows/win32/Controls/em-selectiontype) см.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

## <a name="cricheditctrlgetseltext"></a><a name="getseltext"></a>CrichEditCtrl:GetSelText

Извлекает текст из текущего `CRichEditCtrl` выбора в этом объекте.

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>Параметры

*lpBuf*<br/>
Указатель на буфер для получения текста в текущем выборе.

### <a name="return-value"></a>Возвращаемое значение

Зависит от формы:

- **GetSelText** `lpBuf` **()** Количество символов, скопированных в *lpBuf,* не включая нулевое прекращение.

- **GetSelText ()** Строка, содержащая текущий выбор.

### <a name="remarks"></a>Remarks

Если вы используете первую форму, **GetSelText** `lpBuf` **()**, вы должны убедиться, что буфер достаточно велик для текста он будет получать. Позвоните [в GetSel,](#getsel) чтобы определить количество символов в текущем выборе.

Для получения дополнительной информации см. [EM_GETSELTEXT](/windows/win32/Controls/em-getseltext) в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [CRichEditCtrl::GetSelectionType](#getselectiontype).

## <a name="cricheditctrlgettextlength"></a><a name="gettextlength"></a>CrichEditCtrl:GetTextДлина

Извлекает длину текста, в символах, `CRichEditCtrl` в этом объекте, не включая прекращающийся нулевой характер.

```
long GetTextLength() const;
```

### <a name="return-value"></a>Возвращаемое значение

Длина текста в `CRichEditCtrl` этом объекте.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации см. [WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

## <a name="cricheditctrlgettextlengthex"></a><a name="gettextlengthex"></a>CrichEditCtrl::GetTextLengthEx

Вычисляет длину текста в управлении богатым редактированием.

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>Параметры

*dwFlags*<br/>
Значение, определяющее метод, который будет использоваться при определении длины текста. Этот участник может быть одним или более значениями, перечисленными в флагах члена [GETTEXTLENGTHEX,](/windows/win32/api/richedit/ns-richedit-gettextlengthex) описанных в Windows SDK.

*uCodePage*<br/>
Страница кода для перевода (CP_ACP для страницы кода ANSI, 1200 для Unicode).

### <a name="return-value"></a>Возвращаемое значение

Количество символов или байтов в элементе управления редактированием. Если несовместимые флаги были установлены в *dwFlags,* эта функция участника возвращается E_INVALIDARG.

### <a name="remarks"></a>Remarks

`GetTextLengthEx`дополнительные способы определения длины текста. Он поддерживает функциональность Rich Edit 2.0. Подробнее [о раздуваетесь](/windows/win32/Controls/about-rich-edit-controls) в Windows SDK для получения дополнительной информации.

## <a name="cricheditctrlgettextmode"></a><a name="gettextmode"></a>CrichEditCtrl:GetTextMode

Извлекает текущий текстовый режим и отменяет уровень богатого управления редактированием.

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Набор битовых флагов из типа перечисления [TEXTMODE,](/windows/win32/api/richedit/ne-richedit-textmode) как описано в SDK Windows. Флаги указывают текущий режим текста и отменить уровень управления.

## <a name="cricheditctrlgettextrange"></a><a name="gettextrange"></a>CrichEditCtrl:GetTextRange

Получает указанный диапазон символов.

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>Параметры

*nПервый*<br/>
Индекс положения персонажа, непосредственно предшествующий первому символу в диапазоне.

*nПоследний*<br/>
Положение персонажа сразу после последнего персонажа в диапазоне.

*refString*<br/>
Ссылка на объект [CString,](../../atl-mfc-shared/reference/cstringt-class.md) который получит текст.

### <a name="return-value"></a>Возвращаемое значение

Количество скопированных символов, не включая термин null.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации смотрите [EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange) в Windows SDK.

`GetTextRange`поддерживает функциональность Rich Edit 2.0. Подробнее [о раздуваетесь](/windows/win32/Controls/about-rich-edit-controls) в Windows SDK для получения дополнительной информации.

## <a name="cricheditctrlgetundoname"></a><a name="getundoname"></a>CrichEditCtrl::GetUndoName

Извлекает тип следующего доступного действия в очереди отменить, если таковые имеются.

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Если отменить действие в очереди отстойки элемента возвращается `GetUndoName` тип перечисления [UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid) с указанием типа следующего действия в очереди. Если очередь отменить анонсируется или если действие отменить в `GetUndoName` очереди неизвестного типа, возвращается 0.

### <a name="remarks"></a>Remarks

Типы действий, которые могут быть отменены или передислона включают ввод, удаление, перетаскивание, вырез и операции вставки. Эта информация может быть полезна для приложений, обеспечивающих расширенный пользовательский интерфейс для операций Undo и Redo, таких как окно списка действий, которые могут быть отменены.

## <a name="cricheditctrlgetwordwrapmode"></a><a name="getwordwrapmode"></a>CrichEditCtrl:GetWordWrapMode

Извлекает текущее слово упаковка и слово нарушение вариантов для богатых управления ревертритом.

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Текущее слово упаковка и слово нарушение вариантов. Эти параметры описаны в [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) в Windows SDK.

### <a name="remarks"></a>Remarks

Эта функция участника доступна только для азиатско-языковых версий операционной системы.

## <a name="cricheditctrlhideselection"></a><a name="hideselection"></a>CrichEditCtrl:HideSelection

Изменяет видимость выбора.

```cpp
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>Параметры

*bHide*<br/>
Указывает, если выбор должен быть показан или скрыт, правда, чтобы скрыть выбор.

*bПерм*<br/>
Указывает, должно ли это изменение видимости для выбора быть постоянным.

### <a name="remarks"></a>Remarks

Когда *bPerm* является правдой, он `CRichEditCtrl` изменяет ECO_NOHIDESEL вариант для этого объекта. Краткое описание этой опции можно просмотреть [SetOptions](#setoptions). Эту функцию можно использовать для настройки всех параметров для этого `CRichEditCtrl` объекта.

Для получения дополнительной информации см. [EM_HIDESELECTION](/windows/win32/Controls/em-hideselection) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

## <a name="cricheditctrllimittext"></a><a name="limittext"></a>CrichEditCtrl::LimitText

Ограничивает длину текста, который пользователь может ввести в управление редактирования.

```cpp
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>Параметры

*nChars*<br/>
Определяет длину (в байтах) текста, который пользователь может ввести. Если этот параметр равен 0 (значение по умолчанию), длина текста установлена на байт 64K.

### <a name="remarks"></a>Remarks

Изменение предела текста ограничивает только текст, в который может ввести пользователь. Он не влияет на любой текст, уже находящийся в элементе управления редактированием, и не влияет на `CWnd`длину текста, скопированного на элемент управления редактированием функцией члена [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) в . Если приложение использует `SetWindowText` функцию для размещения большего количества текста в элемент `LimitText`управления редактированием, чем указано в вызове, пользователь может удалить любой текст в элементе управления редактирования. Однако ограничение текста не позволит пользователю заменить существующий текст новым текстом, если исключение текущего выбора не приведет к тому, что текст не будет ниже предела текста.

> [!NOTE]
> Для предела текста каждый элемент OLE считается единым символом.

Для получения дополнительной информации см. [EM_EXLIMITTEXT](/windows/win32/Controls/em-exlimittext) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

## <a name="cricheditctrllinefromchar"></a><a name="linefromchar"></a>CrichEditCtrl:LineFromChar

Извлекает номер строки, содержащей указанный индекс символов.

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Содержит значение индекса на нулевой основе для желаемого символа в тексте элемента управления редактированием или содержит -1. Если *nIndex* -1, он определяет текущую линию, то есть строку, содержащую карету.

### <a name="return-value"></a>Возвращаемое значение

Номер строки, основанной на нулевом уровне, содержащий индекс символов, указанный *nIndex.* Если *nIndex* -1, число строки, содержащей первый символ выбора, возвращается. Если нет выбора, текущий номер строки возвращается.

### <a name="remarks"></a>Remarks

Индекс символов — это количество символов с начала богатого элемента управления редактированием. Для подсчета символов элемент OLE засчитывается как единый символ.

Для получения дополнительной информации смотрите [EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

## <a name="cricheditctrllineindex"></a><a name="lineindex"></a>CrichEditCtrl:LineIndex

Извлекает индекс символов строки `CRichEditCtrl` внутри этого объекта.

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>Параметры

*nЛиния*<br/>
Содержит значение индекса для нужной строки в тексте элемента управления редактированием или содержит -1. Если *nLine* -1, он определяет текущую линию, то есть линию, содержащую карету.

### <a name="return-value"></a>Возвращаемое значение

Индекс символов строки, указанный в *nLine* или -1, если указанное число строк больше, чем количество строк в элементе управления редактирования.

### <a name="remarks"></a>Remarks

Индекс символов — это количество символов от начала богатого элемента управления редактированием до указанной строки.

Для получения дополнительной информации см. [EM_LINEINDEX](/windows/win32/controls/em-lineindex) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

## <a name="cricheditctrllinelength"></a><a name="linelength"></a>CrichEditCtrl:LineLength

Извлекает длину строки в богатом элементауправления для реады.

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>Параметры

*nЛиния*<br/>
Определяетиндекс символов персонажа в строке, длина которого должна быть извлечена. Если этот параметр -1, длина текущей строки (строка, содержащая карету) возвращается, не включая длину выбранного текста в строке. При `LineLength` вызове для управления одностроками элемента реады этот параметр игнорируется.

### <a name="return-value"></a>Возвращаемое значение

При `LineLength` вызове для управления элементами реады с несколькими строками значение возврата — это длина (в TCHAR) строки, указанная *nLine.*  Он не включает символ перевозки-возврата в конце линии. При `LineLength` вызове для управления редактированием одной строки значение возврата — это длина (в TCHAR) текста в элементе управления редактирования. Если значение nLine превышает количество символов в элементе управления, значение возврата равно нулю.

### <a name="remarks"></a>Remarks

Используйте функцию члена [LineIndex](#lineindex) для получения индекса символов для заданного номера строки в этом `CRichEditCtrl` объекте.

Для получения дополнительной информации см. [EM_LINELENGTH](/windows/win32/Controls/em-linelength) в SDK Windows.

### <a name="example"></a>Пример

  Смотрите пример [LineIndex](#lineindex).

## <a name="cricheditctrllinescroll"></a><a name="linescroll"></a>CrichEditCtrl:LineScroll

Прокрутки текста многолинейного элемента управления редактированием.

```cpp
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>Параметры

*nЛинии*<br/>
Определяет количество строк для прокрутки по вертикали.

*nChars*<br/>
Определяет количество позиций символов для прокрутки горизонтально. Это значение игнорируется, если богатый элемент управления редемикирование имеет либо ES_RIGHT, либо ES_CENTER стиль. [Стили отсечения](../../mfc/reference/styles-used-by-mfc.md#edit-styles) указаны в [Create](#create).

### <a name="remarks"></a>Remarks

Элемент управления редактирования не прокручивается вертикально мимо последней строки текста в элементе управления редактирования. Если текущая строка плюс количество строк, указанных *nLines,* превышает общее количество строк в элементе управления отсеивании, значение корректируется таким образом, чтобы последняя строка элемента управления отсеиваю прокручивалась в верхней части окна управления отсеива.

`LineScroll`может быть использован для прокрутки горизонтально мимо последнего символа любой линии.

Для получения дополнительной информации см. [EM_LINESCROLL](/windows/win32/Controls/em-linescroll) в SDK Windows.

### <a name="example"></a>Пример

  Смотрите пример [GetFirstVisibleLine](#getfirstvisibleline).

## <a name="cricheditctrlpaste"></a><a name="paste"></a>CRichEditCtrl::Paste

Вставляет данные из Clipboard в `CRichEditCtrl` точку вставки, расположение кареты.

```cpp
void Paste();
```

### <a name="remarks"></a>Remarks

Данные вставляются только в том случае, если Clipboard содержит данные в признанном формате.

Для получения дополнительной информации смотрите [WM_PASTE](/windows/win32/dataxchg/wm-paste) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

## <a name="cricheditctrlpastespecial"></a><a name="pastespecial"></a>CRichEditCtrl::PasteSpecial

Вставляет данные в определенном `CRichEditCtrl` формате Clipboard в этот объект.

```cpp
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>Параметры

*nКлипФормат*<br/>
Формат клипборда для `CRichEditCtrl` вставки в этот объект.

*dvAspect*<br/>
Аспект устройства для получения данных из Clipboard.

*Hmf*<br/>
Ручка к метафайлу, содержащему культовый вид объекта, который будет вставлен.

### <a name="remarks"></a>Remarks

Новый материал вставляется в точке вставки, расположение caret.

Для получения дополнительной информации смотрите [EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

## <a name="cricheditctrlposfromchar"></a><a name="posfromchar"></a>CrichEditCtrl::PosFromChar

Извлекает координаты области клиента указанного символа в элементуправления редактирования.

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>Параметры

*Nchar*<br/>
Индекс персонажа с нулевым уровнем.

### <a name="return-value"></a>Возвращаемое значение

Положение персонажа,(x, y). Для управления элементами детора одной строки y-координация всегда равна нулю.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации см. [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) в Windows SDK.

## <a name="cricheditctrlredo"></a><a name="redo"></a>CrichEditCtrl:Redo

Повторное действие в очереди повторов элемента управления.

```
BOOL Redo();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации смотрите [EM_REDO](/windows/win32/Controls/em-redo) в SDK Windows.

## <a name="cricheditctrlreplacesel"></a><a name="replacesel"></a>CrichEditCtrl:ReplaceSel

Заменяет текущий выбор `CRichEditCtrl` в этом объекте на указанный текст.

```cpp
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>Параметры

*lpszNewText*<br/>
Указатель на нулевую строку, содержащую текст замены.

*bCanUndo*<br/>
Чтобы указать, что эта функция может быть отменена, установите значение этого параметра на TRUE. Значение по умолчанию — FALSE.

### <a name="remarks"></a>Remarks

Чтобы заменить весь `CRichEditCtrl` текст в этом объекте, используйте [CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

Если нет текущего выбора, текст замены вставляется в точке вставки, то есть текущее местоположение caret.

Эта функция будет форматирать вставленный текст с существующим форматированием символов. При замене всего диапазона текста `SetSel`(позвонив (0,-1) перед вызовом) `ReplaceSel`есть конец параграфа, который сохраняет форматирование предыдущего абзаца, который в наследство от вновь вставленного текста.

Для получения дополнительной информации см. [EM_REPLACESEL](/windows/win32/Controls/em-replacesel) в SDK Windows.

### <a name="example"></a>Пример

  Смотрите пример [LineIndex](#lineindex).

## <a name="cricheditctrlrequestresize"></a><a name="requestresize"></a>CrichEditCtrl:RequestResize

Принуждает `CRichEditCtrl` этот объект отправлять EN_REQUESTRESIZE сообщения уведомлений в родительское окно.

```cpp
void RequestResize();
```

### <a name="remarks"></a>Remarks

Эта функция полезна во время [CWnd::OnSize](../../mfc/reference/cwnd-class.md#onsize) обработки для бездонного `CRichEditCtrl` объекта.

Для получения дополнительной информации смотрите [сообщение EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize) и раздел **«Бездонные раздел управления разделом «Управление** сверху [богатых](/windows/win32/Controls/about-rich-edit-controls) элементов управления» в Разделе SDK СДК с windows.

## <a name="cricheditctrlsetautourldetect"></a><a name="setautourldetect"></a>CrichEditCtrl:SetAutoURLDetect

Устанавливает управление богатым элементом реаддляации для автоматического обнаружения URL-

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
Уточняется, настроен ли элемент управления для автоматического обнаружения URL-адреса. Если правда, она включена. Если FALSE, он отключен.

### <a name="return-value"></a>Возвращаемое значение

Ноль, если успешно, в противном случае ненулевой. Например, сообщение может выйти из строя из-за недостаточной памяти.

### <a name="remarks"></a>Remarks

Если включено, богатый элемент управления редактирования будет сканировать текст, чтобы определить, соответствует ли он стандартному формату URL. Список этих форматов URL см. [EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect) в SDK Windows.

> [!NOTE]
> Не устанавливайте `SetAutoURLDetect` к TRUE если ваш элемент управления редактирования использует CFE_LINK влияние для текста за исключением URL- их. `SetAutoURLDetect`позволяет этот эффект для URL-адресов и отстраняет его для всех других текстов. Более [подробную](/windows/win32/Controls/en-link) информацию о эффекте CFE_LINK смотрите EN_LINK.

## <a name="cricheditctrlsetbackgroundcolor"></a><a name="setbackgroundcolor"></a>CrichEditCtrl::SetBackgroundColor

Устанавливает цвет фона `CRichEditCtrl` для этого объекта.

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>Параметры

*bSysColor*<br/>
Указывает, должен ли быть установлен цвет фона на значение системы. Если это значение соответствует действительности, *cr* игнорируется.

*Cr*<br/>
Запрошенный цвет фона. Используется только в том случае, если *bSysColor* является FALSE.

### <a name="return-value"></a>Возвращаемое значение

Предыдущий цвет фона для этого `CRichEditCtrl` объекта.

### <a name="remarks"></a>Remarks

Цвет фона может быть установлен на значение системы или на определенное значение [COLORREF.](/windows/win32/gdi/colorref)

Для получения дополнительной информации смотрите [EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor) сообщение и структуру [COLORREF](/windows/win32/gdi/colorref) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

## <a name="cricheditctrlsetdefaultcharformat"></a><a name="setdefaultcharformat"></a>CrichEditCtrl::SetDefaultCharFormat

Устанавливает атрибуты форматирования символов для `CRichEditCtrl` нового текста в этом объекте.

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии указатель на структуру [CHARFORMAT,](/windows/win32/api/richedit/ns-richedit-charformata) содержащую новые атрибуты форматирования символов по умолчанию.

Во второй версии указатель на структуру [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) которая представляет собой расширение `CHARFORMAT` Rich Edit 2.0 к структуре, содержащему атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Эта функция меняет только `dwMask` атрибуты, указанные членом *cf.*

Для получения дополнительной информации смотрите `CHARFORMAT` `CHARFORMAT2` [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) сообщение и структуры в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

## <a name="cricheditctrlseteventmask"></a><a name="seteventmask"></a>CrichEditCtrl::SetEventМаск

Устанавливает маску события `CRichEditCtrl` для этого объекта.

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>Параметры

*dwEventМаск*<br/>
Новая маска события `CRichEditCtrl` для этого объекта.

### <a name="return-value"></a>Возвращаемое значение

Предыдущая маска события.

### <a name="remarks"></a>Remarks

Маска события определяет, какие сообщения `CRichEditCtrl` уведомлений объект отправляет в родительское окно.

Для получения дополнительной информации см. [EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

## <a name="cricheditctrlsetmodify"></a><a name="setmodify"></a>CrichEditCtrl::Установка

Устанавливает или очищает измененный флаг для управления изменением.

```cpp
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Параметры

*bИзменено*<br/>
Значение TRUE указывает на то, что текст был изменен, а значение FALSE указывает на то, что он не изменяется. По умолчанию модифицированный флаг устанавливается.

### <a name="remarks"></a>Remarks

Измененный флаг указывает, был ли изменен текст в элементе управления редактирования. Он автоматически устанавливается всякий раз, когда пользователь изменяет текст. Его значение можно получить с помощью функции участника [GetModify.](#getmodify)

Для получения дополнительной информации смотрите [EM_SETMODIFY](/windows/win32/Controls/em-setmodify) в SDK Windows.

### <a name="example"></a>Пример

  Смотрите пример [GetModify](#getmodify).

## <a name="cricheditctrlsetolecallback"></a><a name="setolecallback"></a>CrichEditCtrl:SetOLECallback

Предоставляет `CRichEditCtrl` этому `IRichEditOleCallback` объекту объект для доступа к ресурсам и информации, связанным с OLE.

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>Параметры

*pCallback*<br/>
Указатель на объект [IRichEditOleCallback,](/windows/win32/api/richole/nn-richole-iricheditolecallback) который этот `CRichEditCtrl` объект будет использовать для получения ресурсов и информации, связанных с OLE.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Этот `CRichEditCtrl` объект вызовет [IUnknown::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) для приращения количества использования для объекта COM, указанного *pCallback.*

Для получения дополнительной информации смотрите [EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback) сообщение и интерфейс [IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback) в Windows SDK.

## <a name="cricheditctrlsetoptions"></a><a name="setoptions"></a>CrichEditCtrl:SetOptions

Устанавливает параметры для `CRichEditCtrl` этого объекта.

```cpp
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>Параметры

*Wop*<br/>
Указывает тип операции. Одно из следующих значений:

- ECOOP_SET Установите параметры для тех, которые указаны *dwFlags*.

- ECOOP_OR Объединить текущие параметры с теми, указанные *dwFlags*.

- ECOOP_AND Сохранить только те текущие параметры, которые также указаны *dwFlags*.

- ECOOP_XOR Логически эксклюзивные или текущие варианты с указанными *dwFlags*.

*dwFlags*<br/>
Богатые варианты ретриума. Значения флага перечислены в разделе Замечания.

### <a name="remarks"></a>Remarks

Варианты могут быть комбинацией следующих значений:

- ECO_AUTOWORDSELECTION Автоматический выбор слов при двойном нажатии кнопки.

- ECO_AUTOVSCROLL Автоматически прокручивает текст вправо на 10 символов, когда пользователь вводит символ в конце строки. Когда пользователь нажимает на ключ ENTER, элемент управления прокручивает весь текст обратно в ноль позиций.

- ECO_AUTOHSCROLL Автоматически прокручивает текст на одну страницу, когда пользователь нажимает на ключ ENTER на последней строке.

- ECO_NOHIDESEL не утевает поведение по умолчанию для управления отсеиваний. Поведение по умолчанию скрывает выделение, когда элемент управления теряет фокус ввода и показывает выбор, когда элемент управления получает входним фокус. Если указать ECO_NOHIDESEL, выбранный текст переворачивается, даже если элемент управления не имеет фокуса.

- ECO_READONLY предотвращает ввод или редактирования текста в элементару элемента управления редактированием.

- ECO_WANTRETURN указывает, что возврат вагона будет вставлен, когда пользователь нажимает на ключ ENTER при вводе текста в многолинейное управление богатым редактированием в диалоговом поле. Если вы не укажете этот стиль, нажатие клавиши ENTER отправляет команду в родительское окно элемента «Богатый элемент управления правка качества», которое имитирует нажатие кнопки по умолчанию родительского окна (например, кнопка OK в диалоговом окне). Этот стиль не влияет на управление однолинейным элементом детора.

- ECO_SAVESEL сохраняет выделение, когда элемент управления теряет фокус. По умолчанию все содержимое элемента управления выбирается, когда он восстанавливает фокус.

- ECO_VERTICAL рисует текст и объекты в вертикальном направлении. Доступно только для азиатских языков.

Для получения дополнительной информации смотрите [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

## <a name="cricheditctrlsetparaformat"></a><a name="setparaformat"></a>CrichEditCtrl:SetParaFormat

Устанавливает атрибуты форматирования параграфа для `CRichEditCtrl` текущего выбора в этом объекте.

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>Параметры

*Pf*<br/>
В первой версии указатель на структуру [PARAFORMAT,](/windows/win32/api/richedit/ns-richedit-paraformat) содержащую новые атрибуты форматирования параграфа по умолчанию.

Во второй версии указатель на структуру [PARAFORMAT2,](/windows/win32/api/richedit/ns-richedit-paraformat2) которая представляет собой расширение `PARAFORMAT` Rich Edit 2.0 к структуре, удерживая атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Эта функция меняет только `dwMask` атрибуты, указанные членом *pf.*

Для получения дополнительной информации смотрите `PARAFORMAT` `PARAFORMAT2` [EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat) сообщение и структуры в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

## <a name="cricheditctrlsetpunctuation"></a><a name="setpunctuation"></a>CrichEditCtrl:SetPunctuation

Устанавливает пунктуацию в богатом элементаре управления.

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>Параметры

*fType*<br/>
Флаг препинания. Список возможных значений можно *fType* узнать в [EM_SETPUNCTUATION sDK](/windows/win32/Controls/em-setpunctuation) Windows.

*lpPunc*<br/>
Указатель на структуру [PUNCTUATION,](/windows/win32/api/richedit/ns-richedit-punctuation) как описано в SDK Windows.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно, в противном случае 0.

### <a name="remarks"></a>Remarks

Эта функция участника доступна только для азиатско-языковых версий операционной системы.

## <a name="cricheditctrlsetreadonly"></a><a name="setreadonly"></a>CrichEditCtrl:SetOnly

Изменяет ECO_READONLY опцию для этого `CRichEditCtrl` объекта.

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>Параметры

*bReadOnly*<br/>
Указывает, `CRichEditCtrl` следует ли только читать этот объект.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Краткое описание этой опции можно просмотреть [SetOptions](#setoptions). Эту функцию можно использовать для настройки всех параметров для этого `CRichEditCtrl` объекта.

Для получения дополнительной информации см. [EM_SETREADONLY](/windows/win32/Controls/em-setreadonly) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

## <a name="cricheditctrlsetrect"></a><a name="setrect"></a>CRichEditCtrl:SetRect

Устанавливает прямоугольник форматирования `CRichEditCtrl` для этого объекта.

```cpp
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md) или указатель на [RECT,](/windows/win32/api/windef/ns-windef-rect) который указывает новые границы для форматирования прямоугольника.

### <a name="remarks"></a>Remarks

Прямоугольник форматирования является ограничивающим прямоугольником для текста. Ограничивающий прямоугольник не зависит от размера богатого окна управления правка. Когда `CRichEditCtrl` этот объект впервые создан, прямоугольник форматирования имеет тот же размер, что и область клиента окна. Используйте `SetRect` для того, чтобы сделать прямоугольник форматирования больше или меньше, чем богатое окно для реитриатора.

Для получения дополнительной информации смотрите [EM_SETRECT](/windows/win32/Controls/em-setrect) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

## <a name="cricheditctrlsetsel"></a><a name="setsel"></a>CrichEditCtrl:Set

Устанавливает выделение `CRichEditCtrl` в рамках этого объекта.

```cpp
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>Параметры

*nStartChar*<br/>
Индекс на нулевой основе первого символа для выбора.

*nEndChar*<br/>
Индекс на нулевой основе последнего символа для выбора.

*Cr*<br/>
[Структура CHARRANGE,](/windows/win32/api/richedit/ns-richedit-charrange) которая содержит границы текущего выбора.

### <a name="remarks"></a>Remarks

Две формы этой функции предоставляют альтернативные способы настройки границ для выбора. Краткие описания этих форм следуют:

- **SetSel** `cr` **()** Эта форма `CHARRANGE` использует структуру с ее `cpMin` и `cpMax` членами, чтобы установить границы.

- **SetSel** `nStartChar` **(,** `nEndChar` **)** Эта форма использует параметры *nStartChar* и *nEndChar* для установки границ.

Caret помещается в конце выбора, указанного большим и`cpMin` большим индексом начала`cpMax` (или *nStartChar)* и конечным (или *nEndChar)* индексами. Эта функция прокручивает `CRichEditCtrl` содержимое так, чтобы карета была видна.

Чтобы выбрать весь текст `CRichEditCtrl` в `SetSel` этом объекте, позвоните со стартовым индексом 0 и конечным индексом - 1.

Для получения дополнительной информации смотрите [EM_EXSETSEL](/windows/win32/Controls/em-exsetsel) сообщение и структуру [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) в Windows SDK.

### <a name="example"></a>Пример

  Смотрите пример [GetSel](#getsel).

## <a name="cricheditctrlsetselectioncharformat"></a><a name="setselectioncharformat"></a>CrichEditCtrl::SetSelectionCharFormat

Устанавливает атрибуты форматирования символов для текста в `CRichEditCtrl` текущем выборе в этом объекте.

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии указатель на структуру [CHARFORMAT,](/windows/win32/api/richedit/ns-richedit-charformata) содержащую новые атрибуты форматирования символов для текущего выбора.

Во второй версии указатель на структуру [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) которая представляет собой расширение `CHARFORMAT` Rich Edit 2.0 к структуре, содержащему новые атрибуты форматирования символов для текущего выбора.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Эта функция меняет только `dwMask` атрибуты, указанные членом *cf.*

Для получения дополнительной информаци [EM_SETCHARFORMATи](/windows/win32/Controls/em-setcharformat) `CHARFORMAT` `CHARFORMAT2` см.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

## <a name="cricheditctrlsettargetdevice"></a><a name="settargetdevice"></a>CrichEditCtrl:SetTargetDevice

Устанавливает целевое устройство и ширину линии, используемые для WYSIWYG `CRichEditCtrl` (то, что вы видите, это то, что вы получаете) форматирование в этом объекте.

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>Параметры

*Hdc*<br/>
Обработка контекста устройства для нового целевого устройства.

*lLineWidth*<br/>
Ширина линии для использования для форматирования.

*Dc*<br/>
[CDC](../../mfc/reference/cdc-class.md) для нового целевого устройства.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Если эта функция успешна, богатый элемент управления реитриек владеет контекстом устройства, передаваемым в качестве параметра. В этом случае функция вызова не должна разрушать контекст устройства.

Для получения дополнительной информации смотрите [EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

## <a name="cricheditctrlsettextmode"></a><a name="settextmode"></a>CrichEditCtrl:SetTextMode

Устанавливает текстовый режим или отменить и переделать уровень для богатого управления редактированием.

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>Параметры

*fMode*<br/>
Определяет новые настройки для текстового режима управления и отменяйте параметры уровня. Список возможных значений можно узнать в [EM_SETTEXTMODE SDK](/windows/win32/Controls/em-settextmode) Windows.

### <a name="return-value"></a>Возвращаемое значение

Ноль, если успешно, в противном случае ненулевой.

### <a name="remarks"></a>Remarks

Для описания текстовых режимов EM_SETTEXTMODE см.

Эта функция элемента выходит из строя, если элемент управления содержит текст. Чтобы убедиться, что элемент управления пуст, отправьте [WM_SETTEXT](/windows/win32/winmsg/wm-settext) сообщение пустой строкой.

## <a name="cricheditctrlsetundolimit"></a><a name="setundolimit"></a>CrichEditCtrl:SetUndoLimit

Устанавливает максимальное количество действий, которые могут храниться в очереди отменить.

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>Параметры

*nЛимит*<br/>
Упогоняет максимальное количество действий, которые могут храниться в очереди отменить. Установите к нулю, чтобы отключить Отменить.

### <a name="return-value"></a>Возвращаемое значение

Новое максимальное количество действий отменить для управления богатым исправления.

### <a name="remarks"></a>Remarks

По умолчанию максимальное количество действий в очереди отменить составляет 100. Если увеличить это число, должно быть достаточно доступной памяти для размещения нового номера. Для повышения производительности установите предел для наименьшего возможного значения.

## <a name="cricheditctrlsetwordcharformat"></a><a name="setwordcharformat"></a>CrichEditCtrl::SetWordCharFormat

Устанавливает атрибуты форматирования символов для выбранного `CRichEditCtrl` в настоящее время слова в этом объекте.

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии указатель на структуру [CHARFORMAT,](/windows/win32/api/richedit/ns-richedit-charformata) содержащую новые атрибуты форматирования символов для выбранного в настоящее время слова.

Во второй версии указатель на структуру [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) которая является расширением `CHARFORMAT` Rich Edit 2.0 к структуре, содержащей новые атрибуты форматирования символов для выбранного в настоящее время слова.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Эта функция меняет только `dwMask` атрибуты, указанные членом *cf.*

Для получения дополнительной информации смотрите `CHARFORMAT` `CHARFORMAT2` [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) сообщение и структуры в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

## <a name="cricheditctrlsetwordwrapmode"></a><a name="setwordwrapmode"></a>CrichEditCtrl:SetWordWrapMode

Устанавливает параметры обертывания слов и разрыва слов для управления богатым истечением.

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>Параметры

*uФлаги*<br/>
Варианты для установки для обертывания слов и слово нарушение. Список возможных опций [можно](/windows/win32/Controls/em-setwordwrapmode) узнать EM_SETWORDWRAPMODE в SDK Windows.

### <a name="return-value"></a>Возвращаемое значение

Текущие варианты обертывания слов и разрыва слов.

### <a name="remarks"></a>Remarks

Это сообщение доступно только в версиях операционной системы на азиатском языке.

## <a name="cricheditctrlstopgrouptyping"></a><a name="stopgrouptyping"></a>CrichEditCtrl:StopGroupTyping

Останавливает элемент управления от сбора дополнительных действий ввода в текущее действие отменить.

```cpp
void StopGroupTyping();
```

### <a name="remarks"></a>Remarks

Элемент управления хранит следующее действие ввода, если таковой имеется, в новое действие в очереди отменить.

Для получения дополнительной информации смотрите [EM_STOPGROUPTYPING](/windows/win32/Controls/em-stopgrouptyping) в SDK Windows.

## <a name="cricheditctrlstreamin"></a><a name="streamin"></a>CrichEditCtrl:StreamIn

Заменяет текст `CRichEditCtrl` на этом объекте текстом из указанного ввода потока.

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Параметры

*nФормат*<br/>
Флаги с указанием форматов данных ввода. Дополнительные сведения см. в разделе «Примечания».

*es*<br/>
Структура [EDITSTREAM,](/windows/win32/api/richedit/ns-richedit-editstream) определяющая поток ввода. Дополнительные сведения см. в разделе «Примечания».

### <a name="return-value"></a>Возвращаемое значение

Количество символов, прочитаемых из вхотливого потока.

### <a name="remarks"></a>Remarks

Значение *nFormat* должно быть одним из следующих:

- SF_TEXT указывает только на чтение текста.

- SF_RTF указывает на чтение текста и форматирование.

Любое из этих значений можно сочетать с SFF_SELECTION. Если SFF_SELECTION указан, `StreamIn` заменяет текущий выбор с содержимым входиного потока. Если он не `StreamIn` указан, заменяет все `CRichEditCtrl` содержимое этого объекта.

В `EDITSTREAM` параметре *es*вы указываете функцию обратного вызова, которая заполняет буфер текстом. Эта функция обратного вызова вызывается повторно, пока поток ввода не исчерпан.

Для получения дополнительной информации смотрите [EM_STREAMIN](/windows/win32/Controls/em-streamin) сообщение и структуру [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

## <a name="cricheditctrlstreamout"></a><a name="streamout"></a>CrichEditCtrl::StreamOut

Выписывает содержимое `CRichEditCtrl` этого объекта в указанный выходной поток.

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Параметры

*nФормат*<br/>
Флаги с указанием форматов выходных данных. Дополнительные сведения см. в разделе «Примечания».

*es*<br/>
Структура [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) с указанием потока вывода. Дополнительные сведения см. в разделе «Примечания».

### <a name="return-value"></a>Возвращаемое значение

Количество символов, записанных в потоке вывода.

### <a name="remarks"></a>Remarks

Значение *nFormat* должно быть одним из следующих:

- SF_TEXT указывает только на написание текста.

- SF_RTF указывает на написание текста и форматирование.

- SF_RTFNOOBJS указывает на написание текста и форматирование, замену элементов OLE пробелами.

- SF_TEXTIZED Указывает на написание текста и форматирование с текстовыми представлениями элементов OLE.

Любое из этих значений можно сочетать с SFF_SELECTION. Если SFF_SELECTION указан, `StreamOut` выписывает текущий выбор в поток вывода. Если он не `StreamOut` указан, выписывается `CRichEditCtrl` все содержимое этого объекта.

В `EDITSTREAM` параметре *es*вы указываете функцию обратного вызова, которая заполняет буфер текстом. Эта функция обратного вызова вызывается повторно, пока поток вывода не будет исчерпан.

Для получения дополнительной информации смотрите [EM_STREAMOUT](/windows/win32/Controls/em-streamout) сообщение и структуру [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) в SDK Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

## <a name="cricheditctrlundo"></a><a name="undo"></a>CrichEditCtrl::Undo

Отменяет последнюю операцию в управлении богатым истрижем.

```
BOOL Undo();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если операция отменить успешно; в противном случае, 0.

### <a name="remarks"></a>Remarks

Операция отступоровая также может быть отменена. Например, можно восстановить удаленный текст с `Undo`первым вызовом. До тех пор, пока не будет операции редактирования, вы можете удалить `Undo`текст снова со вторым вызовом.

Для получения дополнительной информации [EM_UNDO](/windows/win32/Controls/em-undo) см.

### <a name="example"></a>Пример

  Смотрите пример [CanUndo](#canundo).

## <a name="see-also"></a>См. также раздел

[MFC Образец WORDPAD](../../overview/visual-cpp-samples.md)<br/>
[Класс CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[CEdit Class](../../mfc/reference/cedit-class.md)<br/>
[Класс CrichEditView](../../mfc/reference/cricheditview-class.md)
