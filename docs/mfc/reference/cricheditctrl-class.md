---
title: Класс CRichEditCtrl | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
dev_langs:
- C++
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 3ad17396a9c82532d46ea04f88b637828fe6f460
ms.sourcegitcommit: 92dbc4b9bf82fda96da80846c9cfcdba524035af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/05/2018
ms.locfileid: "43759705"
---
# <a name="cricheditctrl-class"></a>Класс CRichEditCtrl
Предоставляет функции элемента управления форматированным редактированием.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
class CRichEditCtrl : public CWnd  
```  
  
## <a name="members"></a>Участники  
  
### <a name="public-constructors"></a>Открытые конструкторы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|Создает объект `CRichEditCtrl`.|  
  
### <a name="public-methods"></a>Открытые методы  
  
|Имя|Описание|  
|----------|-----------------|  
|[CRichEditCtrl::CanPaste](#canpaste)|Определяет, если содержимое буфера обмена, можно вставить в этот элемент управления форматированным редактированием.|  
|[CRichEditCtrl::CanRedo](#canredo)|Определяет, есть ли каких-либо действий в очереди повторов элемента управления.|  
|[CRichEditCtrl::CanUndo](#canundo)|Определяет, может ли отменить операцию редактирования.|  
|[CRichEditCtrl::CharFromPos](#charfrompos)|Извлекает сведения о символа, ближайшего к заданной точки в клиентской области элемента управления edit.|  
|[CRichEditCtrl::Clear](#clear)|Очищает текущее выделение.|  
|[CRichEditCtrl::Copy](#copy)|Копирует текущее выделение в буфер обмена.|  
|[CRichEditCtrl::Create](#create)|Создает элемент управления форматированным редактированием Windows, который связывается с данным `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::CreateEx](#createex)|Создает элемент управления форматированным редактированием Windows с заданным расширенные стили Windows, который связывается с данным `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::Cut](#cut)|Вырезание текущего выделения в буфер обмена.|  
|[CRichEditCtrl::DisplayBand](#displayband)|Отображает часть содержимого данного `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|Сброс (очистка) флаг отмены этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::FindText](#findtext)|Размещает текст в рамках этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|Поиск следующего разбиение текста на слова, до или после заданной позиции символа или извлекает сведения о символе в этой позиции.|  
|[CRichEditCtrl::FormatRange](#formatrange)|Форматирует диапазон текста для вывода целевого устройства.|  
|[CRichEditCtrl::GetCharPos](#getcharpos)|Определяет каталог, определенный символ в рамках этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|Получает текущий символ по умолчанию форматирование атрибутов в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetEventMask](#geteventmask)|Получает маску события для этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|Определяет верхний видимой строки в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|Извлекает указатель на `IRichEditOle` интерфейс для этого элемента управления форматированием.|  
|[CRichEditCtrl::GetLimitText](#getlimittext)|Получает ограничение на объем текста, пользователь может ввести в это `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetLine](#getline)|Извлекает строки текста из этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetLineCount](#getlinecount)|Возвращает число строк в данном `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetModify](#getmodify)|Определяет, если содержимое данного `CRichEditCtrl` объекта были изменены с момента последнего сохранения.|  
|[CRichEditCtrl::GetOptions](#getoptions)|Извлекает параметры элемента управления форматированным редактированием.|  
|[CRichEditCtrl::GetParaFormat](#getparaformat)|Извлекает атрибуты в текущее выделение в этом форматирования абзаца `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|Извлекает текущий знаков препинания для элемента управления форматированным редактированием. Это сообщение доступно только в версиях азиатских языков операционной системы.|  
|[CRichEditCtrl::GetRect](#getrect)|Возвращает прямоугольник, форматирования для данного `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetRedoName](#getredoname)|Возвращает тип следующего действия, если таковой имеется, в элемент управления очередь на повтор.|  
|[CRichEditCtrl::GetSel](#getsel)|Получает начальный и конечный положение текущего выделения в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|Извлекает атрибуты в текущее выделение в это форматирование символов `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|Получает тип содержимого в текущее выделение в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::GetSelText](#getseltext)|Получает текст текущего выделенного фрагмента в данном `CRichEditCtrl` объекта|  
|[CRichEditCtrl::GetTextLength](#gettextlength)|Получает длину текста, в символах, в этом `CRichEditCtrl` объекта. Не включает завершающий нуль-символ.|  
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|Возвращает число символов или байтов, в представлении rich edit. Принимает список параметров для указания метода определения длину текста в элементе управления rich edit|  
|[CRichEditCtrl::GetTextMode](#gettextmode)|Возвращает текущий текстовый режим и отмены уровень элемента управления форматированным редактированием.|  
|[CRichEditCtrl::GetTextRange](#gettextrange)|Извлекает указанный фрагмент текста.|  
|[CRichEditCtrl::GetUndoName](#getundoname)|Возвращает тип следующего действия отмены, если таковые имеются.|  
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|Извлекает текущий перенос слов и параметров разбиения на слова для элемента управления форматированным редактированием. Это сообщение доступно только в версиях азиатских языков операционной системы.|  
|[CRichEditCtrl::HideSelection](#hideselection)|Показывает или скрывает текущего выделения.|  
|[CRichEditCtrl::LimitText](#limittext)|Ограничивает объем текста, пользователь может ввести в `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::LineFromChar](#linefromchar)|Определяет строку, в котором содержится данный символ.|  
|[CRichEditCtrl::LineIndex](#lineindex)|Получает индекс символа в заданной строке, в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::LineLength](#linelength)|Получает длину заданной строки в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::LineScroll](#linescroll)|Прокрутка текста в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::Paste](#paste)|Вставляет содержимое буфера обмена в этот элемент управления форматированным редактированием.|  
|[CRichEditCtrl::PasteSpecial](#pastespecial)|Вставляет содержимое буфера обмена в данного элемента управления форматированным редактированием в указанный формат данных.|  
|[CRichEditCtrl::PosFromChar](#posfromchar)|Извлекает клиентские координаты области указанного символа в элемент управления редактированием.|  
|[CRichEditCtrl::Redo](#redo)|Повтор следующего действия в очереди повторов элемента управления.|  
|[CRichEditCtrl::ReplaceSel](#replacesel)|Заменяет текущее выделение в этом `CRichEditCtrl` объект с заданным текстом.|  
|[CRichEditCtrl::RequestResize](#requestresize)|Это заставляет `CRichEditCtrl` объект для отправки уведомлений запросов на изменения размера.|  
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|Указывает, активен ли автоматическое обнаружение URL-адрес в элементе управления rich edit.|  
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|Задает цвет фона в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|Задает текущий символ по умолчанию форматирование атрибутов в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetEventMask](#seteventmask)|Задает маску события для данного `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetModify](#setmodify)|Устанавливает или снимает флаг изменения для данного `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetOLECallback](#setolecallback)|Наборы `IRichEditOleCallback` COM-объект для данного элемента управления форматированным редактированием.|  
|[CRichEditCtrl::SetOptions](#setoptions)|Задает параметры для этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetParaFormat](#setparaformat)|Задает атрибуты в текущее выделение в этом форматирования абзаца `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|Задает для элемента управления форматированным редактированием знаков препинания. Это сообщение доступно только в версиях азиатских языков операционной системы.|  
|[CRichEditCtrl::SetReadOnly](#setreadonly)|Задает параметр только для чтения для этого `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetRect](#setrect)|Задает для данного прямоугольника форматирования `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetSel](#setsel)|Задает выделение в этом `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|Задает форматирование атрибутов в текущее выделение в этом символов `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|Задает целевое устройство вывода для данного `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetTextMode](#settextmode)|Задает уровень режима или отмены текста элемента управления форматированным редактированием. Сообщение не проходит, если элемент управления содержит текст.|  
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|Задает максимальное количество действий, которые можно хранить в очереди отмены.|  
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|Задает форматирование атрибуты текущего слова в этом символов `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|Установка параметров переноса слов и разбиение по словам для сложных данных элемента управления edit. Это сообщение доступно только в версиях азиатских языков операционной системы.|  
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|Останавливает управления сбор дополнительных вводит текущее действие отмены действия. Элемент управления сохраняет следующее действие ввода, если таковое имеется, в новое действие в очереди отмены.|  
|[CRichEditCtrl::StreamIn](#streamin)|Вставляет текст из входного потока в этот `CRichEditCtrl` объекта.|  
|[CRichEditCtrl::StreamOut](#streamout)|Сохраняет текст из этого `CRichEditCtrl` объекта в поток вывода.|  
|[CRichEditCtrl::Undo](#undo)|Отменяет последнюю операцию редактирования.|  
  
## <a name="remarks"></a>Примечания  
 Управления rich edit «» — это окно, в котором пользователь может вводить и редактировать текст. Текст можно назначить форматированием символов и абзацев и могут включать внедренные объекты OLE. Элементы управления rich edit предоставляют программный интерфейс для форматирования текста. Тем не менее приложение должно реализовать все компоненты пользовательского интерфейса, необходимые для предоставления пользователю операций форматирования.  
  
 Это Windows общего элемента управления (и, следовательно `CRichEditCtrl` класс) доступны только для программ, работающих в версиях Windows 95/98 и Windows NT 3.51 и более поздних версиях. `CRichEditCtrl` Класс поддерживает версий 2.0 и 3.0 широкий набор функций пакета SDK для Windows, в элемент управления.  
  
> [!CAUTION]
>  При использовании элемента управления форматированным редактированием в диалоговое окно (независимо от того, является ли приложения SDI, MDI, или на базе диалогового окна), необходимо вызвать [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit) после перед диалогового окна отображается окно. Типичный вызов этой функции — в вашей программе `InitInstance` функция-член. Необходимо вызывать его для каждый раз, можно отобразить диалоговое окно, только в первый раз. Нет необходимости вызывать `AfxInitRichEdit` при работе с `CRichEditView`.  
  
 Дополнительные сведения об использовании `CRichEditCtrl`, см. в разделе:  
  
- [Элементы управления](../../mfc/controls-mfc.md)  
  
- [Использование CRichEditCtrl](../../mfc/using-cricheditctrl.md)  
  
-   Статье базы знаний Q259949: INFO: SetCaretPos() является не соответствующие с CEdit или элементами управления CRichEditCtrl  
  
 Пример использования элемента управления форматированным редактированием в приложении MFC, см. в разделе [WORDPAD](../../visual-cpp-samples.md) пример приложения.  
  
## <a name="inheritance-hierarchy"></a>Иерархия наследования  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `CRichEditCtrl`  
  
## <a name="requirements"></a>Требования  
 **Заголовок:** afxcmn.h  
  
##  <a name="canpaste"></a>  CRichEditCtrl::CanPaste  
 Определяет, если элемент управления форматированием можно вставить в указанный формат буфера обмена.  
  
```  
BOOL CanPaste(UINT nFormat = 0) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *nFormat*  
 Формат данных буфера обмена для запроса. Этот параметр может принимать одно из стандартных форматов буфера обмена, или значение, возвращенное [RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если формат буфера обмена может быть вставлено; в противном случае 0.  
  
### <a name="remarks"></a>Примечания  
 Если *nFormat* равно 0, `CanPaste` будет предпринята попытка использовать любой формат, находящиеся в буфере обмена.  
  
 Дополнительные сведения см. в разделе [EM_CANPASTE](/windows/desktop/Controls/em-canpaste) сообщение и [RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata) функции в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]  
  
##  <a name="canredo"></a>  CRichEditCtrl::CanRedo  
 Определяет, содержит ли очереди повторного выполнения каких-либо действий.  
  
```  
BOOL CanRedo() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если очереди повторного выполнения имеются действия, в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Чтобы получить имя операции в очереди повтора, вызовите [CRichEditCtrl::GetRedoName](#getredoname). Чтобы вернуть самой последней операции отмены, вызовите [повтора](#redo).  
  
 Дополнительные сведения см. в разделе [EM_CANREDO](/windows/desktop/Controls/em-canredo) в пакете Windows SDK.  
  
##  <a name="canundo"></a>  CRichEditCtrl::CanUndo  
 Определяет, может ли отменить последнюю операцию редактирования.  
  
```  
BOOL CanUndo() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если последнюю операцию редактирования могут быть отменены путем вызова [отменить](#undo) функция-член; 0, если он не может быть отменена.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_CANUNDO](/windows/desktop/Controls/em-canundo) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]  
  
##  <a name="charfrompos"></a>  CRichEditCtrl::CharFromPos  
 Извлекает сведения о символе в момент, заданный параметром *pt*.  
  
```  
int CharFromPos(CPoint pt) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *pt*  
 Объект [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) объект, содержащий координаты указанной точки.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Отсчитываемый от нуля индекс символа, ближайшее к заданной точке. Если указанная точка находится за последним символом в элементе управления, возвращаемое значение указывает последний символ в элементе управления.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член работает с элементом управления форматированным редактированием. Чтобы получить сведения для элемента управления, вызовите [CEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos).  
  
 Дополнительные сведения см. в разделе [EM_CHARFROMPOS](/windows/desktop/Controls/em-charfrompos) в пакете Windows SDK.  
  
##  <a name="clear"></a>  CRichEditCtrl::Clear  
 Удаляет (очищает) элемента управления edit текущее выделение (если таковые имеются) в сложных данных.  
  
```  
void Clear();
```  
  
### <a name="remarks"></a>Примечания  
 Удаления, выполненных `Clear` можно отменить, вызвав [отменить](#undo) функция-член.  
  
 Чтобы удалить текущее выделение и помещает удаленные содержимое в буфер обмена, вызовите [Вырезать](#cut) функция-член.  
  
 Дополнительные сведения см. в разделе [WM_CLEAR](/windows/desktop/dataxchg/wm-clear) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]  
  
##  <a name="copy"></a>  CRichEditCtrl::Copy  
 Копирует текущее выделение (если таковые имеются) в элементе управления форматированным редактированием в буфер обмена.  
  
```  
void Copy();
```  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [WM_COPY](/windows/desktop/dataxchg/wm-copy) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]  
  
##  <a name="create"></a>  CRichEditCtrl::Create  
 Создает элемент управления форматированным редактированием Windows, который связывается с данным `CRichEditCtrl` объекта.  
  
```  
virtual BOOL Create(
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>Параметры  
 *dwStyle*  
 Задает стиль элемента управления поля ввода. Применить сочетание стилей окна, перечисленных в **"Примечания"** разделе ниже, и [изменение стилей элемента управления](/windows/desktop/Controls/edit-control-styles), описанные в пакете Windows SDK.  
  
 *Rect*  
 Задает размер и положение элемента управления поля ввода. Может быть [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта или [RECT](../../mfc/reference/rect-structure1.md) структуры.  
  
 *pParentWnd*  
 Указывает родительскому окну элемента редактирования (часто [CDialog](../../mfc/reference/cdialog-class.md)). Он не должен иметь значение NULL.  
  
 *nID*  
 Указывает идентификатор элемента управления поля ввода.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если инициализация прошла успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 При создании `CRichEditCtrl` объекта в два этапа. Во-первых, вызовите [CRichEditCtrl](#cricheditctrl) конструктора, затем вызвать `Create`, который создает элемент управления Windows и присоединяет его к `CRichEditCtrl` объекта.  
  
 При создании элемента управления форматированным редактированием с этой функцией, сначала необходимо загрузить необходимые библиотеки общих элементов управления. Загрузить библиотеку, вызовите глобальную функцию [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit), в свою очередь, которое инициализирует библиотеки общих элементов управления. Необходимо вызвать `AfxInitRichEdit` только один раз в процессе.  
  
 Когда `Create` выполняет, Windows отправляет [WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate), [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize), [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate), и [WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) сообщения в элемент управления редактирования.  
  
 Эти сообщения обрабатываются по умолчанию с помощью [OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate), [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize), [OnCreate](../../mfc/reference/cwnd-class.md#oncreate), и [OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) функции-члены в `CWnd` базового класса. Чтобы расширить обработку сообщения по умолчанию, являются производными от класса `CRichEditCtrl`, добавить схему сообщений к новому классу и переопределить выше функции-члены обработчика сообщений. Переопределить `OnCreate`, например, для выполнения инициализации, необходимые для нового класса.  
  
 Примените следующий [стили окна](../../mfc/reference/styles-used-by-mfc.md#window-styles) для элемента управления.  
  
- WS_CHILD всегда.  
  
- WS_VISIBLE обычно.  
  
- WS_DISABLED редко.  
  
- WS_GROUP для группы элементов управления.  
  
- WS_TABSTOP для включать управления редактированием в порядок следования.  
  
 Дополнительные сведения о стили окна, см. в разделе [CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]  
  
##  <a name="createex"></a>  CRichEditCtrl::CreateEx  
 Создает элемент управления (дочернего окна) и связывает его с `CRichEditCtrl` объекта.  
  
```  
virtual BOOL CreateEx(
    DWORD dwExStyle,  
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>Параметры  
 *dwExStyle*  
 Указывает расширенный стиль создаваемого элемента управления. Список расширенных стилей Windows, см. в разделе *dwExStyle* параметр для [CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) в пакете Windows SDK.  
  
 *dwStyle*  
 Задает стиль элемента управления поля ввода. Применить сочетание стилей окна, перечисленных в **"Примечания"** раздел [создать](#create) и [изменение стилей элемента управления](/windows/desktop/Controls/edit-control-styles), описанные в пакете Windows SDK.  
  
 *Rect*  
 Ссылку на [RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897) структура, описывающая размер и положение окна, создаваемых в клиентских координатах *pParentWnd*.  
  
 *pParentWnd*  
 Указатель на окно, которое является родительским для элемента управления.  
  
 *nID*  
 Идентификатор элемента управления дочернего окна.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Имеет ненулевое значение в случае успешного выполнения, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Используйте `CreateEx` вместо `Create` применение расширенных стилей Windows, определяемое префикс расширенного стиля Windows **WS_EX_**.  
  
##  <a name="cricheditctrl"></a>  CRichEditCtrl::CRichEditCtrl  
 Создает объект `CRichEditCtrl`.  
  
```  
CRichEditCtrl();
```  
  
### <a name="remarks"></a>Примечания  
 Используйте [создать](#create) для создания Windows элемент управления rich edit.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]  
  
##  <a name="cut"></a>  CRichEditCtrl::Cut  
 Удалить (порезов) текущее выделение (если таковые имеются) в широкий набор функций элемента управления edit и копирует в буфер обмена удаленного текста.  
  
```  
void Cut();
```  
  
### <a name="remarks"></a>Примечания  
 Удаления, выполненных `Cut` можно отменить, вызвав [отменить](#undo) функция-член.  
  
 Чтобы удалить текущее выделение, не помещая удаляемый текст в буфер обмена, вызовите [Очистить](#clear) функция-член.  
  
 Дополнительные сведения см. в разделе [WM_CUT](/windows/desktop/dataxchg/wm-cut) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]  
  
##  <a name="displayband"></a>  CRichEditCtrl::DisplayBand  
 Отображает часть содержимого элемента управления форматированным редактированием (текст и элементы OLE), как ранее, отформатированный [FormatRange](#formatrange).  
  
```  
BOOL DisplayBand(LPRECT pDisplayRect);
```  
  
### <a name="parameters"></a>Параметры  
 *pDisplayRect*  
 Указатель на [RECT](../../mfc/reference/rect-structure1.md) или [CRect](../../atl-mfc-shared/reference/crect-class.md) объект, указывающий область устройства для отображения текста.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если отображение форматированного текста выполняется успешно, в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Текст и элементы OLE обрезаются по области, указанной указатель *pDisplayRect*.  
  
 Дополнительные сведения см. в разделе [EM_DISPLAYBAND](/windows/desktop/Controls/em-displayband) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [CRichEditCtrl::FormatRange](#formatrange).  
  
##  <a name="emptyundobuffer"></a>  CRichEditCtrl::EmptyUndoBuffer  
 Сброс (очистка) флага отмены этого элемента управления форматированным редактированием.  
  
```  
void EmptyUndoBuffer();
```  
  
### <a name="remarks"></a>Примечания  
 Элемент управления, теперь смогут отменяет последнюю операцию редактирования. Этот флаг отмены имеет значение каждый раз, когда операции в элементе управления форматированным редактированием могут быть отменены.  
  
 Флаг отмены автоматически очищается при каждом вызове [CWnd](../../mfc/reference/cwnd-class.md) функция-член [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).  
  
 Дополнительные сведения см. в разделе [EM_EMPTYUNDOBUFFER](/windows/desktop/Controls/em-emptyundobuffer) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]  
  
##  <a name="findtext"></a>  CRichEditCtrl::FindText  
 Выполняет поиск текста в элементе управления форматированным редактированием.  
  
```  
long FindText(
    DWORD dwFlags,  
    FINDTEXTEX* pFindText) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *dwFlags*  
 Список возможных значений см. в разделе *wParam* в [EM_FINDTEXTEXT](/windows/desktop/Controls/em-findtextex) в пакете Windows SDK.  
  
 *pFindText*  
 Указатель на [FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-_findtextexa) структуры, что для поиска и возврат диапазона, где совпадение было обнаружено.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Отсчитываемый от нуля позиция следующего совпадения; -1, если больше нет совпадений.  
  
### <a name="remarks"></a>Примечания  
 Также можно воспользоваться либо вверх или вниз в задании параметров соответствующий интервал [CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) структуры в `FINDTEXTEX` структуры.  
  
 Дополнительные сведения см. в разделе [EM_FINDTEXTEX](/windows/desktop/Controls/em-findtextex) сообщение и [FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-_findtextexa) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]  
  
##  <a name="findwordbreak"></a>  CRichEditCtrl::FindWordBreak  
 Находит следующий разбиение текста на слова, до или после позиции, заданной параметром *nвремя запуска*.  
  
```  
DWORD FindWordBreak(
    UINT nCode,  
    DWORD nStart) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *nCode*  
 Указывает действие, выполняемое. Список возможных значений см. в описании параметра *кода* в EM_FINDWORDBREAK в пакете Windows SDK.  
  
 *nвремя запуска*  
 Отсчитываемый от нуля позиция, с которого следует начать.  
  
### <a name="return-value"></a>Возвращаемое значение  
 На основе параметра *nCode*. Дополнительные сведения см. в разделе [EM_FINDWORDBREAK](/windows/desktop/Controls/em-findwordbreak) в пакете Windows SDK.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член можно использовать для получения сведений о символе в заданной позиции.  
  
##  <a name="formatrange"></a>  CRichEditCtrl::FormatRange  
 Форматирует диапазон текста в элементе управления "rich edit" для конкретного устройства.  
  
```  
long FormatRange(
    FORMATRANGE* pfr,  
    BOOL bDisplay = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 *PFR*  
 Указатель на [FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-_formatrange) структуры, который содержит информацию об устройстве вывода. Значение NULL указывает, что кэшированные данные в элементе управления форматированным редактированием может быть освобожден.  
  
 *bDisplay*  
 Указывает, следует ли отрисовывать текст. Если значение равно FALSE, текст только что измеряется.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Индекс последнего символа, который помещается в области, плюс один.  
  
### <a name="remarks"></a>Примечания  
 Как правило, этот вызов сопровождается вызов [DisplayBand](#displayband).  
  
 Дополнительные сведения см. в разделе [EM_FORMATRANGE](/windows/desktop/Controls/em-formatrange) сообщение и [FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-_formatrange) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]  
  
##  <a name="getcharpos"></a>  CRichEditCtrl::GetCharPos  
 Получает положение (в левом верхнем углу) определенный символ в рамках этого `CRichEditCtrl` объекта.  
  
```  
CPoint GetCharPos(long lChar) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *lChar*  
 Отсчитываемый от нуля индекс символа.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Расположение верхнего левого угла символ, заданный параметром *lChar*.  
  
### <a name="remarks"></a>Примечания  
 Символ, заданный, задав значение его отсчитываемый от нуля индекс. Если *lChar* больше индекса последнего символа в этом `CRichEditCtrl` объекта, возвращаемое значение, указывающее координаты позиции позицию сразу после последнего символа в этом `CRichEditCtrl` объекта.  
  
 Дополнительные сведения см. в разделе [EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) в пакете Windows SDK.  
  
##  <a name="getdefaultcharformat"></a>  CRichEditCtrl::GetDefaultCharFormat  
 Получает атрибуты этого форматирование символов по умолчанию `CRichEditCtrl` объекта.  
  
```  
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *CF*  
 В первой версии, указатель на `CHARFORMAT` структуру, содержащую атрибутов форматирования символов по умолчанию.  
  
 Во второй версии, указатель на `CHARFORMAT2` структуру, которая является расширением Rich Edit 2.0 для `CHARFORMAT` структуры, удерживая атрибутов форматирования символов по умолчанию.  
  
### <a name="return-value"></a>Возвращаемое значение  
 `dwMask` Данными-членом *cf*. Он указан символ по умолчанию атрибуты форматирования.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе EM_GETCHARFORMAT сообщение и `CHARFORMAT` и `CHARFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [SetDefaultCharFormat](#setdefaultcharformat).  
  
##  <a name="geteventmask"></a>  CRichEditCtrl::GetEventMask  
 Получает маску события для этого `CRichEditCtrl` объекта.  
  
```  
long GetEventMask() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Маску события для этого `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 Маска событие указывает, какие сообщения уведомления `CRichEditCtrl` объект отправляет своему родительскому окну.  
  
 Дополнительные сведения см. в разделе [EM_GETEVENTMASK](/windows/desktop/Controls/em-geteventmask) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [CRichEditCtrl::SetEventMask](#seteventmask).  
  
##  <a name="getfirstvisibleline"></a>  CRichEditCtrl::GetFirstVisibleLine  
 Определяет верхний видимой строки в этом `CRichEditCtrl` объекта.  
  
```  
int GetFirstVisibleLine() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Отсчитываемый от нуля индекс верхней видимой строки в этом `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_GETFIRSTVISIBLELINE](/windows/desktop/Controls/em-getfirstvisibleline) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]  
  
##  <a name="getiricheditole"></a>  CRichEditCtrl::GetIRichEditOle  
 Обращается к `IRichEditOle` интерфейс для данного `CRichEditCtrl` объекта.  
  
```  
IRichEditOle* GetIRichEditOle() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Указатель на [IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole) интерфейс, который может использоваться для доступа к этой `CRichEditCtrl` функциональности объекта OLE. Значение NULL, если интерфейс недоступен.  
  
### <a name="remarks"></a>Примечания  
 Используйте этот интерфейс для доступа к этой `CRichEditCtrl` функциональных возможностей объекта OLE.  
  
 Дополнительные сведения см. в разделе [EM_GETOLEINTERFACE](/windows/desktop/Controls/em-getoleinterface) сообщение и [IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole) интерфейс в пакете Windows SDK.  
  
##  <a name="getlimittext"></a>  CRichEditCtrl::GetLimitText  
 Возвращает предельное число SMS для данного `CRichEditCtrl` объекта.  
  
```  
long GetLimitText() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущий текст предельный размер в байтах для данного `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 Максимальный объем текста, в байтах, значение равно текст может принимать управления форматированным редактированием.  
  
 Дополнительные сведения см. в разделе [EM_GETLIMITTEXT](/windows/desktop/Controls/em-getlimittext) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]  
  
##  <a name="getline"></a>  CRichEditCtrl::GetLine  
 Извлекает строки текста из этого `CRichEditCtrl` объекта.  
  
```  
int GetLine(
    int nIndex,  
    LPTSTR lpszBuffer) const;  
  
int GetLine(
    int nIndex,  
    LPTSTR lpszBuffer,  
    int nMaxLength) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *nIndex*  
 Отсчитываемый от нуля индекс строки для извлечения.  
  
 *lpszBuffer*  
 Указатель на буфер для получения текста. Первое слово буфера необходимо указать максимальное число байтов, которые могут быть скопированы в буфер.  
  
 *nMaxLength*  
 Максимальное количество символов, которые можно было скопировать в *lpszBuffer*. Вторая форма `GetLine` помещает это значение в первое слово буфера, заданного *lpszBuffer*.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число символов, копируются в *lpszBuffer*.  
  
### <a name="remarks"></a>Примечания  
 Скопированную строку не содержит завершающий нуль-символ.  
  
> [!NOTE]
>  Так как первое слово буфера хранит число копируемых символов, убедитесь, что размер буфера является менее 4 байт.  
  
 Дополнительные сведения см. в разделе [EM_GETLINE](/windows/desktop/Controls/em-getline) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [GetLineCount](#getlinecount).  
  
##  <a name="getlinecount"></a>  CRichEditCtrl::GetLineCount  
 Возвращает число строк в `CRichEditCtrl` объекта.  
  
```  
int GetLineCount() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Количество строк в данном `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_GETLINECOUNT](/windows/desktop/Controls/em-getlinecount) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]  
  
##  <a name="getmodify"></a>  CRichEditCtrl::GetModify  
 Определяет, если содержимое данного `CRichEditCtrl` объекта были изменены.  
  
```  
BOOL GetModify() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение текста в данном `CRichEditCtrl` объект был изменен; в противном случае 0.  
  
### <a name="remarks"></a>Примечания  
 Windows поддерживает внутренний флаг, указывающий, были ли изменены содержимое элемента управления форматированным редактированием. Этот флаг очищается в том случае, когда элемент управления сначала создается и также очистить путем вызова [SetModify](#setmodify) функция-член.  
  
 Дополнительные сведения см. в разделе [EM_GETMODIFY](/windows/desktop/Controls/em-getmodify) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]  
  
##  <a name="getoptions"></a>  CRichEditCtrl::GetOptions  
 Извлекает параметры, заданных в настоящее время для управления форматированным редактированием.  
  
```  
UINT GetOptions() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Комбинация значений флагов текущий параметр. Список этих значений, см. в разделе *возможности* параметр в [EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions) сообщения, как описано в пакете Windows SDK.  
  
##  <a name="getparaformat"></a>  CRichEditCtrl::GetParaFormat  
 Получает абзаца форматирования атрибуты текущего выделенного фрагмента.  
  
```  
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *Общая папка*  
 В первой версии, указатель на [PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-_paraformat) структуру для хранения атрибуты текущего выделенного фрагмента форматирования абзаца.  
  
 Во второй версии, указатель на [PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2) структуру, которая является расширением Rich Edit 2.0 для `PARAFORMAT` структуры, удерживая атрибутов форматирования символов по умолчанию.  
  
### <a name="return-value"></a>Возвращаемое значение  
 `dwMask` Данными-членом *pf*. Задает атрибуты, которые они единообразны во всем текущее выделение форматирования абзаца.  
  
### <a name="remarks"></a>Примечания  
 Если выбрано несколько абзацев, *pf* принимает атрибуты первого абзаца. Возвращаемое значение, указывающее, какие атрибуты они единообразны во всем выделения.  
  
 Дополнительные сведения см. в разделе [EM_GETPARAFORMAT](/windows/desktop/Controls/em-getparaformat) сообщение и `PARAFORMAT` и `PARAFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [CRichEditCtrl::SetParaFormat](#setparaformat).  
  
##  <a name="getpunctuation"></a>  CRichEditCtrl::GetPunctuation  
 Получает текущий знаков препинания в элементе управления rich edit.  
  
```  
BOOL GetPunctuation(
    UINT fType,  
    PUNCTUATION* lpPunc) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *fType*  
 Флаг типа пунктуации, как описано в разделе *fType* параметр [EM_GETPUNCTUATION](/windows/desktop/Controls/em-getpunctuation) в пакете Windows SDK.  
  
 *lpPunc*  
 Указатель на [ПУНКТУАЦИИ](/windows/desktop/api/richedit/ns-richedit-_punctuation) структуры, как описано в пакете Windows SDK.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если операция выполнена успешно; в противном случае 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член доступен только в азиатских языках версиях операционной системы.  
  
##  <a name="getrect"></a>  CRichEditCtrl::GetRect  
 Возвращает прямоугольник, форматирования для данного `CRichEditCtrl` объекта.  
  
```  
void GetRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *lpRect*  
 [CRect](../../atl-mfc-shared/reference/crect-class.md) или указатель на [RECT](../../mfc/reference/rect-structure1.md) для получения прямоугольника форматирования данного `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 В прямоугольнике форматирования — это ограничивающий прямоугольник для текста. Это значение не зависит от размера `CRichEditCtrl` объекта.  
  
 Дополнительные сведения см. в разделе [EM_GETRECT](/windows/desktop/Controls/em-getrect) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [LimitText](#limittext).  
  
##  <a name="getredoname"></a>  CRichEditCtrl::GetRedoName  
 Извлекает тип далее действия, доступные в очереди повторов, если таковые имеются.  
  
```  
UNDONAMEID GetRedoName() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 В случае успешного выполнения `GetRedoName` возвращает [UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-_undonameid) тип перечисления, указывающее тип следующего действия в очереди повторов элемента управления. Пуста ли очередь повтора или неизвестного типа, если действие повтора в очереди `GetRedoName` возвращает 0.  
  
### <a name="remarks"></a>Примечания  
 Типы действий, которые можно отменить или повторить включают ввода, удаления, перемещения, вырезания и операции вставки. Эти сведения можно использовать для приложений, предоставляющих расширенные пользовательский интерфейс для отмены и повтора операций, например поле с раскрывающимся списком redoable действий.  
  
##  <a name="getsel"></a>  CRichEditCtrl::GetSel  
 Извлекает границы области текущего выделения в этом `CRichEditCtrl` объекта.  
  
```  
void GetSel(CHARRANGE& cr) const;  
  
void GetSel(
    long& nStartChar,  
    long& nEndChar) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *CR*  
 Ссылка на [CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) структуру для получения границы текущего выделенного фрагмента.  
  
 *nStartChar*  
 Отсчитываемый от нуля индекс первого символа в текущем выделении.  
  
 *nEndChar*  
 Отсчитываемый от нуля индекс последнего символа в текущем выделении.  
  
### <a name="remarks"></a>Примечания  
 Две формы этой функции предоставляют альтернативные способы получить границы для выделения. Выполните краткое описание каждого из этих форм.  
  
- **GetSel (** `cr` **)** используемый этой формой `CHARRANGE` структура с его `cpMin` и `cpMax` границы возвращаемых участников.  
  
- **GetSel (** `nStartChar` **,** `nEndChar` **)** Эта форма возвращает границы в параметрах *nStartChar* и *nEndChar* .  
  
 Выделение включает все, что, если начало (`cpMin` или *nStartChar*) равно 0 и окончания (`cpMax` или *nEndChar*) является - 1.  
  
 Дополнительные сведения см. в разделе [EM_EXGETSEL](/windows/desktop/Controls/em-exgetsel) сообщение и [CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]  
  
##  <a name="getselectioncharformat"></a>  CRichEditCtrl::GetSelectionCharFormat  
 Получает символ форматирования атрибуты текущего выделенного фрагмента.  
  
```  
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *CF*  
 В первой версии, указатель на [CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat) структуру для получения атрибутов текущего выделенного фрагмента форматирования символов.  
  
 Во второй версии, указатель на [CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a) структуру, которая является расширением Rich Edit 2.0 для `CHARFORMAT` структуру для получения атрибутов текущего выделенного фрагмента форматирования символов.  
  
### <a name="return-value"></a>Возвращаемое значение  
 `dwMask` Данными-членом *cf*. Он задает символ, атрибуты форматирования, которые они единообразны во всем текущего выделения.  
  
### <a name="remarks"></a>Примечания  
 *Cf* параметр получает атрибуты первого символа в текущем выделении. Возвращаемое значение, указывающее, какие атрибуты они единообразны во всем выделения.  
  
 Дополнительные сведения см. в разделе [EM_GETCHARFORMAT](/windows/desktop/Controls/em-getcharformat) сообщение и `CHARFORMAT` и `CHARFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [SetSelectionCharFormat](#setselectioncharformat).  
  
##  <a name="getselectiontype"></a>  CRichEditCtrl::GetSelectionType  
 Определяет тип выделения в данном `CRichEditCtrl` объекта.  
  
```  
WORD GetSelectionType() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Флаги, указывающие содержимое текущего выделения. Сочетание следующих флагов:  
  
- SEL_EMPTY указывает на текущее выделение отсутствует.  
  
- SEL_TEXT указывает, что текущее выделение содержит текст.  
  
- SEL_OBJECT указывает, что текущее выделение содержит хотя бы один элемент OLE.  
  
- SEL_MULTICHAR указывает, что текущее выделение содержит более одного символа текста.  
  
- SEL_MULTIOBJECT указывает, что текущее выделение содержит более одного объекта OLE.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_SELECTIONTYPE](/windows/desktop/Controls/em-selectiontype) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]  
  
##  <a name="getseltext"></a>  CRichEditCtrl::GetSelText  
 Получение текста из текущего выделения в этом `CRichEditCtrl` объекта.  
  
```  
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;  
```  
  
### <a name="parameters"></a>Параметры  
 */ / lpBuf*  
 Указатель на буфер для получения текста в текущем выделении.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Зависит от формы:  
  
- **GetSelText (** `lpBuf` **)** число символов, копируются в *lpBuf*, не включая завершающимся нулевым значением.  
  
- **() GetSelText** строка, содержащая текущее выделение.  
  
### <a name="remarks"></a>Примечания  
 Если вы используете первой форме **GetSelText (** `lpBuf` **)**, необходимо убедиться, что буфер достаточно большим для текста, он будет получать. Вызовите [GetSel](#getsel) для определения количества символов в текущем выделении.  
  
 Дополнительные сведения см. в разделе [EM_GETSELTEXT](/windows/desktop/Controls/em-getseltext) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [CRichEditCtrl::GetSelectionType](#getselectiontype).  
  
##  <a name="gettextlength"></a>  CRichEditCtrl::GetTextLength  
 Получает длину текста, в символах, в этом `CRichEditCtrl` объекта, не включая завершающий нуль-символ.  
  
```  
long GetTextLength() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Длина текста в данном `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [WM_GETTEXTLENGTH](/windows/desktop/winmsg/wm-gettextlength) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]  
  
##  <a name="gettextlengthex"></a>  CRichEditCtrl::GetTextLengthEx  
 Вычисляет длину текста в элементе управления форматированным редактированием.  
  
```  
long GetTextLengthEx(
    DWORD dwFlags,  
    UINT uCodePage = -1) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *dwFlags*  
 Значение, указывающее метод, используемый для определения длины текста. Этот член может иметь одно или несколько значений, перечисленных в элемент флаги [GETTEXTLENGTHEX](/windows/desktop/api/richedit/ns-richedit-_gettextlengthex) описано в пакете Windows SDK.  
  
 *uCodePage*  
 Кодовая страница для перевода (CP_ACP для кодовой страницы ANSI, 1200 для Юникода).  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число символов или байтов в элементе управления. Если были заданы несовместимые флаги в *dwFlags*, эта функция-член возвращает значение E_INVALIDARG.  
  
### <a name="remarks"></a>Примечания  
 `GetTextLengthEx` предоставляет дополнительные способы определения длину текста. Он поддерживает функциональные возможности Rich Edit 2.0. См. в разделе [о элементами управления Rich Edit](/windows/desktop/Controls/about-rich-edit-controls) в Windows SDKfor Дополнительные сведения.  
  
##  <a name="gettextmode"></a>  CRichEditCtrl::GetTextMode  
 Возвращает текущий текстовый режим и отмены уровень элемента управления форматированным редактированием.  
  
```  
UINT GetTextMode() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Набор битовых флагов из [TEXTMODE](/windows/desktop/api/richedit/ne-richedit-tagtextmode) тип перечисления, как описано в пакете Windows SDK. Флаги указывают текущий режим текста, а также отменить уровень элемента управления.  
  
##  <a name="gettextrange"></a>  CRichEditCtrl::GetTextRange  
 Возвращает заданный диапазон символов.  
  
```  
int GetTextRange(
    int nFirst,  
    int nLast,  
    CString& refString) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *nFirst*  
 Индекс позиции символа, непосредственно перед первым символом в диапазоне.  
  
 *nLast*  
 Позиция символа сразу после последнего символа в диапазоне.  
  
 *refString*  
 Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объект, который будет получать текст.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число символов скопирован, не включая завершающий нуль-символ.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_GETTEXTRANGE](/windows/desktop/Controls/em-gettextrange) в пакете Windows SDK.  
  
 `GetTextRange` поддерживает функциональные возможности Rich Edit 2.0. См. в разделе [о элементами управления Rich Edit](/windows/desktop/Controls/about-rich-edit-controls) в Windows SDKfor Дополнительные сведения.  
  
##  <a name="getundoname"></a>  CRichEditCtrl::GetUndoName  
 Возвращает тип следующего действия, доступные в очереди отмены, если таковые имеются.  
  
```  
UNDONAMEID GetUndoName() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Если действие отмены находится в очереди отмены элемента управления, `GetUndoName` возвращает [UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-_undonameid) тип перечисления, указывающее тип следующего действия в очереди. Если очереди отмены пуст или неизвестного типа, если действие отмены в очереди `GetUndoName` возвращает 0.  
  
### <a name="remarks"></a>Примечания  
 Типы действий, которые можно отменить или повторить включают ввода, удаления, перемещения, вырезания и операции вставки. Эти сведения можно использовать для приложений, предоставляющих расширенные пользовательский интерфейс для отмены и повтора операций, например поле с раскрывающимся списком действий, которые могут быть отменены.  
  
##  <a name="getwordwrapmode"></a>  CRichEditCtrl::GetWordWrapMode  
 Извлекает текущий перенос слов и параметров разбиения на слова для элемента управления форматированным редактированием.  
  
```  
UINT GetWordWrapMode() const;  
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущий перенос слов и разбиение по словам параметры. Эти параметры описаны в [EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) в пакете Windows SDK.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член доступен только для азиатских языков версий операционной системы.  
  
##  <a name="hideselection"></a>  CRichEditCtrl::HideSelection  
 Изменяет видимость выделения.  
  
```  
void HideSelection(
    BOOL bHide,  
    BOOL bPerm);
```  
  
### <a name="parameters"></a>Параметры  
 *bHide*  
 Указывает, если выделение следует показано или скрыто, значение TRUE, чтобы скрыть выделение.  
  
 *bPerm*  
 Указывает, если это изменение видимости для выделения должно быть постоянным.  
  
### <a name="remarks"></a>Примечания  
 Когда *bPerm* имеет значение TRUE, он изменяет параметр ECO_NOHIDESEL для данного `CRichEditCtrl` объекта. Краткое описание этого параметра, см. в разделе [SetOptions](#setoptions). Эту функцию можно использовать, чтобы задать все параметры для этого `CRichEditCtrl` объекта.  
  
 Дополнительные сведения см. в разделе [EM_HIDESELECTION](/windows/desktop/Controls/em-hideselection) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]  
  
##  <a name="limittext"></a>  CRichEditCtrl::LimitText  
 Ограничивает длину текста, который пользователь может ввести в элемент управления.  
  
```  
void LimitText(long nChars = 0);
```  
  
### <a name="parameters"></a>Параметры  
 *nChars*  
 Задает длину (в байтах), пользователь может ввести текст. Если этот параметр равен 0 (значение по умолчанию), длина текста присваивается 64 КБ.  
  
### <a name="remarks"></a>Примечания  
 Изменение текста ограничения ограничивает только текст, который пользователь может ввести. Он не оказывает влияния на любой текст уже в элементе управления, а также влияет на длину текста, копируются в элемент управления редактирования, [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) функции-члена в `CWnd`. Если приложение использует `SetWindowText` функции, чтобы поместить текст в элемент управления редактированием, чем указано в вызове `LimitText`, пользователь может удалять любые текстовые строки в элементе управления редактирования. Тем не менее ограничение текст не позволит пользователю заменять существующий текст новым текстом, если не удалить текущее выделение вызывает текста упадет ниже предела текста.  
  
> [!NOTE]
>  Для ограничения текста каждый элемент OLE считается как один символ.  
  
 Дополнительные сведения см. в разделе [EM_EXLIMITTEXT](/windows/desktop/Controls/em-exlimittext) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]  
  
##  <a name="linefromchar"></a>  CRichEditCtrl::LineFromChar  
 Получает номер строки, содержащей символ с указанным индексом.  
  
```  
long LineFromChar(long nIndex) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *nIndex*  
 Содержит отсчитываемый от нуля индекс значение для требуемого знака в тексте элемента управления, или значение -1. Если *nIndex* равно -1, он задает текущую строку, то есть строки, содержащей курсор.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Отсчитываемый от нуля номер строки, содержащей индекс символа, определяемое *nIndex*. Если *nIndex* равно -1, возвращается номер строки, который содержит первый символ выделения. Если ничего не выбрано, возвращается текущий номер строки.  
  
### <a name="remarks"></a>Примечания  
 Индекс символа — количество символов с начала элемента управления форматированным редактированием. Подсчет символов, объект OLE считается как один символ.  
  
 Дополнительные сведения см. в разделе [EM_EXLINEFROMCHAR](/windows/desktop/Controls/em-exlinefromchar) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]  
  
##  <a name="lineindex"></a>  CRichEditCtrl::LineIndex  
 Получает индекс строки в рамках этого `CRichEditCtrl` объекта.  
  
```  
int LineIndex(int nLine = -1) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *бота*  
 Содержит значение индекса для нужной строке в тексте элемента управления, или значение -1. Если *бота* равно -1, он задает текущую строку, то есть строки, содержащей курсор.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Индекс строки, указанной в *бота* или -1, если номер строки больше, то число строк в элементе управления.  
  
### <a name="remarks"></a>Примечания  
 Индекс символа — количество символов с начала элемента управления форматированным редактированием в указанную строку.  
  
 Дополнительные сведения см. в разделе [EM_LINEINDEX](https://msdn.microsoft.com/library/windows/desktop/bb761611) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]  
  
##  <a name="linelength"></a>  CRichEditCtrl::LineLength  
 Получает длину строки в элементе управления rich edit.  
  
```  
int LineLength(int nLine = -1) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *бота*  
 Указывает символьный индекс символа в строке, длина которого требуется получить. Если этот параметр имеет значение -1, возвращается длина текущей строки (строки, содержащей курсор), без учета длины любого выбранного текста в строке. Когда `LineLength` вызывается для элемента управления одной строкой, этот параметр учитывается.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Когда `LineLength` вызывается для элемента управления редактирования несколько строк, возвращаемое значение имеет длину (в TCHAR) строки, номер *бота*.  Он не включает символ возврата каретки в конце строки. Когда `LineLength` вызывается для элемента управления одной строкой, возвращаемое значение имеет длину (в TCHAR) текст в элементе управления. Если бота больше, чем количество символов в элементе управления, возвращаемое значение равно нулю.
  
### <a name="remarks"></a>Примечания  
 Используйте [LineIndex](#lineindex) функция-член для извлечения индекс символа, определяющий номер строки, заданной в данном `CRichEditCtrl` объекта.  
  
 Дополнительные сведения см. в разделе [EM_LINELENGTH](/windows/desktop/Controls/em-linelength) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [LineIndex](#lineindex).  
  
##  <a name="linescroll"></a>  CRichEditCtrl::LineScroll  
 Прокрутка текста элемента управления edit несколько строк.  
  
```  
void LineScroll(
    int nLines,  
    int nChars = 0);
```  
  
### <a name="parameters"></a>Параметры  
 *nLines*  
 Указывает количество строк для прокрутки по вертикали.  
  
 *nChars*  
 Указывает количество позиций знаков для прокрутки по горизонтали. Это значение игнорируется, если для элемента управления форматированным редактированием ES_RIGHT или ES_CENTER стиля. [Изменение стилей](../../mfc/reference/styles-used-by-mfc.md#edit-styles) указываются в [создать](#create).  
  
### <a name="remarks"></a>Примечания  
 Поле ввода не прокручивается по вертикали после последней строки текста в элементе управления. Если текущий строка плюс количество строк, определяемое *nLines* превышает общее число строк в элементе управления, значение корректируются таким образом, чтобы в последней строке элемента управления редактирования прокручиваются к верхней части окна элемента управления edit.  
  
 `LineScroll` используется для прокрутки по горизонтали после последнего символа любой строки.  
  
 Дополнительные сведения см. в разделе [EM_LINESCROLL](/windows/desktop/Controls/em-linescroll) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [GetFirstVisibleLine](#getfirstvisibleline).  
  
##  <a name="paste"></a>  CRichEditCtrl::Paste  
 Вставляет данные из буфера обмена в `CRichEditCtrl` в позиции курсора, расположение курсора.  
  
```  
void Paste();
```  
  
### <a name="remarks"></a>Примечания  
 Данные вставляются только в том случае, если буфер обмена содержит данные в нераспознаваемом формате.  
  
 Дополнительные сведения см. в разделе [WM_PASTE](/windows/desktop/dataxchg/wm-paste) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]  
  
##  <a name="pastespecial"></a>  CRichEditCtrl::PasteSpecial  
 Вставка данных в определенном формате буфера обмена в это `CRichEditCtrl` объекта.  
  
```  
void PasteSpecial(
    UINT nClipFormat,  
    DWORD dvAspect = 0,  
    HMETAFILE hMF = 0);
```  
  
### <a name="parameters"></a>Параметры  
 *nClipFormat*  
 Формат буфера обмена для вставки в данную коллекцию `CRichEditCtrl` объекта.  
  
 *dvAspect*  
 Аспект устройства, для данных, извлекаемых из буфера обмена.  
  
 *hMF*  
 Дескриптор метафайла, содержащий символическое представление объекта для вставки.  
  
### <a name="remarks"></a>Примечания  
 Новый материал вставляется в позицию курсора, расположение курсора.  
  
 Дополнительные сведения см. в разделе [EM_PASTESPECIAL](/windows/desktop/Controls/em-pastespecial) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]  
  
##  <a name="posfromchar"></a>  CRichEditCtrl::PosFromChar  
 Извлекает клиентские координаты области указанного символа в элемент управления редактированием.  
  
```  
CPoint PosFromChar(UINT nChar) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *NChar*  
 Отсчитываемый от нуля индекс символа.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Позиция символа, (x, y). Для элемента управления одной строкой Координата по оси y всегда равно нулю.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) в пакете Windows SDK.  
  
##  <a name="redo"></a>  CRichEditCtrl::Redo  
 Повтор следующего действия в очереди повторов элемента управления.  
  
```  
BOOL Redo();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Дополнительные сведения см. в разделе [EM_REDO](/windows/desktop/Controls/em-redo) в пакете Windows SDK.  
  
##  <a name="replacesel"></a>  CRichEditCtrl::ReplaceSel  
 Заменяет текущее выделение в этом `CRichEditCtrl` объект с указанным текстом.  
  
```  
void ReplaceSel(
    LPCTSTR lpszNewText,  
    BOOL bCanUndo = FALSE);
```  
  
### <a name="parameters"></a>Параметры  
 *lpszNewText*  
 Указатель на заканчивающуюся нулем строку, содержащую текст замены.  
  
 *bCanUndo*  
 Чтобы указать, что эту функцию можно отменить, значение этого параметра равно TRUE. Значение по умолчанию — FALSE.  
  
### <a name="remarks"></a>Примечания  
 Чтобы заменить весь текст в этом `CRichEditCtrl` , используйте [CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).  
  
 Если текущее выделение отсутствует, замещающий текст вставляется в позицию курсора, то есть текущее расположение курсора.  
  
 Эта функция отформатирует вставленного текста с помощью существующих форматирование символов. При замене весь диапазон текста (путем вызова `SetSel`(0, -1) перед вызовом метода `ReplaceSel`), имеется символ абзаца, который сохраняет форматирование в предыдущем абзаце, которой в унаследованы вновь вставленного текста конца.  
  
 Дополнительные сведения см. в разделе [EM_REPLACESEL](/windows/desktop/Controls/em-replacesel) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [LineIndex](#lineindex).  
  
##  <a name="requestresize"></a>  CRichEditCtrl::RequestResize  
 Это заставляет `CRichEditCtrl` объект для отправки сообщений уведомления EN_REQUESTRESIZE своему родительскому окну.  
  
```  
void RequestResize();
```  
  
### <a name="remarks"></a>Примечания  
 Эта функция полезна во время [CWnd::OnSize](../../mfc/reference/cwnd-class.md#onsize) обработки неограниченные `CRichEditCtrl` объекта.  
  
 Дополнительные сведения см. в разделе [EM_REQUESTRESIZE](/windows/desktop/Controls/em-requestresize) сообщение и **элементами управления неограниченные Rich Edit** раздел [о элементами управления Rich Edit](/windows/desktop/Controls/about-rich-edit-controls) в пакете Windows SDK.  
  
##  <a name="setautourldetect"></a>  CRichEditCtrl::SetAutoURLDetect  
 Задает элемент управления форматированным редактированием для автоматического обнаружения URL-адрес.  
  
```  
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 *bEnable*  
 Указывает, задан ли элемент управления для автоматического обнаружения URL-адрес. Значение TRUE, если он включен. Если значение равно FALSE, то он будет отключен.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Нуль, если успешно, в противном случае ненулевое значение. Например сообщение может завершиться ошибкой из-за нехватки памяти.  
  
### <a name="remarks"></a>Примечания  
 Если параметр включен, управления форматированным редактированием будет сканировать текста, чтобы определить, совпадает ли стандартный формат URL-адрес. Список из следующих форматов URL-адрес, см. в разделе [EM_AUTOURLDETECT](/windows/desktop/Controls/em-autourldetect) в пакете Windows SDK.  
  
> [!NOTE]
>  Не устанавливайте `SetAutoURLDetect` значение true, если элемент управления редактирования использует CFE_LINK эффект для текста, отличный от URL-адреса. `SetAutoURLDetect` включает этот эффект для URL-адресов и отключает его для всего текста. См. в разделе [EN_LINK](/windows/desktop/Controls/en-link) Дополнительные сведения о влиянии CFE_LINK.  
  
##  <a name="setbackgroundcolor"></a>  CRichEditCtrl::SetBackgroundColor  
 Задает цвет фона для данного `CRichEditCtrl` объекта.  
  
```  
COLORREF SetBackgroundColor(
    BOOL bSysColor,  
    COLORREF cr);
```  
  
### <a name="parameters"></a>Параметры  
 *bSysColor*  
 Указывает, если цвет фона должно быть присвоено значение системы. Если это значение равно TRUE, *cr* учитывается.  
  
 *CR*  
 Запрошенный фоновый цвет. Используется, только если *bSysColor* имеет значение FALSE.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Предыдущий цвет фона для данного `CRichEditCtrl` объекта.  
  
### <a name="remarks"></a>Примечания  
 Цвет фона можно задать значение system или с заданным [COLORREF](/windows/desktop/gdi/colorref) значение.  
  
 Дополнительные сведения см. в разделе [EM_SETBKGNDCOLOR](/windows/desktop/Controls/em-setbkgndcolor) сообщение и [COLORREF](/windows/desktop/gdi/colorref) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]  
  
##  <a name="setdefaultcharformat"></a>  CRichEditCtrl::SetDefaultCharFormat  
 Задает форматирование атрибуты для нового текста в этом символов `CRichEditCtrl` объекта.  
  
```  
BOOL SetDefaultCharFormat(CHARFORMAT& cf);  
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```  
  
### <a name="parameters"></a>Параметры  
 *CF*  
 В первой версии, указатель на [CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat) структуру, содержащую новый символ по умолчанию атрибуты форматирования.  
  
 Во второй версии, указатель на [CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a) структуру, которая является расширением Rich Edit 2.0 для `CHARFORMAT` структура, содержащая атрибутов форматирования символов по умолчанию.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Только атрибуты, указанные фильтром `dwMask` членом *cf* изменяются при помощи этой функции.  
  
 Дополнительные сведения см. в разделе [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat) сообщение и `CHARFORMAT` и `CHARFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]  
  
##  <a name="seteventmask"></a>  CRichEditCtrl::SetEventMask  
 Задает маску события для данного `CRichEditCtrl` объекта.  
  
```  
DWORD SetEventMask(DWORD dwEventMask);
```  
  
### <a name="parameters"></a>Параметры  
 *dwEventMask*  
 Новая маска событий для данного `CRichEditCtrl` объекта.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Предыдущий маску события.  
  
### <a name="remarks"></a>Примечания  
 Маска событие указывает, какие сообщения уведомления `CRichEditCtrl` объект отправляет своему родительскому окну.  
  
 Дополнительные сведения см. в разделе [EM_SETEVENTMASK](/windows/desktop/Controls/em-seteventmask) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]  
  
##  <a name="setmodify"></a>  CRichEditCtrl::SetModify  
 Задает или удаляет значение измененного флага для элемента управления.  
  
```  
void SetModify(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 *bModified*  
 Значение TRUE указывает, что текст был изменен, и значение FALSE указывает, что он не меняется. По умолчанию имеет значение измененного флага.  
  
### <a name="remarks"></a>Примечания  
 Измененного флага указывает, был ли изменен текст внутри элемента управления редактирования. Автоматически устанавливается каждый раз, когда пользователь изменяет текст. Его значение можно получить с помощью [GetModify](#getmodify) функция-член.  
  
 Дополнительные сведения см. в разделе [EM_SETMODIFY](/windows/desktop/Controls/em-setmodify) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [GetModify](#getmodify).  
  
##  <a name="setolecallback"></a>  CRichEditCtrl::SetOLECallback  
 Это дает `CRichEditCtrl` объекта `IRichEditOleCallback` , который используется для доступа к ресурсам, связанные с OLE и сведения.  
  
```  
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```  
  
### <a name="parameters"></a>Параметры  
 *pCallback*  
 Указатель на [IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback) объекта, `CRichEditCtrl` объект будет использовать для получения ресурсов, связанные с OLE и сведений.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Это `CRichEditCtrl` объект вызовет [IUnknown::AddRef](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) Увеличиваемый счетчик использования COM-объекта, заданного параметром *pCallback*.  
  
 Дополнительные сведения см. в разделе [EM_SETOLECALLBACK](/windows/desktop/Controls/em-setolecallback) сообщение и [IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback) интерфейс в пакете Windows SDK.  
  
##  <a name="setoptions"></a>  CRichEditCtrl::SetOptions  
 Задает параметры для этого `CRichEditCtrl` объекта.  
  
```  
void SetOptions(
    WORD wOp,  
    DWORD dwFlags);
```  
  
### <a name="parameters"></a>Параметры  
 *wOp*  
 Указывает тип операции. Одно из следующих значений:  
  
- ECOOP_SET задание параметров существующим *dwFlags*.  
  
- ECOOP_OR объединение текущего параметры с разрешениями, заданными *dwFlags*.  
  
- ECOOP_AND сохранять только для текущего параметры, заданные по *dwFlags*.  
  
- Логически ECOOP_XOR исключающее или текущие параметры с разрешениями, заданными *dwFlags*.  
  
 *dwFlags*  
 Широкие возможности редактирования. Значения флага, перечислены в разделе "Примечания".  
  
### <a name="remarks"></a>Примечания  
 Параметры могут представлять собой сочетание следующих значений:  
  
- Дважды щелкните ECO_AUTOWORDSELECTION автоматическое выделение слов на.  
  
- ECO_AUTOVSCROLL автоматическая прокрутка текста справа по 10 символов, при вводе символа в конце строки. Когда пользователь нажимает клавишу ВВОД, элемент управления прокручивается весь текст обратно к нулю.  
  
- ECO_AUTOHSCROLL автоматическая прокрутка текста вверх на одну страницу, когда пользователь нажимает клавишу ВВОД в последней строке.  
  
- ECO_NOHIDESEL отключает поведение по умолчанию для элемента управления. Поведение по умолчанию скрывает выделение, когда элемент управления теряет фокус ввода и показано выделение, когда элемент управления получает фокус ввода. При указании ECO_NOHIDESEL инвертируется выделенный текст, даже если элемент управления имеет фокус.  
  
- ECO_READONLY пользователю запрещено изменение текста в элементе управления.  
  
- ECO_WANTRETURN указывает, что символ возврата каретки вставляться в том случае, когда пользователь нажимает клавишу ВВОД при вводе текста в несколько строк расширенных поля ввода в диалоговом окне. Если вы не укажете этот стиль, нажатие клавиши ВВОД отправляет команду родительскому окну элемента управления форматированным редактированием, который имитирует нажатие кнопки по умолчанию родительского окна (например, кнопку OK в диалоговом окне). Этот стиль не влияет на однострочный элемент управления.  
  
- ECO_SAVESEL сохраняет выделение, если элемент управления теряет фокус. По умолчанию выбраны все содержимое элемента управления, когда он получает фокус.  
  
- Рисует ECO_VERTICAL текста и объектов в вертикальном направлении. Доступно только для азиатских языков.  
  
 Дополнительные сведения см. в разделе [EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]  
  
##  <a name="setparaformat"></a>  CRichEditCtrl::SetParaFormat  
 Задает атрибуты для текущего выделения в этом форматирования абзаца `CRichEditCtrl` объекта.  
  
```  
BOOL SetParaFormat(PARAFORMAT& pf);  
BOOL SetParaFormat(PARAFORMAT2& pf);
```  
  
### <a name="parameters"></a>Параметры  
 *Общая папка*  
 В первой версии, указатель на [PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-_paraformat) атрибуты форматирования абзаца структура, содержащая новое значение по умолчанию.  
  
 Во второй версии, указатель на [PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2) структуру, которая является расширением Rich Edit 2.0 для `PARAFORMAT` структуры, удерживая атрибутов форматирования символов по умолчанию.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Только атрибуты, указанные фильтром `dwMask` членом *pf* изменяются при помощи этой функции.  
  
 Дополнительные сведения см. в разделе [EM_SETPARAFORMAT](/windows/desktop/Controls/em-setparaformat) сообщение и `PARAFORMAT` и `PARAFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]  
  
##  <a name="setpunctuation"></a>  CRichEditCtrl::SetPunctuation  
 Задает знаки препинания в элементе управления rich edit.  
  
```  
BOOL SetPunctuation(
    UINT fType,  
    PUNCTUATION* lpPunc);
```  
  
### <a name="parameters"></a>Параметры  
 *fType*  
 Флаг, знаки препинания. Список возможных значений см. в разделе *fType* параметр для [EM_SETPUNCTUATION](/windows/desktop/Controls/em-setpunctuation) в пакете Windows SDK.  
  
 *lpPunc*  
 Указатель на [ПУНКТУАЦИИ](/windows/desktop/api/richedit/ns-richedit-_punctuation) структуры, как описано в пакете Windows SDK.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если успешно, иначе — 0.  
  
### <a name="remarks"></a>Примечания  
 Эта функция-член доступен для азиатских языков только версии операционной системы.  
  
##  <a name="setreadonly"></a>  CRichEditCtrl::SetReadOnly  
 Изменяет параметр ECO_READONLY для данного `CRichEditCtrl` объекта.  
  
```  
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```  
  
### <a name="parameters"></a>Параметры  
 *bReadOnly*  
 Указывает, если данный `CRichEditCtrl` объект должен быть только для чтения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Краткое описание этого параметра, см. в разделе [SetOptions](#setoptions). Эту функцию можно использовать, чтобы задать все параметры для этого `CRichEditCtrl` объекта.  
  
 Дополнительные сведения см. в разделе [EM_SETREADONLY](/windows/desktop/Controls/em-setreadonly) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]  
  
##  <a name="setrect"></a>  CRichEditCtrl::SetRect  
 Задает для данного прямоугольника форматирования `CRichEditCtrl` объекта.  
  
```  
void SetRect(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Параметры  
 *lpRect*  
 [CRect](../../atl-mfc-shared/reference/crect-class.md) или указатель на [RECT](../../mfc/reference/rect-structure1.md) указывает новые границы для прямоугольника форматирования.  
  
### <a name="remarks"></a>Примечания  
 В прямоугольнике форматирования имеет ограничивающего прямоугольника для текста. Ограничивающим прямоугольником не зависит от размера окна элемента управления форматированным редактированием. При этом `CRichEditCtrl` сначала создается объект, прямоугольника форматирования — это тот же размер, что клиентской области окна. Используйте `SetRect` для увеличения или меньше, чем окно широкие возможности редактирования в прямоугольнике форматирования.  
  
 Дополнительные сведения см. в разделе [EM_SETRECT](/windows/desktop/Controls/em-setrect) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]  
  
##  <a name="setsel"></a>  CRichEditCtrl::SetSel  
 Задает выделение в рамках этого `CRichEditCtrl` объекта.  
  
```  
void SetSel(
    long nStartChar,  
    long nEndChar);  
  
void SetSel(CHARRANGE& cr);
```  
  
### <a name="parameters"></a>Параметры  
 *nStartChar*  
 Отсчитываемый от нуля индекс первого символа для выделения.  
  
 *nEndChar*  
 Отсчитываемый от нуля индекс последнего символа для выделения.  
  
 *CR*  
 [CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) структуры, который содержит границы текущего выделенного фрагмента.  
  
### <a name="remarks"></a>Примечания  
 Две формы этой функции предоставляют альтернативные способы задать границы для выделения. Выполните краткое описание каждого из этих форм.  
  
- **SetSel (** `cr` **)** используемый этой формой `CHARRANGE` структура с его `cpMin` и `cpMax` членов, чтобы задать границы.  
  
- **SetSel (** `nStartChar` **,** `nEndChar` **)** этой формы можно использовать параметры *nStartChar* и *nEndChar*задать границы.  
  
 Курсор помещается в конце соответствующий больше начала (`cpMin` или *nStartChar*) и окончания (`cpMax` или *nEndChar*) индексы. Эта функция прокручивает содержимое элемента `CRichEditCtrl` , чтобы курсор является видимым.  
  
 Чтобы выбрать весь текст в этом `CRichEditCtrl` , вызовите `SetSel` с Начальный индекс 0, и конечный индекс - 1.  
  
 Дополнительные сведения см. в разделе [EM_EXSETSEL](/windows/desktop/Controls/em-exsetsel) сообщение и [CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [GetSel](#getsel).  
  
##  <a name="setselectioncharformat"></a>  CRichEditCtrl::SetSelectionCharFormat  
 Задает атрибуты для текста в текущее выделение в это форматирование символов `CRichEditCtrl` объекта.  
  
```  
BOOL SetSelectionCharFormat(CHARFORMAT& cf);  
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```  
  
### <a name="parameters"></a>Параметры  
 *CF*  
 В первой версии, указатель на [CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat) структура, содержащая символ форматирования новых атрибутов для текущего выделения.  
  
 Во второй версии, указатель на [CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a) структуру, которая является расширением Rich Edit 2.0 для `CHARFORMAT` структура, содержащая новый символ форматирования атрибутов для текущего выделения.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Только атрибуты, указанные фильтром `dwMask` членом *cf* изменяются при помощи этой функции.  
  
 Дополнительные сведения см. в разделе [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat) и `CHARFORMAT` и `CHARFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]  
  
##  <a name="settargetdevice"></a>  CRichEditCtrl::SetTargetDevice  
 Задает целевой ширину устройства и строку, используемую для WYSIWYG (что видишь, то и получаете) форматирования в этом `CRichEditCtrl` объекта.  
  
```  
BOOL SetTargetDevice(
    HDC hDC,  
    long lLineWidth);

 
BOOL SetTargetDevice(
    CDC& dc,  
    long lLineWidth);
```  
  
### <a name="parameters"></a>Параметры  
 *hDC*  
 Дескриптор контекста устройства для нового целевого устройства.  
  
 *lLineWidth*  
 Толщина линии, используемый для форматирования.  
  
 *dc*  
 [CDC](../../mfc/reference/cdc-class.md) для нового целевого устройства.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 При успешном выполнении эта функция управления форматированным редактированием оно принадлежит, контекст, передаваемый в качестве параметра. В этом случае вызывающей функции не должен уничтожить контекст устройства.  
  
 Дополнительные сведения см. в разделе [EM_SETTARGETDEVICE](/windows/desktop/Controls/em-settargetdevice) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]  
  
##  <a name="settextmode"></a>  CRichEditCtrl::SetTextMode  
 Задает уровень режима или отмены и повтора текста для элемента управления форматированным редактированием.  
  
```  
BOOL SetTextMode(UINT fMode);
```  
  
### <a name="parameters"></a>Параметры  
 *fMode*  
 Задает новые параметры для элемента управления режим и отмены уровня параметры текста. Список возможных значений, см. в разделе параметр режима для [EM_SETTEXTMODE](/windows/desktop/Controls/em-settextmode) в пакете Windows SDK.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Нуль, если успешно, в противном случае ненулевое значение.  
  
### <a name="remarks"></a>Примечания  
 Описание режимов текста см. в разделе EM_SETTEXTMODE в пакете Windows SDK.  
  
 Эта функция-член не выполняется, если элемент управления содержит текст. Чтобы убедиться, что элемент пуст, отправьте [WM_SETTEXT](/windows/desktop/winmsg/wm-settext) сообщений с пустой строкой.  
  
##  <a name="setundolimit"></a>  CRichEditCtrl::SetUndoLimit  
 Задает максимальное количество действий, которые можно хранить в очереди отмены.  
  
```  
UINT SetUndoLimit(UINT nLimit);
```  
  
### <a name="parameters"></a>Параметры  
 *nLimit*  
 Указывает максимальное количество действий, которые могут храниться в очереди отмены. Значение 0 для отключения отката.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Поле ввода нового максимальное число действий отката для сложных данных.  
  
### <a name="remarks"></a>Примечания  
 По умолчанию максимальное количество действий в очереди отмены равно 100. Если увеличение этого числа, должно существовать недостаточно памяти, чтобы вместить новый. Для повышения производительности ограничить до наименьшее возможное значение.  
  
##  <a name="setwordcharformat"></a>  CRichEditCtrl::SetWordCharFormat  
 Задает форматирование атрибутов для текущего выбранного слова в этом символов `CRichEditCtrl` объекта.  
  
```  
BOOL SetWordCharFormat(CHARFORMAT& cf);  
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```  
  
### <a name="parameters"></a>Параметры  
 *CF*  
 В первой версии, указатель на [CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat) структура, содержащая символ форматирования новых атрибутов для текущего выбранного слова.  
  
 Во второй версии, указатель на [CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a) структуру, которая является расширением Rich Edit 2.0 для `CHARFORMAT` структура, содержащая символ новой атрибутов для текущего выбранного слова форматирования.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Только атрибуты, указанные фильтром `dwMask` членом *cf* изменяются при помощи этой функции.  
  
 Дополнительные сведения см. в разделе [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat) сообщение и `CHARFORMAT` и `CHARFORMAT2` структур в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]  
  
##  <a name="setwordwrapmode"></a>  CRichEditCtrl::SetWordWrapMode  
 Установка параметров переноса слов и разбиение по словам для сложных данных элемента управления edit.  
  
```  
UINT SetWordWrapMode(UINT uFlags) const;  
```  
  
### <a name="parameters"></a>Параметры  
 *uFlags*  
 Параметры для переноса и разбиение по словам. Список возможных параметров, см. в разделе [EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) в пакете Windows SDK.  
  
### <a name="return-value"></a>Возвращаемое значение  
 Текущий переноса по словам и параметры.  
  
### <a name="remarks"></a>Примечания  
 Это сообщение доступно только в версиях азиатских языков операционной системы.  
  
##  <a name="stopgrouptyping"></a>  CRichEditCtrl::StopGroupTyping  
 Останавливает управления сбор дополнительных вводит текущее действие отмены действия.  
  
```  
void StopGroupTyping();
```  
  
### <a name="remarks"></a>Примечания  
 Элемент управления сохраняет следующее действие ввода, если таковое имеется, в новое действие в очереди отмены.  
  
 Дополнительные сведения см. в разделе [EM_STOPGROUPTYPING](/windows/desktop/Controls/em-stopgrouptyping) в пакете Windows SDK.  
  
##  <a name="streamin"></a>  CRichEditCtrl::StreamIn  
 Заменяет текст в этом `CRichEditCtrl` с текстом из указанного входного потока.  
  
```  
long StreamIn(
    int nFormat,  
    EDITSTREAM& es);
```  
  
### <a name="parameters"></a>Параметры  
 *nFormat*  
 Флаги, указывающие форматы входных данных. Дополнительные сведения см. в разделе "Примечания".  
  
 *ES*  
 [EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) структуры, указывающий входной поток. Дополнительные сведения см. в разделе "Примечания".  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число прочитанных знаков из входного потока.  
  
### <a name="remarks"></a>Примечания  
 Значение *nFormat* должно быть одно из следующих:  
  
- Указывает SF_TEXT чтения только текст.  
  
- SF_RTF указывает текста и форматирование.  
  
 Одно из этих значений могут сочетаться с SFF_SELECTION. Если указан SFF_SELECTION `StreamIn` заменяет текущее выделение содержимого входного потока. Если он не указан, `StreamIn` заменяет все содержимое `CRichEditCtrl` объекта.  
  
 В `EDITSTREAM` параметр *es*, указать функцию обратного вызова, который заполняет буфер с текстом. Эта функция обратного вызова вызывается несколько раз, пока не будет исчерпано входного потока.  
  
 Дополнительные сведения см. в разделе [EM_STREAMIN](/windows/desktop/Controls/em-streamin) сообщение и [EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]  
  
 [!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]  
  
##  <a name="streamout"></a>  CRichEditCtrl::StreamOut  
 Записывает содержимое данного `CRichEditCtrl` объекта в указанный выходной поток.  
  
```  
long StreamOut(
    int nFormat,  
    EDITSTREAM& es);
```  
  
### <a name="parameters"></a>Параметры  
 *nFormat*  
 Флаги, указывающие форматов вывода данных. Дополнительные сведения см. в разделе "Примечания".  
  
 *ES*  
 [EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) структуру, указав в выходной поток. Дополнительные сведения см. в разделе "Примечания".  
  
### <a name="return-value"></a>Возвращаемое значение  
 Число символов, записанных в поток вывода.  
  
### <a name="remarks"></a>Примечания  
 Значение *nFormat* должно быть одно из следующих:  
  
- Указывает SF_TEXT записи только текст.  
  
- SF_RTF указывает запись текста и форматирование.  
  
- SF_RTFNOOBJS указывает запись текста и форматирования, заменив элементы OLE с пробелами.  
  
- SF_TEXTIZED указывает запись текста и форматирования, с помощью текстовые представления элементов OLE.  
  
 Эти значения могут объединяться с SFF_SELECTION. Если указан SFF_SELECTION `StreamOut` записывает текущее выделение в выходной поток. Если он не указан, `StreamOut` записывает все содержимое `CRichEditCtrl` объекта.  
  
 В `EDITSTREAM` параметр *es*, указать функцию обратного вызова, который заполняет буфер текста. Эта функция обратного вызова вызывается несколько раз, пока не будет исчерпано в выходной поток.  
  
 Дополнительные сведения см. в разделе [EM_STREAMOUT](/windows/desktop/Controls/em-streamout) сообщение и [EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) структуры в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
 [!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]  
  
 [!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]  
  
##  <a name="undo"></a>  CRichEditCtrl::Undo  
 Отменяет последнюю операцию в элементе управления форматированным редактированием.  
  
```  
BOOL Undo();
```  
  
### <a name="return-value"></a>Возвращаемое значение  
 Ненулевое значение, если операция отмены выполнена успешно; в противном случае — 0.  
  
### <a name="remarks"></a>Примечания  
 Также можно отменить операцию отмены. Например, вы можете восстановить удаленный текст с первого вызова `Undo`. До тех пор, пока нет промежуточные операции редактирования, можно удалить текст с использованием второй вызов `Undo`.  
  
 Дополнительные сведения см. в разделе [EM_UNDO](/windows/desktop/Controls/em-undo) в пакете Windows SDK.  
  
### <a name="example"></a>Пример  
  См. в примере [CanUndo](#canundo).  
  
## <a name="see-also"></a>См. также  
 [Пример MFC WORDPAD](../../visual-cpp-samples.md)   
 [Класс CWnd](../../mfc/reference/cwnd-class.md)   
 [Диаграмма иерархии](../../mfc/hierarchy-chart.md)   
 [Класс CEdit](../../mfc/reference/cedit-class.md)   
 [Класс CRichEditView](../../mfc/reference/cricheditview-class.md)
