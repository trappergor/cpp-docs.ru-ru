---
title: Класс COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/06/2019
ms.locfileid: "70741402"
---
# <a name="colecontrol-class"></a>Класс COleControl

Мощный базовый класс для разработки элементов управления OLE.

## <a name="syntax"></a>Синтаксис

```
class COleControl : public CWnd
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Создает объект `COleControl`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Извлекает текущий внешний вид элемента управления.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Возвращает значение свойства внешнего фона.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Возвращает имя элемента управления, указанное в контейнере.|
|[COleControl::AmbientFont](#ambientfont)|Возвращает значение свойства "шрифт окружения".|
|[COleControl::AmbientForeColor](#ambientforecolor)|Возвращает значение свойства внешнего ForeColor.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Возвращает идентификатор локали контейнера.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Возвращает тип единиц, используемых контейнером.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Определяет, должны ли отображаться дескрипторы захвата.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Определяет, следует ли отображать штриховку.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Возвращает тип выравнивания текста, заданный контейнером.|
|[COleControl::AmbientUIDead](#ambientuidead)|Определяет, должен ли элемент управления реагировать на действия пользовательского интерфейса.|
|[COleControl::AmbientUserMode](#ambientusermode)|Определяет режим контейнера.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Уведомляет контейнер о том, что привязанное свойство было изменено.|
|[COleControl:: Баундпропертирекуестедит](#boundpropertyrequestedit)|Запрашивает разрешение на изменение значения свойства.|
|[COleControl::ClientToParent](#clienttoparent)|Преобразует точку относительно начала координат элемента управления в точку относительно начала его контейнера.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Корректирует прямоугольник курсора, если он перекрывается элементом управления.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Вызывайте эту функцию после изменения набора мнемоник, обрабатываемых элементом управления.|
|[COleControl::DisplayError](#displayerror)|Отображает события ошибок на бирже для пользователя элемента управления.|
|[COleControl::DoClick](#doclick)|Реализация метода акции `DoClick` .|
|[COleControl::DoPropExchange](#dopropexchange)|Сериализует свойства `COleControl` объекта.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Перерисовывает элемент управления OLE, который был подклассом из элемента управления Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Включает поддержку простой рамки для элемента управления.|
|[COleControl::ExchangeExtent](#exchangeextent)|Сериализует ширину и высоту элемента управления.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Сериализует свойства акции элемента управления.|
|[COleControl::ExchangeVersion](#exchangeversion)|Сериализует номер версии элемента управления.|
|[COleControl::FireClick](#fireclick)|Вызывает событие акции `Click` .|
|[COleControl::FireDblClick](#firedblclick)|Вызывает событие акции `DblClick` .|
|[COleControl::FireError](#fireerror)|Вызывает событие акции `Error` .|
|[COleControl::FireEvent](#fireevent)|Вызывает пользовательское событие.|
|[COleControl::FireKeyDown](#firekeydown)|Вызывает событие акции `KeyDown` .|
|[COleControl::FireKeyPress](#firekeypress)|Вызывает событие акции `KeyPress` .|
|[COleControl::FireKeyUp](#firekeyup)|Вызывает событие акции `KeyUp` .|
|[COleControl::FireMouseDown](#firemousedown)|Вызывает событие акции `MouseDown` .|
|[COleControl::FireMouseMove](#firemousemove)|Вызывает событие акции `MouseMove` .|
|[COleControl::FireMouseUp](#firemouseup)|Вызывает событие акции `MouseUp` .|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Запускает событие при изменении состояния готовности элемента управления.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Изменяет поведение активации по умолчанию для элемента управления, который поддерживает `IPointerInactive` интерфейс.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Возвращает значение указанного внешнего свойства.|
|[COleControl::GetAppearance](#getappearance)|Возвращает значение свойства "вид запасов".|
|[COleControl::GetBackColor](#getbackcolor)|Возвращает значение свойства "нестандартный цвет".|
|[COleControl::GetBorderStyle](#getborderstyle)|Возвращает значение свойства BorderStyle для акции.|
|[COleControl::GetCapture](#getcapture)|Определяет, имеет ли безоконный активируемый управляющий объект захват мыши.|
|[COleControl::GetClassID](#getclassid)|Возвращает идентификатор класса OLE элемента управления.|
|[COleControl::GetClientOffset](#getclientoffset)|Получает разность между верхним левым углом прямоугольной области элемента управления и верхним левым углом его клиентской области.|
|[COleControl::GetClientRect](#getclientrect)|Возвращает размер клиентской области элемента управления.|
|[COleControl::GetClientSite](#getclientsite)|Запрашивает объект для указателя на текущий клиентский сайт в контейнере.|
|[COleControl::GetControlFlags](#getcontrolflags)|Возвращает параметры флага элемента управления.|
|[COleControl::GetControlSize](#getcontrolsize)|Возвращает расположение и размер элемента управления OLE.|
|[COleControl::GetDC](#getdc)|Предоставляет средства управления без окон для получения контекста устройства из своего контейнера.|
|[COleControl::GetEnabled](#getenabled)|Возвращает значение свойства "Объем включенного хранения".|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Получает указатель на объект расширенного элемента управления, принадлежащий контейнеру.|
|[COleControl::GetFocus](#getfocus)|Определяет, имеет ли элемент управления фокус.|
|[COleControl::GetFont](#getfont)|Возвращает значение свойства "шрифт акции".|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Возвращает метрики `CFontHolder` объекта.|
|[COleControl::GetForeColor](#getforecolor)|Возвращает значение свойства "основной цвет акции".|
|[COleControl::GetHwnd](#gethwnd)|Возвращает значение свойства "фондовой биржи".|
|[COleControl::GetMessageString](#getmessagestring)|Предоставляет текст строки состояния для пункта меню.|
|[COleControl::GetNotSupported](#getnotsupported)|Предотвращает доступ пользователя к значению свойства элемента управления.|
|[COleControl::GetReadyState](#getreadystate)|Возвращает состояние готовности элемента управления.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Возвращает прямоугольник элемента управления относительно его контейнера.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Возвращает метрики свойства "шрифт акции".|
|[COleControl::GetText](#gettext)|Возвращает значение свойства "текст акции" или "заголовок".|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Переопределите, чтобы разрешить неоконный элемент управления целевым объектом операций перетаскивания.|
|[COleControl::InitializeIIDs](#initializeiids)|Информирует базовый класс идентификаторов IID, который будет использоваться элементом управления.|
|[COleControl::InternalGetFont](#internalgetfont)|`CFontHolder` Возвращает объект для свойства "Font-склад".|
|[COleControl::InternalGetText](#internalgettext)|Извлекает заголовок акции или свойство Text.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Задает состояние готовности элемента управления и запускает событие ready-State-Change.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Делает недействительной область отображаемого элемента управления, что приводит к его перерисовке.|
|[COleControl::InvalidateRgn](#invalidatergn)|Делает недействительным клиентскую область окна контейнера в заданной области. Может использоваться для перерисовки безоконных элементов управления в регионе.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Позволяет выполнять специальную загрузку элемента управления OLE.|
|[COleControl::IsModified](#ismodified)|Определяет, изменилось ли состояние элемента управления.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Указывает, поддерживает ли контейнер оптимизированный рисунок для текущей операции рисования.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Вызывается для определения, является ли элемент управления подклассом элемента управления Windows.|
|[COleControl::Load](#load)|Сбрасывает все предыдущие асинхронные данные и инициирует новую загрузку асинхронного свойства элемента управления.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Определяет, может ли элемент управления деактивироваться контейнером.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Вызывается при изменении свойства окружения.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Вызывается при изменении свойства вида акции.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Вызывается при изменении свойства "фондовой биржи".|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Вызывается при изменении свойства "тип акции".|
|[COleControl::OnClick](#onclick)|Вызывается для срабатывания события щелчка склада.|
|[COleControl::OnClose](#onclose)|Уведомляет о вызове `IOleControl::Close` элемента управления.|
|[COleControl::OnDoVerb](#ondoverb)|Вызывается после выполнения команды элемента управления.|
|[COleControl::OnDraw](#ondraw)|Вызывается, когда элемент управления запрашивает перерисовку самого себя.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Вызывается контейнером, когда элемент управления запрашивает перерисовку самого себя с помощью контекста устройства в виде метафайла.|
|[COleControl::OnEdit](#onedit)|Вызывается контейнером для включения пользовательского интерфейса элемента управления OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Вызывается при изменении свойства "складская поддержка".|
|[COleControl::OnEnumVerbs](#onenumverbs)|Вызывается контейнером для перечисления команд элемента управления.|
|[COleControl::OnEventAdvise](#oneventadvise)|Вызывается, когда обработчики событий подключены или отключены от элемента управления.|
|[COleControl::OnFontChanged](#onfontchanged)|Вызывается при изменении свойства "шрифт акции".|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Вызывается при изменении свойства "геоцветка запасов".|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Вызывается, когда события элемента управления заморожены или не заморожены.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Уведомляет о вызове `IOleObject::GetColorSet` элемента управления.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Предоставляет сведения о назначении контейнеру.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Вызывается для получения строки, представляющей значение свойства.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Запрашивает маркер меню элемента управления, которое будет объединено с меню контейнера.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Переопределение для получения отображаемого размера элемента управления, ближайшего к предложенному размеру и режиму экстента.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Возвращает строки, представляющие возможные значения для свойства.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Возвращает значение, соответствующее предопределенной строке.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Переопределение для получения размера отображаемых областей элемента управления (может использоваться для включения двустороннего рисования).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Переопределение для преобразования размера элемента управления в прямоугольник, начиная с определенной позиции.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Переопределение для получения состояния представления элемента управления.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Вызывается контейнером при отключении элемента управления в пользовательском интерфейсе.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Переопределите, чтобы контейнер для неактивного элемента управления под указателем мыши диспетчеризации WM_MOUSEMOVE сообщения в элемент управления.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Переопределите, чтобы контейнер для неактивного элемента управления под указателем мыши диспетчеризации WM_SETCURSOR сообщения в элемент управления.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Вызывается после срабатывания события склада KeyDown.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Вызывается после срабатывания события KeyPress.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Вызывается после срабатывания события склада KeyUp.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Указывает страницу свойств, используемую для редактирования свойства.|
|[COleControl::OnMnemonic](#onmnemonic)|Вызывается при нажатии назначенной клавиши элемента управления.|
|[COleControl::OnProperties](#onproperties)|Вызывается при вызове команды "Properties" элемента управления.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Переопределение для запроса того, пересекается ли изображение элемента управления с заданной точкой.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Переопределение для запроса того, пересекается ли изображение элемента управления с любой точкой в данном прямоугольнике.|
|[COleControl::OnRenderData](#onrenderdata)|Вызывается платформой для получения данных в указанном формате.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Вызвано платформой для получения данных из файла в указанном формате.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Вызвано платформой для получения данных из глобальной памяти в указанном формате.|
|[COleControl::OnResetState](#onresetstate)|Сбрасывает свойства элемента управления в значения по умолчанию.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Уведомляет о вызове `IOleControl::SetClientSite` элемента управления.|
|[COleControl::OnSetData](#onsetdata)|Заменяет данные элемента управления другим значением.|
|[COleControl::OnSetExtent](#onsetextent)|Вызывается после изменения экстента элемента управления.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Вызывается после изменения измерений элемента управления.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Вызывается при активации пользовательского интерфейса элемента управления.|
|[COleControl::OnTextChanged](#ontextchanged)|Вызывается при изменении свойства "текст на бирже" или "заголовок".|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Обрабатывает сообщения окна (кроме сообщений мыши и клавиатуры) для безоконных элементов управления.|
|[COleControl::ParentToClient](#parenttoclient)|Преобразует точку относительно начала источника контейнера в точку относительно начала координат элемента управления.|
|[COleControl::PostModalDialog](#postmodaldialog)|Уведомляет контейнер о закрытии модального диалогового окна.|
|[COleControl::PreModalDialog](#premodaldialog)|Уведомляет контейнер о том, что будет отображено модальное диалоговое окно.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Уничтожает и повторно создает окно элемента управления.|
|[COleControl::Refresh](#refresh)|Принудительно выполняет перерисовку внешнего вида элемента управления.|
|[COleControl::ReleaseCapture](#releasecapture)|Освобождает захват мыши.|
|[COleControl::ReleaseDC](#releasedc)|Освобождает контекст отображаемого устройства контейнера элемента управления без окон.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Сбрасывает родительский элемент окна элемента управления.|
|[COleControl::ResetStockProps](#resetstockprops)|`COleControl` Инициализирует стандартные свойства значениями по умолчанию.|
|[COleControl::ResetVersion](#resetversion)|Инициализирует номер версии с заданным значением.|
|[COleControl::ScrollWindow](#scrollwindow)|Позволяет безоконному элементу управления прокручивать область внутри его активного изображения на экране.|
|[COleControl::SelectFontObject](#selectfontobject)|Выбирает пользовательское свойство шрифта в контексте устройства.|
|[COleControl::SelectStockFont](#selectstockfont)|Выбирает свойство «стандартный шрифт» в контексте устройства.|
|[COleControl::SerializeExtent](#serializeextent)|Сериализует или инициализирует Отображаемое пространство для элемента управления.|
|[COleControl:: Сериализестоккпропс](#serializestockprops)|Сериализует или инициализирует `COleControl` стандартные свойства.|
|[COleControl::SerializeVersion](#serializeversion)|Сериализует или Инициализирует сведения о версии элемента управления.|
|[COleControl::SetAppearance](#setappearance)|Задает значение свойства "вид запасов".|
|[COleControl::SetBackColor](#setbackcolor)|Задает значение свойства «нестандартный цвет».|
|[COleControl::SetBorderStyle](#setborderstyle)|Задает значение свойства BorderStyle для акции.|
|[COleControl::SetCapture](#setcapture)|Заставляет окно контейнера элемента управления принимать захват мыши от имени элемента управления.|
|[COleControl::SetControlSize](#setcontrolsize)|Задает расположение и размер элемента управления OLE.|
|[COleControl:: Сетенаблед](#setenabled)|Задает значение свойства "Объем включенного хранения".|
|[COleControl::SetFocus](#setfocus)|Заставляет окно контейнера элемента управления получать фокус ввода от имени элемента управления.|
|[COleControl::SetFont](#setfont)|Задает значение свойства "шрифт акции".|
|[COleControl::SetForeColor](#setforecolor)|Задает значение свойства «основной цвет акции».|
|[COleControl::SetInitialSize](#setinitialsize)|Задает размер элемента управления OLE при первом отображении в контейнере.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Изменяет измененное состояние элемента управления.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Указывает, что запрос на изменение не выполнен.|
|[COleControl::SetNotSupported](#setnotsupported)|Предотвращает изменение значения свойства элемента управления пользователем.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Задает прямоугольник элемента управления относительно его контейнера.|
|[COleControl::SetText](#settext)|Задает значение свойства "текст акции" или "заголовок".|
|[COleControl::ThrowError](#throwerror)|Сигнализирует, что в элементе управления OLE произошла ошибка.|
|[COleControl:: Трансформкурдс](#transformcoords)|Преобразует значения координат между контейнером и элементом управления.|
|[COleControl::TranslateColor](#translatecolor)|Преобразует значение OLE_COLOR в значение COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Определяет, будут ли внешние свойства доступны при следующем загрузке элемента управления.|
|[COleControl::WindowProc](#windowproc)|Предоставляет процедуру Windows для `COleControl` объекта.|

### <a name="protected-methods"></a>Защищенные методы

|name|Описание|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Вызывается структурой при необходимости обновления внешнего вида элемента управления.|
|[COleControl::DrawMetafile](#drawmetafile)|Вызывается платформой при использовании контекста устройства Metafile.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Включает вызов метода автоматизации.|
|[COleControl:: Сетинитиалдатаформатс](#setinitialdataformats)|Вызывается платформой для инициализации списка форматов данных, поддерживаемых элементом управления.|

## <a name="remarks"></a>Примечания

Производный `CWnd`от этот класс наследует все функциональные возможности объекта окна Windows, а также дополнительные функциональные возможности, характерные для OLE, такие как срабатывание событий и возможность поддержки методов и свойств.

Элементы управления OLE можно вставлять в приложения-контейнеры OLE и взаимодействовать с контейнером с помощью двусторонней системы обработки событий и предоставления методов и свойств контейнеру. Обратите внимание, что стандартные контейнеры OLE поддерживают только базовую функциональность элемента управления OLE. Они не могут поддерживать расширенные возможности элемента управления OLE. Срабатывание события происходит, когда события отправляются в контейнер в результате определенных действий, выполняемых в элементе управления. В свою очередь, контейнер обменивается данными с элементом управления, используя предоставленный набор методов и свойств, аналогичных функциям- C++ членам и членам данных класса. Такой подход позволяет разработчику управлять внешним видом элемента управления и уведомлять контейнер о выполнении определенных действий.

## <a name="windowless-controls"></a>Элементы управления без окон

Элементы управления OLE можно использовать на месте в режиме «вне окна». Элементы управления без окон имеют значительные преимущества:

- Элементы управления без окон могут быть прозрачными и непрямоугольными

- Элементы управления без окон уменьшают размер экземпляра и время создания объекта

Для элементов управления не требуется окно. Службы, которые предлагает окно, можно легко предоставить с помощью одного общего окна (обычно это контейнер) и разряда диспетчеризации кода. Наличие окна в основном является ненужной сложностью объекта.

Когда используется Безоконная активация, контейнер (который содержит окно) отвечает за предоставление служб, которые в противном случае были бы предоставлены собственным окном элемента управления. Например, если элементу управления требуется запросить фокус клавиатуры, запросить захват мыши или получить контекст устройства, управление этими операциями осуществляется контейнером. Функции-члены без оконнойоперациивызываютэтиоперациивконтейнере.`COleControl`

Если активация без окон включена, контейнер делегирует входные сообщения `IOleInPlaceObjectWindowless` интерфейсу элемента управления (расширение [иолеинплацеобжект](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) для поддержки без окон). `COleControl`Реализация этого интерфейса будет отправлять эти сообщения через карту сообщений элемента управления после правильной настройки координат мыши. Вы можете обрабатывать такие сообщения, как обычные сообщения окна, добавляя соответствующие записи в схему сообщений.

В безоконном элементе управления всегда следует использовать `COleControl` функции-члены, а не соответствующие `CWnd` функции-члены или связанные с ними функции Windows API.

Управляющие объекты OLE могут также создавать окно только в том случае, когда они становятся активными, но объем работы, необходимый для перехода на неактивное состояние, выходит из строя, и скорость перехода отпадает. В некоторых случаях это проблема: например, рассмотрим сетку текстовых полей. При курсоре вверх и вниз по столбцу все элементы управления должны быть активированы на месте, а затем деактивированы. Скорость неактивного или активного перехода напрямую влияет на скорость прокрутки.

Дополнительные сведения о разработке платформы управления OLE см. в статьях [элементы ActiveX](../../mfc/mfc-activex-controls.md) и [общие сведения об элементах управления MFC. Создание управляющей программы](../../mfc/reference/mfc-activex-control-wizard.md)MFC ActiveX. Сведения об оптимизации элементов управления OLE, включая бесоконные и мерцание элементы управления, см [. в разделе элементы ActiveX MFC: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Требования

**Заголовок:** afxctl. h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Возвращает значение свойства внешнего фона.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение свойства внешнего фона контейнера, если оно имеется. Если свойство не поддерживается, эта функция возвращает определенный системой цвет фона Windows.

### <a name="remarks"></a>Примечания

Свойство внешнего фона доступно для всех элементов управления и определяется контейнером. Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

Имя, назначенное контейнеру элементу управления, может использоваться в сообщениях об ошибках, отображаемых пользователю.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Возвращаемое значение

Имя элемента управления OLE. Значение по умолчанию — строка нулевой длины.

### <a name="remarks"></a>Примечания

Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Возвращает значение свойства "шрифт окружения".

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс диспетчеризации шрифтов в контейнере. Значение по умолчанию — NULL. Если возвращаемое значение не равно NULL, вы несете ответственность за освобождение шрифта путем вызова его функции-члена [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) .

### <a name="remarks"></a>Примечания

Свойство «внешний шрифт» определяется контейнером и доступно для всех элементов управления. Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Возвращает значение свойства внешнего ForeColor.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение свойства внешнего ForeColor контейнера, если оно имеется. Если эта функция не поддерживается, она возвращает определенный системой цвет текста Windows.

### <a name="remarks"></a>Примечания

Свойство внешнего ForeColor доступно для всех элементов управления и определяется контейнером. Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

Возвращает идентификатор локали контейнера.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Возвращаемое значение

Значение свойства LocaleID контейнера, если оно имеется. Если это свойство не поддерживается, функция возвращает 0.

### <a name="remarks"></a>Примечания

Элемент управления может использовать LocaleID для адаптации пользовательского интерфейса для конкретных языковых стандартов. Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Возвращает текущий параметр внешнего вида для управляющего объекта.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Возвращаемое значение

Внешний вид элемента управления:

- **0** плоский внешний вид

- **1** объемный внешний вид

### <a name="remarks"></a>Примечания

Вызовите эту функцию, чтобы получить текущее значение свойства DISPID_AMBIENT_APPEARANCE для элемента управления.

##  <a name="ambientscaleunits"></a>COleControl:: Амбиентскалеунитс

Возвращает тип единиц, используемых контейнером.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Возвращаемое значение

Строка, содержащая внешний настройкой контейнера. Если это свойство не поддерживается, эта функция возвращает строку нулевой длины.

### <a name="remarks"></a>Примечания

Внешнее свойство настройкой контейнера можно использовать для вывода позиций или измерений с пометкой выбранной единицы, например твипов или сантиметров. Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientshowgrabhandles"></a>COleControl:: Амбиентшовграбхандлес

Определяет, разрешает ли контейнер элемент управления отображать дескрипторы захвата для себя, если он активен.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если должны отображаться дескрипторы захвата; в противном случае — 0. Если это свойство не поддерживается, эта функция возвращает ненулевое значение.

### <a name="remarks"></a>Примечания

Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientshowhatching"></a>COleControl:: Амбиентшовхатчинг

Определяет, позволяет ли контейнер отображать элемент управления с штриховым шаблоном при активном пользовательском интерфейсе.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если необходимо показать штриховую схему; в противном случае — 0. Если это свойство не поддерживается, эта функция возвращает ненулевое значение.

### <a name="remarks"></a>Примечания

Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Определяет выравнивание текста окружения, предпочитаемое контейнером элементов управления.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Возвращаемое значение

Состояние окружения свойства TextAlign контейнера. Если это свойство не поддерживается, функция возвращает 0.

Ниже приведен список допустимых возвращаемых значений.

|Возвращаемое значение|Значение|
|------------------|-------------|
|0|Общее выравнивание (числа справа, текст слева).|
|1|Выравнивание по левому краю|
|2|Центр|
|3|Выравнивание по правому краю|

### <a name="remarks"></a>Примечания

Это свойство доступно для всех внедренных элементов управления и определяется контейнером. Обратите внимание, что для поддержки этого свойства контейнер не требуется.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Определяет, требуется ли контейнеру элемент управления для реагирования на действия пользовательского интерфейса.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления должен реагировать на действия пользовательского интерфейса; в противном случае — 0. Если это свойство не поддерживается, функция возвращает 0.

### <a name="remarks"></a>Примечания

Например, контейнер может установить значение TRUE в режиме конструктора.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Определяет, находится ли контейнер в режиме конструктора или в пользовательском режиме.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если контейнер находится в пользовательском режиме; в противном случае — 0 (в режиме конструктора). Если это свойство не поддерживается, функция возвращает значение TRUE.

### <a name="remarks"></a>Примечания

Например, контейнер может установить значение FALSE в режиме конструктора.

##  <a name="boundpropertychanged"></a>COleControl:: Баундпропертичанжед

Сигнализирует, что значение связанного свойства изменилось.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчеризации связанного свойства элемента управления.

### <a name="remarks"></a>Примечания

Этот метод должен вызываться каждый раз при изменении значения свойства, даже в тех случаях, когда изменение не было выполнено с помощью метода набора свойств. Будьте особенно осведомлены о привязанных свойствах, сопоставленных с переменными членов. При каждом изменении `BoundPropertyChanged` переменной-члена необходимо вызвать метод.

##  <a name="boundpropertyrequestedit"></a>COleControl:: Баундпропертирекуестедит

Запрашивает разрешение от `IPropertyNotifySink` интерфейса для изменения значения привязанного свойства, предоставленного элементом управления.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчеризации связанного свойства элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если изменение разрешено; в противном случае — 0. Значение по умолчанию — ненулевой.

### <a name="remarks"></a>Примечания

Если разрешение запрещено, элемент управления не должен изменять значение свойства. Это можно сделать, проигнорируя или не выполнив действие, которое попыталось изменить значение свойства.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Преобразует координаты *ппоинт* в родительские координаты.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Параметры

*лпркбаундс*<br/>
Указатель на границы элемента управления OLE в контейнере. Не является клиентской областью, а областью всего элемента управления, включая границы и полосы прокрутки.

*ппоинт*<br/>
Указатель на точку области клиента OLE для преобразования в координаты родительского объекта (контейнера).

### <a name="remarks"></a>Примечания

Входные *ппоинт* зависят от источника клиентской области элемента управления OLE (в левом верхнем углу клиентской области элемента управления). На выходе *ппоинт* определяется относительно начала родительского элемента (верхнего левого угла контейнера).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Настраивает прямоугольник курсора, если он полностью или частично охватывается перекрывающимися, непрозрачными объектами.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
На входе — указатель на структуру [Rect](/windows/win32/api/windef/ns-windef-rect) , содержащую область курсора для корректировки. В выходных данных, настроенной области ввода или NULL, если прямоугольник курсора полностью охвачен.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Курсор является мигающим линией, блоком или точечным рисунком, который обычно указывает, куда будет вставлен текст или графика.

Безоконный объект не может безопасно отображать курсор без предварительного пропроверки того, является ли курсор частично или полностью скрыт перекрытием объектов. Чтобы сделать это возможным, объект может использовать `ClipCaretRect` , чтобы получить заданный курсор в области обрезки.

Объекты, создающие курсор, должны отправлять прямоугольник курсора в `ClipCaretRect` и использовать скорректированный прямоугольник для курсора. Если курсор полностью скрыт, этот метод возвратит значение FALSE, а курсор не должен отображаться в данном случае.

##  <a name="colecontrol"></a>  COleControl::COleControl

Создает объект `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Примечания

Обычно эта функция не вызывается напрямую. Вместо этого элемент управления OLE обычно создается его фабрикой классов.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Вызывайте эту функцию, когда был изменен набор мнемоник, поддерживаемых элементом управления.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Примечания

После получения этого уведомления контейнер элемента управления получает новый набор назначенных клавиш, вызвав метод [метод интерфейса IOleControl:: жетконтролинфо](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Обратите внимание, что контейнер не должен отвечать на это уведомление.

##  <a name="displayerror"></a>  COleControl::DisplayError

Вызвано структурой после обработки события "ошибка акции" (если обработчик событий не подавляет отображение ошибки).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Параметры

*SCODE*<br/>
Значение кода состояния для отчета. Полный список возможных кодов см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).

*лпсздескриптион*<br/>
Описание ошибки, о которой сообщается.

*lpszSource*<br/>
Имя модуля, создающего ошибку (как правило, имя модуля управления OLE).

*лпсзелпфиле*<br/>
Имя файла справки, содержащего описание ошибки.

*нхелпид*<br/>
Идентификатор контекста справки о сообщении об ошибке.

### <a name="remarks"></a>Примечания

Поведение по умолчанию отображает окно сообщения, содержащее описание ошибки, которое содержится в *лпсздескриптион*.

Переопределите эту функцию, чтобы настроить отображение ошибок.

##  <a name="doclick"></a>  COleControl::DoClick

Имитирует действие щелчка мыши в элементе управления.

```
void DoClick();
```

### <a name="remarks"></a>Примечания

Будет вызвана `COleControl::OnClick` переопределяемая функция-член, и будет запущено событие щелчка склада, если оно поддерживается элементом управления.

Эта функция поддерживается `COleControl` базовым классом в качестве метода акции с именем DoClick. Дополнительные сведения см. в статье [элементы управления ActiveX: Методы](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

Вызывается платформой при загрузке или хранении элемента управления из постоянного представления хранилища, такого как поток или набор свойств.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект `CPropExchange` . Платформа предоставляет этот объект для установки контекста обмена свойствами, включая его направление.

### <a name="remarks"></a>Примечания

Эта функция обычно вызывает семейство функций **PX_** для загрузки или хранения определенных определяемых пользователем свойств элемента управления OLE.

Если для создания проекта OLE-элемента управления использовался мастер элементов управления, переопределенная версия этой функции будет выполнять сериализацию стандартных свойств, `COleControl` `COleControl::DoPropExchange`поддерживаемых с помощью вызова функции базового класса. При добавлении определяемых пользователем свойств в элемент управления OLE потребуется изменить эту функцию для сериализации новых свойств. Дополнительные сведения о сериализации см. в статье [элементы управления ActiveX: Сериализация](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>COleControl::D Осуперкласспаинт

Перерисовывает элемент управления OLE, который был подклассом из элемента управления Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства контейнера элемента управления.

*ркбаундс*<br/>
Область, в которой должен быть нарисован элемент управления.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию, чтобы правильно обрабатывался неактивный элемент управления OLE. Эту функцию следует использовать только в том случае, если элемент управления OLE является подклассом элемента управления Windows и должен `OnDraw` вызываться в функции элемента управления.

Дополнительные сведения об этой функции и подклассах элемента управления Windows см. в статье [элементы ActiveX: Подклассировать элемент управления](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)Windows.

##  <a name="drawcontent"></a>  COleControl::DrawContent

Вызывается структурой при необходимости обновления внешнего вида элемента управления.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства.

*RC*<br/>
Прямоугольная область, отображаемая в.

### <a name="remarks"></a>Примечания

Эта функция напрямую вызывает переопределяемую `OnDraw` функцию.

##  <a name="drawmetafile"></a>COleControl::D Равметафиле

Вызывается платформой при использовании контекста устройства Metafile.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства Metafile.

*RC*<br/>
Прямоугольная область, отображаемая в.

##  <a name="enablesimpleframe"></a>COleControl:: Енаблесимплефраме

Включает характеристику простого кадра для элемента управления OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Примечания

Эта характеристика позволяет элементу управления поддерживать визуальное вложение других элементов управления, но не включает истинное значение OLE. Примером может быть поле группы с несколькими элементами управления внутри. Эти элементы управления не содержат OLE, но находятся в одном поле группы.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Сериализует или Инициализирует состояние экстента элемента управления (его измерения в единицах HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) . Платформа предоставляет этот объект для установки контекста обмена свойствами, включая его направление.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция прошла удачно; 0 в противном случае.

### <a name="remarks"></a>Примечания

Эта функция обычно вызывается реализацией `COleControl::DoPropExchange`по умолчанию.

##  <a name="exchangestockprops"></a>COleControl:: Ексчанжестоккпропс

Сериализует или Инициализирует состояние стандартных свойств элемента управления.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект [кпропексчанже](../../mfc/reference/cpropexchange-class.md) . Платформа предоставляет этот объект для установки контекста обмена свойствами, включая его направление.

### <a name="remarks"></a>Примечания

Эта функция обычно вызывается реализацией `COleControl::DoPropExchange`по умолчанию.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

Сериализует или Инициализирует состояние сведений о версии элемента управления.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Параметры

*ппкс*<br/>
Указатель на объект `CPropExchange` . Платформа предоставляет этот объект для установки контекста обмена свойствами, включая его направление.

*двверсиондефаулт*<br/>
Номер текущей версии элемента управления.

*бконверт*<br/>
Указывает, следует ли преобразовывать постоянные данные в самый последний формат при сохранении или обслуживании в том же формате, который был загружен.

### <a name="return-value"></a>Возвращаемое значение

Ненулевая часть функции прошла удачно; 0 в противном случае.

### <a name="remarks"></a>Примечания

Как правило, это будет первая функция, вызываемая переопределением `COleControl::DoPropExchange`элемента управления. При загрузке эта функция считывает номер версии постоянных данных и соответствующим образом устанавливает атрибут Version объекта [кпропексчанже](../../mfc/reference/cpropexchange-class.md) . При сохранении эта функция записывает номер версии постоянных данных.

Дополнительные сведения о сохраняемости и управлении версиями см. в статье [элементы управления ActiveX: Сериализация](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Вызывается структурой при нажатии кнопки мыши над активным элементом управления.

```
void FireClick();
```

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события щелчка в сопоставлении событий элемента управления должно быть определено событие щелчка склада.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Вызывается структурой при двойном щелчке мыши по активному элементу управления.

```
void FireDblClick();
```

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события DblClick в карте событий элемента управления должно быть определено событие DblClick.

##  <a name="fireerror"></a>  COleControl::FireError

Вызывает событие ошибки акции.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Параметры

*SCODE*<br/>
Значение кода состояния для отчета. Полный список возможных кодов см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).

*лпсздескриптион*<br/>
Описание ошибки, о которой сообщается.

*нхелпид*<br/>
Идентификатор справки об ошибке, о которой сообщается.

### <a name="remarks"></a>Примечания

Это событие предоставляет способ сигнализации в соответствующих местах кода, что в элементе управления произошла ошибка. В отличие от других складских событий, таких как щелчок или перемещение, ошибка никогда не запускается платформой.

Чтобы сообщить об ошибке, возникающей во время работы свойства Get, функции набора свойств или метода автоматизации, вызовите метод [COleControl:: ThrowError](#throwerror).

Реализация события «биржа» элемента управления OLE использует значение SCODE. Если элемент управления использует это событие и предназначен для использования в Visual Basic 4,0, то будут возникать ошибки, так как значение SCODE не поддерживается в Visual Basic.

Чтобы устранить эту проблему, вручную измените параметр SCODE в элементе управления. ODL-файла в **длинное целое**. Кроме того, любое пользовательское событие, метод или свойство, использующее параметр SCODE, также вызывает ту же проблему.

##  <a name="fireevent"></a>  COleControl::FireEvent

Вызывает определенное пользователем событие из элемента управления с любым количеством необязательных аргументов,.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчеризации запускаемого события.

*пбпарамс*<br/>
Дескриптор для типов параметров события.

### <a name="remarks"></a>Примечания

Обычно эта функция не должна вызываться напрямую. Вместо этого вы будете вызывать функции обработки событий в разделе "схема событий" объявления класса элемента управления.

Аргумент *пбпарамс* представляет собой разделенный пробелами список **VTS_** . Одно или несколько из этих значений, разделенных пробелами (не запятыми), составляют список параметров функции. Ниже приведены возможные значения.

|Символ|Тип параметра|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Дополнительные константы типа Variant определены для всех типов Variant, за исключением VTS_FONT и VTS_PICTURE, которые предоставляют указатель на константу данных Variant. Эти константы именуются с помощью соглашения **VTS_P** `constantname` . Например, VTS_PCOLOR является указателем на константу VTS_COLOR.

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Вызывается структурой при нажатии клавиши, когда элемент управления активен в пользовательском интерфейсе.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Параметры

*пнчар*<br/>
Указатель на значение виртуального ключевого кода нажатой клавиши. Список стандартных виртуальных клавиш см. в разделе Winuser. h

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события KeyDown в сопоставлении событий элемента управления должно быть определено событие KeyDown "склад".

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Вызывается структурой при нажатии и освобождении клавиши, когда пользовательский элемент управления является активным в контейнере.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Параметры

*пнчар*<br/>
Указатель на значение символа нажатой клавиши.

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Получатель события может изменить *пнчар*, например преобразовать все символы нижнего регистра в верхний регистр. Если необходимо проверить измененный символ, переопределите `OnKeyPressEvent`.

Для автоматического срабатывания события KeyPress в сопоставлении событий элемента управления должно быть определено событие KeyPress.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Вызывается платформой при освобождении ключа, когда пользовательский элемент управления является активным в контейнере.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Параметры

*пнчар*<br/>
Указатель на значение виртуального ключа в освобожденном ключе. Список стандартных виртуальных клавиш см. в разделе Winuser. h

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события KeyUp в сопоставлении событий элемента управления должно быть определено событие «вверх по складу».

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Вызывается структурой при нажатии кнопки мыши над активным пользовательским элементом управления.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*нбуттон*<br/>
Числовое значение нажатой кнопки мыши. Он может содержать одно из следующих значений:

- LEFT_BUTTON нажата левая кнопка мыши.

- MIDDLE_BUTTON средняя кнопка мыши была нажата.

- RIGHT_BUTTON нажата правая кнопка мыши.

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

*x*<br/>
Координата x курсора при нажатии кнопки мыши. Координата задается относительно левого верхнего угла окна управления.

*y*<br/>
Координата y курсора при нажатии кнопки мыши. Координата задается относительно левого верхнего угла окна управления.

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события MouseDown в сопоставлении событий элемента управления должно быть определено событие MouseDown.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Вызывается структурой при перемещении курсора над активным пользовательским элементом управления.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*нбуттон*<br/>
Числовое значение нажатой кнопки мыши. Содержит сочетание следующих значений:

- LEFT_BUTTON. в ходе действия была нажата левая кнопка мыши.

- MIDDLE_BUTTON. средняя кнопка мыши была нажата во время действия.

- RIGHT_BUTTON. в ходе действия была нажата правая кнопка мыши.

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

*x*<br/>
Координата x курсора. Координата задается относительно левого верхнего угла окна управления.

*y*<br/>
Координата y курсора. Координата задается относительно левого верхнего угла окна управления.

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события MouseMove в сопоставлении событий элемента управления должно быть определено событие MouseMove типа «складское перемещение».

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Вызывается структурой при отпускании кнопки мыши над активным пользовательским элементом управления.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*нбуттон*<br/>
Числовое значение отпущеной кнопки мыши. Он может иметь одно из следующих значений:

- LEFT_BUTTON левая кнопка мыши была освобождена.

- MIDDLE_BUTTON средняя кнопка мыши была выпущена.

- RIGHT_BUTTON, что была разпущена правая кнопка мыши.

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

*x*<br/>
Координата x курсора, когда была отжата кнопка мыши. Координата задается относительно левого верхнего угла окна управления.

*y*<br/>
Координата y курсора, когда была отжата кнопка мыши. Координата задается относительно левого верхнего угла окна управления.

### <a name="remarks"></a>Примечания

Если это событие определено как пользовательское событие, вы определяете, когда это событие будет запущено.

Для автоматического срабатывания события MouseUp в сопоставлении событий элемента управления должно быть определено событие MouseUp склада.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Запускает событие с текущим значением состояния готовности элемента управления.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Примечания

Состояние готовности может иметь одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|Элемент управления в данный момент загружает свойства|
|READYSTATE_LOADED|Элемент управления инициализирован|
|READYSTATE_INTERACTIVE|Элемент управления имеет достаточно данных для интерактивного взаимодействия, но не все асинхронные данные еще загружены|
|READYSTATE_COMPLETE|Все данные элемента управления|

Используйте [жетреадистате](#getreadystate) для определения текущей готовности элемента управления.

[InternalSetReadyState](#internalsetreadystate) изменяет состояние готовности на переданное значение, затем вызывает `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

Изменяет поведение активации по умолчанию для элемента управления, который поддерживает `IPointerInactive` интерфейс.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Возвращаемое значение

Сочетание флагов из перечисления ПОИНТЕРИНАКТИВЕ. Возможные флаги:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Объект должен быть активирован на месте при перемещении курсора мыши во время операции перемещения мыши.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Объект должен быть деактивирован, когда указатель мыши покидает объект во время операции перемещения мыши.|
|POINTERINACTIVE_ACTIVATEONDRAG|Объект должен быть активирован на месте при перетаскивании указателя мыши во время операции перетаскивания.|

### <a name="remarks"></a>Примечания

`IPointerInactive` Если интерфейс включен, контейнер будет делегировать ему сообщения WM_SETCURSOR и WM_MOUSEMOVE. `COleControl`Реализация этого интерфейса будет отправлять эти сообщения через карту сообщений элемента управления после правильной настройки координат мыши.

Каждый раз, когда контейнер получает сообщение WM_SETCURSOR или WM_MOUSEMOVE с указателем мыши на неактивный объект `IPointerInactive`, он должен вызывать `GetActivationPolicy` интерфейс и возвращать флаги из перечисления поинтеринактиве.

Эти сообщения можно обрабатывать так же, как обычные сообщения в окне, добавляя соответствующие записи в схему сообщений. В обработчиках избегайте использования `m_hWnd` переменной-члена (или любых функций-членов, использующих ее) без предварительной проверки того, что ее значение не равно null.

Любой объект, предназначенный для того, чтобы сделать больше, чем установить курсор мыши и (или) запустить событие перемещения мыши, например дать особую визуальную обратную связь, должен вернуть флаг POINTERINACTIVE_ACTIVATEONENTRY и нарисовать отзыв, только если он активен. Если объект возвращает этот флаг, контейнер должен немедленно активировать его на месте, а затем переслать ему то же сообщение, которое инициировало вызов `GetActivationPolicy`.

Если возвращаются флаги POINTERINACTIVE_ACTIVATEONENTRY и POINTERINACTIVE_DEACTIVATEONLEAVE, то объект будет активирован только при наведении мыши на объект. Если возвращается только флаг POINTERINACTIVE_ACTIVATEONENTRY, объект активируется только один раз, когда указатель мыши впервые входит в объект.

Также может потребоваться, чтобы неактивный элемент управления был целевым объектом операции перетаскивания OLE. Это требует активации элемента управления в момент, когда пользователь перетаскивает на него объект, чтобы окно элемента управления можно было зарегистрировать как цель перетаскивания. Чтобы активация производилась во время перетаскивания, верните флаг POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Сведения, которые обмениваются `GetActivationPolicy` данными, не должны кэшироваться контейнером. Вместо этого этот метод должен вызываться каждый раз, когда указатель мыши переходит в неактивный объект.

Если неактивный объект не запрашивается на месте, когда указатель мыши попадает в него, его контейнер должен отправлять последующие сообщения WM_SETCURSOR этому объекту, вызывая [онинактивесеткурсор](#oninactivesetcursor) , если указатель мыши остается над объектом.

`IPointerInactive` Включение интерфейса обычно означает, что элемент управления должен поддерживать обработку сообщений мыши все время. Чтобы это поведение можно было использовать в контейнере, который `IPointerInactive` не поддерживает интерфейс, элемент управления должен всегда активироваться, если он видим, а это означает, что элемент управления будет иметь флаг OLEMISC_ACTIVATEWHENVISIBLE в различных флагах. Однако, чтобы этот флаг не действовал в контейнере, который поддерживает `IPointerInactive`, можно также указать флаг OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

Возвращает значение внешнего свойства контейнера.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Параметры

*dwDispid*<br/>
Идентификатор диспетчеризации требуемого внешнего свойства.

*втпроп*<br/>
Тег типа Variant, указывающий тип значения, возвращаемого в *пвпроп*.

*пвпроп*<br/>
Указатель на адрес переменной, которая будет принимать значение свойства или возвращаемое значение. Фактический тип этого указателя должен соответствовать типу, заданному параметром *втпроп*.

|втпроп|Тип Пвпроп|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если свойство окружения поддерживается; в противном случае — 0.

### <a name="remarks"></a>Примечания

Если используется `GetAmbientProperty` для получения свойств внешнего DisplayName и настройкой, установите *втпроп* в VT_BSTR и *пвпроп* в `CString*`. Если вы получаете свойство Font для окружающей среды, задайте для *втпроп* значение VT_FONT, а для *пвпроп* — лпфонтдисп *.

Обратите внимание, что функции уже предоставлены для общих внешних свойств, таких как [амбиентбаккколор](#ambientbackcolor) и [амбиентфонт](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Реализует функцию Get свойства вида "Стандартный" элемента управления.

```
short GetAppearance ();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение задает текущий параметр внешнего вида в виде **короткого** (VT_I2) значения (при успешном выполнении). Это значение равно нулю, если внешний вид элемента управления является плоским и 1, если внешний вид элемента управления является трехмерным.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Реализует функцию Get свойства "фондовой биржи" элемента управления.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение задает текущий цвет фона как значение OLE_COLOR, если оно выполнено успешно. Это значение можно преобразовать в значение COLORREF с помощью вызова метода `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Реализует функцию Get свойства BorderStyle, определяющего тип акции элемента управления.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Возвращаемое значение

1, если элемент управления имеет нормальную границу; 0, если элемент управления не имеет границы.

##  <a name="getcapture"></a>  COleControl::GetCapture

Определяет, имеет `COleControl` ли объект захват мыши.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Если элемент управления активирован и безоконный, возвращает **это** значение, если элемент управления в данный момент имеет захват мыши (как определено в контейнере элемента управления), или null, если он не имеет записи.

В противном случае `CWnd` возвращает объект с захватом мыши ( `CWnd::GetCapture`то же, что и).

### <a name="remarks"></a>Примечания

Активированный безоконный элемент управления получает захват мыши при вызове [сеткаптуре](#setcapture) .

##  <a name="getclassid"></a>  COleControl::GetClassID

Вызывается платформой для получения идентификатора класса OLE элемента управления.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Параметры

*пклсид*<br/>
Указатель на расположение идентификатора класса.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов не был успешным; в противном случае — 0.

### <a name="remarks"></a>Примечания

Обычно реализуется с помощью [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Получает разность между верхним левым углом прямоугольной области элемента управления и верхним левым углом его клиентской области.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Параметры

*pdxOffset*<br/>
Указатель на горизонтальное смещение клиентской области элемента управления OLE.

*pdyOffset*<br/>
Указатель на вертикальное смещение клиентской области элемента управления OLE.

### <a name="remarks"></a>Примечания

Элемент управления OLE содержит прямоугольную область внутри своего контейнера. Клиентская область элемента управления — это область управления, исключая границы и полосы прокрутки. Смещение, полученное `GetClientOffset` , — это разница между верхним левым углом прямоугольной области элемента управления и верхним левым углом его клиентской области. Если элемент управления содержит неклиентские элементы, отличные от стандартных границ и полос прокрутки, переопределите эту функцию-член, чтобы указать смещение.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Возвращает размер клиентской области элемента управления.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
Указатель на `RECT` структуру, содержащую размеры клиентской области элемента управления без окон, то есть размер элемента управления минус границы окна, кадры, полосы прокрутки и т. д. Параметр *лпрект* указывает размер клиентского прямоугольника элемента управления, а не его расположения.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Запрашивает объект для указателя на текущий клиентский сайт в контейнере.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на текущий клиентский сайт элемента управления в своем контейнере.

### <a name="remarks"></a>Примечания

Возвращаемый указатель указывает на экземпляр `IOleClientSite`. `IOleClientSite` Интерфейс, реализованный контейнерами, представляет собой представление своего контекста объекта: где он привязан в документе, где он получает хранилище, Пользовательский интерфейс и другие ресурсы.

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

Возвращает параметры флага элемента управления.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Возвращаемое значение

ORed сочетание флагов в перечислении Контролфлагс:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Примечания

По умолчанию `GetControlFlags` возвращает `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Если задано, то использует функцию Begin-Paint, адаптированную для элементов управления OLE, а не API [бегинпаинт](/windows/win32/api/winuser/nf-winuser-beginpaint) (по умолчанию задано).|
|`clipPaintDC`|Если не задано, отключает вызов `IntersectClipRect` `COleControl` в и получает небольшое преимущество в скорости. Если вы используете безоконную активацию, флаг не действует.|
|`pointerInactive`|Если задано, обеспечивает взаимодействие с мышью, пока элемент управления неактивен, `COleControl`включая `IPointerInactive` реализацию интерфейса, который по умолчанию отключен.|
|`noFlickerActivate`|Если задано, то устраняет дополнительные операции рисования и сопутствующую визуальную мерцание. Используется, когда элемент управления рисует себя в неактивном и активном состояниях. Если вы используете безоконную активацию, флаг не действует.|
|`windowlessActivate`|Если задано значение, указывает, что элемент управления использует безоконную активацию.|
|`canOptimizeDraw`|Если задано, указывает, что элемент управления будет выполнять оптимизированный рисунок, если он поддерживается контейнером.|

Дополнительные сведения о `GetControlFlags` и других оптимизациях элементов управления OLE см. в [разделе элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Возвращает размер окна элемента управления OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Параметры

*pcx*<br/>
Задает ширину элемента управления в пикселях.

*pcy*<br/>
Задает высоту элемента управления в пикселях.

### <a name="remarks"></a>Примечания

Обратите внимание, что все координаты окон управления задаются относительно левого верхнего угла элемента управления.

##  <a name="getdc"></a>  COleControl::GetDC

Предоставляет неоконный объект для получения экрана (или совместимого) контекста устройства из своего контейнера.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Параметры

*лпркрект*<br/>
Указатель на прямоугольник, который элемент управления без окон требуется перерисовать, в клиентских координатах элемента управления. Значение NULL означает экстент полного объекта.

*dwFlags*<br/>
Рисование атрибутов контекста устройства. Возможные варианты:

- OLEDC_NODRAW указывает, что объект не будет использовать контекст устройства для выполнения любых рисунков, а только для получения сведений об устройстве отображения. Контейнер должен просто передать контроллер домена без дальнейшей обработки.

- OLEDC_PAINTBKGND запрашивает, что контейнер зарисовывает фон, прежде чем возвращать контроллер домена. Объект должен использовать этот флаг, если он запрашивает контроллер домена для перерисовки области с прозрачным фоном.

- OLEDC_OFFSCREEN информирует контейнер о том, что объект хочет подготовиться к просмотру в виде экранного растрового изображения, который затем должен быть скопирован на экран. Объект должен использовать этот флаг, когда операция рисования, которую он собирается выполнить, приводит к большому мерцанию. Контейнер может не удовлетворять этому запросу. Однако если этот флаг не установлен, контейнер должен выполнить обратную передачу на экран контроллера домена. Это позволяет объектам выполнять операции с прямым экраном, такие как отображение выбора (с помощью операции **XOR** ).

### <a name="return-value"></a>Возвращаемое значение

Указатель на контекст устройства отображения для клиентской области `CWnd` контейнера в случае успеха; в противном случае возвращается значение null. Контекст устройства отображения можно использовать в последующих функциях GDI для рисования в клиентской области окна контейнера.

### <a name="remarks"></a>Примечания

Для освобождения контекста после рисования необходимо вызвать функцию члена [релеаседк](#releasedc) . При вызове `GetDC`объекты передают прямоугольник, в который они должны нарисоваться, в собственных координатах клиента. `GetDC`Преобразует эти данные в координаты клиентской области контейнера. Объект не должен запрашивать нужный прямоугольник рисования, превышающий его собственный прямоугольник клиентской области, размер которого можно получить с помощью [жетклиентрект](#getclientrect). Это предотвращает непреднамеренное Рисование объектов, где они не должны быть.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Реализует функцию Get свойства, включенного в элемент управления.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления включен; в противном случае — 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Получает указатель на объект, поддерживаемый контейнером, который представляет элемент управления с расширенным набором свойств.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект расширенного элемента управления контейнера. Если объект недоступен, значение равно NULL.

Этим объектом можно управлять через его `IDispatch` интерфейс. Также можно использовать `QueryInterface` для получения других доступных интерфейсов, предоставляемых объектом. Однако объект не обязательно должен поддерживать конкретный набор интерфейсов. Обратите внимание, что полагаться на конкретные функции объекта расширенного элемента управления контейнера, можно ограничить переносимость элемента управления на другие произвольные контейнеры.

### <a name="remarks"></a>Примечания

Функция, вызывающая эту функцию, отвечает за освобождение указателя по завершении работы с объектом. Обратите внимание, что контейнер не требуется для поддержки этого объекта.

##  <a name="getfocus"></a>  COleControl::GetFocus

Определяет, имеет `COleControl` ли объект фокус.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Возвращаемое значение

Если элемент управления активирован и безоконный, возвращает **это** значение, если элемент управления в данный момент имеет фокус клавиатуры (как определено в контейнере элемента управления) или null, если он не имеет фокуса.

В противном случае `CWnd` возвращает объект, имеющий фокус ( `CWnd::GetFocus`то же, что и).

### <a name="remarks"></a>Примечания

Активированный безоконный элемент управления получает фокус при вызове [SetFocus](#setfocus) .

##  <a name="getfont"></a>  COleControl::GetFont

Реализует функцию Get свойства "шрифт акции".

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс диспетчеризации шрифтов свойства стандартного шрифта элемента управления.

### <a name="remarks"></a>Примечания

Обратите внимание, что вызывающая сторона должна освободить объект после завершения. В реализации элемента управления используйте `InternalGetFont` для доступа к объекту шрифта акции элемента управления. Дополнительные сведения об использовании шрифтов в элементе управления см. в статье [элементы управления ActiveX: Использование шрифтов в элементе управления](../../mfc/mfc-activex-controls-using-fonts.md)ActiveX.

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Измеряет текстовые метрики для любого `CFontHolder` объекта, принадлежащего элементу управления.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Параметры

*лптм*<br/>
Указатель на структуру [текстметрик](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

*фонсолдер*<br/>
Ссылка на объект [кфонсолдер](../../mfc/reference/cfontholder-class.md) .

### <a name="remarks"></a>Примечания

Такой шрифт можно выбрать с помощью функции [COleControl:: селектфонтобжект](#selectfontobject) . `GetFontTextMetrics`Инициализирует `TEXTMETRIC` структуру, на которую указывает, с помощью *лптм* с допустимыми `fontHolder`сведениями о метриках в случае успеха или при успешном заполнении структуры нулями. Эту функцию следует использовать вместо [жеттекстметрикс](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) при рисовании элемента управления, так как элементы управления, как и любой ВНЕДРЕНный OLE-объект, могут быть необходимы для отрисовки в метафайл.

Структура `TEXTMETRIC` шрифта по умолчанию обновляется при вызове функции [SelectFontObject](#selectfontobject). Вызывайте `GetFontTextMetrics` его только после выбора свойства «стандартный шрифт», чтобы гарантировать, что предоставляемая им информация является допустимой.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Реализует функцию Get для свойства «основной цвет акции».

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение задает текущий цвет переднего плана как значение OLE_COLOR, если оно выполнено успешно. Это значение можно преобразовать в значение [COLORREF](/windows/win32/gdi/colorref) с помощью вызова метода `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Реализует функцию Get свойства "фондовой биржи".

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Возвращаемое значение

Обработчик окна элемента управления OLE (при наличии); в противном случае — NULL.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Вызывается платформой для получения короткой строки, описывающей назначение пункта меню, идентифицируемого *NID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор пункта меню.

*рмессаже*<br/>
Ссылка на объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , через который будет возвращена строка.

### <a name="remarks"></a>Примечания

Это можно использовать для получения сообщения для вывода в строке состояния во время выделения пункта меню. Реализация по умолчанию пытается загрузить строковый ресурс, идентифицируемый *NID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Предотвращает доступ пользователя к значению свойства элемента управления.

```
void GetNotSupported();
```

### <a name="remarks"></a>Примечания

Вызывайте эту функцию вместо функции Get любого свойства, когда извлечение свойства пользователем элемента управления не поддерживается. Одним из примеров может быть свойство, которое доступно только для записи.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Возвращает состояние готовности элемента управления.

```
long GetReadyState();
```

### <a name="return-value"></a>Возвращаемое значение

Состояние готовности элемента управления, одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|Элемент управления в данный момент загружает свойства|
|READYSTATE_LOADED|Элемент управления инициализирован|
|READYSTATE_INTERACTIVE|Элемент управления имеет достаточно данных для интерактивного взаимодействия, но не все асинхронные данные еще загружены|
|READYSTATE_COMPLETE|Все данные элемента управления|

### <a name="remarks"></a>Примечания

Большинству простых элементов управления никогда не нужно различать ЗАГРУЖЕНные и ИНТЕРАКТИВные элементы. Однако элементы управления, которые поддерживают свойства пути к данным, могут быть готовы к интерактивному использованию, пока по крайней мере некоторые данные не будут получены асинхронно. Элемент управления должен попытаться перейти в интерактивный режиме как можно скорее.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Получает координаты прямоугольника элемента управления относительно контейнера, выраженного в единицах устройства.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
Указатель на структуру прямоугольника, в которую будут скопированы координаты элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления встроен в активное расположение; в противном случае — 0.

### <a name="remarks"></a>Примечания

Прямоугольник является допустимым только в том случае, если элемент управления находится в активном месте.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Измеряет текстовые метрики для свойства «стандартный шрифт» элемента управления, которое можно выбрать с помощью функции [селектстоккфонт](#selectstockfont) .

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Параметры

*лптм*<br/>
Указатель на структуру [текстметрик](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

### <a name="remarks"></a>Примечания

Функция инициализирует структуру, на которую указывает лптм, с допустимыми сведениями о метриках в случае успеха, или заполните структуру нулями, если они не были успешными. `GetStockTextMetrics` `TEXTMETRIC` Используйте эту функцию вместо [жеттекстметрикс](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) при рисовании элемента управления, так как элементы управления, как и любой ВНЕДРЕНный OLE-объект, могут быть необходимы для отрисовки в метафайл.

Структура шрифта по умолчанию обновляется `SelectStockFont` при вызове функции. `TEXTMETRIC` Эту функцию следует вызывать только после выбора шрифта акции, чтобы гарантировать, что предоставляемая им информация является допустимой.

##  <a name="gettext"></a>  COleControl::GetText

Реализует функцию Get для стандартного текста или свойства Caption.

```
BSTR GetText();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение текстовой строки элемента управления или строка нулевой длины, если строка не существует.

> [!NOTE]
>  Дополнительные сведения о типе данных BSTR см. в статье [типы данных](../../mfc/reference/data-types-mfc.md) в разделе Macros and Globals.

### <a name="remarks"></a>Примечания

Обратите внимание, что вызывающая функция для `SysFreeString` этой функции должна вызывать в строке, возвращенной для освобождения ресурса. В реализации элемента управления используйте `InternalGetText` для доступа к свойству «стандартный текст» или «заголовок» элемента управления.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

Переопределите `GetWindowlessDropTarget` , если требуется, чтобы безоконный элемент управления не был целевым объектом операции перетаскивания OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `IDropTarget` интерфейс объекта. Так как у него нет окна, объект без окон не может зарегистрировать `IDropTarget` интерфейс. Однако для участия в перетаскивании объект без окон по-прежнему может реализовать интерфейс и вернуть его в `GetWindowlessDropTarget`.

### <a name="remarks"></a>Примечания

Как правило, это потребует, чтобы окно элемента управления было зарегистрировано как цель перетаскивания. Но поскольку элемент управления не имеет собственного окна, контейнер будет использовать собственное окно в качестве цели перетаскивания. Элементу управления просто требуется предоставить реализацию `IDropTarget` интерфейса, к которому контейнер может делегировать вызовы в соответствующее время. Например:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>COleControl:: Инитиализеиидс

Информирует базовый класс идентификаторов IID, который будет использоваться элементом управления.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Параметры

*пиидпримари*<br/>
Указатель на идентификатор интерфейса основного интерфейса диспетчеризации элемента управления.

*пиидевентс*<br/>
Указатель на идентификатор интерфейса интерфейса события элемента управления.

### <a name="remarks"></a>Примечания

Вызовите эту функцию в конструкторе элемента управления, чтобы сообщить базовому классу идентификаторов интерфейсов, которые будет использовать элемент управления.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Обращается к свойству "Стандартный шрифт" вашего элемента управления

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Возвращаемое значение

Ссылка на объект [кфонсолдер](../../mfc/reference/cfontholder-class.md) , который содержит объект шрифта акции.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Обращается к свойству "Стандартный текст" или "заголовок" вашего элемента управления.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Возвращаемое значение

Ссылка на текстовую строку элемента управления.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Задает состояние готовности элемента управления.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Параметры

*лневреадистате*<br/>
Состояние готовности, устанавливаемое для элемента управления, одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|Элемент управления в данный момент загружает свойства|
|READYSTATE_LOADED|Элемент управления инициализирован|
|READYSTATE_INTERACTIVE|Элемент управления имеет достаточно данных для интерактивного взаимодействия, но не все асинхронные данные еще загружены|
|READYSTATE_COMPLETE|Все данные элемента управления|

### <a name="remarks"></a>Примечания

Большинству простых элементов управления никогда не нужно различать ЗАГРУЖЕНные и ИНТЕРАКТИВные элементы. Однако элементы управления, которые поддерживают свойства пути к данным, могут быть готовы к интерактивному использованию, пока по крайней мере некоторые данные не будут получены асинхронно. Элемент управления должен попытаться перейти в интерактивный режиме как можно скорее.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Заставляет элемент управления перерисовывать себя.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
Указатель на область элемента управления, который необходимо сделать недействительным.

*берасе*<br/>
Указывает, следует ли удалять фон в области обновления при обработке области обновления.

### <a name="remarks"></a>Примечания

Если *лпрект* имеет значение null, весь элемент управления будет перерисован. Если *лпрект* не равно null, это указывает на часть прямоугольника элемента управления, которая должна стать недействительной. В случаях, когда элемент управления не имеет окна или в данный момент не активен, прямоугольник игнорируется и вызывается функция-член [иадвисесинк:: онвиевчанже](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) клиентского сайта. Используйте эту функцию вместо `CWnd::InvalidateRect` или. `InvalidateRect`

##  <a name="invalidatergn"></a>COleControl:: Инвалидатергн

Делает недействительным клиентскую область окна контейнера в заданной области.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Параметры

*пргн*<br/>
Указатель на объект [кргн](../../mfc/reference/crgn-class.md) , определяющий область вывода объекта OLE, которую необходимо сделать недействительными, в клиентских координатах содержащего окна. Если этот параметр имеет значение NULL, то экстентом является весь объект.

*берасе*<br/>
Указывает, следует ли стирать фон в пределах недействительной области. Значение TRUE показывает, что фон удаляется. Если значение равно FALSE, фон остается неизменным.

### <a name="remarks"></a>Примечания

Его можно использовать для перерисовки безоконных элементов управления в контейнере. Недействительная область, а также все остальные области в области обновления помечаются для рисования при отправке следующего сообщения [WM_PAINT](/windows/win32/gdi/wm-paint) .

Если *берасе* имеет значение true для любой части области обновления, то фон во всем регионе, а не только в заданной части, удаляется.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Позволяет выполнять специальную загрузку элемента управления OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления преобразуется; в противном случае — 0.

### <a name="remarks"></a>Примечания

При преобразовании формы, использующей элементы управления VBX, к той, которая использует элементы управления OLE, может потребоваться специальный код загрузки для элементов управления OLE. Например, если вы загружаете экземпляр элемента управления OLE, у вас может быть вызов [PX_Font](persistence-of-ole-controls.md#px_font) в `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Однако элементы управления VBX не имеют объекта Font; Каждое свойство Font сохранено по отдельности. В этом случае следует использовать `IsConvertingVBX` для различения этих двух вариантов:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Другой случай — если ваш элемент управления VBX сохранил собственные двоичные данные (в своем обработчике сообщений VBM_SAVEPROPERTY), и элемент управления OLE сохранит свои двоичные данные в другом формате. Если вы хотите, чтобы элемент управления OLE был обратно совместим с элементом управления VBX, можно считать старый и новый форматы, используя `IsConvertingVBX` функцию, путем различения загрузки элемента управления VBX или элемента управления OLE.

В `DoPropExchange` функции вашего элемента управления можно проверить это условие и, если значение true, выполнить загрузку кода, относящегося к этому преобразованию (например, в предыдущих примерах). Если элемент управления не преобразуется, можно выполнить нормальный код загрузки. Эта возможность применима только к элементам управления, преобразуемым из аналога VBX.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Включает вызов метода автоматизации.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления инициализирован; в противном случае — 0.

### <a name="remarks"></a>Примечания

Реализация `IDispatch::Invoke` `dispid`вызовов `IsInvokeAllowed` платформы для определения, может ли быть вызвана заданная функция (идентифицируемая). Поведение по умолчанию для элемента управления OLE заключается в том, чтобы разрешить вызов методов автоматизации только в том случае, если элемент управления инициализирован. `IsInvokeAllowed` однако является виртуальной функцией и может быть переопределена при необходимости (например, когда элемент управления используется в качестве сервера автоматизации).

##  <a name="ismodified"></a>  COleControl::IsModified

Определяет, было ли изменено состояние элемента управления.

```
BOOL IsModified();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если состояние элемента управления было изменено с момента последнего сохранения; в противном случае — 0.

### <a name="remarks"></a>Примечания

Состояние элемента управления изменяется при изменении значения свойства.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Определяет, поддерживает ли контейнер оптимизированный рисунок для текущей операции рисования.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если контейнер поддерживает оптимизированное Рисование для текущей операции рисования; в противном случае — FALSE.

### <a name="remarks"></a>Примечания

Если оптимизированный рисунок поддерживается, элементу управления не нужно выбирать старые объекты (перья, кисти, шрифты и т. д.) в контексте устройства после завершения рисования.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Вызывается платформой для определения, является ли элемент управления подклассом элемента управления Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления является подклассом; в противном случае — 0.

### <a name="remarks"></a>Примечания

Необходимо переопределить эту функцию и вернуть значение TRUE, если элемент управления OLE является подклассом элемента управления Windows.

##  <a name="load"></a>  COleControl::Load

Сбрасывает все предыдущие данные, загруженные асинхронно, и инициирует новую загрузку асинхронного свойства элемента управления.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Параметры

*strNewPath*<br/>
Указатель на строку, содержащую путь, который ссылается на абсолютное расположение свойства асинхронного элемента управления.

*предл*<br/>
Объект [кдатапаспроперти](../../mfc/reference/cdatapathproperty-class.md) , реализующий асинхронное свойство элемента управления.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Предотвращает деактивацию элемента управления в контейнере.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Параметры

*Блок*<br/>
Значение TRUE, если активное состояние элемента управления на месте должно быть заблокировано; Значение FALSE, если необходимо разблокировать.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если блокировка прошла успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Обратите внимание, что каждая блокировка элемента управления должна быть сопряжена с разблокировкой элемента управления по завершении. Элемент управления следует блокировать только для коротких периодов, например при срабатывании события.

##  <a name="onambientpropertychange"></a>COleControl:: Онамбиентпропертичанже

Вызывается платформой при изменении значения внешнего свойства контейнера.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*dispID*<br/>
Идентификатор диспетчеризации свойства окружения, измененного или DISPID_UNKNOWN при изменении нескольких свойств.

##  <a name="onappearancechanged"></a>COleControl:: Онаппеаранцечанжед

Вызывается структурой при изменении значения свойства "Оформление акции".

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если требуется уведомление после изменения этого свойства. Реализация по умолчанию `InvalidateControl`вызывает.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Вызывается структурой при изменении значения свойства "стандартное значение".

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если требуется уведомление после изменения этого свойства. Реализация по умолчанию `InvalidateControl`вызывает.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Вызывается структурой при изменении значения свойства BorderStyle для акции.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию `InvalidateControl`вызывает.

Переопределите эту функцию, если требуется уведомление после изменения этого свойства.

##  <a name="onclick"></a>COleControl:: OnClick

Вызывается структурой при нажатии кнопки мыши или при вызове метода DoClick.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Параметры

*ибуттон*<br/>
Индекс кнопки мыши. Может иметь одно из следующих значений:

- LEFT_BUTTON нажата левая кнопка мыши.

- MIDDLE_BUTTON нажата средняя кнопка мыши.

- RIGHT_BUTTON нажата правая кнопка мыши.

### <a name="remarks"></a>Примечания

Реализация по умолчанию `COleControl::FireClick`вызывает.

Переопределите эту функцию-член, чтобы изменить или расширить обработку по умолчанию.

##  <a name="onclose"></a>COleControl:: OnClose

Вызывается платформой, когда контейнер вызвал `IOleControl::Close` функцию элемента управления.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Параметры

*двсавеоптион*<br/>
Флаг, указывающий, следует ли сохранить объект перед загрузкой. Допустимые значения:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Примечания

По умолчанию `OnClose` сохраняет объект элемента управления, если он был изменен и *двсавеоптион* имеет значение OLECLOSE_SAVEIFDIRTY или OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Вызывается платформой, когда контейнер вызывает `IOleObject::DoVerb` функцию члена.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*иверб*<br/>
Индекс вызываемой команды элемента управления.

*лпмсг*<br/>
Указатель на сообщение Windows, вызвавшее вызов команды.

*хвндпарент*<br/>
Маркер родительского окна элемента управления. Если при выполнении команды создается окно (или Windows), то в качестве родителя следует использовать *хвндпарент* .

*лпрект*<br/>
Указатель на структуру RECT, в которую будет скопированы координаты элемента управления относительно контейнера.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае — 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию использует записи схемы сообщений ON_OLEVERB и ON_STDOLEVERB, чтобы определить подходящую функцию для вызова.

Переопределите эту функцию, чтобы изменить обработку глагола по умолчанию.

##  <a name="ondraw"></a>  COleControl::OnDraw

Вызывается платформой для отрисовки элемента управления OLE в указанном ограничивающем прямоугольнике с помощью указанного контекста устройства.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором происходит рисование.

*ркбаундс*<br/>
Прямоугольная область элемента управления, включая границу.

*рЦинвалид*<br/>
Недопустимая прямоугольная область элемента управления.

### <a name="remarks"></a>Примечания

`OnDraw`обычно вызывается для отображения экрана с передачей контекста устройства экрана в качестве *основного контроллера домена*. Параметр *ркбаундс* определяет прямоугольник в контексте целевого устройства (относительно текущего режима сопоставления). Параметр *рЦинвалид* является недопустимым фактическим прямоугольником. В некоторых случаях это будет меньше области, чем *ркбаундс*.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

Вызывается платформой для отрисовки элемента управления OLE в указанном ограничивающем прямоугольнике с помощью указанного контекста устройства в формате метафайла.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором происходит рисование.

*ркбаундс*<br/>
Прямоугольная область элемента управления, включая границу.

### <a name="remarks"></a>Примечания

Реализация по умолчанию вызывает функцию [OnDraw](#ondraw) .

##  <a name="onedit"></a>  COleControl::OnEdit

Вызывает активацию элемента управления в пользовательском интерфейсе.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*лпмсг*<br/>
Указатель на сообщение Windows, вызвавшее команду.

*хвндпарент*<br/>
Маркер родительского окна элемента управления.

*лпрект*<br/>
Указатель на прямоугольник, используемый элементом управления в контейнере.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов успешно выполнен; в противном случае — 0.

### <a name="remarks"></a>Примечания

Это действует так же, как вызов команды OLEIVERB_UIACTIVATE элемента управления.

Эта функция обычно используется в качестве функции обработчика для записи схемы сообщения ON_OLEVERB. Это делает команду "Изменить" доступной в меню "объект" элемента управления. Например:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>COleControl:: Оненабледчанжед

Вызывается структурой при изменении значения свойства, включенного в склад.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если требуется уведомление после изменения этого свойства. Реализация по умолчанию вызывает [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Вызывается платформой, когда контейнер вызывает `IOleObject::EnumVerbs` функцию члена.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Параметры

*ппенумолеверб*<br/>
Указатель на `IEnumOLEVERB` объект, перечисляющий команды элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если доступны команды. в противном случае — 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию перечисляет записи ON_OLEVERB в схеме сообщений.

Переопределите эту функцию, чтобы изменить способ перечисления команд по умолчанию.

##  <a name="oneventadvise"></a>COleControl:: Оневентадвисе

Вызывается платформой, когда обработчик событий подключается к элементу управления OLE или отключается от него.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Параметры

*бадвисе*<br/>
Значение TRUE указывает, что обработчик событий был подключен к элементу управления. Значение FALSE указывает, что обработчик событий был отключен от элемента управления.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Вызывается структурой при изменении значения свойства "шрифт акции".

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию `COleControl::InvalidateControl`вызывает. Если элемент управления является подклассом элемента управления Windows, реализация по умолчанию также отправляет сообщение WM_SETFONT в окно элемента управления.

Переопределите эту функцию, если требуется уведомление после изменения этого свойства.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Вызывается структурой при изменении значения свойства "ForeColor" на бирже.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию `InvalidateControl`вызывает.

Переопределите эту функцию, если требуется уведомление после изменения этого свойства.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Вызывается платформой после вызова `IOleControl::FreezeEvents`контейнера.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Параметры

*бфризе*<br/>
Значение TRUE, если обработка событий элемента управления заморожена; в противном случае — FALSE.

### <a name="remarks"></a>Примечания

Реализация по умолчанию не выполняет никаких действий.

Переопределите эту функцию, если требуется дополнительное поведение при замороженной или незамороженной обработке событий.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Вызывается платформой, когда контейнер вызывает `IViewObject::GetColorSet` функцию члена.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Параметры

*ptd*<br/>
Указывает на целевое устройство, для которого должен быть подготовлен снимок. Если это значение равно NULL, изображение должно быть подготовлено для целевого устройства по умолчанию (обычно это устройство отображения).

*хиктаржетдев*<br/>
Указывает контекст информации на целевом устройстве, указанном параметром *ПТД*. Этот параметр может быть контекстом устройства, но это не обязательно. Если *ПТД* имеет значение null, *хиктаржетдев* также должно иметь значение null.

*ppColorSet*<br/>
Указатель на расположение, в которое необходимо скопировать набор цветов, которые будут использоваться. Если функция не возвращает набор цветов, возвращается значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если возвращается допустимый набор цветов; в противном случае — 0.

### <a name="remarks"></a>Примечания

Контейнер вызывает эту функцию для получения всех цветов, необходимых для рисования элемента управления OLE. Контейнер может использовать наборы цветов, полученные в сочетании с цветами, требуемыми для установки общей цветовой палитры. Реализация по умолчанию возвращает значение FALSE.

Переопределите эту функцию, чтобы выполнить специальную обработку этого запроса.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Вызывается структурой, когда контейнер элемента управления запрашивает сведения об элементе управления.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Параметры

*пконтролинфо*<br/>
Указатель на структуру [контролинфо](/windows/win32/api/ocidl/ns-ocidl-controlinfo) для заполнения.

### <a name="remarks"></a>Примечания

Эта информация состоит в основном из описания назначенных клавиш элемента управления. Реализация по умолчанию заполняет *пконтролинфо* данными по умолчанию.

Переопределите эту функцию, если элементу управления требуется обрабатывать назначенные клавиши.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Вызывается платформой для получения строки, представляющей текущее значение свойства, идентифицируемого *DISPID*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*strValue*<br/>
Ссылка на объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , через который будет возвращена строка.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если строка была возвращена в *strValue;* в противном случае 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если у элемента управления есть свойство, значение которого нельзя преобразовать непосредственно в строку, и вы хотите, чтобы значение свойства отображалось в браузере свойств, предоставленном контейнером.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Вызывается структурой, когда элемент управления активируется в пользовательском интерфейсе, чтобы получить меню для слияния с существующим меню контейнера.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Возвращаемое значение

Маркер меню элемента управления или значение NULL, если у элемента управления нет. Реализация по умолчанию возвращает значение NULL.

### <a name="remarks"></a>Примечания

Дополнительные сведения о слиянии ресурсов OLE см. в [меню и ресурсах (OLE)](../../mfc/menus-and-resources-ole.md)статьи.

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Вызывается платформой в ответ на `IViewObjectEx::GetNaturalExtent` запрос контейнера.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Параметры

*дваспект*<br/>
Указывает способ представления объекта. Представления включают содержимое, значок, эскиз или печатный документ. Допустимые значения берутся из перечисления [дваспект](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*линдекс*<br/>
Часть объекта, представляющая интерес. В настоящее время допустимо только 1.

*ptd*<br/>
Указывает на структуру [двтаржетдевице](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , определяющую целевое устройство, для которого должен быть возвращен размер объекта.

*хиктаржетдев*<br/>
Задает информационный контекст для целевого устройства, указанный параметром *ПТД* , из которого объект может извлекать метрики устройства и тестировать возможности устройства. Если *ПТД* имеет значение null, объект должен игнорировать значение в параметре *хиктаржетдев* .

*pExtentInfo*<br/>
Указывает на `DVEXTENTINFO` структуру, задающую данные о размере. `DVEXTENTINFO` Структура:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Член `dwExtentMode` структуры может принимать одно из двух значений:

- DVEXTENT_CONTENT. запрашивать размер элемента управления в точном соответствии с содержимым (с привязкой к размеру)

- DVEXTENT_INTEGRAL при изменении размера, передавать предложенный размер для контроля

*псизел*<br/>
Указывает на размер данных, возвращаемых элементом управления. Возвращаемые данные размера устанавливаются в значение-1 для любого измерения, которое не было скорректировано.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если успешно Возвращает или корректирует размер; в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, чтобы вернуть размер отображения объекта, ближайший к предложенному размеру и режиму экстента в `DVEXTENTINFO` структуре. Реализация по умолчанию возвращает значение FALSE и не вносит изменения в размер.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Вызывается платформой для получения набора предопределенных строк, представляющих возможные значения для свойства.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*пстрингаррай*<br/>
Массив строк, который необходимо заполнить возвращаемыми значениями.

*пкукиеаррай*<br/>
Массив типа DWORD, который необходимо заполнить возвращаемыми значениями.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элементы были добавлены в *пстрингаррай* и *пкукиеаррай*.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если у элемента управления есть свойство с набором возможных значений, которые могут быть представлены строками. Для каждого элемента, добавляемого в *пстрингаррай*, необходимо добавить соответствующий элемент "cookie" в *пкукиеаррай.* Эти значения "cookie" впоследствии могут передаваться платформой `COleControl::OnGetPredefinedValue` функции.

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Вызывается платформой для получения значения, соответствующего одной из предопределенных строк, ранее возвращенных переопределением `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*двкукие*<br/>
Значение файла cookie, которое ранее было возвращено `COleControl::OnGetPredefinedStrings`переопределением.

*лпвараут*<br/>
Указатель на `VARIANT` структуру, через которую будет возвращено значение свойства.

### <a name="return-value"></a>Возвращаемое значение

Не равно нулю, если значение было возвращено в *лпвараут*; в противном случае — 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Вызывается платформой в ответ на запрос [IViewObject2::-экстент](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) контейнера.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Параметры

*двдраваспект*<br/>
DWORD, описывающий, какой вид или аспект объекта должен отображаться. Допустимые значения берутся из перечисления [дваспект](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*линдекс*<br/>
Часть объекта, представляющая интерес. В настоящее время допустимо только 1.

*ptd*<br/>
Указывает на структуру [двтаржетдевице](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , определяющую целевое устройство, для которого должен быть возвращен размер объекта.

*лпсизел*<br/>
Указывает на расположение, где возвращается размер объекта.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если сведения о экстенте успешно возвращены; в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если в элементе управления используется двусторонняя прорисовка, и ее непрозрачные и прозрачные части имеют разные измерения.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Вызывается платформой в ответ на `IViewObjectEx::GetRect` запрос контейнера.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Параметры

*дваспект*<br/>
DWORD, описывающий, какой вид или аспект объекта должен отображаться. Допустимые значения берутся из перечисления [дваспект](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2:

- DVASPECT_CONTENT ограничивающий прямоугольник всего объекта. Левый верхний угол в источнике объекта и размер, равный экстенту, `GetViewExtent`возвращенному *.*

- Объекты DVASPECT_OPAQUE с прямоугольной непрозрачной областью возвращают этот прямоугольник. Другие сбои.

- DVASPECT_TRANSPARENT прямоугольник, охватывающий все прозрачные или неравномерные части.

*прект*<br/>
Указывает на структуру [Rect](/previous-versions/dd162907\(v=vs.85\)) , указывающую прямоугольник, в котором должен быть нарисован объект. Этот параметр управляет положением и растяжением объекта.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если размер прямоугольника для объекта возвращается успешно. в противном случае — 0.

### <a name="remarks"></a>Примечания

Размер объекта преобразуется в прямоугольник, `OnGetViewRect` начинающийся с определенной позиции (по умолчанию это верхний левый угол экрана). Переопределите эту функцию, если в элементе управления используется двусторонняя прорисовка, и ее непрозрачные и прозрачные части имеют разные измерения.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Вызывается платформой в ответ на `IViewObjectEx::GetViewStatus` запрос контейнера.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Возвращаемое значение

При успешном выполнении одно из значений перечисления ВИЕВСТАТУС. в противном случае — 0. Возможные значения — любое сочетание следующих параметров:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Объект полностью непрозрачен. Если этот бит не задан, объект содержит прозрачные части. Этот бит применяется только к аспектам, связанным с содержимым, а не к DVASPECT_ICON или DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Объект имеет сплошной фон (состоящий из сплошного цвета, а не шаблона кисти). Этот бит имеет смысл только в том случае, если VIEWSTATUS_OPAQUE установлен и применим только к аспектам, связанным с содержимым, а не к DVASPECT_ICON или DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Объект поддерживает DVASPECT_OPAQUE. С этим пропорциями можно вызывать все методы Ивиевобжектекс, которые принимают вид рисунка в качестве параметра.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Объект поддерживает DVASPECT_TRANSPARENT. С `IViewObjectEx` этим пропорциями можно вызывать все методы, которые принимают вид рисунка в качестве параметра.|

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если в элементе управления используется двусторонняя прорисовка. Реализация по умолчанию возвращает VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Вызывается платформой при отключении элемента управления в пользовательском интерфейсе.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Примечания

Реализация должна скрыть все панели инструментов, `OnShowToolbars`отображаемые.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Вызывается контейнером для неактивного объекта под указателем мыши при получении сообщения WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Параметры

*лпркбаундс*<br/>
Прямоугольник, ограничивающий объект, в клиентских координатах содержащего окна. Сообщает объекту точное расположение и размер на экране при получении сообщения WM_MOUSEMOVE.

*x*<br/>
Координата x положения указателя мыши в клиентских координатах содержащего окна.

*y*<br/>
Координата y положения указателя мыши в клиентских координатах содержащего окна.

*двкэйстате*<br/>
Определяет текущее состояние клавиш с модификатором клавиатуры на клавиатуре. Допустимые значения могут быть сочетанием любого из флагов MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON и MK_RBUTTON.

### <a name="remarks"></a>Примечания

Обратите внимание, что для передачи позиции курсора мыши используется координата клиента окна (пикселей). Это стало возможным благодаря передаче ограничивающего прямоугольника объекта в ту же систему координат.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Вызывается контейнером для неактивного объекта под указателем мыши при получении сообщения WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Параметры

*лпркбаундс*<br/>
Прямоугольник, ограничивающий объект, в клиентских координатах содержащего окна. Сообщает объекту точное расположение и размер на экране при получении сообщения WM_SETCURSOR.

*x*<br/>
Координата x положения указателя мыши в клиентских координатах содержащего окна.

*y*<br/>
Координата y положения указателя мыши в клиентских координатах содержащего окна.

*dwMouseMsg*<br/>
Идентификатор сообщения мыши, для которого произошла WM_SETCURSOR.

*бсеталвайс*<br/>
Указывает, должен ли объект устанавливать курсор. Если значение — TRUE, объект должен установить курсор; Если значение равно FALSE, курсор не обязан установить курсор и в этом случае должен возвращать S_FALSE.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Обратите внимание, что для передачи позиции курсора мыши используется координата клиента окна (пикселей). Это стало возможным благодаря передаче ограничивающего прямоугольника объекта в ту же систему координат.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Вызывается структурой после обработки события KeyDown.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Значение виртуального ключевого кода нажатой клавиши. Список стандартных виртуальных клавиш см. в разделе Winuser. h

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элементу управления требуется доступ к сведениям о ключе после запуска события.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Вызывается платформой после срабатывания события нажатия на акцию.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Содержит значение виртуального ключевого кода нажатой клавиши. Список стандартных виртуальных клавиш см. в разделе Winuser. h

### <a name="remarks"></a>Примечания

Обратите внимание, что значение *nchar* может быть изменено контейнером.

Переопределите эту функцию, если требуется уведомление после наступления этого события.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Вызывается структурой после обработки события KeyDown.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Значение виртуального ключевого кода нажатой клавиши. Список стандартных виртуальных клавиш см. в разделе Winuser. h

*ншифтстате*<br/>
Содержит сочетание следующих флагов:

- SHIFT_MASK клавиша SHIFT была нажата во время действия.

- CTRL_MASK клавиша CTRL была нажата во время действия.

- ALT_MASK клавиша ALT была нажата во время действия.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элементу управления требуется доступ к сведениям о ключе после запуска события.

##  <a name="onmappropertytopage"></a>COleControl:: Онмаппропертитопаже

Вызывается платформой для получения идентификатора класса страницы свойств, реализующей редактирование указанного свойства.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Параметры

*DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*лпклсид*<br/>
Указатель на `CLSID` структуру, с помощью которой будет возвращен идентификатор класса.

*пбпажеоптионал*<br/>
Возвращает признак того, является ли использование заданной страницы свойств необязательным.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если идентификатор класса был возвращен в *лпклсид*; в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, чтобы предоставить способ вызова страниц свойств элемента управления из браузера свойств контейнера.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Вызывается платформой при обнаружении контейнером нажатия назначенной клавиши в элементе управления OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Параметры

*пмсг*<br/>
Указатель на сообщение Windows, созданное нажатием назначенной клавиши.

##  <a name="onproperties"></a>Свойства COleControl::

Вызывается структурой при вызове команды свойств элемента управления контейнером.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*лпмсг*<br/>
Указатель на сообщение Windows, вызвавшее команду.

*хвндпарент*<br/>
Маркер родительского окна элемента управления.

*лпрект*<br/>
Указатель на прямоугольник, используемый элементом управления в контейнере.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов успешно выполнен; в противном случае — 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию отображает модальное диалоговое окно Свойства.

Эту функцию также можно использовать, чтобы вызвать отображение страниц свойств элемента управления. Выполните вызов `OnProperties` функции, передав в параметр *хвндпарент* маркер родителя элемента управления. В этом случае значения параметров *лпмсг* и *лпрект* игнорируются.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Вызывается платформой в ответ на `IViewObjectEx::QueryHitPoint` запрос контейнера.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Параметры

*дваспект*<br/>
Указывает способ представления объекта. Допустимые значения берутся из перечисления [дваспект](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*пректбаундс*<br/>
Указатель на `RECT` структуру, указывающую ограничивающий прямоугольник клиентской области элемента управления OLE.

*птллок*<br/>
Указатель на структуру `POINT` , указывающую точку, которая должна быть проверена на попадание. Точка указывается в координатах области клиента OLE.

*лклосехинт*<br/>
Расстояние, которое определяет "Close" до точки, проверенной на попадание.

*фитресулт*<br/>
Указатель на результат запроса на попадание. Одно из следующих значений:

- HITRESULT_OUTSIDE *птллок* находится за пределами объекта OLE и не закрывается.

- HITRESULT_TRANSPARENT *птллок* находится внутри границ объекта OLE, но не близко к изображению. Например, точка в середине прозрачного круга может быть HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *птллок* находится внутри или за пределами объекта OLE, но достаточно близко к объекту, который будет рассматриваться внутри. Для небольших, тонких или детализированных объектов это значение может использоваться. Даже если точка находится за пределами ограничивающего прямоугольника объекта, он все равно может быть закрыт (это необходимо для попадания в небольшие объекты).

- HITRESULT_HIT *птллок* находится внутри изображения объекта.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если результат попадания возвращается успешно; в противном случае — 0. Попадание — это перекрытие с областью просмотра элемента управления OLE.

### <a name="remarks"></a>Примечания

Запрашивает, перекрывает ли прямоугольник, отображаемый объектом, заданную точку (попадания в точку). `QueryHitPoint`может быть переопределен для проверки попадания для непрямоугольных объектов.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Вызывается платформой в ответ на `IViewObjectEx::QueryHitRect` запрос контейнера.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Параметры

*дваспект*<br/>
Указывает способ представления объекта. Допустимые значения берутся из перечисления [дваспект](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*пректбаундс*<br/>
Указатель на `RECT` структуру, указывающую ограничивающий прямоугольник клиентской области элемента управления OLE.

*прклок*<br/>
Указатель на `RECT` структуру, указывающую прямоугольник для проверки на попадание (пересекается с прямоугольником объекта) относительно левого верхнего угла объекта.

*лклосехинт*<br/>
Не используется.

*фитресулт*<br/>
Указатель на результат запроса на попадание. Одно из следующих значений:

- HITRESULT_OUTSIDE. точка в прямоугольнике не достигнута объектом OLE.

- HITRESULT_HIT по крайней мере одной точкой в прямоугольнике будет попадание на объект.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если результат попадания возвращается успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Запрашивает, перекрывается ли прямоугольник, отображаемый объектом, точкой в заданном прямоугольнике (она находится в прямоугольнике). `QueryHitRect`может быть переопределен для проверки попадания для непрямоугольных объектов.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Вызывается платформой для получения данных в указанном формате.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Параметры

*лпформатетк*<br/>
Указывает на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , указывающую формат, в котором запрашиваются сведения.

*лпстгмедиум*<br/>
Указывает на структуру [стгмедиум](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) , в которой должны возвращаться данные.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Указанный формат — один, ранее помещенный в управляющий объект с помощью функций-членов [делайрендердата](../../mfc/reference/coledatasource-class.md#delayrenderdata) или [делайрендерфиледата](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) для отложенной отрисовки. Реализация по умолчанию этой функции вызывает `OnRenderFileData` или `OnRenderGlobalData`, соответственно, если указанный носитель является либо файлом, либо памятью. Если запрошенный формат — CF_METAFILEPICT или постоянный формат набора свойств, то реализация по умолчанию визуализирует соответствующие данные и возвращает ненулевое значение. В противном случае он возвращает 0 и не выполняет никаких действий.

Если *лпстгмедиум-> тимед* — TYMED_NULL, то стгмедиум следует выделить и заполнить, как указано в *лпформатетк-> тимед*. Если не TYMED_NULL, СТГМЕДИУМ следует заполнять данными.

Переопределите эту функцию, чтобы предоставить данные в запрошенном формате и среднем. В зависимости от данных может потребоваться переопределить одну из других версий этой функции. Если данные невелики и имеют фиксированный размер, `OnRenderGlobalData`Переопределите. Если данные находятся в файле или имеют переменный размер, переопределите `OnRenderFileData`.

Дополнительные сведения см. в разделе `FORMATETC` структуры `STGMEDIUM` и в Windows SDK.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Вызывается платформой для получения данных в указанном формате, когда среда хранения представляет собой файл.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Параметры

*лпформатетк*<br/>
Указывает на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , указывающую формат, в котором запрашиваются сведения.

*pFile*<br/>
Указывает на объект [кфиле](../../mfc/reference/cfile-class.md) , в котором должны быть визуализированы данные.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Указанный формат был ранее помещен в управляющий объект с помощью функции-члена [делайрендердата](../../mfc/reference/coledatasource-class.md#delayrenderdata) для отложенной отрисовки. Реализация по умолчанию этой функции просто возвращает значение FALSE.

Переопределите эту функцию, чтобы предоставить данные в запрошенном формате и среднем. В зависимости от данных может потребоваться переопределить одну из других версий этой функции. Если требуется выполнить обработку нескольких средних носителей, переопределите `OnRenderData`. Если данные находятся в файле или имеют переменный размер, переопределите `OnRenderFileData`.

Дополнительные сведения см. в описании `FORMATETC` структуры в Windows SDK.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Вызывается платформой для получения данных в указанном формате, если указанный носитель является глобальной памятью.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Параметры

*лпформатетк*<br/>
Указывает на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , указывающую формат, в котором запрашиваются сведения.

*фглобал*<br/>
Указывает на указатель на глобальную память, в которой должны возвращаться данные. Если память не была выделена, этот параметр может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Указанный формат был ранее помещен в управляющий объект с помощью функции-члена [делайрендердата](../../mfc/reference/coledatasource-class.md#delayrenderdata) для отложенной отрисовки. Реализация по умолчанию этой функции просто возвращает значение FALSE.

Если *фглобал* имеет значение null, то новый хглобал должен быть выделен и возвращен в *фглобал*. В противном случае ХГЛОБАЛ, заданный параметром *фглобал* , должен быть заполнен данными. Объем данных, помещаемых в ХГЛОБАЛ, не должен превышать текущий размер блока памяти. Кроме того, блок нельзя перераспределить до большего размера.

Переопределите эту функцию, чтобы предоставить данные в запрошенном формате и среднем. В зависимости от данных может потребоваться переопределить одну из других версий этой функции. Если требуется выполнить обработку нескольких средних носителей, переопределите `OnRenderData`. Если данные находятся в файле или имеют переменный размер, переопределите `OnRenderFileData`.

Дополнительные сведения см. в описании `FORMATETC` структуры в Windows SDK.

##  <a name="onresetstate"></a>  COleControl::OnResetState

Вызывается структурой, когда свойству элемента управления должны быть присвоены значения по умолчанию.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию вызывает [DoPropExchange](#dopropexchange), передавая `CPropExchange` объект, вызывающий свойства, для которого заданы значения по умолчанию.

Средство записи управления может вставлять код инициализации для элемента управления OLE в это переопределяемое значение. Эта функция вызывается, когда вызывается сбой [IPersistStream:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) или [иперсистстораже:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) или [иперсистстреаминит:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) или [иперсистстораже:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) , без предварительного вызова либо `IPersistStream::Load` `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

Вызывается платформой, когда контейнер вызвал `IOleControl::SetClientSite` функцию элемента управления.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Примечания

По умолчанию `OnSetClientSite` проверяет, загружены ли свойства пути к данным, и, если они `DoDataPathPropExchange`есть, вызывает.

Переопределите эту функцию для выполнения специальной обработки этого уведомления. В частности, переопределения этой функции должны вызывать базовый класс.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Вызывается платформой для замены данных элемента управления указанными данными.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Параметры

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , указывающую формат данных.

*лпстгмедиум*<br/>
Указатель на структуру [стгмедиум](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) , в которой находятся данные.

*брелеасе*<br/>
Значение TRUE, если элемент управления должен освободить среду хранения; Значение FALSE, если элемент управления не должен освобождать среду хранения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Если данные находятся в формате постоянного набора свойств, реализация по умолчанию соответствующим образом изменяет состояние элемента управления. В противном случае реализация по умолчанию не выполняет никаких действий. Если *брелеасе* имеет значение true, выполняется вызов метода `ReleaseStgMedium` . в противном случае — нет.

Переопределите эту функцию, чтобы заменить данные элемента управления указанными данными.

Дополнительные сведения см. в разделе `FORMATETC` структуры `STGMEDIUM` и в Windows SDK.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Вызывается структурой при необходимости изменения экстента элемента управления в результате вызова [иолеобжект:: сетекстент](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Параметры

*лпсизел*<br/>
Указатель на `SIZEL` структуру, которая использует длинные целые числа для представления ширины и высоты элемента управления, выраженного в единицах HIMETRIC.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если изменение размера было принято; в противном случае — 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию обрабатывает изменение размера экстента элемента управления. Если элемент управления находится в активном состоянии, `OnPosRectChanged` выполняется вызов контейнера.

Переопределите эту функцию, чтобы изменить размер элемента управления по умолчанию.

##  <a name="onsetobjectrects"></a>COleControl:: Онсетобжектректс

Вызывается платформой для реализации вызова [иолеинплацеобжект:: сетобжектректс](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Параметры

*лпректпос*<br/>
Указатель на `RECT` структуру, указывающий новое расположение и размер элемента управления относительно контейнера.

*лпректклип*<br/>
Указатель на `RECT` структуру, указывающую прямоугольную область, в которую должен быть обрезан элемент управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если изменение расположения было принято; в противном случае — 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию автоматически обрабатывает перемещение и изменение размера окна элемента управления и возвращает значение TRUE.

Переопределите эту функцию, чтобы изменить поведение этой функции по умолчанию.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Вызывается структурой при активации пользовательского интерфейса элемента управления.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию не выполняет никаких действий.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Вызывается структурой при изменении значения свойства Caption или Text.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию `InvalidateControl`вызывает.

Переопределите эту функцию, если требуется уведомление после изменения этого свойства.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Вызывается платформой в ответ на `IOleInPlaceObjectWindowless::OnWindowMessage` запрос контейнера.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Параметры

*об*<br/>
Идентификатор сообщения, переданный Windows.

*wParam*<br/>
В соответствии с передачей в Windows. Указывает дополнительные сведения, относящиеся к конкретному сообщению. Содержимое этого параметра зависит от значения параметра *MSG* .

*lParam*<br/>
В соответствии с передачей в Windows. Указывает дополнительные сведения, относящиеся к конкретному сообщению. Содержимое этого параметра зависит от значения параметра *MSG* .

*плресулт*<br/>
Код результата Windows. Указывает результат обработки сообщения и зависит от отправленного сообщения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Обрабатывает сообщения окна для безоконных элементов управления. `COleControl``OnWindowlessMessage` следует использовать для сообщений окон, отличных от сообщений мыши и клавиатуры. `COleControl`предоставляет [сеткаптуре](#setcapture) и [SetFocus](#setfocus) специально для получения захвата мыши и фокуса клавиатуры для объектов OLE без окон.

Так как объекты без окон не имеют окна, им нужен механизм, позволяющий контейнеру отправлять сообщения. Безоконный объект OLE получает сообщения из своего контейнера через `OnWindowMessage` метод `IOleInPlaceObjectWindowless` интерфейса (расширение [иолеинплацеобжект](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) для поддержки без окон). `OnWindowMessage`не принимает `HWND` параметр.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Преобразует координаты *ппоинт* в клиентские координаты.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Параметры

*лпркбаундс*<br/>
Указатель на границы элемента управления OLE в контейнере. Не является клиентской областью, а областью всего элемента управления, включая границы и полосы прокрутки.

*ппоинт*<br/>
Указатель на родительскую точку (контейнер), которая должна быть преобразована в координаты клиентской области элемента управления.

*бхиттест*<br/>
Указывает, следует ли выполнять проверку попадания в точке.

### <a name="return-value"></a>Возвращаемое значение

Если *бхиттест* имеет значение false, возвращает хтновхере. Если *бхиттест* имеет значение true, возвращает расположение, в котором родительская точка (контейнер) помещается в клиентскую область элемента управления OLE, и является одним из следующих значений проверки попадания в указатель мыши:

- ХТБОРДЕР в границах окна, у которых нет границы изменения размера.

- ХТБОТТОМ в нижней горизонтальной границе окна.

- ХТБОТТОМЛЕФТ в левом нижнем углу границы окна.

- ХТБОТТОМРИГХТ в правом нижнем углу границы окна.

- ХТКАПТИОН в области заголовка окна.

- ХТКЛИЕНТ в клиентской области.

- Хтеррор на фоне экрана или на разделительной линии между окнами (то же, что и хтновхере, `DefWndProc` за исключением того, что функция Windows выдает системный сигнал для указания на ошибку).

- ХТГРОВБОКС в поле размера.

- ХССКРОЛЛ на горизонтальной полосе прокрутки.

- ХТЛЕФТ в левой границе окна.

- ХТМАКСБУТТОН в кнопке развертывания.

- ХТМЕНУ в области меню.

- ХТМИНБУТТОН в кнопке сворачивания.

- ХТНОВХЕРЕ на фоне экрана или на разделительной линии между окнами.

- ХТРЕДУЦЕ в кнопке сворачивания.

- ХТРИГХТ в правой границе окна.

- ХТСИЗЕ в поле размера (то же, что и ХТГРОВБОКС).

- ХТСИСМЕНУ в меню элемента управления или в кнопке Закрыть дочернего окна.

- ХТТОП в верхней горизонтальной границе окна.

- ХТТОПЛЕФТ в левом верхнем углу границы окна.

- ХТТОПРИГХТ в верхнем правом углу границы окна.

- ХТТРАНСПАРЕНТ в окне, которое в настоящий момент покрывается другим окном.

- ХТВСКРОЛЛ на вертикальной полосе прокрутки.

- ХТЗУМ в кнопке развертывания.

### <a name="remarks"></a>Примечания

Входные *ппоинт* зависят от источника родительского элемента (верхнего левого угла контейнера). На выходе *ппоинт* задается относительно источника клиентской области элемента управления OLE (верхний левый угол клиентской области элемента управления).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Уведомляет контейнер о закрытии модального диалогового окна.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Параметры

*хвндпарент*<br/>
Обработано с родительским окном модального диалогового окна.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию после отображения любого модального диалогового окна. Необходимо вызвать эту функцию, чтобы контейнер мог включить все окна верхнего уровня, `PreModalDialog`отключенные. Эта функция должна быть сопряжена с вызовом `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Уведомляет контейнер о том, что будет отображено модальное диалоговое окно.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Параметры

*хвндпарент*<br/>
Обработано с родительским окном модального диалогового окна.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию перед отображением любого модального диалогового окна. Необходимо вызвать эту функцию, чтобы контейнер мог отключить все свои окна верхнего уровня. После отображения модального диалогового окна необходимо вызвать метод `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Уничтожает и повторно создает окно элемента управления.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Примечания

Это может потребоваться, если необходимо изменить разрядность стиля окна.

##  <a name="refresh"></a>  COleControl::Refresh

Принудительно перерисовывает элемент управления OLE.

```
void Refresh();
```

### <a name="remarks"></a>Примечания

Эта функция поддерживается `COleControl` базовым классом как методом акции, именуемым Refresh. Это позволяет пользователям элемента управления OLE перерисовывать элемент управления в определенное время. Дополнительные сведения об этом методе см. в статье [элементы управления ActiveX: Методы](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>COleControl:: Релеасекаптуре

Освобождает захват мыши.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Если элемент управления в данный момент имеет захват мыши, запись освобождается. В противном случае эта функция не действует.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Освобождает контекст устройства для просмотра контейнера элемента управления без окон, освобождая контекст устройства для использования другими приложениями.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Определяет контекст устройства контейнера для освобождения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Приложение должно вызывать метод `ReleaseDC` для каждого вызова [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Задает родительский элемент для элемента управления.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Параметры

*хвндаутер*<br/>
Маркер окна управления.

*хвндпарент*<br/>
Маркер нового родительского окна.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию для сброса родителя окна элемента управления.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Инициализирует состояние `COleControl` стандартных свойств значениями по умолчанию.

```
void ResetStockProps();
```

### <a name="remarks"></a>Примечания

Это следующие свойства: Внешний вид, цвет фона, BorderStyle, заголовок, включен, шрифт, ForeColor, hWnd и текст. Описание свойств хранения см. в разделе [элементы управления ActiveX: Добавление свойств](../../mfc/mfc-activex-controls-adding-stock-properties.md)запасов.

Можно улучшить производительность двоичной инициализации элемента управления, используя `ResetStockProps` и `ResetVersion` для переопределения `COleControl::OnResetState`. См. пример ниже. Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Инициализирует номер версии в указанном значении.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Параметры

*двверсиондефаулт*<br/>
Номер версии, который должен быть назначен элементу управления.

### <a name="remarks"></a>Примечания

Можно улучшить производительность двоичной инициализации элемента управления, используя `ResetVersion` и `ResetStockProps` для переопределения `COleControl::OnResetState`. См. пример на сайте [ресетстоккпропс](#resetstockprops). Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Позволяет неоконному объекту OLE прокручивать область внутри своего активного изображения на экране.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Параметры

*ксамаунт*<br/>
Задает величину (в единицах устройства) горизонтальной прокрутки. Этот параметр должен быть отрицательным значением для прокрутки влево.

*ямаунт*<br/>
Задает величину (в единицах устройства) вертикальной прокрутки. Этот параметр должен иметь отрицательное значение для прокрутки вверх.

*лпрект*<br/>
Указывает на объект [крект](../../atl-mfc-shared/reference/crect-class.md) или структуру Rect, указывающую часть клиентской области объекта OLE для прокрутки в клиентских координатах содержащего окна. Если *лпрект* имеет значение null, то вся клиентская область объекта OLE прокручивается.

*лпклипрект*<br/>
Указывает на `CRect` объект или `RECT` структуру, указывающую прямоугольник для обрезки. Прокручиваться могут только Пиксели внутри прямоугольника. Биты за пределами прямоугольника не затрагиваются, даже если они находятся в прямоугольнике *лпрект* . Если *лпклипрект* имеет значение null, то для прямоугольника прокрутки не выполняется обрезка.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Выбирает шрифт в контексте устройства.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на объект контекста устройства.

*фонсолдер*<br/>
Ссылка на объект [кфонсолдер](../../mfc/reference/cfontholder-class.md) , представляющий выбранный шрифт.

### <a name="return-value"></a>Возвращаемое значение

Указатель на ранее выбранный шрифт. Когда вызывающий объект завершает все операции рисования, использующие *фонсолдер,* он должен снова выбрать ранее выбранный шрифт, передав его в качестве параметра в [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

Выбирает свойство «стандартный шрифт» в контексте устройства.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором будет выбран шрифт.

### <a name="return-value"></a>Возвращаемое значение

Указатель на ранее выбранный `CFont` объект. Следует использовать [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) , чтобы снова выбрать этот шрифт в контексте устройства по завершении.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Сериализует или Инициализирует состояние отображаемого пространства, выделенного элементу управления.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Параметры

*AR*<br/>
`CArchive` Объект для сериализации в или из.

### <a name="remarks"></a>Примечания

Можно улучшить производительность двоичного сохранения элемента управления `SerializeExtent`с помощью, `SerializeStockProps`и `SerializeVersion` для переопределения `COleControl::Serialize`. См. пример ниже. Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Сериализует или Инициализирует состояние `COleControl` стандартных свойств: Внешний вид, цвет фона, стиль границы, заголовок, включен, шрифт, цвет текста и текст.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Параметры

*AR*<br/>
`CArchive` Объект для сериализации в или из.

### <a name="remarks"></a>Примечания

Описание свойств хранения см. в разделе [элементы управления ActiveX: Добавление свойств](../../mfc/mfc-activex-controls-adding-stock-properties.md)запасов.

Можно улучшить производительность двоичного сохранения элемента управления `SerializeStockProps`с помощью, `SerializeExtent`и `SerializeVersion` для переопределения `COleControl::Serialize`. Пример см. в коде по адресу [сериализикстент](#serializeextent). Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Сериализует или Инициализирует состояние сведений о версии элемента управления.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Параметры

*AR*<br/>
`CArchive` Объект для сериализации в или из.

*двверсиондефаулт*<br/>
Номер текущей версии элемента управления.

*бконверт*<br/>
Указывает, следует ли преобразовывать постоянные данные в последний формат при сохранении или сохранять их в том же формате, в котором они были загружены.

### <a name="return-value"></a>Возвращаемое значение

Номер версии элемента управления. Если загружается указанный архив, `SerializeVersion` Возвращает версию, загруженную из этого архива. В противном случае возвращается текущая загруженная версия.

### <a name="remarks"></a>Примечания

Можно улучшить производительность двоичного сохранения элемента управления `SerializeVersion`с помощью, `SerializeExtent`и `SerializeStockProps` для переопределения `COleControl::Serialize`. Пример см. в коде по адресу [сериализикстент](#serializeextent). Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Задает значение свойства "вид запасов" элемента управления.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Параметры

*саппеаранце*<br/>
**Короткое** (VT_I2) значение, используемое для внешнего вида элемента управления. Нулевое значение задает внешний вид элемента управления плоским, а значение 1 устанавливает внешний вид элемента управления в 3D.

### <a name="remarks"></a>Примечания

Дополнительные сведения о свойствах хранения см [. в разделе элементы управления ActiveX: Свойства](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Задает значение свойства элемента управления "неиспользуемая номенклатура".

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Параметры

*dwBackColor*<br/>
Значение OLE_COLOR, используемое для фонового рисования элемента управления.

### <a name="remarks"></a>Примечания

Дополнительные сведения об использовании этого свойства и других связанных свойств см. в статье [элементы управления ActiveX: Свойства](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Задает значение свойства BorderStyle для элемента управления.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Параметры

*sBorderStyle*<br/>
Новый стиль границы для элемента управления; 0 означает отсутствие границы, а 1 — нормальную границу.

### <a name="remarks"></a>Примечания

После этого окно управления будет повторно создано и `OnBorderStyleChanged` вызвано.

##  <a name="setcapture"></a>  COleControl::SetCapture

Заставляет окно контейнера элемента управления принимать захват мыши от имени элемента управления.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CWnd` объект окна, который ранее получил ввод мыши.

### <a name="remarks"></a>Примечания

Если элемент управления активирован и безоконный, эта функция заставляет окно контейнера элемента управления захватить захват мыши от имени элемента управления. В противном случае эта функция заставляет сам элемент управления захватить захват мыши (то же, что `CWnd::SetCapture`и).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Задает размер окна элемента управления OLE и уведомляет контейнер об изменении сайта элемента управления.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Параметры

*cx*<br/>
Задает новую ширину элемента управления в пикселях.

*CY*<br/>
Задает новую высоту элемента управления в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае — 0.

### <a name="remarks"></a>Примечания

Эта функция не должна использоваться в конструкторе элемента управления.

Обратите внимание, что все координаты окон управления задаются относительно левого верхнего угла элемента управления.

##  <a name="setenabled"></a>COleControl:: Сетенаблед

Задает значение свойства для элемента управления, включенного в запас.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Параметры

*бенаблед*<br/>
Значение TRUE, если элемент управления должен быть включен. в противном случае — FALSE.

### <a name="remarks"></a>Примечания

После задания этого свойства `OnEnabledChange` вызывается.

##  <a name="setfocus"></a>  COleControl::SetFocus

Заставляет окно контейнера элемента управления получать фокус ввода от имени элемента управления.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CWnd` объект окна, который ранее имел фокус ввода, или значение null, если такое окно отсутствует.

### <a name="remarks"></a>Примечания

Если элемент управления активирован и безоконный, эта функция заставляет окно контейнера элемента управления получать фокус ввода от имени элемента управления. Фокус ввода направляет ввод с клавиатуры в окно контейнера, а контейнер отправляет все последующие сообщения клавиатуры объекту OLE, который вызывает `SetFocus`. Любое окно, которое ранее получило фокус ввода.

Если элемент управления не является безоконным, эта функция приводит к тому, что сам элемент управления принимает фокус ввода (то `CWnd::SetFocus`же, что и).

##  <a name="setfont"></a>  COleControl::SetFont

Задает свойство "Стандартный шрифт" для элемента управления.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Параметры

*пфонтдисп*<br/>
Указатель на интерфейс диспетчеризации шрифтов.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Задает значение свойства "основной цвет запасов" вашего элемента управления.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Параметры

*dwForeColor*<br/>
Значение OLE_COLOR, используемое для фонового рисования элемента управления.

### <a name="remarks"></a>Примечания

Дополнительные сведения об использовании этого свойства и других связанных свойств см. в статье [элементы управления ActiveX: Свойства](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>COleControl:: Сетинитиалдатаформатс

Вызывается платформой для инициализации списка форматов данных, поддерживаемых элементом управления.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию задает два формата: CF_METAFILEPICT и набор постоянных свойств.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Задает размер элемента управления OLE при первом отображении в контейнере.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Параметры

*cx*<br/>
Начальная ширина элемента управления OLE в пикселях.

*CY*<br/>
Начальная высота элемента управления OLE в пикселях.

### <a name="remarks"></a>Примечания

Вызовите эту функцию в конструкторе, чтобы задать начальный размер элемента управления. Начальный размер измеряется в единицах устройства или в пикселях. Рекомендуется делать этот вызов в конструкторе элемента управления.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Изменяет измененное состояние элемента управления.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Параметры

*бмодифиед*<br/>
Новое значение для измененного флага элемента управления. Значение TRUE указывает, что состояние элемента управления изменено; Значение FALSE указывает, что состояние элемента управления было только что сохранено.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию каждый раз, когда происходит изменение, которое повлияет на устойчивое состояние элемента управления. Например, если изменяется значение постоянного свойства, вызовите эту функцию с *бмодифиед* **true**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Указывает, что запрос на изменение не выполнен.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Примечания

Вызывайте эту функцию `BoundPropertyRequestEdit` при сбое. Эта функция создает исключение типа `COleDispScodeException` для указания, что операция задания не разрешена.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Предотвращает изменение значения свойства элемента управления пользователем.

```
void SetNotSupported();
```

### <a name="remarks"></a>Примечания

Вызывайте эту функцию вместо функции Set любого свойства, если изменение значения свойства пользователем элемента управления не поддерживается. Одним из примеров может быть свойство, которое доступно только для чтения.

##  <a name="setrectincontainer"></a>COleControl:: Сетректинконтаинер

Задает координаты прямоугольника элемента управления относительно контейнера, выраженного в единицах устройства.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
Указатель на прямоугольник, содержащий новые координаты элемента управления относительно контейнера.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае — 0.

### <a name="remarks"></a>Примечания

Если элемент управления открыт, его размер изменяется; в противном случае `OnPosRectChanged` вызывается функция контейнера.

##  <a name="settext"></a>  COleControl::SetText

Задает значение для заголовка акции элемента управления или свойства текста.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Параметры

*псзтекст*<br/>
Указатель на символьную строку.

### <a name="remarks"></a>Примечания

Обратите внимание, что заголовок и свойства текста должны сопоставлены с одним и тем же значением. Это означает, что любые изменения, вносимые в любое из этих свойств, будут автоматически изменять оба свойства. Как правило, элемент управления должен поддерживать как заголовок товара, так и свойство текста, но не оба значения.

##  <a name="throwerror"></a>  COleControl::ThrowError

Сигнализирует о возникновении ошибки в элементе управления.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Параметры

*SC*<br/>
Значение кода состояния для отчета. Полный список возможных кодов см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).

*ндескриптионид*<br/>
Строковый идентификатор ресурса исключения для сообщения.

*нхелпид*<br/>
Идентификатор справки раздела, по которому будет выполняться отчет.

*псздескриптион*<br/>
Строка, содержащая объяснение исключения, которое необходимо сообщить.

### <a name="remarks"></a>Примечания

Эта функция должна вызываться только в функции Get или Set для свойства OLE или реализации метода OLE-автоматизации. Если необходимо сообщить об ошибках, происходящих в другое время, следует запустить событие «ошибка акции».

##  <a name="transformcoords"></a>COleControl:: Трансформкурдс

Преобразует значения координат между HIMETRIC единицами и собственными единицами контейнера.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Параметры

*lpptlHimetric*<br/>
Указатель на структуру `POINTL` , содержащую координаты в единицах HIMETRIC.

*lpptfContainer*<br/>
Указатель на структуру `POINTF` , содержащую координаты в размерах блока контейнера.

*flags*<br/>
Сочетание следующих значений:

- XFORMCOORDS_POSITION расположение в контейнере.

- XFORMCOORDS_SIZE размер в контейнере.

- XFORMCOORDS_HIMETRICTOCONTAINER преобразование единиц измерения HIMETRIC в единицы контейнера.

- XFORMCOORDS_CONTAINERTOHIMETRIC преобразует единицы контейнера в HIMETRIC единицы.

### <a name="remarks"></a>Примечания

Первые два флага, XFORMCOORDS_POSITION и XFORMCOORDS_SIZE, указывают, должны ли координаты обрабатываться как расположение или размер. Остальные два флага указывают направление преобразования.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

Преобразует значение цвета из типа данных OLE_COLOR в тип данных [COLORREF](/windows/win32/gdi/colorref) .

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Параметры

*клрколор*<br/>
Тип данных OLE_COLOR. Дополнительные сведения см. в описании функции Windows [олетранслатеколор](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) .

*хпал*<br/>
Описатель необязательной палитры; может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Значение цвета в формате RGB (красный, зеленый, синий 32), которое определяет сплошной цвет, ближайший к значению *клрколор* , которое может представлять устройство.

### <a name="remarks"></a>Примечания

Эта функция полезна для преобразования свойств ForeColor и BackColor в типы COLORREF, используемые функциями-членами [CDC](../../mfc/reference/cdc-class.md) .

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Определяет, следует ли элементу управления использовать значения внешних свойств в качестве значений по умолчанию, когда впоследствии он загружается из его постоянного состояния.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение указывает, что внешние свойства будут допустимыми; в противном случае внешние свойства будут недопустимыми.

### <a name="remarks"></a>Примечания

В некоторых контейнерах элемент управления может не иметь доступа к его внешним свойствам во время начального вызова переопределения `COleControl::DoPropExchange`. Это происходит, если контейнер вызывает [иперсистстреаминит:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) или [Иперсистстораже:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) перед вызовом [иолеобжект:: сетклиентсите](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (т. е. Если он не учитывает бит состояния OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>  COleControl::WindowProc

Предоставляет процедуру Windows для `COleControl` объекта.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Параметры

*message*<br/>
Указывает сообщение Windows для обработки.

*wParam*<br/>
Предоставляет дополнительные сведения, используемые при обработке сообщения. Значение параметра зависит от сообщения.

*lParam*<br/>
Предоставляет дополнительные сведения, используемые при обработке сообщения. Значение параметра зависит от сообщения.

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение отправляемого сообщения.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию для отправки конкретных сообщений с помощью схемы сообщений элемента управления.

## <a name="see-also"></a>См. также

[Пример CIRC3 для MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример ТЕССЕЛП для MFC](../../overview/visual-cpp-samples.md)<br/>
[Класс COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Класс CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Класс CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
