---
title: Класс Кфтпконнектион
ms.date: 11/04/2016
f1_keywords:
- CFtpConnection
- AFXINET/CFtpConnection
- AFXINET/CFtpConnection::CFtpConnection
- AFXINET/CFtpConnection::Command
- AFXINET/CFtpConnection::CreateDirectory
- AFXINET/CFtpConnection::GetCurrentDirectory
- AFXINET/CFtpConnection::GetCurrentDirectoryAsURL
- AFXINET/CFtpConnection::GetFile
- AFXINET/CFtpConnection::OpenFile
- AFXINET/CFtpConnection::PutFile
- AFXINET/CFtpConnection::Remove
- AFXINET/CFtpConnection::RemoveDirectory
- AFXINET/CFtpConnection::Rename
- AFXINET/CFtpConnection::SetCurrentDirectory
helpviewer_keywords:
- CFtpConnection [MFC], CFtpConnection
- CFtpConnection [MFC], Command
- CFtpConnection [MFC], CreateDirectory
- CFtpConnection [MFC], GetCurrentDirectory
- CFtpConnection [MFC], GetCurrentDirectoryAsURL
- CFtpConnection [MFC], GetFile
- CFtpConnection [MFC], OpenFile
- CFtpConnection [MFC], PutFile
- CFtpConnection [MFC], Remove
- CFtpConnection [MFC], RemoveDirectory
- CFtpConnection [MFC], Rename
- CFtpConnection [MFC], SetCurrentDirectory
ms.assetid: 5e3a0501-8893-49cf-a3d5-0628d8d6b936
ms.openlocfilehash: 977a8c9fc6dd653a59434d29bb72b0fe28900001
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69506370"
---
# <a name="cftpconnection-class"></a>Класс Кфтпконнектион

Управляет подключением FTP к Интернет-серверу и позволяет напрямую управлять каталогами и файлами на этом сервере.

## <a name="syntax"></a>Синтаксис

```
class CFtpConnection : public CInternetConnection
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кфтпконнектион:: Кфтпконнектион](#cftpconnection)|Создает объект `CFtpConnection`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кфтпконнектион:: Command](#command)|Отправляет команду напрямую на FTP-сервер.|
|[Кфтпконнектион:: CreateDirectory](#createdirectory)|Создает каталог на сервере.|
|[Кфтпконнектион:: GetCurrentDirectory](#getcurrentdirectory)|Возвращает текущий каталог для данного соединения.|
|[Кфтпконнектион:: Жеткуррентдиректорясурл](#getcurrentdirectoryasurl)|Возвращает текущий каталог для этого соединения в виде URL-адреса.|
|[Кфтпконнектион:: onfile](#getfile)|Получает файл с подключенного сервера|
|[Кфтпконнектион:: OpenFile](#openfile)|Открывает файл на подключенном сервере.|
|[Кфтпконнектион::P Утфиле](#putfile)|Помещает файл на сервер.|
|[Кфтпконнектион:: Remove](#remove)|Удаляет файл с сервера.|
|[Кфтпконнектион:: Ремоведиректори](#removedirectory)|Удаляет указанный каталог с сервера.|
|[Кфтпконнектион:: Rename](#rename)|Переименовывает файл на сервере.|
|[Кфтпконнектион:: Сеткуррентдиректори](#setcurrentdirectory)|Задает текущий каталог FTP.|

## <a name="remarks"></a>Примечания

FTP является одной из трех служб Интернета, распознаваемых классами MFC WinInet.

Для взаимодействия с FTP-сервером Интернета необходимо сначала создать экземпляр [Цинтернетсессион](../../mfc/reference/cinternetsession-class.md), а затем создать `CFtpConnection` объект. Вы никогда не создаете `CFtpConnection` объект напрямую; вместо этого вызовите метод [Цинтернетсессион:: жетфтпконнектион](../../mfc/reference/cinternetsession-class.md#getftpconnection) `CFtpConnection` , который создает объект и возвращает указатель на него.

Дополнительные сведения о `CFtpConnection` работе с другими классами Интернета MFC см. в статье Интернет – [программирование с помощью WinInet](../../mfc/win32-internet-extensions-wininet.md). Дополнительные сведения о взаимодействии с другими двумя поддерживаемыми службами, HTTP и Gopher см. в разделе Классы [чттпконнектион](../../mfc/reference/chttpconnection-class.md) и [кгоферконнектион](../../mfc/reference/cgopherconnection-class.md).

## <a name="example"></a>Пример

  См. пример в разделе Общие сведения о классе [кфтпфилефинд](../../mfc/reference/cftpfilefind-class.md) .

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[Цинтернетконнектион](../../mfc/reference/cinternetconnection-class.md)

`CFtpConnection`

## <a name="requirements"></a>Требования

**Заголовок:** афксинет. h

##  <a name="cftpconnection"></a>Кфтпконнектион:: Кфтпконнектион

Эта функция-член вызывается для создания `CFtpConnection` объекта.

```
CFtpConnection(
    CInternetSession* pSession,
    HINTERNET hConnected,
    LPCTSTR pstrServer,
    DWORD_PTR dwContext);

CFtpConnection(
    CInternetSession* pSession,
    LPCTSTR pstrServer,
    LPCTSTR pstrUserName = NULL,
    LPCTSTR pstrPassword = NULL,
    DWORD_PTR dwContext = 0,
    INTERNET_PORT nPort = INTERNET_INVALID_PORT_NUMBER,
    BOOL bPassive = FALSE);
```

### <a name="parameters"></a>Параметры

*псессион*<br/>
Указатель на связанный объект [Цинтернетсессион](../../mfc/reference/cinternetsession-class.md) .

*хконнектед*<br/>
Маркер текущего сеанса Интернета в Windows.

*пстрсервер*<br/>
Указатель на строку, содержащую имя FTP-сервера.

*двконтекст*<br/>
Идентификатор контекста для операции. *двконтекст* определяет сведения о состоянии операции, возвращаемые [Цинтернетсессион:: онстатускаллбакк](../../mfc/reference/cinternetsession-class.md#onstatuscallback). Значение по умолчанию — 1; Однако для операции можно явно назначить конкретный идентификатор контекста. Объект и все его работа будут связаны с ИДЕНТИФИКАТОРом контекста.

*пструсернаме*<br/>
Указатель на строку, завершающуюся нулем, которая указывает имя пользователя для входа. Если значение равно NULL, значение по умолчанию — Anonymous.

*пстрпассворд*<br/>
Указатель на строку, завершающуюся нулем, которая указывает пароль, используемый для входа в систему. Если оба *пстрпассворд* и *пструсернаме* имеют значение null, анонимный пароль по умолчанию — это имя электронной почты пользователя. Если *пстрпассворд* имеет значение null (или пустая строка), но *пструсернаме* не имеет значение null, используется пустой пароль. В следующей таблице описывается поведение четырех возможных параметров *пструсернаме* и *пстрпассворд*.

|*пструсернаме*|*пстрпассворд*|Имя пользователя, отправленное на FTP-сервер|Пароль, отправленный на FTP-сервер|
|--------------------|--------------------|---------------------------------|---------------------------------|
|NULL или ""|NULL или ""|подключившихся|Имя электронной почты пользователя|
|Строка, не РАВНая NULL|NULL или ""|*пструсернаме*|" "|
|Строка со значением NULL, отличным от NULL|ОШИБКА|ОШИБКА||
|Строка, не РАВНая NULL|Строка, не РАВНая NULL|*пструсернаме*|*пстрпассворд*|

*Nпорт*<br/>
Число, идентифицирующее порт TCP/IP, используемый на сервере.

*бпассиве*<br/>
Указывает пассивный или активный режим для этого FTP-сеанса. Если задано значение TRUE, то для Win32 API *dwFlag* устанавливается значение INTERNET_FLAG_PASSIVE.

### <a name="remarks"></a>Примечания

Вы никогда не создаете `CFtpConnection` объект напрямую. Вместо этого вызовите метод [Цинтернетсессион:: жетфтпконнектион](../../mfc/reference/cinternetsession-class.md#getftpconnection), который `CFptConnection` создает объект.

##  <a name="command"></a>Кфтпконнектион:: Command

Отправляет команду напрямую на FTP-сервер.

```
CInternetFile* Command(
    LPCTSTR pszCommand,
    CmdResponseType eResponse = CmdRespNone,
    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,
    DWORD_PTR dwContext = 1);
```

### <a name="parameters"></a>Параметры

*псзкомманд*<br/>
Указатель на строку, содержащую отправляемую команду.

*ереспонсе*<br/>
Определяет, следует ли ожидать ответ FTP-сервера. Может принимать одно из следующих значений:

- `CmdRespNone`Ответ не ожидается.

- `CmdRespRead`Ожидается ответ.

*dwFlags*<br/>
Значение, содержащее флаги, управляющие этой функцией. Полный список см. в разделе [фтпкомманд](/windows/win32/api/wininet/nf-wininet-ftpcommandw).

*двконтекст*<br/>
Указатель на значение, содержащее определяемое приложением значение, используемое для идентификации контекста приложения в обратных вызовах.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция члена эмулирует функциональность функции [фтпкомманд](/windows/win32/api/wininet/nf-wininet-ftpcommandw) , как описано в Windows SDK.

При возникновении ошибки MFC создает исключение типа [Цинтернетексцептион](../../mfc/reference/cinternetexception-class.md).

##  <a name="createdirectory"></a>Кфтпконнектион:: CreateDirectory

Вызовите эту функцию-член, чтобы создать каталог на подключенном сервере.

```
BOOL CreateDirectory(LPCTSTR pstrDirName);
```

### <a name="parameters"></a>Параметры

*пстрдирнаме*<br/>
Указатель на строку, содержащую имя создаваемого каталога.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Windows [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

Используется `GetCurrentDirectory` для определения текущего рабочего каталога для данного соединения с сервером. Не считайте, что удаленная система подключила вас к корневому каталогу.

`pstrDirName` Параметр может быть либо частично, либо полным именем файла относительно текущего каталога. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `CreateDirectory`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

##  <a name="getcurrentdirectory"></a>Кфтпконнектион:: GetCurrentDirectory

Вызовите эту функцию члена, чтобы получить имя текущего каталога.

```
BOOL GetCurrentDirectory(CString& strDirName) const;

BOOL GetCurrentDirectory(
    LPTSTR pstrDirName,
    LPDWORD lpdwLen) const;
```

### <a name="parameters"></a>Параметры

*стрдирнаме*<br/>
Ссылка на строку, которая получит имя каталога.

*пстрдирнаме*<br/>
Указатель на строку, которая получит имя каталога.

*лпдвлен*<br/>
Указатель на DWORD, который содержит следующие сведения:

|||
|-|-|
|При входе|Размер буфера, на который ссылается *пстрдирнаме*.|
|При возврате|Число символов, сохраняемых в *пстрдирнаме*. Если функция-член завершается с ошибкой и возвращается ERROR_INSUFFICIENT_BUFFER, то *лпдвлен* содержит число байтов, которое должно выделить приложение для получения строки.|

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

Чтобы получить имя каталога в виде URL-адреса, вызовите [жеткуррентдиректорясурл](#getcurrentdirectoryasurl).

Параметры *пстрдирнаме* или *стрдирнаме* могут быть либо частично квалифицированными именами файлов относительно текущего каталога, либо полными. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `GetCurrentDirectory`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

##  <a name="getcurrentdirectoryasurl"></a>Кфтпконнектион:: Жеткуррентдиректорясурл

Вызовите эту функцию-член, чтобы получить имя текущего каталога в виде URL-адреса.

```
BOOL GetCurrentDirectoryAsURL(CString& strDirName) const;

BOOL GetCurrentDirectoryAsURL(
    LPTSTR pstrName,
    LPDWORD lpdwLen) const;
```

### <a name="parameters"></a>Параметры

*стрдирнаме*<br/>
Ссылка на строку, которая получит имя каталога.

*пстрдирнаме*<br/>
Указатель на строку, которая получит имя каталога.

*лпдвлен*<br/>
Указатель на DWORD, который содержит следующие сведения:

|||
|-|-|
|При входе|Размер буфера, на который ссылается *пстрдирнаме*.|
|При возврате|Число символов, сохраняемых в *пстрдирнаме*. Если функция-член завершается с ошибкой и возвращается ERROR_INSUFFICIENT_BUFFER, то *лпдвлен* содержит число байтов, которое должно выделить приложение для получения строки.|

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

`GetCurrentDirectoryAsURL`ведет себя так же, как [GetCurrentDirectory](#getcurrentdirectory)

Параметр *стрдирнаме* может быть либо частично квалифицированным именем файла, относительно текущего каталога, либо полным. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `GetCurrentDirectoryAsURL`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

##  <a name="getfile"></a>Кфтпконнектион:: onfile

Эта функция-член вызывается для получения файла с FTP-сервера и сохранения его на локальном компьютере.

```
BOOL GetFile(
    LPCTSTR pstrRemoteFile,
    LPCTSTR pstrLocalFile,
    BOOL bFailIfExists = TRUE,
    DWORD dwAttributes = FILE_ATTRIBUTE_NORMAL,
    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,
    DWORD_PTR dwContext = 1);
```

### <a name="parameters"></a>Параметры

*пстрремотефиле*<br/>
Указатель на строку с завершающим нулем, содержащую имя файла, который необходимо получить с FTP-сервера.

*пстрлокалфиле*<br/>
Указатель на строку с завершающим нулем, содержащую имя файла, создаваемого в локальной системе.

*бфаилифексистс*<br/>
Указывает, может ли имя файла уже использоваться существующим файлом. Если имя локального файла уже существует и этот параметр имеет значение true, `GetFile` происходит сбой. В противном случае будет удалена существующая копия файла. `GetFile`

*дваттрибутес*<br/>
Указывает атрибуты файла. Это может быть любое сочетание следующих флагов FILE_ATTRIBUTE_ *.

- FILE_ATTRIBUTE_ARCHIVE файл является архивным файлом. Приложения используют этот атрибут для пометки файлов для резервного копирования или удаления.

- FILE_ATTRIBUTE_COMPRESSED файл или каталог сжат. Для файла сжатие означает, что все данные в файле сжимаются. Для каталога по умолчанию используется сжатие для вновь созданных файлов и подкаталогов.

- FILE_ATTRIBUTE_DIRECTORY файл является каталогом.

- FILE_ATTRIBUTE_NORMAL. для файла не заданы другие атрибуты. Этот атрибут допустим только в том случае, если он используется отдельно. Все другие атрибуты файла переопределяют FILE_ATTRIBUTE_NORMAL:

- FILE_ATTRIBUTE_HIDDEN. файл скрыт. Он не должен включаться в обычный список каталогов.

- FILE_ATTRIBUTE_READONLY файл доступен только для чтения. Приложения могут считывать файл, но не могут выполнять запись в него или удалять его.

- FILE_ATTRIBUTE_SYSTEM. файл является частью или используется исключительно операционной системой.

- FILE_ATTRIBUTE_TEMPORARY. файл используется для временного хранения. Приложения должны выполнять запись в файл только в случае крайней необходимости. Большая часть данных файла остается в памяти без записи на носитель, так как файл скоро будет удален.

*dwFlags*<br/>
Задает условия, при которых происходит перемещение. Этот параметр может быть любым из значений *dwFlags* , описанных в разделе [фтпжетфиле](/windows/win32/api/wininet/nf-wininet-ftpgetfilew) в Windows SDK.

*двконтекст*<br/>
Идентификатор контекста для извлечения файла. Дополнительные сведения о *двконтекст*см. в разделе **Примечания** .

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

`GetFile`— Это высокоуровневая подпрограммы, которая обрабатывает все издержки, связанные с чтением файла с FTP-сервера и сохранением его на локальном компьютере. Приложения, которые извлекают файловые данные или которым требуется закрытое управление перемещением файлов, должны `OpenFile` использовать и [Цинтернетфиле:: Read](../../mfc/reference/cinternetfile-class.md#read) .

Если *dwFlags* — FILE_TRANSFER_TYPE_ASCII, то при преобразовании файловых данных также преобразуются символы управления и форматирования в эквиваленты Windows. При передаче по умолчанию используется двоичный режим, при котором файл загружается в том же формате, в котором он хранится на сервере.

*Пстрремотефиле* и *пстрлокалфиле* могут быть либо частично квалифицированными именами файлов относительно текущего каталога, либо полными. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `GetFile`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

Переопределите *двконтекст* по умолчанию, чтобы задать для идентификатора контекста значение, выбранное вами. Идентификатор контекста связан с этой конкретной операцией `CFtpConnection` объекта, созданного его объектом [Цинтернетсессион](../../mfc/reference/cinternetsession-class.md) . Значение возвращается в [Цинтернетсессион:: онстатускаллбакк](../../mfc/reference/cinternetsession-class.md#onstatuscallback) , чтобы предоставить состояние операции, с которой оно определено. См. статью [первые шаги в Интернете: WinInet](../../mfc/wininet-basics.md) для получения дополнительных сведений об идентификаторе контекста.

##  <a name="openfile"></a>Кфтпконнектион:: OpenFile

Эта функция-член вызывается для открытия файла, расположенного на FTP-сервере для чтения или записи.

```
CInternetFile* OpenFile(
    LPCTSTR pstrFileName,
    DWORD dwAccess = GENERIC_READ,
    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,
    DWORD_PTR dwContext = 1);
```

### <a name="parameters"></a>Параметры

*пстрфиленаме*<br/>
Указатель на строку, содержащую имя открываемого файла.

*двакцесс*<br/>
Определяет, как будет осуществляться доступ к файлу. Может быть либо GENERIC_READ, либо GENERIC_WRITE, но не оба.

*dwFlags*<br/>
Задает условия, при которых происходит последующая передача. Это может быть любая из следующих констант FTP_TRANSFER_ *:

- FTP_TRANSFER_TYPE_ASCII передача файлов с помощью метода передачи по протоколу FTP ASCII (тип A). Преобразует сведения об элементе управления и форматировании в локальные эквиваленты.

- FTP_TRANSFER_TYPE_BINARY. файл передает данные с помощью метода передачи изображений FTP (тип I). Файл передает данные в том виде, в котором они существуют, без изменений. Это метод перемещения по умолчанию.

*двконтекст*<br/>
Идентификатор контекста для открытия файла. Дополнительные сведения о *двконтекст*см. в разделе **Примечания** .

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [Цинтернетфиле](../../mfc/reference/cinternetfile-class.md) .

### <a name="remarks"></a>Примечания

`OpenFile`следует использовать в следующих ситуациях:

- Приложение содержит данные, которые необходимо отправить и создать в виде файла на FTP-сервере, но эти данные не находятся в локальном файле. После `OpenFile` открытия файла приложение использует [Цинтернетфиле:: Write](../../mfc/reference/cinternetfile-class.md#write) для отправки данных FTP-файла на сервер.

- Приложение должно получить файл с сервера и поместить его в память, управляемую приложением, а не записывать на диск. Приложение использует [Цинтернетфиле:: Read](../../mfc/reference/cinternetfile-class.md#read) после использования `OpenFile` для открытия файла.

- Приложению требуется очень полный контроль над переносом файлов. Например, приложение может попытаться отобразить элемент управления хода выполнения, обозначающий ход выполнения состояния перемещения файла при скачивании файла.

После вызова `OpenFile` метода и до `CInternetConnection::Close`вызова приложение может вызвать только [Цинтернетфиле:: Read](../../mfc/reference/cinternetfile-class.md#read), [Цинтернетфиле:: Write](../../mfc/reference/cinternetfile-class.md#write), `CInternetConnection::Close`или [кфтпфилефинд:: финдфиле](../../mfc/reference/cftpfilefind-class.md#findfile). Вызовы других функций FTP для одного и того же сеанса FTP завершатся ошибкой и задают код ошибки FTP_ETRANSFER_IN_PROGRESS.

Параметр *пстрфиленаме* может быть либо частично квалифицированным именем файла относительно текущего каталога, либо полным. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `OpenFile`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

Переопределите *двконтекст* по умолчанию, чтобы задать для идентификатора контекста значение, выбранное вами. Идентификатор контекста связан с этой конкретной операцией `CFtpConnection` объекта, созданного его объектом [Цинтернетсессион](../../mfc/reference/cinternetsession-class.md) . Значение возвращается в [Цинтернетсессион:: онстатускаллбакк](../../mfc/reference/cinternetsession-class.md#onstatuscallback) , чтобы предоставить состояние операции, с которой оно определено. См. статью [первые шаги в Интернете: WinInet](../../mfc/wininet-basics.md) для получения дополнительных сведений об идентификаторе контекста.

##  <a name="putfile"></a>Кфтпконнектион::P Утфиле

Эта функция-член вызывается для сохранения файла на FTP-сервере.

```
BOOL PutFile(
    LPCTSTR pstrLocalFile,
    LPCTSTR pstrRemoteFile,
    DWORD dwFlags = FTP_TRANSFER_TYPE_BINARY,
    DWORD_PTR dwContext = 1);
```

### <a name="parameters"></a>Параметры

*пстрлокалфиле*<br/>
Указатель на строку, содержащую имя файла, отправляемого из локальной системы.

*пстрремотефиле*<br/>
Указатель на строку, содержащую имя файла, создаваемого на FTP-сервере.

*dwFlags*<br/>
Задает условия, при которых происходит перемещение файла. Может быть любой из констант FTP_TRANSFER_ *, описанных в [OpenFile](#openfile).

*двконтекст*<br/>
Идентификатор контекста для размещения файла. Дополнительные сведения о *двконтекст*см. в разделе **Примечания** .

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

`PutFile`— Это высокоуровневая подпрограммы, которая обрабатывает все операции, связанные с сохранением файла на FTP-сервере. Приложения, которые отправляют данные или которым требуется более близкий контроль над передачей файлов, должны использовать [OpenFile](#openfile) и [Цинтернетфиле:: Write](../../mfc/reference/cinternetfile-class.md#write).

Переопределите `dwContext` значение по умолчанию, чтобы задать идентификатор контекста в качестве значения по своему усмотрению. Идентификатор контекста связан с этой конкретной операцией `CFtpConnection` объекта, созданного его объектом [Цинтернетсессион](../../mfc/reference/cinternetsession-class.md) . Значение возвращается в [Цинтернетсессион:: онстатускаллбакк](../../mfc/reference/cinternetsession-class.md#onstatuscallback) , чтобы предоставить состояние операции, с которой оно определено. См. статью [первые шаги в Интернете: WinInet](../../mfc/wininet-basics.md) для получения дополнительных сведений об идентификаторе контекста.

##  <a name="remove"></a>Кфтпконнектион:: Remove

Вызовите эту функцию члена, чтобы удалить указанный файл с подключенного сервера.

```
BOOL Remove(LPCTSTR pstrFileName);
```

### <a name="parameters"></a>Параметры

*пстрфиленаме*<br/>
Указатель на строку, содержащую имя удаляемого файла.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

Параметр *пстрфиленаме* может быть либо частично квалифицированным именем файла относительно текущего каталога, либо полным. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `Remove` Функция преобразует разделители имен каталогов в соответствующие символы перед их использованием.

##  <a name="removedirectory"></a>Кфтпконнектион:: Ремоведиректори

Вызовите эту функцию члена, чтобы удалить указанный каталог с подключенного сервера.

```
BOOL RemoveDirectory(LPCTSTR pstrDirName);
```

### <a name="parameters"></a>Параметры

*пстрдирнаме*<br/>
Указатель на строку, содержащую удаляемый каталог.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

Используйте [GetCurrentDirectory](#getcurrentdirectory) для определения текущего рабочего каталога сервера. Не считайте, что удаленная система подключила вас к корневому каталогу.

Параметр *пстрдирнаме* может быть либо частично, либо полным именем файла относительно текущего каталога. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `RemoveDirectory`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

##  <a name="rename"></a>Кфтпконнектион:: Rename

Вызовите эту функцию члена, чтобы переименовать указанный файл на подключенном сервере.

```
BOOL Rename(
    LPCTSTR pstrExisting,
    LPCTSTR pstrNew);
```

### <a name="parameters"></a>Параметры

*пстрексистинг*<br/>
Указатель на строку, содержащую текущее имя файла для переименования.

*пстрнев*<br/>
Указатель на строку, содержащую новое имя файла.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

Параметры *пстрексистинг* и *пстрнев* могут быть либо частично полным именем файла относительно текущего каталога, либо полным. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `Rename`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

##  <a name="setcurrentdirectory"></a>Кфтпконнектион:: Сеткуррентдиректори

Вызовите эту функцию-член, чтобы перейти в другой каталог на сервере FTP.

```
BOOL SetCurrentDirectory(LPCTSTR pstrDirName);
```

### <a name="parameters"></a>Параметры

*пстрдирнаме*<br/>
Указатель на строку, содержащую имя каталога.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0. Если вызов завершается неудачно, можно вызвать функцию Win32 [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) , чтобы определить причину ошибки.

### <a name="remarks"></a>Примечания

Параметр *пстрдирнаме* может быть либо частично, либо полным именем файла относительно текущего каталога. В качестве разделителя\\каталога для любого имени можно использовать обратную косую черту () или косую черту (/). `SetCurrentDirectory`преобразует разделители имен каталогов в соответствующие символы перед их использованием.

Используйте [GetCurrentDirectory](#getcurrentdirectory) для определения текущего рабочего каталога FTP-сервера. Не считайте, что удаленная система подключила вас к корневому каталогу.

## <a name="see-also"></a>См. также

[Класс CInternetConnection](../../mfc/reference/cinternetconnection-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CInternetConnection](../../mfc/reference/cinternetconnection-class.md)<br/>
[Класс CInternetSession](../../mfc/reference/cinternetsession-class.md)
