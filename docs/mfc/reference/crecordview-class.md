---
title: Класс CRecordView
ms.date: 11/04/2016
f1_keywords:
- CRecordView
- AFXDB/CRecordView
- AFXDB/CRecordView::CRecordView
- AFXDB/CRecordView::IsOnFirstRecord
- AFXDB/CRecordView::IsOnLastRecord
- AFXDB/CRecordView::OnGetRecordset
- AFXDB/CRecordView::OnMove
helpviewer_keywords:
- CRecordView [MFC], CRecordView
- CRecordView [MFC], IsOnFirstRecord
- CRecordView [MFC], IsOnLastRecord
- CRecordView [MFC], OnGetRecordset
- CRecordView [MFC], OnMove
- CRecordView [MFC], OnMove
ms.assetid: 9b4b0897-bd50-4d48-a0b4-f3323f5ccc55
ms.openlocfilehash: 409739d97c9f7ae9a730ac8f05bd86e647da2c71
ms.sourcegitcommit: ab8d7b47b63b62892a1256a09b1324a9a136eccf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2020
ms.locfileid: "78215530"
---
# <a name="crecordview-class"></a>Класс CRecordView

Представление, которое отображает записи базы данных в элементах управления.

## <a name="syntax"></a>Синтаксис

```
class AFX_NOVTABLE CRecordView : public CFormView
```

## <a name="members"></a>Члены

### <a name="protected-constructors"></a>Защищенные конструкторы

|Имя|Description|
|----------|-----------------|
|[CRecordView:: CRecordView](#crecordview)|Формирует объект `CRecordView`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Description|
|----------|-----------------|
|[CRecordView:: Исонфирстрекорд](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записью в связанном наборе записей.|
|[CRecordView:: Исонластрекорд](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записью в связанном наборе записей.|
|[CRecordView:: Онжетрекордсет](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CRecordset`. ClassWizard переопределяет эту функцию и при необходимости создает набор записей.|
|[CRecordView:: OnMove](#onmove)||

### <a name="protected-methods"></a>Защищенные методы

|Имя|Description|
|----------|-----------------|
|[CRecordView:: OnMove](#onmove)|Если текущая запись изменилась, обновляет ее в источнике данных, а затем переходит к указанной записи (Следующая, Предыдущая, первая или последняя).|

## <a name="remarks"></a>Remarks

Представление является представлением формы, которое напрямую подключено к `CRecordset` объекту. Представление создается на основе ресурса шаблона диалогового окна и отображает поля объекта `CRecordset` в элементах управления шаблона диалогового окна. Объект `CRecordView` использует обмен данными в диалоговых окнах (DDX) и обмен полями записей (RFX) для автоматизации перемещения данных между элементами управления в форме и полями набора записей. `CRecordView` также предоставляет реализацию по умолчанию для перехода к первой, следующей, предыдущей или последней записи и интерфейс для обновления записи в данный момент в представлении.

> [!NOTE]
>  Если вы работаете с классами объектов доступа к данным (DAO), а не с классами ODBC, используйте вместо этого класс [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) . Дополнительные сведения см. в статье [Общие сведения о программировании баз данных](../../data/data-access-programming-mfc-atl.md).

Наиболее распространенным способом создания представления записей является мастер приложений. Мастер приложений создает класс представления записей и связанный с ним класс набора записей как часть скелета начального приложения. Если класс представления записей не создается с помощью мастера приложений, его можно создать позже с помощью ClassWizard. Если вам нужна только одна форма, то проще подходить с помощью мастера приложений. ClassWizard позволяет принять решение об использовании представления записей в дальнейшем в процессе разработки. Использование ClassWizard для создания представления записей и набора записей по отдельности, а затем их подключение является самым гибким подходом, поскольку обеспечивает более широкие возможности управления именованием класса набора записей и его. H/. CPP файлы. Этот подход также позволяет иметь несколько представлений записей для одного и того же класса набора записей.

Чтобы облегчить пользователям переход от записи к записи в представлении записей, мастер приложений создает меню (и, при необходимости, панель инструментов) ресурсов для перехода к первой, следующей, предыдущей или последней записи. При создании класса представления записей с помощью ClassWizard необходимо создать эти ресурсы самостоятельно с помощью редакторов меню и растровых изображений.

Сведения о реализации по умолчанию для перехода от записи к записи см. в разделе `IsOnFirstRecord` и `IsOnLastRecord`, а также в статье [с помощью представления записей](../../data/using-a-record-view-mfc-data-access.md).

`CRecordView` отслеживает расположение пользователя в наборе записей, чтобы представление записей может обновить пользовательский интерфейс. Когда пользователь переходит к концу набора записей, представление записей отключает объекты пользовательского интерфейса, такие как элементы меню или кнопки панели инструментов, для перемещения дальше в том же направлении.

Дополнительные сведения об объявлении и использовании представлений записей и классов набора записей см. в разделе «Проектирование и создание представления записей» в [представлениях записей](../../data/record-views-mfc-data-access.md)статей. Дополнительные сведения о работе представлений записей и их использовании см. в статье [Использование представления записей](../../data/using-a-record-view-mfc-data-access.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CRecordView`

## <a name="requirements"></a>Требования

**Заголовок:** афксдб. h

##  <a name="crecordview"></a>CRecordView:: CRecordView

При создании объекта типа, производного от `CRecordView`, вызовите либо форму конструктора для инициализации объекта представления, и укажите ресурс диалогового окна, на котором основано представление.

```
explicit CRecordView(LPCTSTR lpszTemplateName);
explicit CRecordView(UINT nIDTemplate);
```

### <a name="parameters"></a>Параметры

*лпсзтемплатенаме*<br/>
Содержит строку, завершающуюся нулем, которая является именем ресурса шаблона диалогового окна.

*нидтемплате*<br/>
Содержит ИДЕНТИФИКАЦИОНный номер ресурса шаблона диалогового окна.

### <a name="remarks"></a>Remarks

Можно либо указать ресурс по имени (передать строку в качестве аргумента конструктору), либо по его ИДЕНТИФИКАТОРу (передать целое число без знака в качестве аргумента). Рекомендуется использовать идентификатор ресурса.

> [!NOTE]
>  Производный класс *должен* предоставить собственный конструктор. В конструкторе производного класса вызовите конструктор `CRecordView::CRecordView` с именем ресурса или ИДЕНТИФИКАТОРом в качестве аргумента, как показано в примере ниже.

`CRecordView::OnInitialUpdate` вызывает `UpdateData`, который вызывает `DoDataExchange`. Этот начальный вызов `DoDataExchange` подключает элементы управления `CRecordView` (косвенно) к `CRecordset` элементам данных поля, созданным с помощью ClassWizard. Эти элементы данных нельзя использовать до тех пор, пока не будет вызван базовый класс `CFormView::OnInitialUpdate` функции члена.

> [!NOTE]
>  При использовании ClassWizard мастер определяет значение **перечисления** `CRecordView::IDD`, указывает его в объявлении класса и использует его в списке инициализации элементов для конструктора.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDatabase#32](../../mfc/codesnippet/cpp/crecordview-class_1.cpp)]

##  <a name="isonfirstrecord"></a>CRecordView:: Исонфирстрекорд

Вызовите эту функцию-член, чтобы определить, является ли текущая запись первой записью в объекте набора записей, связанном с этим представлением записей.

```
BOOL IsOnFirstRecord();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая запись является первой записью в наборе записей; в противном случае — 0.

### <a name="remarks"></a>Remarks

Эта функция полезна для написания собственных реализаций обработчиков обновления команд по умолчанию, написанных ClassWizard.

Если пользователь переходит на первую запись, платформа отключает все объекты пользовательского интерфейса, необходимые для перехода к первой или предыдущей записи.

##  <a name="isonlastrecord"></a>CRecordView:: Исонластрекорд

Вызовите эту функцию-член, чтобы определить, является ли текущая запись последней записью в объекте набора записей, связанном с этим представлением записей.

```
BOOL IsOnLastRecord();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая запись является последней записью в наборе записей; в противном случае — 0.

### <a name="remarks"></a>Remarks

Эта функция полезна для написания собственных реализаций обработчиков обновления команд по умолчанию, ClassWizard запись для поддержки пользовательского интерфейса для перехода от записи к записи.

> [!CAUTION]
>  Результат этой функции надежен, за исключением того, что представление не может определить конец набора записей, пока пользователь не переместит его. Пользователь должен перейти за пределы последней записи, прежде чем представление записи сможет определить, что он должен отключить все объекты пользовательского интерфейса для перехода к следующей или последней записи. Если пользователь переместится за последнюю запись, а затем перейдет к последней записи (или до нее), представление записей может отслеживанию положения пользователя в наборе записей и правильно отключить объекты пользовательского интерфейса. `IsOnLastRecord` также ненадежна после вызова функции реализации `OnRecordLast`, которая обрабатывает команду ID_RECORD_LAST или `CRecordset::MoveLast`.

##  <a name="ongetrecordset"></a>CRecordView:: Онжетрекордсет

Возвращает указатель на объект, производный от `CRecordset`, связанный с представлением записей.

```
virtual CRecordset* OnGetRecordset() = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект, производный от `CRecordset`, если объект был успешно создан; в противном случае — пустой указатель.

### <a name="remarks"></a>Remarks

Необходимо переопределить эту функцию-член для создания или получения объекта набора записей и возвращения указателя на него. Если вы объявили класс представления записей с помощью ClassWizard, мастер запишет для вас переопределение по умолчанию. Реализация по умолчанию ClassWizard возвращает указатель набора записей, хранящийся в представлении записей, если он существует. В противном случае он конструирует объект набора записей типа, указанного с помощью ClassWizard, и вызывает его `Open` функцию-член для открытия таблицы или выполнения запроса, а затем возвращает указатель на объект.

Дополнительные сведения и примеры см. в разделе [представления записей статьи: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).

##  <a name="onmove"></a>CRecordView:: OnMove

Вызовите эту функцию-член, чтобы перейти к другой записи в наборе записей и отобразить ее поля в элементах управления представления записей.

```
virtual BOOL OnMove(UINT nIDMoveCommand);
```

### <a name="parameters"></a>Параметры

*нидмовекомманд*<br/>
Одно из следующих стандартных значений идентификатора команды:

- ID_RECORD_FIRST перейти к первой записи в наборе записей.

- ID_RECORD_LAST перейти к последней записи в наборе записей.

- ID_RECORD_NEXT перейти к следующей записи в наборе записей.

- ID_RECORD_PREV перейти к предыдущей записи в наборе записей.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если перемещение прошло успешно; в противном случае — 0, если запрос на перемещение был отклонен.

### <a name="remarks"></a>Remarks

Реализация по умолчанию вызывает соответствующую функцию члена `Move` объекта `CRecordset`, связанного с представлением записи.

По умолчанию `OnMove` обновляет текущую запись в источнике данных, если пользователь изменил его в представлении записей.

Мастер приложений создает ресурс меню с элементами меню первая запись, последняя запись, следующая запись и Предыдущая запись. При выборе параметра закрепляемая панель инструментов Мастер приложений также создает панель инструментов с кнопками, соответствующими этим командам.

Если переместиться за последнюю запись в наборе записей, то в представлении записей будет отображаться последняя запись. Если перейти назад после первой записи, то в представлении записей будет отображаться первая запись.

> [!CAUTION]
>  Вызов `OnMove` создает исключение, если набор записей не содержит записей. Вызовите соответствующую функцию обработчика обновлений пользовательского интерфейса — `OnUpdateRecordFirst`, `OnUpdateRecordLast`, `OnUpdateRecordNext`или `OnUpdateRecordPrev` — перед соответствующей операцией перемещения, чтобы определить, содержит ли набор записей какие-либо записи.

## <a name="see-also"></a>См. также раздел

[Класс CFormView](../../mfc/reference/cformview-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CRecordset](../../mfc/reference/crecordset-class.md)<br/>
[Класс CFormView](../../mfc/reference/cformview-class.md)
