---
title: Поддержка базы данных, мастер приложений MFC | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- vc.appwiz.mfc.exe.database
dev_langs:
- C++
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7a2f6fde7b62dacae540f6f3b6d22569e637ad97
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46421002"
---
# <a name="database-support-mfc-application-wizard"></a>Поддержка базы данных, мастер приложений MFC

Эта страница содержит параметры, которые позволяют пользователю указать уровень базы данных поддерживают (и источника данных, при необходимости) для проекта.

- **Поддержка баз данных**

   Задает уровень поддержки базы данных для проекта.

   |Параметр|Описание|
   |------------|-----------------|
   |**None**|Не поддерживает базы данных. Этот параметр используется по умолчанию.|
   |**Только файлы заголовков**|Предоставляет базовый уровень поддержки базы данных для приложения. При выборе поддержки ODBC в рамках **тип клиента**, мастер приложений MFC включает в проект файл заголовка AFXDB. З. Он добавляет библиотеки, но он не создает любые классы, зависящие от базы данных. Можно создать наборы записей в более поздней версии и использовать их для проверки и обновления записей. При выборе поддержки OLE DB в рамках **тип клиента**, включены следующие файлы заголовков: ATLBASE. H AFXOLEDB. H ATLPLUS. H|
   |**Представление базы данных без поддержки файлов**|Включает в себя базы данных файлы заголовков, библиотек, представление записей и набор записей. (Доступно только для приложений с помощью **поддержка архитектуры Document/view** параметра, выбранного в [тип приложения](../../mfc/reference/application-type-mfc-application-wizard.md) страницы.) Этот параметр включает поддержку документов, но не поддержку сериализации. Если вы решили включить представления базы данных, необходимо указать источник данных.|
   |**Представление базы данных с поддержкой файлов**|Включает в себя базы данных файлы заголовков, библиотек, представление записей и набор записей. (Доступно только для приложений с помощью **поддержка архитектуры Document/view** параметра, выбранного в **тип приложения** страницы.) Этот параметр поддерживает сериализацию документов, которую можно использовать, например, для обновления файла профиля пользователя. Приложения баз данных обычно выполняются на основе записей, а не на отдельных файлов, поэтому не требуется сериализация. Тем не менее возможно специальное использование для сериализации. Если вы решили включить представления базы данных, необходимо указать источник данных.|

   > [!NOTE]
   > В разделе **база данных поддерживает**, если выбран один **представление без поддержки файлов базы данных** или **представление с поддержкой файлов базы данных**, представление классов будет отличаться в зависимости на ваш **тип клиента** выбора, как показано ниже:

   - При выборе **ODBC** под **тип клиента**, а затем класс представления приложения является производным от [CRecordView](../../mfc/reference/crecordview-class.md). Этот класс, связанный с [CRecordset](../../mfc/reference/crecordset-class.md)-производный класс, который автоматически создается мастером приложений MFC. Этот параметр позволяет использовать приложения на основе форм, в котором представление записей используется для просмотра и обновления записей в наборе записей.

   - При выборе **OLE DB** под **тип клиента**, а затем класс представления является производным от [COleDBRecordView](../../mfc/reference/coledbrecordview-class.md), и связанной с ними [CTable](../../data/oledb/ctable-class.md) или [CCommand](../../data/oledb/ccommand-class.md)-производного класса.

- **Тип клиента**

   Указывает, использует ли проект классы OLE DB или ODBC.

   |Параметр|Описание|
   |------------|-----------------|
   |**OLE DB**|Если этот параметр выбран, при нажатии **источника данных** кнопка вызывает **свойства канала передачи данных** мастер для создания подключения к источнику данных OLE DB.|
   |**ODBC**|Если этот параметр выбран, при нажатии **источника данных** кнопка вызывает **Выбор источника данных** мастер поможет создать подключение к источнику данных ODBC.|

- **Источник данных**

   Нажмите кнопку **источника данных** кнопку, чтобы задать источник данных, используя указанный драйвер или поставщик и базы данных. Если вы выбрали OLE DB в **тип клиента** , эта кнопка будет показываться **свойства канала передачи данных** диалоговое окно. Если вы выбрали ODBC в **тип клиента** параметр, эта кнопка предоставляет **Выбор источника данных** диалоговое окно. Этот параметр доступен только в том случае, если вы решили включить представление базы данных в приложении.

   |Параметр|Описание|
   |------------|-----------------|
   |**Свойства связи данных** (OLE DB)|Устанавливает указанный источник данных с помощью указанного поставщика OLE DB. Необходимо указать поставщика OLE DB, расположение данных, источник данных, идентификатор входа и (необязательно) пароль. Дополнительные сведения об этом диалоговом окне, см. в разделе **источника данных** в [Мастер потребителя ATL OLE DB](../../atl/reference/atl-ole-db-consumer-wizard.md).|
   |**Выберите источник данных** (ODBC)|Устанавливает указанный источник данных с помощью заданного драйвера ODBC. Необходимо выбрать имя источника данных, чтобы выбрать таблицу для источника данных. Мастер выполняет привязку всех столбцов таблицы для переменных-членов из `CRecordset`-производного класса. Дополнительные сведения об этом диалоговом окне, см. в разделе **источника данных** в [Мастер потребителя MFC ODBC](../../mfc/reference/mfc-odbc-consumer-wizard.md).|

   > [!NOTE]
   > В предыдущих выпусках, нажав Shift **источника данных** кнопки открывается диалоговое окно открытия файла для вы можете выбрать файл данных (udl). Эта функция больше не поддерживается.

- **Создать класс базы данных с атрибутами**

   Доступно для клиентов OLE DB только. Указывает, использовать ли классы баз данных в созданном проекте атрибуты.

- **Привязать все столбцы**

   Доступно только для клиентов ODBC. Указывает, связаны ли все столбцы в выбранной таблице. Если этот флажок установлен, все столбцы привязаны; Если этот флажок не установлен, столбцы не привязаны, и необходимо привязать их вручную в классе наборов записей.

- **Type**

   Доступно только для клиентов ODBC. Указывает ли набор записей является динамическим подмножеством данных или моментального снимка, как описано в следующей таблице.

   |Параметр|Описание|
   |------------|-----------------|
   |**Динамический набор**|Указывает, что набор записей является динамическим подмножеством данных. Динамический набор является результатом запроса, который предоставляет индексированное представление в запрошенных данных базы данных. Подмножества кэширует только целочисленный индекс исходных данных и таким образом обеспечивается повышение производительности за моментального снимка. Индекс точки непосредственно для каждой записи найденных в результате запроса и указывает, если запись удаляется. Также имеется доступ к обновленным данным в запрошенных записях.|
   |**Снимок**|Указывает, что набор записей является моментальным снимком. Моментальный снимок является результатом запроса и — это представление базы данных в один момент времени. Все записи, обнаруженные в результате запроса кэшируются, поэтому вы не видите любые изменения исходных записей.|

## <a name="see-also"></a>См. также

[Мастер приложений MFC](../../mfc/reference/mfc-application-wizard.md)
