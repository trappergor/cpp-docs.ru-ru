---
title: Форматирование CString и отображение окна сообщения
ms.date: 11/04/2016
helpviewer_keywords:
- CString objects [MFC], formatting and message boxes
ms.assetid: d1068cf4-9cc5-4952-b9e7-d612c53cbc28
ms.openlocfilehash: ad880c5302fd2274c5d46719e912461fd7497f10
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78854081"
---
# <a name="cstring-formatting-and-message-box-display"></a>Форматирование CString и отображение окна сообщения

Для форматирования и анализа `CString` объектов предоставлено несколько функций. Эти функции можно использовать каждый раз, когда необходимо манипулировать `CString` объектами, но они особенно полезны для форматирования строк, которые будут отображаться в тексте окна сообщения.

Эта группа функций также включает в себя глобальную подпрограммы для отображения окна сообщения.

### <a name="cstring-functions"></a>Функции CString

|||
|-|-|
|[афксекстрактсубстринг](#afxextractsubstring)|Извлекает подстроки, разделенные одним символом из заданной исходной строки.|
|[AfxFormatString1](#afxformatstring1)|Заменяет заданную строку символами формата "%1" в строке, содержащейся в таблице строк.|
|[AfxFormatString2](#afxformatstring2)|Заменяет две строки на символы формата "%1" и "%2" в строке, содержащейся в таблице строк.|
|[AfxMessageBox](#afxmessagebox)|Отображает окно сообщения.|

### <a name="requirements"></a>Требования

  **Заголовок** AFXWIN. h

##  <a name="afxextractsubstring"></a>афксекстрактсубстринг

Эту глобальную функцию можно использовать для извлечения подстроки из заданной исходной строки.

```
BOOL AFXAPI AfxExtractSubString (
    CString& rString,
    LPCTSTR lpszFullString,
    int iSubString,
    TCHAR chSep  = '\n');
```

### <a name="parameters"></a>Параметры

*rStr*<br/>
Ссылка на объект [CString](../../atl-mfc-shared/using-cstring.md) , который будет принимать отдельную подстроку.

*лпсзфуллстринг*<br/>
Строка, содержащая полный текст строки, из которой производится извлечение.

*исубстринг*<br/>
Отсчитываемый от нуля индекс подстроки, извлекаемой из *лпсзфуллстринг*.

*чсеп*<br/>
Символ разделителя, используемый для разделения подстрок.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если функция успешно извлекли подстроку по указанному индексу; в противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Эта функция полезна при извлечении нескольких подстрок из исходной строки, когда один из них разделяет каждую подстроку. Эта функция выполняет поиск с начала параметра *лпсзфуллстринг* при каждом вызове.

Эта функция возвращает значение FALSE, если либо *лпсзфуллстринг* имеет значение null, либо функция достигает конца *Лпсзфуллстринг* без поиска *исубстринг*+ 1 вхождений указанного символа разделителя. Параметр *RSTR* не будет изменен из исходного значения, если для *лпсзфуллстринг* было задано значение null. в противном случае в качестве параметра *RSTR* устанавливается пустая строка, если не удалось извлечь подстроку для указанного индекса.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_Utilities#48](../../mfc/codesnippet/cpp/cstring-formatting-and-message-box-display_1.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** AFXWIN. h

##  <a name="afxformatstring1"></a>AfxFormatString1

Заменяет строку, на которую указывает *lpsz1* , для всех экземпляров символов "%1" в ресурсе строки шаблона, идентифицируемом *НИДС*.

```
void  AfxFormatString1(
    CString& rString,
    UINT nIDS,
    LPCTSTR lpsz1);
```

### <a name="parameters"></a>Параметры

*rStr*<br/>
Ссылка на объект `CString`, который будет содержать результирующую строку после выполнения подстановки.

*нидс*<br/>
Идентификатор ресурса строки шаблона, в которой будет выполняться подстановка.

*lpsz1*<br/>
Строка, которая заменит символы формата "%1" в строке шаблона.

### <a name="remarks"></a>Remarks

Вновь сформированная строка хранится в *RSTR*. Например, если строка в таблице строк имеет значение "файл %1 не найден", а *lpsz1* равен "к:\мифиле. TXT ", затем *RSTR* будет содержать строку" file к:\мифиле. TXT не найден». Эта функция полезна для форматирования строк, отправляемых в окна сообщений и другие окна.

Если символы формата "%1" появляются в строке несколько раз, будут выполнены несколько подстановок.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_Utilities#25](../../mfc/codesnippet/cpp/cstring-formatting-and-message-box-display_2.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** AFXWIN. h

##  <a name="afxformatstring2"></a>AfxFormatString2

Замещает строку, на которую указывает *lpsz1* , для всех экземпляров символов "%1" и строки, на которую указывает *lpsz2* , для всех экземпляров символов "%2" в ресурсе строки шаблона, определенном параметром *НИДС*.

```
void AfxFormatString2(
    CString& rString,
    UINT nIDS,
    LPCTSTR lpsz1,
    LPCTSTR lpsz2);
```

### <a name="parameters"></a>Параметры

*rStr*<br/>
Ссылка на `CString`, которая будет содержать результирующую строку после выполнения подстановки.

*нидс*<br/>
Идентификатор таблицы строк шаблона, в которой будет выполняться подстановка.

*lpsz1*<br/>
Строка, которая заменит символы формата "%1" в строке шаблона.

*lpsz2*<br/>
Строка, которая заменит символы формата "%2" в строке шаблона.

### <a name="remarks"></a>Remarks

Вновь сформированная строка хранится в *RSTR*. Например, если строка в таблице строк имеет значение "файл %1 не найден в каталоге %2", *lpsz1* указывает на "MyFile. TXT "и *lpsz2* указывает на" к:\мидир ", затем *RSTR* будет содержать строку" файл MyFile. Не удалось найти TXT в каталоге К:\МИДИР "

Если символы формата "%1" или "%2" появляются в строке несколько раз, будут выполнены несколько подстановок. Они не обязательно должны быть в числовом порядке.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_Utilities#26](../../mfc/codesnippet/cpp/cstring-formatting-and-message-box-display_3.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** AFXWIN. h

##  <a name="afxmessagebox"></a>AfxMessageBox

Отображает окно сообщения на экране.

```
int AfxMessageBox(
    LPCTSTR lpszText,
    UINT nType = MB_OK,
    UINT nIDHelp = 0);

int AFXAPI AfxMessageBox(
    UINT nIDPrompt,
    UINT nType = MB_OK,
    UINT nIDHelp = (UINT) -1);
```

### <a name="parameters"></a>Параметры

*lpszText*<br/>
Указывает на объект `CString` или строку, завершающуюся нулем, содержащую сообщение, отображаемое в окне сообщения.

*nType*<br/>
Стиль окна сообщения. Примените к полю любой из [стилей окна сообщения](../../mfc/reference/styles-used-by-mfc.md#message-box-styles) .

*нидхелп*<br/>
Идентификатор контекста справки для сообщения; значение 0 указывает, что будет использоваться контекст справки по умолчанию для приложения.

*нидпромпт*<br/>
Уникальный идентификатор, используемый для ссылки на строку в таблице строк.

### <a name="return-value"></a>Возвращаемое значение

Нуль, если недостаточно памяти для вывода окна сообщения; в противном случае возвращается одно из следующих значений:

- ИДАБОРТ была выбрана кнопка прервать.

- ИДКАНЦЕЛ была выбрана кнопка "Отмена".

- ИДИГНОРЕ кнопка «пропустить».

- ИДНО. кнопка не была выбрана.

- ИДОК, что была выбрана кнопка ОК.

- ИДРЕТРИ, что была выбрана кнопка повторить.

- ИДЕС, что была выбрана кнопка Да.

Если в окне сообщения есть кнопка Отмена, значение ИДКАНЦЕЛ будет возвращено, если нажата клавиша ESC или если выбрана кнопка Отмена. Если у окна сообщения нет кнопки Отмена, нажатие клавиши ESC не оказывает никакого воздействия.

Функции [AfxFormatString1](#afxformatstring1) и [AfxFormatString2](#afxformatstring2) могут быть полезны при форматировании текста, отображаемого в окне сообщения.

### <a name="remarks"></a>Remarks

Первая форма этой перегруженной функции отображает текстовую строку, на которую указывает *лпсзтекст* , в окне сообщения и использует *нидхелп* для описания контекста справки. Контекст справки используется для перехода к связанному разделу справки, когда пользователь нажимает клавишу справки (обычно это F1).

Вторая форма функции использует строковый ресурс с ИДЕНТИФИКАТОРом *нидпромпт* для вывода сообщения в окне сообщения. Связанная страница справки находится по значению *нидхелп*. Если используется значение по умолчанию *нидхелп* (-1), то для контекста справки используется идентификатор ресурса строки, *нидпромпт*. Дополнительные сведения об определении контекстов справки см. в [техническом примечании 28](../../mfc/tn028-context-sensitive-help-support.md).

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#133](../../mfc/reference/codesnippet/cpp/cstring-formatting-and-message-box-display_4.cpp)]

## <a name="see-also"></a>См. также раздел

[Макросы и глобальные](../../mfc/reference/mfc-macros-and-globals.md)<br/>
[Класс CStringT](../../atl-mfc-shared/reference/cstringt-class.md)
