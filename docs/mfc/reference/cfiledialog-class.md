---
title: Класс CFileDialog | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
dev_langs:
- C++
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 01fac0286ea93766771043ebfa7e268f0d6b167d
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50073907"
---
# <a name="cfiledialog-class"></a>Класс CFileDialog

Инкапсулирует общее диалоговое окно, который используется для открытия файла или файла операции сохранения.

## <a name="syntax"></a>Синтаксис

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Создает объект `CFileDialog`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Добавляет кнопку с галочкой в диалоговом окне.|
|[CFileDialog::AddComboBox](#addcombobox)|Добавляет поле со списком в диалоговом окне.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Добавляет элемент к элементу управления контейнера в диалоговом окне.|
|[CFileDialog::AddEditBox](#addeditbox)|Добавляет поле ввода в диалоговом окне.|
|[CFileDialog::AddMenu](#addmenu)|Добавляет меню диалогового окна.|
|[CFileDialog::AddPlace](#addplace)|Перегружен. Добавляет папку в список помещает пользователь для открытия или сохранения элементов.|
|[CFileDialog::AddPushButton](#addpushbutton)|Добавляет кнопку в диалоговом окне.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Добавляет группе (также известный как переключатель) в диалоговом окне.|
|[CFileDialog::AddSeparator](#addseparator)|Добавляет разделитель в диалоговом окне.|
|[CFileDialog::AddText](#addtext)|Добавляет текстовое содержимое в диалоговом окне.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Обновляет состояние `CFileDialog` в соответствии с параметрами и флагов, хранящихся в `m_ofn` переменной-члена.|
|[CFileDialog::DoModal](#domodal)|Отображает диалоговое окно и позволяет пользователю сделать выбор.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Включает стрелку раскрывающегося списка на **откройте** или **Сохранить** кнопку в диалоговом окне.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Останавливает добавлять элементы в группу visual в диалоговом окне.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Возвращает текущее состояние кнопки check (флажок) в диалоговом окне.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Возвращает текущее состояние элемента в элементе управления контейнера, в диалоговом окне.|
|[CFileDialog::GetControlState](#getcontrolstate)|Получает текущую видимость и включенные состояния данного элемента управления.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Получает текущий текст в поле ввода.|
|[CFileDialog::GetFileExt](#getfileext)|Возвращает расширение выбранного файла.|
|[CFileDialog::GetFileName](#getfilename)|Возвращает имя файла, выбранного файла.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Возвращает название выбранного файла.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Возвращает путь в настоящее время открытия папки или каталога для стиле проводника **откройте** или **Сохранить как** общее диалоговое окно.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Извлекает внутренний объект COM для настраиваемый `CFileDialog` объекта.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Извлекает внутренний объект COM для `CFileDialog` , используемый в качестве **откройте** диалоговое окно файла.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Извлекает внутренний объект COM для `CFileDialog` , используемый в качестве **Сохранить** диалоговое окно файла.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Возвращает полный путь Далее выбранного файла.|
|[CFileDialog::GetOFN](#getofn)|Извлекает `OPENFILENAME` структуры `CFileDialog` объекта.|
|[CFileDialog::GetPathName](#getpathname)|Возвращает полный путь выбранного файла.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Возвращает состояние выбранного файла только для чтения.|
|[CFileDialog::GetResult](#getresult)|Возвращает выбор, внесенные пользователем в диалоговом окне.|
|[CFileDialog::GetResults](#getresults)|Получает варианты пользователя в диалоговое окно Выбор нескольких элементов.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Получает определенный элемент из указанного контейнера элементов управления в диалоговом окне.|
|[CFileDialog::GetStartPosition](#getstartposition)|Возвращает позицию первого элемента список имен файлов.|
|[CFileDialog::HideControl](#hidecontrol)|Скрывает указанного элемента управления в стиле проводника **откройте** или **Сохранить как** общее диалоговое окно.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Определяет, если текущее диалоговое окно в режиме выбора папки.|
|[CFileDialog::MakeProminent](#makeprominent)|Окружение элемент управления в диалоговом окне, чтобы лучше выделялся по сравнению с другими элементами управления, добавленными.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Удаляет элемент из контейнерного элемента управления в диалоговом окне.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Задает текущее состояние кнопки check (флажок) в диалоговом окне.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Задает текущее состояние элемента в элементе управления контейнера, в диалоговом окне.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Задает текст элемента управления. Например, текст, сопровождающий типа "переключатель" или элемента меню.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Задает текст, связанный с элементом управления, например текст кнопки или изменить метку поля.|
|[CFileDialog::SetControlState](#setcontrolstate)|Задает текущую видимость и включенные состояния данного элемента управления.|
|[CFileDialog::SetControlText](#setcontroltext)|Задает текст для указанного элемента управления в стиле проводника **откройте** или **Сохранить как** общее диалоговое окно.|
|[CFileDialog::setdefext изменена](#setdefext)|Задает расширение имени файла по умолчанию для обозревателя стиле **откройте** или **Сохранить как** общее диалоговое окно.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Задает текущий текст в поле ввода.|
|[CFileDialog::SetProperties](#setproperties)|Предоставляет хранилище свойств, которое определяет значения по умолчанию для сохраняемого элемента.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Задает выбранное состояние какого-либо элемента в группе или поле со списком в диалоговом окне.|
|[CFileDialog::SetTemplate](#settemplate)|Задает шаблон диалогового окна для `CFileDialog` объекта.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Объявляет группу visual в диалоговом окне. Последующие вызовы для любого метода «add» добавить эти элементы в эту группу.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Обновляет данные, хранящиеся в `m_ofn` переменную-член для соответствия текущему состоянию диалоговым окном файла.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Описание|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Вызывается при нажатии кнопки.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Вызывается, когда флажок или снятии флажка.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Вызывается, когда элемент управления быть активными.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Обрабатывает сообщения WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Проверяет имя файла, введенное в диалоговом окне.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Обрабатывает сообщения WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Обрабатывает сообщения WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Вызывается, когда выбран элемент контейнера.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Позволяет выполнять пользовательские действия при изменении выбора файла.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Дескрипторы совместно использовать нарушений.|
|[CFileDialog::OnTypeChange](#ontypechange)|Обрабатывает сообщения WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Windows `OPENFILENAME` структуры. Предоставляет доступ к параметрам поле диалогового окна базовый файл.|

## <a name="remarks"></a>Примечания

Общих файловых диалоговых позволяют реализовать выбора файлов диалоговые окна, например, **открыть файл** и **Сохранить как**, таким образом, соответствуют стандартам Windows.

Можно использовать `CFileDialog` как есть без конструктору, предоставленному, или же возможно наследование класса из собственного диалогового окна `CFileDialog` и создание конструктора в соответствии с потребностями. В любом случае этим диалоговым окнам будет работать как стандартные диалоговые окна MFC, поскольку они являются производными от [класс CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog` использует COMMDLG. DLL-файл, который включен в Windows.

Внешний вид и функциональность `CFileDialog` с Windows Vista или более поздней версии, отличаются от более ранних версиях Windows. Значение по умолчанию `CFileDialog` автоматически использует новые Windows Vista или более поздней версии стиля без изменения кода, если программа находится скомпилированный и выполнения в Windows Vista или более поздней версии. Используйте *bVistaStyle принимал* параметра в конструктор для переопределения автоматического обновления в ручном режиме. Для автоматического обновления исключение настраиваемых диалоговых окон. Они не будут преобразовываться в новый стиль. Дополнительные сведения о конструкторе см. в разделе [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
>  Идентификатор системы управления отличается в Windows Vista или более поздней версии из более ранних версиях Windows, при использовании `CFileDialog`. Необходимо обновить все ссылки на `CFileDialog` элементов управления в коде, прежде чем можно перенести свой проект из более ранней версии Windows.

Некоторые `CFileDialog` методы не поддерживаются в Windows Vista или более поздней версии. Проверьте в разделе отдельном методе, сведения о поддержке метода. Кроме того следующие унаследованные функции не поддерживаются в Windows Vista или более поздней версии:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Сообщения windows для `CFileDialog` класс различаются в зависимости от используемой операционной системы. Например, Windows XP не поддерживает [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) и [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) для `CFileDialog` класса. Тем не менее Windows Vista и более поздних версий поддерживают их. Дополнительные сведения о различных сообщениях, которые создаются и порядок, в котором они поступают, см. в разделе [CFileDialog пример: ведение журнала порядок событий](../../visual-cpp-samples.md).

Чтобы использовать `CFileDialog` следует сначала создать объект с помощью `CFileDialog` конструктор. После создания диалоговом окне можно задать или изменить значения в [CFileDialog::m_ofn](#m_ofn) структуры для инициализации значения или состояния элементов управления диалогового окна. `m_ofn` Структуры имеет тип `OPENFILENAME`. Дополнительные сведения см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры в пакете Windows SDK.

После инициализации элементов окна, вызовите [CFileDialog::DoModal](#domodal) метод для отображения диалогового окна поле, чтобы пользователь может ввести путь и имя файла. `DoModal` Возвращает, нажал ли пользователь кнопку ОК (IDOK) или кнопку Отмена (IDCANCEL). Если `DoModal` возвращает IDOK, можно использовать один из `CFileDialog` прописными открытыми функциями-членами для получения информации пользователем.

> [!NOTE]
> В Windows Vista или более поздней версии, несколько вызовов [IFileDialog::SetFileTypes](https://msdn.microsoft.com/library/windows/desktop/bb775980) приводит к ошибке. Второй вызов `SetFileTypes` для любого экземпляра `CFileDialog` возвратит E_UNEXPECTED в Windows Vista или более поздней версии. Некоторые `CFileDialog` метод функции вызывают `SetFileTypes`. Например, два вызова к `CFileDialog::DoModal` для одного экземпляра `CFileDialog` приводит к возникновению ошибки [ASSERT](diagnostic-services.md#assert).

`CFileDialog` включает в себя несколько защищенных членов, которые позволяют выполнять пользовательскую обработку нарушения общего ресурса, проверка правильности имени файла и уведомление об изменении списков. Эти защищенные члены являются функции обратного вызова, большинству приложений не требуется использовать, так как по умолчанию обработка выполняется автоматически. Записи схемы сообщений для этих функций не требуются, поскольку они являются стандартные виртуальные функции.

Можно использовать Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) функция для определения, произошла ли ошибка во время инициализации диалогового окна и Дополнительные сведения об ошибке.

Уничтожение `CFileDialog` объектов обрабатывается автоматически. Нет необходимости вызывать [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Чтобы позволить пользователю выбрать несколько файлов, установите флаг OFN_ALLOWMULTISELECT, перед вызовом метода `DoModal`. Необходимо указать собственный буфер имени файла в соответствии с возвращаемый список несколько имен файлов. Это можно сделать путем замены `m_ofn.lpstrFile` с указателем на буфер распределения, после создания `CFileDialog`, но перед вызовом метода `DoModal`.

Кроме того, необходимо задать `m_ofn.nMaxFile` с помощью число символов в буфере, на которые указывают `m_ofn.lpstrFile`. Если задать максимальное количество файлов для `n`, необходимый размер буфера является `n * (_MAX_PATH + 1) + 1`. Первый элемент, возвращается в буфер — это путь к папке, где были выбраны файлы. Для Windows Vista или более поздней версии в стиле диалоговых окон строковых имен каталогов и файлов, которые нулевым байтом, с помощью дополнительный символ null после последнего имени файла. Этот формат позволяет диалоговых окнах проводника для возврата длинные имена файлов, содержащие пробелы. Для старого стиля диалоговых окон строковых имен каталогов и файлов разделенных пробелами и функция использует короткие имена файлов для имена файлов пробелами.

В следующем примере показано, как использовать буфер для получения и списка несколько имен файлов.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Чтобы изменить размер буфера в ответ на выбор несколько имен файлов, должен быть производным от нового класса `CFileDialog` и переопределить [CFileDialog::OnFileNameChange](#onfilenamechange) метод.

Если при создании нового производного класса от `CFileDialog`, можно использовать схему сообщений для обработки сообщения. Чтобы расширить обработку сообщения по умолчанию, являются производными от класса `CFileDialog`, добавить схему сообщений к новому классу и обеспечения функций-членов для новых сообщений. У вас нет для предоставления функция-ловушка для настройки диалогового окна.

Чтобы настроить в диалоговом окне, являются производными от класса `CFileDialog`укажите шаблон пользовательского диалогового окна и добавить схему сообщений для обработки сообщений уведомлений из расширенных элементов управления. Передайте все необработанные сообщения базового класса. У вас нет для настройки функция-обработчик.

При использовании Windows Vista или более поздней версии стиль `CFileDialog`, нельзя использовать схемы сообщений и шаблонов диалоговых окон. Вместо этого необходимо использовать COM-интерфейсы, аналогичными функциональными возможностями.

Дополнительные сведения об использовании `CFileDialog`, см. в разделе [классы общих диалоговых окон](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Требования

**Заголовок:** afxdlgs.h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Добавляет кнопку с галочкой в диалоговом окне.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор "Проверить", необходимо добавить.

*strLabel*<br/>
Имя кнопки check.

*bChecked*<br/>
Логическое значение, указывающее текущее состояние "Проверить". Значение TRUE, если этот флажок установлен; Значение FALSE в противном случае

### <a name="remarks"></a>Примечания

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Добавляет поле со списком в диалоговом окне.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля со списком, который необходимо добавить.

### <a name="remarks"></a>Примечания

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

Добавляет элемент к элементу управления контейнера в диалоговом окне.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления для добавления элемента.

*dwIDItem*<br/>
Идентификатор элемента.

*strLabel*<br/>
Текст для элемента.

### <a name="remarks"></a>Примечания

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

Добавляет поле ввода в диалоговом окне.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля ввода, который необходимо добавить.

*strText*<br/>
Имя поля редактирования.

### <a name="remarks"></a>Примечания

##  <a name="addmenu"></a>  CFileDialog::AddMenu

Добавляет меню диалогового окна.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор меню, чтобы добавить.

*strLabel*<br/>
Имя меню.

### <a name="remarks"></a>Примечания

##  <a name="addplace"></a>  CFileDialog::AddPlace

Добавляет папку в список помещает пользователь для открытия или сохранения элементов.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Параметры

*lpszFolder*<br/>
Путь к папке должны быть доступны пользователю. Это может быть только папку.

*fdap*<br/>
Указывает, где размещается папка в пределах списка.

*PSI*<br/>
Указатель на экземпляр интерфейса IShellItem к папке должны быть доступны пользователю. Это может быть только папку.

### <a name="remarks"></a>Примечания

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Добавляет кнопку в диалоговом окне.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор кнопки для добавления.

*strLabel*<br/>
Имя кнопки.

### <a name="remarks"></a>Примечания

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

Добавляет группе (также известный как переключатель) в диалоговом окне.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор группы переключателей, необходимо добавить.

### <a name="remarks"></a>Примечания

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

Добавляет разделитель в диалоговом окне.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Добавьте идентификатор разделителя.

### <a name="remarks"></a>Примечания

##  <a name="addtext"></a>  CFileDialog::AddText

Добавляет текст в диалоговом окне.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор текста для добавления.

*strText*<br/>
Имя текста.

### <a name="remarks"></a>Примечания

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

Обновляет текущее состояние [CFileDialog](../../mfc/reference/cfiledialog-class.md) на основе значений, хранящихся в `m_ofn` структуру данных.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Примечания

В версиях Windows до Windows Vista, член [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) структуру данных непрерывно был синхронизирован с состоянием `CFileDialog`. Любые изменения [m_ofn](#m_ofn) переменной-члена были немедленно отражаются в состоянии диалогового окна. Кроме того, любые изменения состояния окна немедленно обновлять `m_ofn` переменной-члена.

В Windows Vista или более поздней версии значения в `m_ofn` переменной-члена и состояние `CFileDialog` , не обязательно быть синхронизирована. Эта функция вызывает состояние `CFileDialog` обновляться в соответствии с `m_ofn` структуры. Windows вызывает эту функцию автоматически во время [CFileDialog::DoModal](#domodal).

Дополнительные сведения об использовании `CFileDialog` класса под Windows Vista или более поздней версии, см. в разделе [класса CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Пример

  См. в примере [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

Вызывайте эту функцию для создания стандартного диалогового окна файла Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Параметры

*bOpenFileDialog*<br/>
[in] Параметр, который определяет, какой тип диалогового окна для создания. Присвойте ему значение TRUE для создания **Открытие файла** диалоговое окно. Задайте для него значение FALSE для создания **сохранить файл как** диалоговое окно.

*lpszDefExt*<br/>
[in] Расширение имени файла по умолчанию. Если пользователь не содержит известного расширения имени (один, который связан на компьютере пользователя) в поле имя файла, расширение, заданный *lpszDefExt* автоматически добавляется к имени файла. Если этот параметр имеет значение NULL, добавляется без расширения.

*lpszFileName*<br/>
[in] Имя исходного файла, которое отображается в поле имя файла. Если значение равно NULL, отображается не исходное имя файла.

*dwFlags*<br/>
[in] Сочетание одного или нескольких флагов, которые можно использовать для настройки диалогового окна. Описание этих флагов, см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры в пакете Windows SDK. При изменении `m_ofn.Flags` структура элемента, используйте оператор побитового или изменений, чтобы сохранить поведение по умолчанию без изменений.

*lpszFilter*<br/>
[in] Ряд пар "строка", которые задают фильтры можно применить к файлу. При указании фильтров файлов только файлы, соответствующие условиям фильтра будут отображаться в списке файлов. Дополнительные сведения о том, как работать с фильтрами файлов в разделе "Примечания".

*pParentWnd*<br/>
[in] Указатель на родительский объект или владельца окно диалоговым окном файла.

*dwSize*<br/>
[in] Размер `OPENFILENAME` структуры. Это значение зависит от версии операционной системы. MFC позволяет определить, верны диалоговое окно для создания этого параметра. Размер по умолчанию 0 означает, что код MFC определит размер поле правильный диалогового окна для использования на основе версии операционной системы, в которой выполняется программа.

*bVistaStyle принимал*<br/>
[in] **Примечание** этот параметр доступен в Visual Studio 2008 и более поздних и оно будет вызвать диалоговое окно Новый стиль для использования только в том случае, если вы используете в Windows Vista или более поздней версии.

Параметр, который задает стиль для диалогового окна файла. Установите значение true для использования нового стиля Vista диалоговые окна открытия файла. В противном случае будет использоваться старый стиль диалоговых окон. См. в разделе "Примечания" Дополнительные сведения под управлением Vista.

### <a name="remarks"></a>Примечания

Либо **Открытие файла** или **сохранить файл как** создается диалоговое окно, в зависимости от значения *bOpenFileDialog*.

Задание расширений по умолчанию с помощью *lpszDefExt* может не дать поведение, которое ожидается, что, так как редко является прогнозируемым, какие расширения имеют сопоставления файлов на компьютере пользователя. Если вам требуется больший контроль над добавлением расширение по умолчанию, вы можете собственный производный класс из `CFileDialog`и Переопределите `CFileDialog::OnFileNameOK` метод, чтобы выполнить собственную обработку расширения.

Чтобы пользователи могли выбрать несколько файлов, установите флаг OFN_ALLOWMULTISELECT перед вызовом метода [DoModal](#domodal). Необходимо указать собственный буфер имени файла для хранения возвращаемый список несколько имен файлов. Это можно сделать путем замены `m_ofn.lpstrFile` с указателем на буфер распределения, после создания [CFileDialog](../../mfc/reference/cfiledialog-class.md), но перед вызовом метода `DoModal`. Кроме того, необходимо задать `m_ofn.nMaxFile` число символов в буфере, на которые указывают `m_ofn.lpstrFile`. Если задать максимальное количество файлов для *n*, необходимый размер буфера является `n`*(_MAX_PATH + 1) + 1. Пример:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Чтобы разрешить пользователю изменять размер в диалоговом окне проводника с помощью клавиатуры или мыши, установите флаг OFN_ENABLESIZING. Этот параметр необходим, только в том случае, если указать процедуру обработки или пользовательский шаблон. Флаг работает только с диалоговым окном в стиле проводника; Невозможно изменить размер старого стиля диалоговым окнам.

*LpszFilter* параметр используется для определения типа имени файла, файл должен иметь для отображения в списке файлов. Первая строка в паре строка описывает фильтр; Вторая строка указывает расширение имени файла для использования. Можно указать несколько расширений, используя в качестве разделителя точку с запятой (знак «;»). Строка заканчивается с двумя "&#124;" символов, за которым следует символ NULL. Можно также использовать [CString](../../atl-mfc-shared/using-cstring.md) объект для этого параметра.

Например Microsoft Excel позволяет пользователям открывать файлы, имеющие расширения .xlc (диаграмма) или .xls (лист) среди других. Фильтр для Excel можно записать так:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Тем не менее, если вы планируете использовать эту строку, чтобы напрямую обновить `OPENFILENAME` структуру, следует заканчивать строки символом null '\0', а не вертикальными чертами ("&#124;").

*BVistaStyle принимал* применим только при работе под Windows Vista или более поздней версии. В более ранних версиях Windows этот параметр учитывается. Если *bVistaStyle принимал* имеет значение TRUE, при компиляции программы с помощью Visual Studio 2008 или более поздней версии, по-новому Vista **диалоговое окно файла** будет использоваться. В противном случае предыдущий стиль в MFC **диалоговое окно файла** будет использоваться.

Шаблонов диалоговых окон не поддерживаются в диалоговых окнах, на основе *bVistaStyle принимал*

### <a name="example"></a>Пример

  См. в примере [CFileDialog::DoModal](#domodal).

##  <a name="domodal"></a>  CFileDialog::DoModal

Вызывайте эту функцию для отображения Windows общего файлового диалогового и разрешить пользователю просмотр файлов и каталогов и введите имя файла.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Возвращаемое значение

IDOK и IDCANCEL. Если возвращается IDCANCEL, вызовите Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) функцию, чтобы определить, произошла ли ошибка.

IDOK и IDCANCEL являются константы, указывающие, является ли пользователь выбрал кнопку ОК или "Отмена".

### <a name="remarks"></a>Примечания

Если вы хотите инициализировать различные параметры диалогового окна файла путем определения участников `m_ofn` структуры, это следует сделать до вызова метода `DoModal`, но после создания объекта диалогового окна.

Например, если вы хотите разрешить пользователю выбирать несколько файлов, устанавливать флаг OFN_ALLOWMULTISELECT перед вызовом `DoModal`, как показано в примере кода в этом разделе.

Когда пользователь нажимает кнопки ОК или "Отмена" диалогового окна или выбирает закрытия параметр в диалоговом окне управления меню, управление возвращается в приложение. Затем можно вызвать другие функции-члены для получения параметров или сведения о входных данных пользователя в диалоговом окне.

`DoModal` — это виртуальная функция переопределении от класса `CDialog`.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

Позволяет стрелку раскрывающегося списка при открытии или кнопка в диалоговом окне "Сохранить".

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор списка, раскрывающегося списка.

### <a name="remarks"></a>Примечания

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Останавливает добавлять элементы в группу visual в диалоговом окне.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение S_OK, если выполнение прошло успешно; в противном случае значение ошибки.

### <a name="remarks"></a>Примечания

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

Возвращает текущее состояние кнопки check (флажок) в диалоговом окне.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля с флажком.

*bChecked*<br/>
Состояние флажка. Значение TRUE указывает, установлен; Значение FALSE указывает, флажок снят.

### <a name="remarks"></a>Примечания

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

Возвращает текущее состояние элемента в элементе управления контейнера, в диалоговом окне.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления.

*dwIDItem*<br/>
Идентификатор элемента.

*dwState*<br/>
Ссылка на переменную, которая получает один из нескольких значений из перечисления CDCONTROLSTATE, которое указывает текущее состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

Извлекает текущую видимость и включенные состояния данного элемента управления.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор элемента управления.

*dwState*<br/>
Ссылка на переменную, которая получает одно или несколько значений из перечисления CDCONTROLSTATE, которое указывает текущее состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Извлекает текущий текст в поле ввода.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля ввода.

*strText*<br/>
Текстовое значение.

### <a name="remarks"></a>Примечания

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Вызывайте эту функцию для получения расширение имени файла, введенного в диалоговое окно.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Возвращаемое значение

Расширение имени файла.

### <a name="remarks"></a>Примечания

Например если ввести имя файла — это данные. TXT, `GetFileExt` возвращает «TXT».

Если `m_ofn.Flags` OFN_ALLOWMULTISELECT флаг установлен, эта строка содержит последовательность нулем строк с первой строки, что путь к каталогу файловой группы выбран, следуют имена всех файлов, выбранных пользователем. Для получения пути файла, используйте [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) функций-членов.

##  <a name="getfilename"></a>  CFileDialog::GetFileName

Вызывайте эту функцию для получения названия для имени файла, введенного в диалоговом окне.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Имя файла

### <a name="remarks"></a>Примечания

Имя файла содержит префикс и расширение. Например `GetFileName` вернет «TEXT. Средство доступа к данным» для файла C:\FILES\TEXT.DAT.

Если `m_ofn.Flags` имеет `OFN_ALLOWMULTISELECT` набор флагов, следует вызывать [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) для получения пути файла.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

Вызывайте эту функцию для получения название файла, введенный в диалоговом окне.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Заголовок файла.

### <a name="remarks"></a>Примечания

Заголовок файла включает в себя только его префикса, без пути или расширения. Например `GetFileTitle` вернет «TEXT» для файла C:\FILES\TEXT.DAT.

Если `m_ofn.Flags` OFN_ALLOWMULTISELECT флаг установлен, эта строка содержит последовательность нулем строк с первой строки, что путь к каталогу файловой группы выбран, следуют имена всех файлов, выбранных пользователем. По этой причине использовать [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) функции-члены для получения следующего имени файла в списке.

### <a name="example"></a>Пример

  См. в примере [CFileDialog::DoModal](#domodal).

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

Вызовите эту функцию-член для получения пути в настоящее время открыть папку или каталог для проводника открыть или сохранить как общее диалоговое окно.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) объект, содержащий открытые папки или каталога.

### <a name="remarks"></a>Примечания

Диалоговое окно должна быть создана с помощью стиля OFN_EXPLORER; в противном случае метод завершится с утверждение.

Этот метод можно вызывать только в том случае, пока откроется диалоговое окно. После диалоговое окно будет закрыто, эта функция больше не будет работать и выполнение метода завершится ошибкой с утверждение.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

Извлекает указатель на внутренний объект COM для данного [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на внутренний объект COM для `CFileDialog`. Отвечает соответствующим образом освободить этот указатель.

### <a name="remarks"></a>Примечания

Используйте эту функцию только в Windows Vista или более поздней версии с объектом, который имеет *bVistaStyle принимал* присвоено значение TRUE. Если вы используете эту функцию при *bVistaStyle принимал* имеет значение FALSE, он будет возвращать значение NULL в режиме выпуска и создают утверждение в режиме отладки.

Дополнительные сведения о `IFileDialogCustomize` интерфейсом, см. в разделе [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Пример

Этот пример извлекает внутренний COM-объекта. Чтобы запустить этот пример кода, необходимо скомпилировать его в Windows Vista или более поздней версии.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

Извлекает указатель на внутренний объект COM для данного `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на внутренний объект COM для `CFileDialog`. Отвечает соответствующим образом освободить этот указатель.

### <a name="remarks"></a>Примечания

Используйте эту функцию только в Windows Vista или более поздней версии с объектом, который имеет *bVistaStyle принимал* присвоено значение TRUE. Эта функция возвращает значение NULL, если `CFileDialog` не **откройте** диалоговое окно или, если *bVistaStyle принимал* имеет значение FALSE. В нашем примере окончательный функция только возвращает значение NULL в режиме выпуска - в режиме отладки возникнет исключение утверждения.

Дополнительные сведения о `IFileOpenDialog` интерфейсом, см. в разделе [IFileOpenDialog](https://msdn.microsoft.com/library/windows/desktop/bb775834).

### <a name="example"></a>Пример

Этот пример извлекает внутренний COM-объекта. Чтобы выполнить этот код, необходимо скомпилировать его под Windows Vista или более поздней версии.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

Извлекает указатель на внутренний объект COM для данного `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на внутренний объект COM для `CFileDialog`. Отвечает соответствующим образом освободить этот указатель.

### <a name="remarks"></a>Примечания

Используйте эту функцию только в Windows Vista или более поздней версии с объектом, который имеет *bVistaStyle принимал* присвоено значение TRUE. Эта функция возвращает значение NULL, если `CFileDialog` не **Сохранить** диалоговое окно или, если *bVistaStyle принимал* имеет значение FALSE. В нашем примере окончательный функция только возвращает значение NULL в режиме выпуска - в режиме отладки возникнет исключение утверждения.

Дополнительные сведения о `IFileSaveDialog` интерфейсом, см. в разделе [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Пример

Этот пример извлекает внутренний COM-объекта. Чтобы запустить этот пример кода, необходимо скомпилировать его в Windows Vista или более поздней версии.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

Вызывайте эту функцию для получения имени следующего файла из группы, выбранной в диалоговом окне.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Параметры

*торговых терминалов*<br/>
Ссылку на значение ПОЗИЦИИ, возвращенное предыдущим `GetNextPathName` или `GetStartPosition` вызов функции. Значение NULL, если был достигнут конец списка.

### <a name="return-value"></a>Возвращаемое значение

Полный путь к файлу.

### <a name="remarks"></a>Примечания

Путь имя файла включает заголовок файла, а также весь каталог. Например `GetNextPathName` вернет «C:\FILES\TEXT. Средство доступа к данным» для файла C:\FILES\TEXT.DAT. Можно использовать `GetNextPathName` в цикле прямой итерации, если установить начальное положение, с помощью вызова `GetStartPosition`.

Если выделение содержит только один файл, будет возвращаться имя этого файла.

##  <a name="getofn"></a>  CFileDialog::GetOFN

Получает связанный `OPENFILENAME` структуры.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Возвращаемое значение

[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры.

### <a name="remarks"></a>Примечания

Использовать второй версии этой функции для инициализации вида **Открытие файла** или **сохранить файл как** диалоговом после его создания, но перед его отображением с `DoModal` функция-член. Например, можно задать `lpstrTitle` членом `m_ofn` заголовок чтобы диалоговое окно, чтобы иметь.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

Вызывайте эту функцию, чтобы получить полный путь к файлу, введенные в диалоговом окне.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Полный путь к файлу.

### <a name="remarks"></a>Примечания

Путь имя файла включает заголовок файла, а также весь каталог. Например `GetPathName` вернет «C:\FILES\TEXT. Средство доступа к данным» для файла C:\FILES\TEXT.DAT.

Если `m_ofn.Flags` OFN_ALLOWMULTISELECT флаг установлен, эта строка содержит последовательность из null teminated строк с первой строки, что путь к каталогу файловой группы выбран, следуют имена всех файлов, выбранных пользователем. По этой причине использовать [GetStartPosition](#getstartposition) и [GetNextPathName](#getnextpathname) функции-члены для получения следующего имени файла в списке.

### <a name="example"></a>Пример

  См. в примере [CFileDialog::DoModal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Вызывайте эту функцию, чтобы определить, была ли выбрана флажок только для чтения в Windows standard Открытие файла и сохраните файл как диалоговых окнах.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если установлен флажок только для чтения, в диалоговом окне; в противном случае 0.

### <a name="remarks"></a>Примечания

Можно скрыть флажок только для чтения, задав стиль OFN_HIDEREADONLY `CFileDialog` конструктор.

> [!NOTE]
> Windows Vista или более поздней версии стиля `CFileDialog` объектов не поддерживают эту функцию. Попытка использовать эту функцию на Windows Vista или более поздней версии стиля `CFileDialog` вызовет [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>  CFileDialog::GetResult

Извлекает выбор, внесенные пользователем в диалоговом окне.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на экземпляр интерфейса IShellItem, представляющий выбора пользователя.

### <a name="remarks"></a>Примечания

##  <a name="getresults"></a>  CFileDialog::GetResults

Извлекает решения пользователя в диалоговое окно Выбор нескольких элементов.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на IShellItemArray, через который осуществляется элементов, выбранных в диалоговом окне.

### <a name="remarks"></a>Примечания

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

Извлекает определенный элемент из указанного контейнера элемента управления в диалоговом окне.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления.

*dwIDItem*<br/>
Идентификатор элемента, выбранного пользователем в элементе управления.

### <a name="remarks"></a>Примечания

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

Вызовите эту функцию-член для получения позиции первого пути файла в списке, если `m_ofn.Flags` OFN_ALLOWMULTISELECT флаг.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение ПОЗИЦИИ, который может использоваться для итерации; Значение NULL, если список пуст.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Вызовите эту функцию-член для скрытия указанного элемента управления в стиле проводника открыть или сохранить как общее диалоговое окно.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор элемента управления, чтобы скрыть.

### <a name="remarks"></a>Примечания

Диалоговое окно должна быть создана с помощью стиля OFN_EXPLORER; в противном случае функция завершится с ошибкой с утверждение.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

Определяет, является ли текущее диалоговое окно в режиме выбора папки.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если диалоговое окно находится в режиме выбора папки; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn` — это структура типа `OPENFILENAME`. Данные в этой структуре представляет текущее состояние `CFileDialog`.

### <a name="remarks"></a>Примечания

Эта структура используется для инициализации вида **Открытие файла** или **сохранить файл как** диалоговом после его создания, но прежде чем использовать с [DoModal](#domodal) метод. Например, можно задать *lpstrTitle* членом `m_ofn` заголовок чтобы диалоговое окно, чтобы иметь.

С Windows Vista или более поздней версии стиль [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` всегда соответствовать состояние диалогового окна не гарантируется. Она синхронизируется с диалоговым окном, в более ранних версиях Windows. См. в разделе [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) и [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) Дополнительные сведения о синхронизации `m_ofn` структуры и `CFileDialog` состояния в Windows Vista или более поздней версии.

Windows Vista или более поздней версии для работы с файлами стиля не поддерживают определенные элементы и флаги `CFileDialog`. Таким образом это не повлияет.

Ниже приведен список элементов, которые не поддерживаются операционной системой Windows Vista или более поздней версии:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Следующие флаги не поддерживаются и поэтому не действовать при использовании Windows Vista или более поздней версии стиль `CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - эффективно всегда на Windows Vista или более поздней версии

- OFN_NOLONGNAMES - эффективно всегда отключен в Windows Vista или более поздней версии

- OFN_NONETWORKBUTTON - эффективно всегда на Windows Vista или более поздней версии

- OFN_READONLY

- OFN_SHOWHELP

Дополнительные сведения об этой структуре см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры в пакете Windows SDK.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

Окружение элемент управления в диалоговом окне таким образом, чтобы лучше выделялся по сравнению с другими элементами управления.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

Вызывается при нажатии кнопки.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор кнопки.

### <a name="remarks"></a>Примечания

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

Вызывается, когда флажок устанавливается или снимается.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля с флажком.

*bChecked*<br/>
Установлен или снят.

### <a name="remarks"></a>Примечания

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

Вызывается при активации элемента управления.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

Переопределите этот метод, если вы хотите обрабатывать сообщения WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Примечания

Система отправляет сообщение CDN_SELCHANGE, когда пользователь выбирает новый файл или папку в списке файлов **откройте** или **Сохранить как** диалоговое окно. Переопределите этот метод, если вы хотите выполнять какие-либо действия в ответ на это сообщение.

Система отправляет данное сообщение только в том случае, если диалоговое окно был создан с флагом OFN_EXPLORER включен. Дополнительные сведения об уведомлениях см. в разделе [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange). Сведения о флаге OFN_EXPLORER, см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры и [открыть диалоговых и сохранить как](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

Переопределите эту функцию только в том случае, если вы хотите предоставить пользовательскую проверку имен файлов, которые вводятся в общее диалоговое окно файла.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Возвращаемое значение

1, если имя файла не является допустимым именем файла; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция позволяет отклонять имя файла по любой причине конкретного приложения. Как правило вы не обязательно должны использовать эту функцию, так как платформа предоставляет стандартную проверку имен файлов и отображает окно сообщения, если введено недопустимое имя файла.

Если возвращается 1, диалоговое окно будет отображаться для пользователя ввести другое имя файла. В процедуру диалогового окна закрывает диалоговое окно, если возвращаемое значение 0. Другие ненулевое возвращают значения, сейчас зарезервированы и не должны использоваться.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

Переопределите эту функцию для обработки сообщения WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Примечания

Сообщение уведомления отправляется при открытии в диалоговом окне Открыть или сохранить как новую папку.

Уведомление будет отправлено только в том случае, если диалоговое окно содержит OFN_EXPLORER стиль. Дополнительные сведения об уведомлениях см. в разделе [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange). Сведения о стиле OFN_EXPLORER см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры и [открыть диалоговых и сохранить как](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

Переопределите эту функцию для обработки сообщения WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Примечания

Система отправляет это сообщение уведомления, когда система завершит упорядочение элементов управления в **откройте** или **Сохранить как** диалоговое окно, чтобы освободить место для элементов управления диалогового окна "дочерний".

Система отправляет это только в том случае, если диалоговое окно содержит OFN_EXPLORER стиль. Дополнительные сведения об уведомлениях см. в разделе [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone). Сведения о стиле OFN_EXPLORER см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры и [открыть диалоговых и сохранить как](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Windows Vista или более поздней версии для работы с файлами стиля не поддерживают эту функцию. Попытка использовать эту функцию на Windows Vista или более поздней версии диалоговое окно файла стиля вызовет [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

Вызывается при выборе элемента контейнера.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления.

*dwIDItem*<br/>
Идентификатор элемента.

### <a name="remarks"></a>Примечания

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

Эта функция вызывается всякий раз, когда текущее выделение в поле со списком будет изменена.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Параметры

*nIDBox*<br/>
Идентификатор списка или поля со списком, в которой произошло выделение.

*iCurSel*<br/>
Индекс текущего выделенного фрагмента.

*nCode*<br/>
Код уведомления элемента управления. Этот параметр должен иметь одно из следующих значений:

- Указывает CD_LBSELCHANGE *iCurSel* является выбранный элемент в поле со списком с поддержкой единственного выбора.

- Указывает, что CD_LBSELSUB *iCurSel* больше не выбран в поле со списком множественного выбора.

- Указывает, что CD_LBSELADD *iCurSel* выбран в поле со списком множественного выбора.

- CD_LBSELNOITEMS указывает, что существует не выбрано в поле со списком множественного выбора.

### <a name="remarks"></a>Примечания

Переопределите эту функцию для предоставления обычной обработки изменения выделения в окне списка. Например эту функцию можно использовать для отображения прав доступа или Дата последнего изменения каждого файла пользователем.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

Переопределите эту функцию, чтобы предоставить пользовательскую обработку нарушений общего ресурса.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Параметры

*lpszPathName*<br/>
Путь к файлу, в котором произошло нарушение общего ресурса.

### <a name="return-value"></a>Возвращаемое значение

Одно из следующих значений:

- Имя файла OFN_SHAREFALLTHROUGH возвращается из диалогового окна.

- Нет OFN_SHARENOWARN дальнейших действий необходимо принять меры.

- OFN_SHAREWARN пользователь получает стандартное сообщение предупреждения для этой ошибки.

### <a name="remarks"></a>Примечания

Как правило вы не обязательно должны использовать эту функцию, так как платформа предоставляет проверку нарушения общего ресурса по умолчанию и отображает окно сообщения при возникновении нарушения общего доступа.

Если вы хотите отключить проверку конфигурации общей папки, используйте побитовый оператор OR для объединения флаг OFN_SHAREAWARE с `m_ofn.Flags`.

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

Переопределите эту функцию для обработки сообщения WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Примечания

Сообщение уведомления отправляется в том случае, когда пользователь выбирает новый тип файлов в списке типов файлов с открытой лицензией или сохранить как диалоговое окно.

Уведомление будет отправлено только в том случае, если диалоговое окно содержит OFN_EXPLORER стиль. Дополнительные сведения об уведомлениях см. в разделе [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange). Сведения о стиле OFN_EXPLORER см. в разделе [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) структуры и [открыть диалоговых и сохранить как](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

Удаляет элемент из контейнерного элемента управления в диалоговом окне.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления для удаления элемента из.

*dwIDItem*<br/>
Идентификатор элемента.

### <a name="remarks"></a>Примечания

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

Задает текущее состояние кнопки check (флажок) в диалоговом окне.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля с флажком.

*bChecked*<br/>
Состояние флажка. Значение TRUE указывает, установлен; Значение FALSE указывает, флажок снят.

### <a name="remarks"></a>Примечания

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

Задает текущее состояние элемента в элементе управления контейнера, в диалоговом окне.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления.

*dwIDItem*<br/>
Идентификатор элемента.

*dwState*<br/>
Одно или несколько значений из перечисления CDCONTROLSTATE, которые указывают новое состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

Задает текст элемента управления. Например, текст, сопровождающий типа "переключатель" или элемента меню.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления.

*dwIDItem*<br/>
Идентификатор элемента.

*strLabel*<br/>
Текст для элемента.

### <a name="remarks"></a>Примечания

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

Задает текст, связанный с элементом управления, например текст кнопки или изменить метку поля.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор элемента управления.

*strLabel*<br/>
Имя элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

Задает текущую видимость и включенные состояния данного элемента управления.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор элемента управления.

*dwState*<br/>
Одно или несколько значений из перечисления CDCONTROLSTATE, на которые указывают текущее состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

Вызовите этот метод, чтобы задать текст для указанного элемента управления в стиле проводника **откройте** или **Сохранить как** диалоговое окно.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
[in] Идентификатор элемента управления, для которого требуется задать текст.

*lpsz*<br/>
[in] Указатель на строку, содержащую текст, задайте для элемента управления.

### <a name="remarks"></a>Примечания

Обе версии этой функции могут использоваться для приложений, использующих Юникод. Однако только версия с типом LPCSTR недопустим для приложений, использующих ANSI.

Чтобы использовать этот метод, необходимо создать диалоговое окно со стилем OFN_EXPLORER. В противном случае функция завершится с ошибкой с утверждение.

##  <a name="setdefext"></a>  CFileDialog::setdefext изменена

Вызывайте эту функцию, чтобы задать расширение имени файла по умолчанию для проводника открыть или сохранить как общее диалоговое окно.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Параметры

*lpsz*<br/>
Указатель на строку, содержащую расширение по умолчанию для использования объект диалогового окна. Это строка не должна содержать точку (.).

### <a name="remarks"></a>Примечания

Диалоговое окно должна быть создана с помощью стиля OFN_EXPLORER; в противном случае функция завершится с ошибкой с утверждение.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Задает текущий текст в поле ввода.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор поля ввода.

*strText*<br/>
Текстовое значение.

### <a name="remarks"></a>Примечания

##  <a name="setproperties"></a>  CFileDialog::SetProperties

Предоставляет хранилище свойств, которое определяет значения по умолчанию для сохраняемого элемента.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Параметры

*lpszPropList*<br/>
Список предварительно заданных свойств, разделенных точкой с запятой (";"). Список флагов см. в разделе **флаги** раздел [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna).

### <a name="remarks"></a>Примечания

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

Задает выбранное состояние какого-либо элемента в группе или поле со списком в диалоговом окне.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор контейнерного элемента управления.

*dwIDItem*<br/>
Идентификатор элемента, выбранного пользователем в элементе управления.

### <a name="remarks"></a>Примечания

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Задает шаблон диалогового окна для [CFileDialog](../../mfc/reference/cfiledialog-class.md) объекта.

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Параметры

*nWin3ID*<br/>
[in] Содержит идентификатор ресурса шаблона для не Explorer `CFileDialog` объекта. Этот шаблон используется, только на Windows NT 3.51 или если стиль OFN_EXPLORER не присутствует.

*nWin4ID*<br/>
[in] Содержит идентификатор ресурса шаблона для обозревателя `CFileDialog` объекта. Этот шаблон используется, только на Windows NT 4.0 и более поздних версий, Windows 95 и более поздних версий, или при наличии OFN_EXPLORER стиль.

*lpWin3ID*<br/>
[in] Содержит имя ресурса шаблона для не Explorer `CFileDialog` объекта. Этот шаблон используется, только на Windows NT 3.51 или если стиль OFN_EXPLORER не присутствует.

*lpWin4ID*<br/>
[in] Содержит имя ресурса шаблона обозревателя `CFileDialog` объекта. Этот шаблон используется, только на Windows NT 4.0 и более поздних версий, Windows 95 и более поздних версий, или при наличии OFN_EXPLORER стиль.

### <a name="remarks"></a>Примечания

Система будет использовать только один из заданных шаблонов. Система определяет, какой шаблон должен использоваться на основе наличия OFN_EXPLORER стиль и операционной системы, на котором приложение выполняется на. Указав шаблона в стиле проводника и не Explorer, можно легко поддержки Windows NT 3.51, Windows NT 4.0 и более поздних версий и Windows 95 и более поздних версий.

> [!NOTE]
> Windows Vista или более поздней версии стиля файловых диалоговых окон не поддерживают эту функцию. Попытка использовать эту функцию на Windows Vista или более поздней версии стиля ― диалоговое окно файла вызывает исключение [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Альтернативой является использование настраиваемое диалоговое окно. Дополнительные сведения об использовании пользовательского `CFileDialog`, см. в разделе [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

Объявляет группу visual в диалоговом окне. Последующие вызовы для любого метода «add» добавить эти элементы в эту группу.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*dwIDCtl*<br/>
Идентификатор группы visual.

*strLabel*<br/>
Имя группы.

### <a name="remarks"></a>Примечания

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

Обновления `m_ofn` структуру данных таблицы [CFileDialog](../../mfc/reference/cfiledialog-class.md) на основании текущего состояния внутреннего объекта.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Примечания

В версиях Windows до Windows Vista, член [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) структуру данных непрерывно был синхронизирован с состоянием `CFileDialog`. Любые изменения [m_ofn](#m_ofn) переменной-члена непосредственно влияет состояние диалогового окна. Кроме того любые изменения состояния диалогового окна немедленно обновить переменную-член m_ofn.

В Windows Vista или более поздней версии `m_ofn` структура данных не обновляется автоматически. Чтобы гарантировать точность данных в `m_ofn` переменную-член, следует вызывать `UpdateOFNFromShellDialog` функцию перед доступом к данным. Windows вызывает эту функцию автоматически во время обработки [IFileDialog::OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Дополнительные сведения об использовании `CFileDialog` класса под Windows Vista или более поздней версии, см. в разделе [класса CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Пример

В этом примере обновляется `CFileDialog` перед его отображением. Перед обновлением `m_ofn` переменная-член, нам нужно синхронизировать ее текущее состояние диалогового окна.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>См. также

[Класс CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)

