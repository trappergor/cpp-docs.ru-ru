---
title: Класс CToolBarCtrl
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: e62d1a6773e1b65eaa1d2f0a8050873c673b5039
ms.sourcegitcommit: 1839405b97036891b6e4d37c99def044d6f37eff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2020
ms.locfileid: "88561860"
---
# <a name="ctoolbarctrl-class"></a>Класс CToolBarCtrl

Предоставляет функциональные возможности стандартного элемента управления "панель инструментов" Windows.

## <a name="syntax"></a>Синтаксис

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[CToolBarCtrl:: CToolBarCtrl](#ctoolbarctrl)|Формирует объект `CToolBarCtrl`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CToolBarCtrl:: Аддбитмап](#addbitmap)|Добавляет одно или несколько изображений растровой кнопки в список изображений кнопок, доступных для элемента управления ToolBar.|
|[CToolBarCtrl:: Аддбуттонс](#addbuttons)|Добавляет одну или несколько кнопок к элементу управления ToolBar.|
|[CToolBarCtrl:: AddString](#addstring)|Добавляет новую строку, переданную в качестве идентификатора ресурса, в внутренний список строк панели инструментов.|
|[CToolBarCtrl:: Аддстрингс](#addstrings)|Добавляет новую строку или строки, передаваемые в качестве указателя на буфер строк с разделителями null, во внутренний список строк панели инструментов.|
|[CToolBarCtrl:: AutoSize](#autosize)|Изменяет размер элемента управления ToolBar.|
|[CToolBarCtrl:: Чанжебитмап](#changebitmap)|Изменяет точечный рисунок для кнопки в текущем элементе управления ToolBar.|
|[CToolBarCtrl:: Чеккбуттон](#checkbutton)|Проверяет или снимает заданную кнопку в элементе управления ToolBar.|
|[CToolBarCtrl:: Коммандтоиндекс](#commandtoindex)|Возвращает отсчитываемый от нуля индекс для кнопки, связанной с указанным идентификатором команды.|
|[CToolBarCtrl:: Create](#create)|Создает элемент управления Toolbar и прикрепляет его к `CToolBarCtrl` объекту.|
|[CToolBarCtrl:: Креатикс](#createex)|Создает элемент управления ToolBar с указанными расширенными стилями Windows и прикрепляет его к `CToolBarCtrl` объекту.|
|[CToolBarCtrl:: Настройка](#customize)|Отображает диалоговое окно Настройка панели инструментов.|
|[CToolBarCtrl::D Елетебуттон](#deletebutton)|Удаляет кнопку из элемента управления ToolBar.|
|[CToolBarCtrl:: Енаблебуттон](#enablebutton)|Включает или отключает указанную кнопку в элементе управления ToolBar.|
|[CToolBarCtrl:: Жетанчорхигхлигхт](#getanchorhighlight)|Получает параметр выделения закреплений для панели инструментов.|
|[CToolBarCtrl::/Bitmap](#getbitmap)|Извлекает индекс растрового изображения, связанного с кнопкой на панели инструментов.|
|[CToolBarCtrl:: Жетбитмапфлагс](#getbitmapflags)|Получает флаги, связанные с точечным рисунком панели инструментов.|
|[CToolBarCtrl:: "Кнопка"](#getbutton)|Извлекает сведения об указанной кнопке в элементе управления ToolBar.|
|[CToolBarCtrl:: Жетбуттонкаунт](#getbuttoncount)|Извлекает число кнопок, находящихся в данный момент в элементе управления ToolBar.|
|[CToolBarCtrl:: Жетбуттонинфо](#getbuttoninfo)|Извлекает сведения для кнопки на панели инструментов.|
|[CToolBarCtrl:: Жетбуттонсизе](#getbuttonsize)|Извлекает текущую ширину и высоту кнопок панели инструментов в пикселях.|
|[CToolBarCtrl:: Жетколорсчеме](#getcolorscheme)|Извлекает цветовую схему текущего элемента управления ToolBar.|
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|Извлекает список изображений, используемый элементом управления Toolbar для вывода отключенных кнопок.|
|[CToolBarCtrl:: Жетдроптаржет](#getdroptarget)|Извлекает интерфейс [интерфейс IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) для элемента управления ToolBar.|
|[CToolBarCtrl:: Жетекстендедстиле](#getextendedstyle)|Извлекает расширенные стили для элемента управления ToolBar.|
|[CToolBarCtrl:: Жесотимажелист](#gethotimagelist)|Извлекает список изображений, который используется элементом управления Toolbar для вывода "горячих" кнопок. Кнопка «горячее» отображается, если указатель мыши находится над ним.|
|[CToolBarCtrl:: Жесотитем](#gethotitem)|Получает индекс горячего элемента на панели инструментов.|
|[CToolBarCtrl::/ImageList](#getimagelist)|Извлекает список изображений, используемый элементом управления Toolbar для отображения кнопок в состоянии по умолчанию.|
|[CToolBarCtrl:: Жетинсертмарк](#getinsertmark)|Извлекает текущую метку вставки для панели инструментов.|
|[CToolBarCtrl:: Жетинсертмаркколор](#getinsertmarkcolor)|Получает цвет, используемый для рисования метки вставки панели инструментов.|
|[CToolBarCtrl:: Жетитемрект](#getitemrect)|Извлекает ограничивающий прямоугольник кнопки в элементе управления ToolBar.|
|[CToolBarCtrl:: Жетмакссизе](#getmaxsize)|Возвращает общий размер всех видимых кнопок и разделителей на панели инструментов.|
|[CToolBarCtrl:: Жетмакстекстровс](#getmaxtextrows)|Возвращает максимальное число строк текста, отображаемых на кнопке панели инструментов.|
|[CToolBarCtrl:: не метрики](#getmetrics)|Извлекает метрики элемента управления ToolBar.|
|[CToolBarCtrl:: Padding](#getpadding)|Извлекает горизонтальное и вертикальное заполнение текущего элемента управления ToolBar.|
|[CToolBarCtrl:: Жетпресседимажелист](#getpressedimagelist)|Извлекает список изображений, используемый текущим элементом управления Toolbar для представления кнопок в нажатом состоянии.|
|[CToolBarCtrl:: коrect](#getrect)|Извлекает ограничивающий прямоугольник для указанной кнопки панели инструментов.|
|[CToolBarCtrl:: GetRows](#getrows)|Извлекает количество строк кнопок, отображаемых на панели инструментов.|
|[CToolBarCtrl:: State](#getstate)|Извлекает сведения о состоянии указанной кнопки в элементе управления ToolBar, например о том, включен ли он, нажат или установлен.|
|[CToolBarCtrl:: GetString](#getstring)|Извлекает строку панели инструментов.|
|[CToolBarCtrl:: штриховка](#getstyle)|Извлекает стили, используемые в данный момент для элемента управления ToolBar.|
|[CToolBarCtrl:: подсказки](#gettooltips)|Получает маркер элемента управления "Подсказка", если он имеется, связанный с элементом управления ToolBar.|
|[CToolBarCtrl:: Хидебуттон](#hidebutton)|Скрывает или отображает указанную кнопку в элементе управления ToolBar.|
|[CToolBarCtrl:: HitTest](#hittest)|Определяет, где находится точка в элементе управления ToolBar.|
|[CToolBarCtrl:: неопределенное](#indeterminate)|Задает или очищает неопределенное (серое) состояние указанной кнопки в элементе управления ToolBar.|
|[CToolBarCtrl:: Инсертбуттон](#insertbutton)|Вставляет кнопку в элемент управления ToolBar.|
|[CToolBarCtrl:: Инсертмаркхиттест](#insertmarkhittest)|Извлекает данные метки вставки для точки на панели инструментов.|
|[CToolBarCtrl:: Исбуттончеккед](#isbuttonchecked)|Сообщает, выбрана ли указанная кнопка в элементе управления ToolBar.|
|[CToolBarCtrl:: Исбуттоненаблед](#isbuttonenabled)|Сообщает, включена ли указанная кнопка в элементе управления ToolBar.|
|[CToolBarCtrl:: Исбуттонхидден](#isbuttonhidden)|Сообщает, скрыта ли указанная кнопка в элементе управления ToolBar.|
|[CToolBarCtrl:: Исбуттонхигхлигхтед](#isbuttonhighlighted)|Проверяет состояние выделения кнопки панели инструментов.|
|[CToolBarCtrl:: Исбуттониндетерминате](#isbuttonindeterminate)|Сообщает, является ли состояние указанной кнопки в элементе управления ToolBar неопределенным (серым).|
|[CToolBarCtrl:: Исбуттонпрессед](#isbuttonpressed)|Сообщает, нажата ли указанная кнопка в элементе управления ToolBar.|
|[CToolBarCtrl:: Лоадимажес](#loadimages)|Загружает растровые изображения в список изображений элемента управления ToolBar.|
|[CToolBarCtrl:: Мапакцелератор](#mapaccelerator)|Сопоставляет символ ускорителя с кнопкой панели инструментов.|
|[CToolBarCtrl:: Маркбуттон](#markbutton)|Задает состояние выделения для данной кнопки в элементе управления ToolBar.|
|[CToolBarCtrl:: Мовебуттон](#movebutton)|Перемещает кнопку из одного индекса в другой.|
|[CToolBarCtrl::P Рессбуттон](#pressbutton)|Нажимает или освобождает указанную кнопку в элементе управления ToolBar.|
|[CToolBarCtrl:: Реплацебитмап](#replacebitmap)|Заменяет существующий точечный рисунок в текущем элементе управления ToolBar новым растровым изображением.|
|[CToolBarCtrl:: RestoreState](#restorestate)|Восстанавливает состояние элемента управления ToolBar.|
|[CToolBarCtrl:: SaveState](#savestate)|Сохраняет состояние элемента управления ToolBar.|
|[CToolBarCtrl:: Сетанчорхигхлигхт](#setanchorhighlight)|Задает параметр выделения закреплений для панели инструментов.|
|[CToolBarCtrl:: Сетбитмапсизе](#setbitmapsize)|Задает размер растровых изображений, добавляемых к элементу управления ToolBar.|
|[CToolBarCtrl:: Сетбуттонинфо](#setbuttoninfo)|Задает сведения для существующей кнопки на панели инструментов.|
|[CToolBarCtrl:: Сетбуттонсизе](#setbuttonsize)|Задает размер кнопок, добавляемых к элементу управления ToolBar.|
|[CToolBarCtrl:: Сетбуттонструктсизе](#setbuttonstructsize)|Задает размер `TBBUTTON` структуры.|
|[CToolBarCtrl:: Сетбуттонвидс](#setbuttonwidth)|Задает минимальную и максимальную ширину кнопок в элементе управления ToolBar.|
|[CToolBarCtrl:: Сеткмдид](#setcmdid)|Задает идентификатор команды для отправки окну-владельцу при нажатии указанной кнопки.|
|[CToolBarCtrl:: Сетколорсчеме](#setcolorscheme)|Задает цветовую схему для текущего элемента управления ToolBar.|
|[CToolBarCtrl:: Сетдисабледимажелист](#setdisabledimagelist)|Задает список изображений, который будет использоваться элементом управления Toolbar для вывода отключенных кнопок.|
|[CToolBarCtrl:: Сетдравтекстфлагс](#setdrawtextflags)|Устанавливает флаги в функции Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), которая используется для рисования текста в указанном прямоугольнике, в соответствии с установленными флагами.|
|[CToolBarCtrl:: Сетекстендедстиле](#setextendedstyle)|Задает расширенные стили для элемента управления ToolBar.|
|[CToolBarCtrl:: Сесотимажелист](#sethotimagelist)|Задает список изображений, который будет использоваться элементом управления Toolbar для вывода "горячих" кнопок.|
|[CToolBarCtrl:: Сесотитем](#sethotitem)|Задает горячий элемент на панели инструментов.|
|[CToolBarCtrl:: Сетимажелист](#setimagelist)|Задает список изображений, который будет использоваться панелью инструментов для отображения кнопок, которые находятся в состоянии по умолчанию.|
|[CToolBarCtrl:: Сетиндент](#setindent)|Задает отступ для первой кнопки в элементе управления ToolBar.|
|[CToolBarCtrl:: Сетинсертмарк](#setinsertmark)|Задает текущую метку вставки для панели инструментов.|
|[CToolBarCtrl:: Сетинсертмаркколор](#setinsertmarkcolor)|Задает цвет, используемый для отображения метки вставки для панели инструментов.|
|[CToolBarCtrl:: Сетмакстекстровс](#setmaxtextrows)|Задает максимальное число строк текста, отображаемых на кнопке панели инструментов.|
|[CToolBarCtrl:: Сетметрикс](#setmetrics)|Задает метрики элемента управления ToolBar.|
|[CToolBarCtrl:: Сетовнер](#setowner)|Задает для окна возможность получения сообщений уведомления из элемента управления ToolBar.|
|[CToolBarCtrl:: Сетпаддинг](#setpadding)|Задает горизонтальное и вертикальное заполнение текущего элемента управления ToolBar.|
|[CToolBarCtrl:: Сетпресседимажелист](#setpressedimagelist)|Задает список изображений, используемый текущим элементом управления Toolbar для представления кнопок в нажатом состоянии.|
|[CToolBarCtrl:: Сетровс](#setrows)|Задает количество строк кнопок, отображаемых на панели инструментов.|
|[CToolBarCtrl:: SetState](#setstate)|Задает состояние указанной кнопки в элементе управления ToolBar.|
|[CToolBarCtrl:: SetStyle](#setstyle)|Задает стили для элемента управления ToolBar.|
|[CToolBarCtrl:: Сеттултипс](#settooltips)|Связывает элемент управления «подсказка» с элементом управления ToolBar.|
|[CToolBarCtrl:: SetWindowTheme](#setwindowtheme)|Задает визуальный стиль элемента управления ToolBar.|

## <a name="remarks"></a>Remarks

Этот элемент управления (и, следовательно, `CToolBarCtrl` класс) доступен только для программ, работающих под управлением windows 95/98 и Windows NT версии 3,51 и более поздних версий.

Обычный элемент управления панели инструментов Windows — это прямоугольное дочернее окно, содержащее одну или несколько кнопок. Эти кнопки могут отображать растровое изображение, строку или и то, и другое. Когда пользователь нажимает кнопку, он отправляет командное сообщение окну владельца панели инструментов. Как правило, кнопки на панели инструментов соответствуют элементам меню приложения; они предоставляют пользователям более прямой способ доступа к командам приложения.

`CToolBarCtrl` объекты содержат несколько важных внутренних структур данных: список растровых изображений кнопок или список изображений, список строк меток для кнопок и список `TBBUTTON` структур, связывающих изображение и/или строку с положением, стилем, состоянием и идентификатором команды для кнопки. На каждый элемент этих структур данных ссылается индекс, начинающийся с нуля. Прежде чем можно будет использовать `CToolBarCtrl` объект, необходимо настроить эти структуры данных. Список строк можно использовать только для меток кнопок; нельзя получить строки с панели инструментов.

Для использования `CToolBarCtrl` объекта, как правило, выполняются следующие действия.

1. Создайте `CToolBarCtrl` объект.

1. Вызовите [CREATE](#create) , чтобы создать общий элемент управления панели инструментов Windows и присоединить его к `CToolBarCtrl` объекту. Укажите стиль панели инструментов с помощью стилей, например TBSTYLE_TRANSPARENT для прозрачной панели инструментов или TBSTYLE_DROPDOWN для панели инструментов, которая поддерживает кнопки с раскрывающимся списком.

1. Определение того, как должны отображаться кнопки на панели инструментов:

   - Чтобы использовать растровые изображения для кнопок, добавьте на панель инструментов точечные рисунки кнопки, вызвав [аддбитмап](#addbitmap).

   - Чтобы использовать изображения, отображаемые в списке изображений для кнопок, укажите список изображений, вызвав [сетимажелист](#setimagelist), [сесотимажелист](#sethotimagelist)или [сетдисабледимажелист](#setdisabledimagelist).

   - Чтобы использовать строковые метки для кнопок, добавьте строки на панель инструментов, вызвав [AddString](#addstring) и (или) [аддстрингс](#addstrings).

1. Добавьте структуры кнопок на панель инструментов, вызвав [аддбуттонс](#addbuttons).

1. Если вам нужны подсказки для кнопки на панели инструментов в окне владельца, которое не является `CFrameWnd` , необходимо обработать TTN_NEEDTEXT сообщения в окне владелец панели инструментов, как описано в разделе [Обработка всплывающих уведомлений](../../mfc/handling-tool-tip-notifications.md). Если родительское окно панели инструментов является производным от `CFrameWnd` , всплывающие подсказки отображаются без каких-либо дополнительных усилий, так как `CFrameWnd` предоставляет обработчик по умолчанию.

1. Если вы хотите, чтобы пользователь мог настраивать панель инструментов, обрабатывайте сообщения уведомления о настройке в окне "владелец", как описано в разделе [обработка уведомлений о настройке](../../mfc/handling-customization-notifications.md).

Параметр [SaveState](#savestate) можно использовать для сохранения текущего состояния элемента управления Toolbar в реестре и [RestoreState](#restorestate) для восстановления состояния на основе сведений, сохраненных ранее в реестре. Помимо сохранения состояния панели инструментов между применениями приложения, приложения обычно сохраняют состояние, прежде чем пользователь начнет настраивать панель инструментов в случае, если пользователь позже захочет восстановить исходное состояние панели инструментов.

## <a name="support-for-internet-explorer-version-40-and-later"></a>Поддержка Internet Explorer версии 4,0 и более поздних версий

Для поддержки функций, появившихся в Internet Explorer версии 4,0 и более поздних, MFC предоставляет поддержку списка изображений, а также прозрачные и плоские стили для элементов управления ToolBar.

Прозрачная панель инструментов позволяет отображать на панели инструментов клиент с помощью. Чтобы создать прозрачную панель инструментов, используйте стили TBSTYLE_FLAT и TBSTYLE_TRANSPARENT. Прозрачные панели инструментов Отслеживание горячей замены; Это значит, что при наведении указателя мыши на кнопку на панели инструментов внешний вид кнопки изменяется. Панели инструментов, созданные только TBSTYLE_FLAT стиле, будут содержать непрозрачные кнопки.

Поддержка списков изображений позволяет управлять поведением по умолчанию, горячими образами и отключенными образами. Используйте [кнопки](#getimagelist) [жесотимажелист](#gethotimagelist)и [жетдисабледимажелист](#getdisabledimagelist) с прозрачной панелью инструментов для работы с изображением в соответствии с его состоянием:

Дополнительные сведения об использовании см `CToolBarCtrl` . в разделе [элементы управления](../../mfc/controls-mfc.md) и [Использование CToolBarCtrl](../../mfc/using-ctoolbarctrl.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>Требования

**Заголовок:** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a> CToolBarCtrl:: Аддбитмап

Добавляет одно или несколько изображений кнопок в список изображений кнопок, хранящихся в элементе управления ToolBar.

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>Параметры

*ннумбуттонс*<br/>
Число изображений кнопок в точечном рисунке.

*нбитмапид*<br/>
Идентификатор ресурса точечного рисунка, содержащего изображение кнопки или изображения для добавления.

*пбитмап*<br/>
Указатель на `CBitmap` объект, содержащий изображение кнопки или изображения для добавления.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс первого нового образа в случае успеха; в противном случае — 1.

### <a name="remarks"></a>Remarks

Вы можете использовать Windows API [креатемаппедбитмап](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap) для отображения цветов перед добавлением точечного рисунка на панель инструментов. При передаче указателя на `CBitMap` объект необходимо убедиться, что растровое изображение не уничтожается до тех пор, пока не будет удалена панель инструментов.

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a> CToolBarCtrl:: Аддбуттонс

Добавляет одну или несколько кнопок к элементу управления ToolBar.

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>Параметры

*ннумбуттонс*<br/>
Число добавляемых кнопок.

*лпбуттонс*<br/>
Адрес массива `TBBUTTON` структур, содержащий сведения о добавляемых кнопках. Число элементов в массиве должно совпадать с кнопками, заданными параметром *ннумбуттонс*.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Указатель *лпбуттонс* указывает на массив `TBBUTTON` структур. Каждая `TBBUTTON` Структура связывает добавленную кнопку со стилем кнопки, изображением и/или строкой, идентификатором команды, состоянием и определяемыми пользователем данными:

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

Ниже приведены элементы.

- `iBitmap`

   Отсчитываемый от нуля индекс изображения кнопки,-1, если для этой кнопки нет изображения.

- `idCommand`

   Идентификатор команды, связанный с кнопкой. Этот идентификатор отправляется в сообщении WM_COMMAND при выборе кнопки. Если `fsStyle` элемент имеет значение TBSTYLE_SEP, этот элемент должен быть равен нулю.

- `fsState`

   Флаги состояния кнопки. Это может быть комбинация значений, перечисленных ниже.

  - TBSTATE_CHECKED кнопка имеет стиль TBSTYLE_CHECKED и нажата.

  - TBSTATE_ENABLED кнопка принимает вводимые пользователем данные. Кнопка, не имеющая этого состояния, не принимает ввод пользователя и является серым.

  - TBSTATE_HIDDEN кнопка не отображается и не может принимать данные, вводимые пользователем.

  - TBSTATE_INDETERMINATE кнопка неактивна.

  - TBSTATE_PRESSED нажатии кнопки.

  - TBSTATE_WRAP разрыв строки после кнопки. Кнопка также должна иметь состояние TBSTATE_ENABLED.

- `fsStyle`

   Стиль кнопки. Это может быть комбинация значений, перечисленных ниже.

  - TBSTYLE_BUTTON создает стандартную кнопку отправки.

  - TBSTYLE_CHECK создает кнопку, переключающую нажатое и ненажатое состояние каждый раз, когда пользователь щелкает его. Кнопка имеет другой цвет фона, если он находится в нажатом состоянии.

  - TBSTYLE_CHECKGROUP создает кнопку проверки, которая остается нажатой, пока не будет нажата другая кнопка в группе.

  - TBSTYLE_GROUP создает кнопку, которая остается нажатой, пока не будет нажата другая кнопка в группе.

  - TBSTYLE_SEP создает разделитель, предоставляя небольшой зазор между группами кнопок. Кнопка с таким стилем не получает входные данные пользователя.

- `dwData`

   Определяемые пользователем данные.

- `iString`

   Отсчитываемый от нуля индекс строки, используемой в качестве метки кнопки,-1, если для этой кнопки нет строки.

Изображение и (или) строка, чей индекс должен быть ранее добавлен в список элементов управления ToolBar с помощью [аддбитмап](#addbitmap), [AddString](#addstring)и (или) [аддстрингс](#addstrings).

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a> CToolBarCtrl:: AddString

Добавляет новую строку, переданную в качестве идентификатора ресурса, в внутренний список строк панели инструментов.

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>Параметры

*нстрингид*<br/>
Идентификатор ресурса строкового ресурса для добавления в список строк элемента управления ToolBar.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс первой новой строки, добавленной в случае успеха; в противном случае — 1.

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a> CToolBarCtrl:: Аддстрингс

Добавляет новую строку или строки в список строк, доступных для элемента управления ToolBar.

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>Параметры

*лпсзстрингс*<br/>
Адрес буфера, который содержит одну или несколько строк, заканчивающихся нулем, для добавления в список строк панели инструментов. Последняя строка должна завершаться двумя символами NULL.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс первой новой строки, добавленной в случае успеха; в противном случае — 1.

### <a name="remarks"></a>Remarks

Строки в буфере должны быть разделены символом NULL. Необходимо убедиться, что последняя строка имеет два конца null. Чтобы правильно отформатировать постоянную строку, вы можете написать ее следующим образом:

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

или:

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

Не следует передавать `CString` объект в эту функцию, поскольку невозможно иметь более одного символа NULL в `CString` .

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a> CToolBarCtrl:: AutoSize

Изменяет размеры всего элемента управления ToolBar.

```cpp
void AutoSize();
```

### <a name="remarks"></a>Remarks

Эту функцию следует вызывать при изменении размера родительского окна или при изменении размера панели инструментов (например, при задании размера кнопки или растрового изображения или добавлении строк).

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a> CToolBarCtrl:: Чанжебитмап

Изменяет точечный рисунок для кнопки в текущем элементе управления ToolBar.

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>Параметры

*идбуттон*\
окне Идентификатор команды для получения нового точечного рисунка.

*ибитмап*\
окне Отсчитываемый от нуля индекс изображения в списке изображений текущего элемента управления ToolBar.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Если этот метод выполнен успешно, система отображает указанное изображение в указанной кнопке.

Этот метод отправляет [TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap) сообщение, описанное в Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода показано, как изменить точечный рисунок для кнопки " **сохранить файл** " на точечный рисунок кнопки " **о программе** ".

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a> CToolBarCtrl:: Чеккбуттон

Проверяет или снимает заданную кнопку в элементе управления ToolBar.

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для проверки или очистки.

*бчекк*<br/>
Значение TRUE для проверки кнопки; значение FALSE, чтобы очистить ее.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Если кнопка была отмечена, она кажется нажатой. Если вы хотите изменить более одного состояния кнопки, попробуйте вызвать [SetState](#setstate) .

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a> CToolBarCtrl:: Коммандтоиндекс

Возвращает отсчитываемый от нуля индекс для кнопки, связанной с указанным идентификатором команды.

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды, индекс кнопки которого требуется найти.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс для кнопки, связанной с ИДЕНТИФИКАТОРом команды.

### <a name="remarks"></a>Remarks

## <a name="ctoolbarctrlcreate"></a><a name="create"></a> CToolBarCtrl:: Create

Создает элемент управления Toolbar и прикрепляет его к `CToolBarCtrl` объекту.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*двстиле*<br/>
Задает стиль элемента управления ToolBar. Панели инструментов всегда должны иметь стиль WS_CHILD. Кроме того, можно указать любое сочетание стилей и стиля окон на панели инструментов, как описано в разделе **Примечания**.

*rect*<br/>
При необходимости задает размер и расположение элемента управления ToolBar. Это может быть либо объект [крект](../../atl-mfc-shared/reference/crect-class.md) , либо структура [Rect](/windows/win32/api/windef/ns-windef-rect) .

*ппарентвнд*<br/>
Задает родительское окно элемента управления ToolBar. Оно не должно иметь значение NULL.

*nID*<br/>
Задает идентификатор элемента управления ToolBar.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Построение создается `CToolBarCtrl` в два этапа. Сначала вызовите конструктор, а затем вызовите метод `Create` , который создает элемент управления Toolbar и прикрепляет его к `CToolBarCtrl` объекту. Применить следующие стили окна к элементу управления ToolBar.

- WS_CHILD всегда

- WS_VISIBLE обычно

- WS_DISABLED редко

Описание стилей окна см. в разделе [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) в Windows SDK.

При необходимости примените сочетание [общих стилей элементов управления](/windows/win32/Controls/common-control-styles), как описано в Windows SDK.

Применить сочетание стилей панели инструментов к элементу управления или к самим кнопкам. Стили описаны на [панели инструментов раздела и в разделе стили кнопок](/windows/win32/Controls/toolbar-control-and-button-styles) в Windows SDK.

Чтобы использовать расширенные стили панели инструментов, вызовите метод [сетекстендедстиле](#setextendedstyle) после вызова метода `Create` . Чтобы создать панель инструментов с расширенными стилями окна, вызовите метод [CToolBarCtrl:: креатикс](#createex) вместо `Create` .

Элемент управления ToolBar автоматически задает размер и расположение окна панели инструментов. Высота основана на высоте кнопок на панели инструментов. Ширина совпадает с шириной клиентской области родительского окна. Стили CCS_TOP и CCS_BOTTOM определяют, располагается ли панель инструментов вдоль верхней или нижней части клиентской области. По умолчанию панель инструментов имеет стиль CCS_TOP.

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a> CToolBarCtrl:: Креатикс

Создает элемент управления (дочернее окно) и связывает его с `CToolBarCtrl` объектом.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*двексстиле*<br/>
Задает расширенный стиль создаваемого элемента управления. Список расширенных стилей Windows см. в разделе параметр *двексстиле* для [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) в Windows SDK.

*двстиле*<br/>
Задает стиль элемента управления ToolBar. Панели инструментов всегда должны иметь стиль WS_CHILD. Кроме того, можно указать любое сочетание стилей и стиля окон на панели инструментов, как описано в разделе « **Примечания** » раздела [CREATE](#create).

*rect*<br/>
Ссылка на структуру [Rect](/windows/win32/api/windef/ns-windef-rect) , описывающую размер и расположение создаваемого окна в клиентских координатах *ппарентвнд*.

*ппарентвнд*<br/>
Указатель на окно, которое является родительским элементом управления.

*nID*<br/>
Идентификатор дочернего окна элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Используйте `CreateEx` вместо [CREATE](#create) , чтобы применить расширенные стили Windows, заданные **WS_EX_** в расширенном стиле Windows. `CreateEx` создает элемент управления с расширенными стилями Windows, заданным параметром *двексстиле*. Установка расширенных стилей, относящихся к элементу управления с помощью [сетекстендедстиле](#setextendedstyle). Например, используйте `CreateEx` для установки таких стилей, как WS_EX_CONTEXTHELP, но используйте `SetExtendedStyle` для установки таких стилей, как TBSTYLE_EX_DRAWDDARROWS. Дополнительные сведения см. в статье стили, описанные в разделе [Расширенные стили панели инструментов](/windows/win32/Controls/toolbar-extended-styles) в Windows SDK.

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a> CToolBarCtrl:: CToolBarCtrl

Формирует объект `CToolBarCtrl`.

```
CToolBarCtrl();
```

### <a name="remarks"></a>Remarks

Чтобы сделать панель инструментов доступной, необходимо вызвать метод [CREATE](#create) .

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a> CToolBarCtrl:: Настройка

Отображает диалоговое окно Настройка панели инструментов.

```cpp
void Customize();
```

### <a name="remarks"></a>Remarks

Это диалоговое окно позволяет пользователю настроить панель инструментов, добавляя и удаляя кнопки. Для поддержки настройки родительское окно панели инструментов должно обрабатывать сообщения уведомления о настройке, как описано в разделе [обработка уведомлений о настройке](../../mfc/handling-customization-notifications.md). Панель инструментов также должна быть создана с использованием стиля CCS_ADJUSTABLE, как описано в разделе [CToolBarCtrl:: Create](#create).

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a> CToolBarCtrl::D Елетебуттон

Удаляет кнопку из элемента управления ToolBar.

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс удаляемой кнопки.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a> CToolBarCtrl:: Енаблебуттон

Включает или отключает указанную кнопку в элементе управления ToolBar.

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для включения или отключения.

*bEnable*<br/>
Значение TRUE, чтобы включить кнопку; Значение FALSE, чтобы отключить кнопку.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Если кнопка включена, ее можно нажать и проверить. Если вы хотите изменить более одного состояния кнопки, попробуйте вызвать [SetState](#setstate) .

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a> CToolBarCtrl:: Жетанчорхигхлигхт

Получает параметр выделения закреплений для панели инструментов.

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>Возвращаемое значение

Если ненулевое значение, выделение закреплений включено. Если значение равно нулю, выделение закреплений отключено.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight), как описано в Windows SDK.

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a> CToolBarCtrl::/Bitmap

Извлекает индекс растрового изображения, связанного с кнопкой на панели инструментов.

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для кнопки, индекс которой необходимо получить.

### <a name="return-value"></a>Возвращаемое значение

Возвращает индекс битовой карты в случае успеха или ноль в противном случае.

### <a name="remarks"></a>Remarks

Реализует функциональные возможности [TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap) в Windows SDK.

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a> CToolBarCtrl:: Жетбитмапфлагс

Получает растровые флаги из панели инструментов.

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа UINT с установленным флагом TBBF_LARGE, если отображение может поддерживать большие точечные рисунки панели инструментов. в противном случае снимите флажок.

### <a name="remarks"></a>Remarks

Его следует вызывать после создания панели инструментов, но перед добавлением точечных рисунков на панель инструментов. Возвращаемое значение указывает, поддерживает ли дисплей крупные точечные рисунки. Если дисплей поддерживает крупные точечные рисунки и вы решили использовать их, вызовите [сетбитмапсизе](#setbitmapsize) и [сетбуттонсизе](#setbuttonsize) , прежде чем добавлять большой точечный рисунок с помощью [аддбитмап](#addbitmap).

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a> CToolBarCtrl:: "Кнопка"

Извлекает сведения об указанной кнопке в элементе управления ToolBar.

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс кнопки, для которой требуется получить сведения.

*лпбуттон*<br/>
Адрес `TBBUTTON` структуры, получающей копию сведений о кнопке. Сведения о структуре см. в разделе [CToolBarCtrl:: аддбуттонс](#addbuttons) `TBBUTTON` .

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a> CToolBarCtrl:: Жетбуттонкаунт

Извлекает число кнопок, находящихся в данный момент в элементе управления ToolBar.

```
int GetButtonCount() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число кнопок.

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a> CToolBarCtrl:: Жетбуттонинфо

Извлекает сведения для кнопки на панели инструментов.

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*птбби*<br/>
Указатель на структуру [тббуттонинфо](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) , которая получает сведения о кнопке.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс кнопки (в случае успеха). в противном случае — 1.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo), как описано в Windows SDK.

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a> CToolBarCtrl:: Жетбуттонсизе

Возвращает размер кнопки на панели инструментов.

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, которое содержит значения ширины и высоты в ЛОВОРД и HIWORD соответственно.

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a> CToolBarCtrl:: Жетбуттонтекст

Получает отображаемый текст указанной кнопки на текущем элементе управления ToolBar.

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>Параметры

*идбуттон*\
окне Идентификатор для кнопки, отображаемый текст которой извлекается.

### <a name="return-value"></a>Возвращаемое значение

Значение [CString](../../atl-mfc-shared/using-cstring.md) , содержащее отображаемый текст указанной кнопки.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext) сообщение, описанное в Windows SDK.

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a> CToolBarCtrl:: Жетколорсчеме

Извлекает цветовую схему текущего элемента управления ToolBar.

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>Параметры

*лпколорсчеме*\
заполняет Указатель на структуру [колорсчеме](/windows/win32/api/commctrl/ns-commctrl-colorscheme) , которая получает сведения о цветовой схеме. При возврате из этого метода структура описывает цвет выделения и цвет тени элемента управления ToolBar.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme) сообщение, описанное в Windows SDK.

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a> CToolBarCtrl:: Жетдисабледимажелист

Извлекает список изображений, используемый элементом управления Toolbar для вывода отключенных кнопок.

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CImageList](../../mfc/reference/cimagelist-class.md) или значение null, если отключенный список изображений не задан.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist), как описано в Windows SDK. Реализация MFC `GetDisabledImageList` использует `CImageList` объект, содержащий изображения кнопки элемента управления ToolBar, а не маркер списка изображений.

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a> CToolBarCtrl:: Жетдроптаржет

Извлекает интерфейс [интерфейс IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) для элемента управления ToolBar.

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>Параметры

*ппдроптаржет*<br/>
Указатель на указатель интерфейса [интерфейс IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) . При возникновении ошибки в этот адрес помещается пустой указатель.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение HRESULT, указывающее на успешное выполнение или сбой операции.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETOBJECT](/windows/win32/Controls/tb-getobject), как описано в Windows SDK.

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a> CToolBarCtrl:: Жетекстендедстиле

Извлекает расширенные стили для элемента управления ToolBar.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, представляющее расширенные стили, используемые в данный момент для элемента управления ToolBar. Список стилей см. в разделе [Расширенные стили панели инструментов](/windows/win32/Controls/toolbar-extended-styles)в Windows SDK.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle), как описано в Windows SDK.

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a> CToolBarCtrl:: Жесотимажелист

Извлекает список изображений, который используется элементом управления Toolbar для вывода "горячих" кнопок. Кнопка «горячее» отображается, если указатель мыши находится над ним.

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CImageList](../../mfc/reference/cimagelist-class.md) или значение null, если отключенный список изображений не задан.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist), как описано в Windows SDK. Кнопка «горячее» отображается, если указатель мыши находится над ним.

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a> CToolBarCtrl:: Жесотитем

Получает индекс горячего элемента на панели инструментов.

```
int GetHotItem() const;
```

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс горячего элемента на панели инструментов.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem), как описано в Windows SDK.

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a> CToolBarCtrl::/ImageList

Извлекает список изображений, используемый элементом управления Toolbar для отображения кнопок в состоянии по умолчанию.

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CImageList](../../mfc/reference/cimagelist-class.md) или значение null, если список изображений не задан.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist), как описано в Windows SDK.

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a> CToolBarCtrl:: Жетинсертмарк

Извлекает текущую метку вставки для панели инструментов.

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>Параметры

*птбим*<br/>
Указатель на структуру [тбинсертмарк](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) , которая получает метку вставки.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark), как описано в Windows SDK.

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CToolBarCtrl:: Жетинсертмаркколор

Получает цвет, используемый для рисования метки вставки панели инструментов.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение COLORREF, содержащее текущий цвет отметки вставки.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor), как описано в Windows SDK.

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a> CToolBarCtrl:: Жетитемрект

Извлекает ограничивающий прямоугольник кнопки в элементе управления ToolBar.

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс кнопки, для которой требуется получить сведения.

*лпрект*<br/>
Адрес структуры [Rect](/windows/win32/api/windef/ns-windef-rect) или объекта [крект](../../atl-mfc-shared/reference/crect-class.md) , который получает координаты ограничивающего прямоугольника.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция не извлекает ограничивающий прямоугольник для кнопок, состояние которых равно TBSTATE_HIDDEN.

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a> CToolBarCtrl:: Жетмакссизе

Возвращает общий размер всех видимых кнопок и разделителей на панели инструментов.

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>Параметры

*псизе*<br/>
Указатель на структуру [размера](/windows/win32/api/windef/ns-windef-size) , которая получает размер элементов.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize), как описано в Windows SDK.

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a> CToolBarCtrl:: Жетмакстекстровс

Возвращает максимальное число строк текста, отображаемых на кнопке панели инструментов.

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>Возвращаемое значение

Максимальное число строк текста, отображаемое на кнопке панели инструментов.

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a> CToolBarCtrl:: не метрики

Извлекает метрики `CToolBarCtrl` объекта.

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>Параметры

*птбм*<br/>
Указатель на структуру [тбметрикс](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) `CToolBarCtrl` объекта.

### <a name="remarks"></a>Remarks

Эта функция члена эмулирует функциональность [TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics) сообщения, как описано в Windows SDK.

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a> CToolBarCtrl:: Padding

Извлекает горизонтальное и вертикальное заполнение текущего элемента управления ToolBar.

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>Параметры

*пнхорзпаддинг*\
заполняет Целое число, получающее горизонтальное заполнение элемента управления Toolbar в пикселях.

*пнвертпаддинг*\
заполняет Целое число, получающее вертикальное заполнение элемента управления Toolbar в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_GETPADDING](/windows/win32/Controls/tb-getpadding) сообщение, описанное в Windows SDK.

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a> CToolBarCtrl:: Жетпресседимажелист

Извлекает список изображений, используемый текущим элементом управления Toolbar для представления кнопок в нажатом состоянии.

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) , содержащий список изображений для текущего элемента управления, или значение null, если такой список изображений не задан.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist) сообщение, описанное в Windows SDK.

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a> CToolBarCtrl:: коrect

Извлекает ограничивающий прямоугольник для указанной кнопки панели инструментов.

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*лпрект*<br/>
Указатель на структуру [Rect](/windows/win32/api/windef/ns-windef-rect) для получения сведений о ограничивающем прямоугольнике.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если успешно; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETRECT](/windows/win32/Controls/tb-getrect), как описано в Windows SDK.

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a> CToolBarCtrl:: GetRows

Извлекает количество строк кнопок, отображаемых в данный момент элементом управления ToolBar.

```
int GetRows() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число строк кнопок, отображаемых на панели инструментов в данный момент.

### <a name="remarks"></a>Remarks

Обратите внимание, что количество строк всегда будет равно единице, если только панель инструментов не была создана с использованием стиля TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a> CToolBarCtrl:: State

Извлекает сведения о состоянии указанной кнопки в элементе управления ToolBar, например о том, включен ли он, нажат или установлен.

```
int GetState(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для получения сведений.

### <a name="return-value"></a>Возвращаемое значение

Сведения о состоянии кнопки в случае успеха или-1 в противном случае. Сведения о состоянии кнопки могут представлять собой сочетание значений, перечисленных в [CToolBarCtrl:: аддбуттонс](#addbuttons).

### <a name="remarks"></a>Remarks

Эта функция особенно полезна, если требуется получить более одного состояния кнопки. Чтобы получить одно состояние, используйте одну из следующих функций члена: [исбуттоненаблед](#isbuttonenabled), [исбуттончеккед](#isbuttonchecked), [исбуттонпрессед](#isbuttonpressed), [исбуттонхидден](#isbuttonhidden)или [исбуттониндетерминате](#isbuttonindeterminate). Однако `GetState` функция-член является единственным способом обнаружения состояния кнопки TBSTATE_WRAP.

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a> CToolBarCtrl:: GetString

Извлекает строку панели инструментов.

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>Параметры

*nString*<br/>
Индекс строки.

*лпстрстринг*<br/>
Указатель на буфер, используемый для возврата строки.

*кчмакслен*<br/>
Длина буфера в байтах.

*str*<br/>
Строка.

### <a name="return-value"></a>Возвращаемое значение

Длина строки, если она выполнена успешно,-1, если нет.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_GETSTRING](/windows/win32/Controls/tb-getstring), как описано в Windows SDK.

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a> CToolBarCtrl:: штриховка

Возвращает стили, примененные в данный момент к элементу управления ToolBar.

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, содержащее сочетание [стилей элементов управления ToolBar](/windows/win32/Controls/toolbar-control-and-button-styles), как описано в Windows SDK.

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a> CToolBarCtrl:: подсказки

Получает маркер элемента управления "Подсказка", если он имеется, связанный с элементом управления ToolBar.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) , связанный с этой панелью инструментов, или значение null, если у панели инструментов нет связанного элемента управления "Подсказка".

### <a name="remarks"></a>Remarks

Поскольку элемент управления ToolBar обычно создает и поддерживает собственный элемент управления "Подсказка", большинству программ не требуется вызывать эту функцию.

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a> CToolBarCtrl:: HitTest

Определяет, где находится точка в элементе управления ToolBar.

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>Параметры

*PowerPoint*<br/>
Указатель на структуру [Point](/windows/win32/api/windef/ns-windef-point) , которая содержит координату x проверки попадания в элементе `x` и координату y проверки попадания в элементе `y` . Координаты задаются относительно клиентской области панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Целочисленное значение, указывающее расположение точки на панели инструментов. Если значение равно нулю или положительному значению, это возвращаемое значение является начинающимся с нуля индексом неразделителя элемента, в котором находится точка.

Если возвращаемое значение отрицательное, точка не находится внутри кнопки. Абсолютное значение возвращаемого значения — это индекс элемента-разделителя или ближайший неразделительный элемент.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_HITTEST](/windows/win32/Controls/tb-hittest), как описано в Windows SDK.

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a> CToolBarCtrl:: Хидебуттон

Скрывает или отображает указанную кнопку в элементе управления ToolBar.

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для скрытия или отображения.

*bHide*<br/>
Значение TRUE, чтобы скрыть кнопку, значение FALSE, чтобы показать ее.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Если вы хотите изменить более одного состояния кнопки, попробуйте вызвать [SetState](#setstate) .

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a> CToolBarCtrl:: неопределенное

Задает или очищает неопределенное состояние указанной кнопки в элементе управления ToolBar.

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды, неопределенное состояние которой необходимо установить или удалить.

*биндетерминате*<br/>
Значение TRUE, чтобы задать неопределенное состояние для указанной кнопки; значение FALSE, чтобы очистить ее.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Неопределенные кнопки отображаются серым цветом, например способ отображения кнопки Полужирный на панели инструментов текстового процессора, когда выбранный текст содержит как полужирный, так и обычный символ. Если вы хотите изменить более одного состояния кнопки, попробуйте вызвать [SetState](#setstate) .

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a> CToolBarCtrl:: Инсертбуттон

Вставляет кнопку в элемент управления ToolBar.

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс кнопки. Эта функция вставляет кнопку Создать слева от этой кнопки.

*лпбуттон*<br/>
Адрес структуры, `TBBUTTON` содержащей сведения о вставляемой кнопке. Описание структуры см. в разделе [CToolBarCtrl:: аддбуттонс](#addbuttons) `TBBUTTON` .

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Изображение и (или) строка, чей индекс должен быть ранее добавлен в список элементов управления ToolBar с помощью [аддбитмап](#addbitmap), [AddString](#addstring)и (или) [аддстрингс](#addstrings).

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a> CToolBarCtrl:: Инсертмаркхиттест

Извлекает данные метки вставки для точки на панели инструментов.

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>Параметры

*PowerPoint*<br/>
Указатель на структуру [Point](/windows/win32/api/windef/ns-windef-point) , содержащую координаты проверки попадания относительно клиентской области панели инструментов.

*птбим*<br/>
Указатель на структуру [тбинсертмарк](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) , которая получает сведения о метке вставки.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest), как описано в Windows SDK.

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a> CToolBarCtrl:: Исбуттончеккед

Определяет, проверяется ли указанная кнопка в элементе управления ToolBar.

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки на панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если кнопка отмечена флажком; в противном случае — ноль.

### <a name="remarks"></a>Remarks

Рассмотрите возможность вызова метода " [State](#getstate) ", если требуется получить более одного состояния кнопки.

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a> CToolBarCtrl:: Исбуттоненаблед

Определяет, включена ли указанная кнопка в элементе управления ToolBar.

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки на панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если кнопка включена; в противном случае — ноль.

### <a name="remarks"></a>Remarks

Рассмотрите возможность вызова метода " [State](#getstate) ", если требуется получить более одного состояния кнопки.

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a> CToolBarCtrl:: Исбуттонхидден

Определяет, скрыта ли указанная кнопка в элементе управления ToolBar.

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки на панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если кнопка скрыта; в противном случае — ноль.

### <a name="remarks"></a>Remarks

Рассмотрите возможность вызова метода " [State](#getstate) ", если требуется получить более одного состояния кнопки.

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a> CToolBarCtrl:: Исбуттонхигхлигхтед

Проверяет состояние выделения кнопки на панели инструментов.

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
окне Идентификатор команды для кнопки панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Положительное целое число, если кнопка выделена, 0, если кнопка не выделена, или-1, если возникает ошибка.

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a> CToolBarCtrl:: Исбуттониндетерминате

Определяет, является ли указанная кнопка в элементе управления ToolBar неопределенной.

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
окне Идентификатор команды кнопки на панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Положительное целое число, если кнопка является неопределенной, ноль, если кнопка не является неопределенной, или-1 при возникновении ошибки.

### <a name="remarks"></a>Remarks

Неопределенные кнопки отображаются серым цветом, например, способ отображения кнопки Полужирный на панели инструментов текстового процессора, если выделенный текст содержит как полужирный, так и обычный символ. Рассмотрите возможность вызова метода " [State](#getstate) ", если требуется получить более одного состояния кнопки.

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a> CToolBarCtrl:: Исбуттонпрессед

Определяет, нажата ли указанная кнопка в элементе управления ToolBar.

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки на панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если нажата кнопка; в противном случае — ноль.

### <a name="remarks"></a>Remarks

Рассмотрите возможность вызова метода " [State](#getstate) ", если требуется получить более одного состояния кнопки.

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a> CToolBarCtrl:: Лоадимажес

Загружает растровые изображения в список изображений элемента управления ToolBar.

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>Параметры

*ибитмапид*<br/>
Идентификатор растрового изображения, содержащего изображения для загрузки. Чтобы указать собственный ресурс точечного рисунка, присвойте этому параметру идентификатор ресурса Bitmap и задайте для *хинст* значение null. Ресурс точечного рисунка будет добавлен в список изображений в виде одного образа. Вы можете добавить стандартные, определенные системой точечные рисунки, задав для *хинст* значение HINST_COMMCTRL и задав для этого параметра один из следующих идентификаторов:

|Идентификатор точечного рисунка|Описание|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Точечные рисунки в обозревателе крупного размера|
|IDB_HIST_SMALL_COLOR|Точечные рисунки в обозревателе малого размера|
|IDB_STD_LARGE_COLOR|Стандартные точечные рисунки крупного размера|
|IDB_STD_SMALL_COLOR|Стандартные точечные рисунки небольшого размера|
|IDB_VIEW_LARGE_COLOR|Просмотр точечных рисунков в большом размере|
|IDB_VIEW_SMALL_COLOR|Просмотр точечных рисунков в небольшом размере|

*хинст*<br/>
К вызывающему приложению. Этот параметр может быть HINST_COMMCTRL для загрузки стандартного списка изображений.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages), как описано в Windows SDK.

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a> CToolBarCtrl:: Мапакцелератор

Сопоставляет символ ускорителя с кнопкой панели инструментов.

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>Параметры

*чакцел*<br/>
Символ ускорителя для сопоставления. Этот символ совпадает с символом, подчеркнутым в тексте кнопки.

*пидбтн*<br/>
Указатель на UINT, который получает идентификатор команды для кнопки, которая соответствует сочетанию клавиш, указанному в *чакцел*.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator), как описано в Windows SDK.

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a> CToolBarCtrl:: Маркбуттон

Задает состояние выделения для данной кнопки в элементе управления ToolBar.

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*фхигхлигхт*<br/>
Указывает состояние выделения для установки. По умолчанию значение TRUE. Если задано значение FALSE, кнопка будет иметь состояние по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton), как описано в Windows SDK.

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a> CToolBarCtrl:: Мовебуттон

Перемещает кнопку из одного индекса в другой.

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>Параметры

*нолдпос*<br/>
Отсчитываемый от нуля индекс перемещаемой кнопки.

*нневпос*<br/>
Отсчитываемый от нуля индекс назначения кнопки.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton), как описано в Windows SDK.

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a> CToolBarCtrl::P Рессбуттон

Нажимает или освобождает указанную кнопку в элементе управления ToolBar.

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
окне Идентификатор команды для нажатия или выпуска.

*бпресс*<br/>
окне Значение TRUE, чтобы нажать указанную кнопку; Значение FALSE, чтобы освободить указанную кнопку. Значение по умолчанию — TRUE.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод успешно выполнен; в противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Если вы хотите изменить более одного состояния кнопки, попробуйте вызвать [SetState](#setstate) .

Этот метод отправляет [TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton) сообщение, описанное в Windows SDK.

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a> CToolBarCtrl:: Реплацебитмап

Заменяет существующий точечный рисунок в текущем элементе управления ToolBar новым растровым изображением.

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>Параметры

*преплацебитмап*\
окне Указатель на структуру [тбреплацебитмап](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap) , описывающую заменяемый точечный рисунок и новый точечный рисунок.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap) сообщение, описанное в Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода показано, как заменить точечный рисунок для стандартной панели инструментов другим растровым изображением.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a> CToolBarCtrl:: RestoreState

Восстанавливает состояние элемента управления Toolbar из расположения в реестре, заданном параметрами.

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Параметры

*хкэйрут*<br/>
Определяет текущий открытый ключ в реестре или любое из следующих стандартных зарезервированных значений обработчика:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*лпсзсубкэй*<br/>
Указывает на строку с завершающим нулем, содержащую имя подраздела, с которым связано значение. Этот параметр может иметь значение null или быть указателем на пустую строку. Если параметр имеет значение NULL, то значение будет добавлено к ключу, определяемому параметром *хкэйрут* .

*лпсзвалуенаме*<br/>
Указывает на строку, содержащую имя извлекаемого значения. Если значение с таким именем еще не существует в ключе, функция добавляет его в ключ.

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a> CToolBarCtrl:: SaveState

Сохраняет состояние элемента управления Toolbar в расположении в реестре, заданном параметрами.

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Параметры

*хкэйрут*<br/>
Определяет текущий открытый ключ в реестре или любое из следующих стандартных зарезервированных значений обработчика:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*лпсзсубкэй*<br/>
Указывает на строку с завершающим нулем, содержащую имя подраздела, с которым связано значение. Этот параметр может иметь значение null или быть указателем на пустую строку. Если параметр имеет значение NULL, то значение будет добавлено к ключу, определяемому параметром *хкэйрут* .

*лпсзвалуенаме*<br/>
Указывает на строку, содержащую имя значения, которое необходимо задать. Если значение с таким именем еще не существует в ключе, функция добавляет его в ключ.

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a> CToolBarCtrl:: Сетанчорхигхлигхт

Задает параметр выделения закреплений для панели инструментов.

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>Параметры

*фанчор*<br/>
окне Указывает, включено или отключено выделение закреплений. Если это значение не равно нулю, выделение привязки будет включено. Если это значение равно нулю, выделение привязки будет отключено.

### <a name="return-value"></a>Возвращаемое значение

Предыдущий параметр привязки. Если выделение было включено, это значение не равно нулю. Если выделение не было включено, это значение равно нулю.

### <a name="remarks"></a>Remarks

Этот метод реализует поведение сообщения Win32 [TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight), как описано в Windows SDK.

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a> CToolBarCtrl:: Сетбитмапсизе

Задает размер фактических растровых изображений, добавляемых к элементу управления ToolBar.

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Ширина и высота растровых изображений в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться только перед добавлением точечных рисунков на панель инструментов. Если в приложении явно не задан размер точечного рисунка, по умолчанию используется значение 16 на 15 пикселей.

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a> CToolBarCtrl:: Сетбуттонинфо

Задает сведения для существующей кнопки на панели инструментов.

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*птбби*<br/>
Указатель на структуру [тббуттонинфо](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) , которая получает сведения о кнопке.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Функция члена реализует поведение сообщения Win32 [TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo), как описано в Windows SDK.

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a> CToolBarCtrl:: Сетбуттонсизе

Задает размер кнопок в элементе управления ToolBar.

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Ширина и высота кнопок в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Размер кнопки всегда должен быть не меньше размера точечного рисунка, который он заключает. Эта функция должна вызываться только перед добавлением точечных рисунков на панель инструментов. Если в приложении явно не задан размер кнопки, по умолчанию используется значение 24 x 22 пикселей.

### <a name="example"></a>Пример

  См. пример для [CToolBar:: жеттулбарктрл](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl).

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a> CToolBarCtrl:: Сетбуттонструктсизе

Задает размер `TBBUTTON` структуры.

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>Параметры

*нсизе*<br/>
Размер структуры в байтах `TBBUTTON` .

### <a name="remarks"></a>Remarks

Если вы хотите хранить в структуре дополнительные данные `TBBUTTON` , можно либо получить новую структуру из `TBBUTTON` , добавить необходимые элементы, либо создать новую структуру, содержащую `TBBUTTON` структуру в качестве первого элемента. Затем следует вызвать эту функцию, чтобы указать элементу управления ToolBar размер новой структуры.

Дополнительные сведения о структуре см. в разделе [CToolBarCtrl:: аддбуттонс](#addbuttons) `TBBUTTON` .

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a> CToolBarCtrl:: Сетбуттонвидс

Задает минимальную и максимальную ширину кнопок в элементе управления ToolBar.

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>Параметры

*кксмин*<br/>
Минимальная ширина кнопки в пикселях. Кнопки панели инструментов никогда не будут более узкими, чем это значение.

*кксмакс*<br/>
Максимальная ширина кнопки в пикселях. Если текст кнопки слишком широк, элемент управления отображает его с помощью точек многоточия.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth), как описано в Windows SDK.

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a> CToolBarCtrl:: Сеткмдид

Задает идентификатор команды, которая будет отправляться окну-владельцу при нажатии указанной кнопки.

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс кнопки, идентификатор команды которого необходимо задать.

*nID*<br/>
Идентификатор команды для установки выбранной кнопки.

### <a name="return-value"></a>Возвращаемое значение

В случае успешного выполнения возвращает ненулевое значение; в противном случае — ноль.

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a> CToolBarCtrl:: Сетколорсчеме

Задает цветовую схему для текущего элемента управления ToolBar.

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>Параметры

*лпколорсчеме*\
окне Указатель на структуру [колорсчеме](/windows/win32/api/commctrl/ns-commctrl-colorscheme) , описывающую цвет выделения и цвет тени элемента управления ToolBar.

### <a name="remarks"></a>Remarks

Этот метод не действует, если задана визуальная тема Windows Vista.

Этот метод отправляет [TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme) сообщение, описанное в Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода задается цветовая схема для текущего элемента управления ToolBar. В примере кода левый и верхний края каждой кнопки инструмента красного и правого и нижнего края синим. Когда пользователь нажимает кнопку, красные края кнопки помечаются синим цветом, а синие — красным.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a> CToolBarCtrl:: Сетдисабледимажелист

Задает список изображений, который будет использоваться элементом управления Toolbar для вывода отключенных кнопок.

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*пимажелист*<br/>
Указатель на объект, `CImageList` содержащий изображения, которые будут использоваться элементом управления Toolbar для вывода отключенных изображений кнопки.

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CImageList](../../mfc/reference/cimagelist-class.md) , который ранее использовался элементом управления Toolbar для вывода отключенных изображений кнопки.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist), как описано в Windows SDK. Реализация MFC `SetDisabledImageList` использует `CImageList` объект, содержащий отключенные изображения кнопки элемента управления ToolBar, а не маркер списка изображений.

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a> CToolBarCtrl:: Сетдравтекстфлагс

Устанавливает флаги в функции Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), которая используется для рисования текста в указанном прямоугольнике, в соответствии с установленными флагами.

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>Параметры

*двмаск*<br/>
Сочетание одного или нескольких флагов DT_, указанных в функции Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), которое указывает, какие биты в *двдтфлагс* будут использоваться при рисовании текста.

*двдтфлагс*<br/>
Сочетание одного или нескольких флагов DT_, указанных в функции Win32 `DrawText` , которые указывают, как будет нарисован текст кнопки. Это значение передается в `DrawText` при прорисовке текста кнопки.

### <a name="return-value"></a>Возвращаемое значение

Объект типа DWORD, содержащий предыдущие флаги рисования текста.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags), как описано в Windows SDK. Эта функция – член задает флаги в функции Win32 `DrawText` , которая рисует текст в указанном прямоугольнике, отформатированный в соответствии с установленными флагами.

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a> CToolBarCtrl:: Сетекстендедстиле

Задает расширенные стили для элемента управления ToolBar.

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>Параметры

*двексстиле*<br/>
Значение, указывающее новые расширенные стили. Этот параметр может быть сочетанием расширенных стилей панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, представляющее предыдущие расширенные стили. Список стилей см. в разделе [Расширенные стили панели инструментов](/windows/win32/Controls/toolbar-extended-styles)в Windows SDK.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle), как описано в Windows SDK.

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a> CToolBarCtrl:: Сесотимажелист

Задает список изображений, который будет использоваться элементом управления Toolbar для вывода "горячих" кнопок.

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*пимажелист*<br/>
Указатель на объект, `CImageList` содержащий изображения, которые будут использоваться элементом управления Toolbar для показа изображений активной кнопки.

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CImageList](../../mfc/reference/cimagelist-class.md) , который ранее использовался элементом управления Toolbar для показа изображений активной кнопки.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist), как описано в Windows SDK.

Реализация MFC `SetHotImageList` использует `CImageList` объект, содержащий изображения активной кнопки элемента управления ToolBar, а не маркер списка изображений. Кнопка "горячая" отображается при выделении указателя над ним.

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a> CToolBarCtrl:: Сесотитем

Задает горячий элемент на панели инструментов.

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>Параметры

*нхот*<br/>
Отсчитываемый от нуля номер индекса элемента, который будет активным. Если это значение равно-1, ни один из элементов не будет активным.

### <a name="return-value"></a>Возвращаемое значение

Индекс предыдущего горячего элемента или значение-1, если не было горячего элемента.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem), как описано в Windows SDK.

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a> CToolBarCtrl:: Сетимажелист

Задает список изображений, который будет использоваться панелью инструментов для отображения кнопок, которые находятся в состоянии по умолчанию.

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*пимажелист*<br/>
Указатель на объект, `CImageList` содержащий изображения, которые будут использоваться элементом управления Toolbar для отображения изображений кнопок в их состоянии по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [CImageList](../../mfc/reference/cimagelist-class.md) , который ранее использовался элементом управления Toolbar для отображения изображений кнопки в состоянии по умолчанию.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist), как описано в Windows SDK.

Реализация MFC `SetImageList` использует `CImageList` объект, содержащий изображения кнопки элемента управления ToolBar, а не маркер списка изображений.

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a> CToolBarCtrl:: Сетиндент

Задает отступ для первой кнопки в элементе управления ToolBar.

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>Параметры

*ииндент*<br/>
Значение, указывающее отступ в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a> CToolBarCtrl:: Сетинсертмарк

Задает текущую метку вставки для панели инструментов.

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>Параметры

*птбим*<br/>
Указатель на структуру [тбинсертмарк](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) , содержащую метку вставки.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark), как описано в Windows SDK.

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CToolBarCtrl:: Сетинсертмаркколор

Задает цвет, используемый для отображения метки вставки для панели инструментов.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Параметры

*клрнев*<br/>
Значение COLORREF, содержащее новый цвет метки вставки.

### <a name="return-value"></a>Возвращаемое значение

Значение COLORREF, содержащее предыдущий цвет отметки вставки.

### <a name="remarks"></a>Remarks

Эта функция члена реализует поведение сообщения Win32 [TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor), как описано в Windows SDK.

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a> CToolBarCtrl:: Сетмакстекстровс

Задает максимальное число строк текста, отображаемых на кнопке панели инструментов.

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>Параметры

*имаксровс*<br/>
Максимальное число заданных строк.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a> CToolBarCtrl:: Сетметрикс

Задает метрики `CToolBarCtrl` объекта.

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>Параметры

*птбм*<br/>
Указатель на структуру [тбметрикс](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) `CToolBarCtrl` объекта.

### <a name="remarks"></a>Remarks

Эта функция члена эмулирует функциональность [TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics) сообщения, как описано в Windows SDK.

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a> CToolBarCtrl:: Сетовнер

Задает окно владельца для элемента управления ToolBar.

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>Параметры

*Приводится*<br/>
Указатель на `CWnd` `CWnd` объект, производный от или, который будет новым владельцем окна для элемента управления ToolBar.

### <a name="remarks"></a>Remarks

Окно-владелец — это окно, которое получает уведомления с панели инструментов.

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a> CToolBarCtrl:: Сетпаддинг

Задает горизонтальное и вертикальное заполнение текущего элемента управления ToolBar.

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>Параметры

*нхорзпаддинг*\
окне Задает горизонтальное заполнение элемента управления Toolbar в пикселях.

*нвертпаддинг*\
окне Задает вертикальное заполнение элемента управления Toolbar в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Параметр DWORD, младшее слово которого содержит предыдущее значение отступа по горизонтали, а большое слово содержит предыдущее значение отступа по вертикали. Значения заполнения измеряются в пикселях.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_SETPADDING](/windows/win32/Controls/tb-setpadding) сообщение, описанное в Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода горизонтальное и вертикальное заполнение текущего элемента управления ToolBar устанавливается на 20 пикселей.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a> CToolBarCtrl:: Сетпресседимажелист

Задает список изображений, используемый текущим элементом управления Toolbar для представления кнопок в нажатом состоянии.

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*иимажеид*\
окне Отсчитываемый от нуля индекс списка изображений. Если используется только один список изображений, присвойте этому параметру значение нуль.

*пимажелист*\
окне Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) , содержащий новый список изображений.

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) , содержащий предыдущий список изображений для текущего элемента управления, или значение null, если такой список изображений не задан.

### <a name="remarks"></a>Remarks

Этот метод отправляет [TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist) сообщение, описанное в Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода для нажатого списка изображений задается то же значение, что и в списке изображений по умолчанию.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a> CToolBarCtrl:: Сетровс

Запрашивает у элемента управления ToolBar изменение размера до запрошенного числа строк.

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*nRows*<br/>
Запрошенное число строк.

*бларжер*<br/>
Указывает, следует ли использовать больше строк или меньше строк, если невозможно изменить размер панели инструментов до запрошенного числа строк.

*лпрект*<br/>
Указывает на объект [крект](../../atl-mfc-shared/reference/crect-class.md) или структуру [Rect](/windows/win32/api/windef/ns-windef-rect) , которая будет принимать новый ограничивающий прямоугольник панели инструментов.

### <a name="remarks"></a>Remarks

Если панель инструментов не может изменить размер до запрошенного числа или строк, размер будет изменен на следующий больший или следующий меньший допустимый размер в зависимости от значения *бларжер*. Если *бларжер* имеет значение true, новое число строк будет больше запрошенного числа. Если *бларжер* имеет значение false, новое число строк будет меньше запрошенного числа.

Заданное число строк допустимо для панели инструментов, если кнопки можно упорядочить таким образом, чтобы все строки имели одинаковое количество кнопок (за исключением последней строки). Например, для панели инструментов, содержащей четыре кнопки, нельзя установить размер до трех строк, поскольку последние две строки должны быть короче. Если вы попытаетесь установить размер до трех строк, то получится четыре строки, если *бларжер* имеет значение true и две строки, если *бларжер* имел значение false.

Если на панели инструментов есть разделители, то правила, когда заданное число строк являются допустимыми, более сложными. Макет рассчитывается таким образом, что группы кнопок (кнопки с разделителем перед первой и последней кнопкой в группе) никогда не разбиваются на несколько строк, если только группа не умещается в одной строке.

Если группа не помещается в одну строку, следующая группа начнется со следующей строки, даже если она поместится на строку, в которой заканчивается большая группа. Назначение этого правила заключается в том, чтобы сделать разделение между большими группами более заметным. Результирующие вертикальные разделители считаются строками.

Обратите внимание, что `SetRows` функция – член всегда выбирает макет, который приводит к наименьшему размеру панели инструментов. Создание панели инструментов с TBSTYLE_WRAPABLE стилем и последующим изменением размера элемента управления приведет к простому применению метода, описанного выше, с учетом ширины элемента управления.

Эту функцию можно вызывать только для панелей инструментов, созданных с помощью стиля TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a> CToolBarCtrl:: SetState

Задает состояние указанной кнопки в элементе управления ToolBar.

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для кнопки.

*Nсведения*<br/>
Флаги состояния. Это может быть сочетание значений, перечисленных для состояний кнопки в [CToolBarCtrl:: аддбуттонс](#addbuttons).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция особенно полезна, если требуется задать более одного состояния кнопки. Чтобы установить одно состояние, используйте одну из следующих функций члена: [енаблебуттон](#enablebutton), [чеккбуттон](#checkbutton), [Хидебуттон](#hidebutton), [неопределенный](#indeterminate)или [прессбуттон](#pressbutton).

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a> CToolBarCtrl:: SetStyle

Задает стили для элемента управления ToolBar.

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>Параметры

*двстиле*<br/>
Значение типа DWORD, содержащее сочетание [стилей элементов управления ToolBar](/windows/win32/Controls/toolbar-control-and-button-styles), как описано в Windows SDK.

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a> CToolBarCtrl:: Сеттултипс

Связывает элемент управления «подсказка» с элементом управления ToolBar.

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>Параметры

*птип*<br/>
Указатель на объект [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) .

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a> CToolBarCtrl:: SetWindowTheme

Задает визуальный стиль `CToolBarCtrl` объекта.

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>Параметры

*псзсубаппнаме*<br/>
Указатель на строку в Юникоде, содержащую стиль отображения панели инструментов, который необходимо задать.

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение не используется.

### <a name="remarks"></a>Remarks

Эта функция члена эмулирует функциональность [TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme) сообщения, как описано в Windows SDK.

## <a name="see-also"></a>См. также

[Пример CMNCTRL1 для MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример MFC MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd, класс](../../mfc/reference/cwnd-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс CToolBar](../../mfc/reference/ctoolbar-class.md)
