---
title: CDaoRecordView, класс
ms.date: 11/04/2016
f1_keywords:
- CDaoRecordView
- AFXDAO/CDaoRecordView
- AFXDAO/CDaoRecordView::CDaoRecordView
- AFXDAO/CDaoRecordView::IsOnFirstRecord
- AFXDAO/CDaoRecordView::IsOnLastRecord
- AFXDAO/CDaoRecordView::OnGetRecordset
- AFXDAO/CDaoRecordView::OnMove
helpviewer_keywords:
- CDaoRecordView [MFC], CDaoRecordView
- CDaoRecordView [MFC], IsOnFirstRecord
- CDaoRecordView [MFC], IsOnLastRecord
- CDaoRecordView [MFC], OnGetRecordset
- CDaoRecordView [MFC], OnMove
ms.assetid: 5aa7d0e2-bd05-413e-b216-80c404ce18ac
ms.openlocfilehash: 95ed9207d0047287e373401da52f05235a817999
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87223139"
---
# <a name="cdaorecordview-class"></a>CDaoRecordView, класс

Представление, которое отображает записи базы данных в элементах управления.

## <a name="syntax"></a>Синтаксис

```
class AFX_NOVTABLE CDaoRecordView : public CFormView
```

## <a name="members"></a>Участники

### <a name="protected-constructors"></a>Защищенные конструкторы

|Имя|Описание:|
|----------|-----------------|
|[CDaoRecordView:: CDaoRecordView](#cdaorecordview)|Формирует объект `CDaoRecordView`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание:|
|----------|-----------------|
|[CDaoRecordView:: Исонфирстрекорд](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записью в связанном наборе записей.|
|[CDaoRecordView:: Исонластрекорд](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записью в связанном наборе записей.|
|[CDaoRecordView:: Онжетрекордсет](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CDaoRecordset` . ClassWizard переопределяет эту функцию и при необходимости создает набор записей.|
|[CDaoRecordView:: OnMove](#onmove)|Если текущая запись изменилась, обновляет ее в источнике данных, а затем переходит к указанной записи (Следующая, Предыдущая, первая или последняя).|

## <a name="remarks"></a>Remarks

Представление является представлением формы, которое напрямую подключено к `CDaoRecordset` объекту. Представление создается на основе ресурса шаблона диалогового окна и отображает поля `CDaoRecordset` объекта в элементах управления шаблона диалогового окна. `CDaoRecordView`Объект использует обмен данными диалоговых данных (DDX) и обмен полями записей DAO (DFX) для автоматизации перемещения данных между элементами управления в форме и полями набора записей. `CDaoRecordView`также предоставляет реализацию по умолчанию для перехода к первой, следующей, предыдущей или последней записи и интерфейс для обновления записи, которая в настоящее время находится в представлении.

> [!NOTE]
> Классы базы данных DAO отличаются от классов баз данных MFC, основанных на открытом подключении к базам данных (ODBC). Все имена классов баз данных DAO имеют префикс "Кдао". Вы по-прежнему можете обращаться к источникам данных ODBC с помощью классов DAO. классы DAO обычно предлагают превосходные возможности, так как они используют ядро СУБД Microsoft Jet.

Наиболее распространенным способом создания представления записей является мастер приложений. Мастер приложений создает класс представления записей и связанный с ним класс набора записей как часть скелета начального приложения.

Если вам нужна только одна форма, то проще подходить с помощью мастера приложений. ClassWizard позволяет принять решение об использовании представления записей в дальнейшем в процессе разработки. Если класс представления записей не создается с помощью мастера приложений, его можно создать позже с помощью ClassWizard. Использование ClassWizard для создания представления записей и набора записей по отдельности, а затем их подключение является самым гибким подходом, поскольку обеспечивает более широкие возможности управления именованием класса набора записей и его. H/. CPP файлы. Этот подход также позволяет иметь несколько представлений записей для одного и того же класса набора записей.

Чтобы облегчить пользователям переход от записи к записи в представлении записей, мастер приложений создает меню (и, при необходимости, панель инструментов) ресурсов для перехода к первой, следующей, предыдущей или последней записи. При создании класса представления записей с помощью ClassWizard необходимо создать эти ресурсы самостоятельно с помощью редакторов меню и растровых изображений.

Сведения о реализации по умолчанию для перехода от записи к записи см. `IsOnFirstRecord` в `IsOnLastRecord` статьях и и в статье [Использование представления записей](../../data/using-a-record-view-mfc-data-access.md), которое относится как к, так `CRecordView` и к `CDaoRecordView` .

`CDaoRecordView`отслеживает расположение пользователя в наборе записей, чтобы представление записей может обновить пользовательский интерфейс. Когда пользователь переходит к концу набора записей, представление записей отключает объекты пользовательского интерфейса, такие как элементы меню или кнопки панели инструментов, для перемещения дальше в том же направлении.

Дополнительные сведения об объявлении и использовании представлений записей и классов набора записей см. в разделе «Проектирование и создание представления записей» в [представлениях записей](../../data/record-views-mfc-data-access.md)статей. Дополнительные сведения о работе представлений записей и их использовании см. в статье [Использование представления записей](../../data/using-a-record-view-mfc-data-access.md). Все упомянутые выше статьи применимы как к `CRecordView` , так и к `CDaoRecordView` .

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CDaoRecordView`

## <a name="requirements"></a>Требования

**Заголовок:** афксдао. h

## <a name="cdaorecordviewcdaorecordview"></a><a name="cdaorecordview"></a>CDaoRecordView:: CDaoRecordView

При создании объекта типа, производного от `CDaoRecordView` , вызовите либо форму конструктора для инициализации объекта представления, и укажите ресурс диалогового окна, на котором основано представление.

```
explicit CDaoRecordView(LPCTSTR lpszTemplateName);
explicit CDaoRecordView(UINT nIDTemplate);
```

### <a name="parameters"></a>Параметры

*лпсзтемплатенаме*<br/>
Содержит строку, завершающуюся нулем, которая является именем ресурса шаблона диалогового окна.

*нидтемплате*<br/>
Содержит ИДЕНТИФИКАЦИОНный номер ресурса шаблона диалогового окна.

### <a name="remarks"></a>Remarks

Можно либо указать ресурс по имени (передать строку в качестве аргумента конструктору), либо по его ИДЕНТИФИКАТОРу (передать целое число без знака в качестве аргумента). Рекомендуется использовать идентификатор ресурса.

> [!NOTE]
> Производный класс должен предоставить собственный конструктор. В конструкторе производного класса вызовите конструктор `CDaoRecordView::CDaoRecordView` с именем ресурса или идентификатором в качестве аргумента.

`CDaoRecordView::OnInitialUpdate`вызывает метод `CWnd::UpdateData` `CWnd::DoDataExchange` . Этот начальный вызов позволяет `DoDataExchange` соединить `CDaoRecordView` элементы управления (косвенно) с `CDaoRecordset` элементами данных полей, созданными с помощью ClassWizard. Эти элементы данных нельзя использовать до тех пор, пока не будет вызвана `CFormView::OnInitialUpdate` функция члена базового класса.

> [!NOTE]
> При использовании ClassWizard мастер определяет **`enum`** значение `CDaoRecordView::IDD` в объявлении класса и использует его в списке инициализации элементов для конструктора.

[!code-cpp[NVC_MFCDatabase#35](../../mfc/codesnippet/cpp/cdaorecordview-class_1.cpp)]

## <a name="cdaorecordviewisonfirstrecord"></a><a name="isonfirstrecord"></a>CDaoRecordView:: Исонфирстрекорд

Вызовите эту функцию-член, чтобы определить, является ли текущая запись первой записью в объекте набора записей, связанном с этим представлением записей.

```
BOOL IsOnFirstRecord();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая запись является первой записью в наборе записей; в противном случае — 0.

### <a name="remarks"></a>Remarks

Эта функция полезна для написания собственных реализаций обработчиков обновления команд по умолчанию, написанных ClassWizard.

Если пользователь переходит к первой записи, инфраструктура отключает любые объекты пользовательского интерфейса (например, элементы меню или кнопки панели инструментов), которые необходимо выполнить для перехода на первую или предыдущую запись.

## <a name="cdaorecordviewisonlastrecord"></a><a name="isonlastrecord"></a>CDaoRecordView:: Исонластрекорд

Вызовите эту функцию-член, чтобы определить, является ли текущая запись последней записью в объекте набора записей, связанном с этим представлением записей.

```
BOOL IsOnLastRecord();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая запись является последней записью в наборе записей; в противном случае — 0.

### <a name="remarks"></a>Remarks

Эта функция полезна для написания собственных реализаций обработчиков обновления команд по умолчанию, ClassWizard запись для поддержки пользовательского интерфейса для перехода от записи к записи.

> [!CAUTION]
> Результат этой функции надежен, за исключением того, что представление может не обнаруживать конец набора записей, пока пользователь не переместит его. Пользователю может потребоваться перейти за пределы последней записи, прежде чем представление записи сможет определить, что он должен отключить все объекты пользовательского интерфейса для перехода к следующей или последней записи. Если пользователь переместится за последнюю запись, а затем перейдет к последней записи (или до нее), представление записей может отслеживанию положения пользователя в наборе записей и правильно отключить объекты пользовательского интерфейса.

## <a name="cdaorecordviewongetrecordset"></a><a name="ongetrecordset"></a>CDaoRecordView:: Онжетрекордсет

Возвращает указатель на `CDaoRecordset` производный объект, связанный с представлением записи.

```
virtual CDaoRecordset* OnGetRecordset() = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CDaoRecordset` производный объект, если объект был успешно создан; в противном случае — пустой указатель.

### <a name="remarks"></a>Remarks

Необходимо переопределить эту функцию-член для создания или получения объекта набора записей и возвращения указателя на него. Если вы объявили класс представления записей с помощью ClassWizard, мастер запишет для вас переопределение по умолчанию. Реализация по умолчанию ClassWizard возвращает указатель набора записей, хранящийся в представлении записей, если он существует. В противном случае он конструирует объект набора записей типа, указанного с помощью ClassWizard, и вызывает его `Open` функцию-член для открытия таблицы или выполнения запроса, а затем возвращает указатель на объект.

Дополнительные сведения и примеры см. в разделе [представления записей статьи: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).

## <a name="cdaorecordviewonmove"></a><a name="onmove"></a>CDaoRecordView:: OnMove

Вызовите эту функцию-член, чтобы перейти к другой записи в наборе записей и отобразить ее поля в элементах управления представления записей.

```
virtual BOOL OnMove(UINT nIDMoveCommand);
```

### <a name="parameters"></a>Параметры

*нидмовекомманд*<br/>
Одно из следующих стандартных значений идентификатора команды:

- ID_RECORD_FIRST перейти к первой записи в наборе записей.

- ID_RECORD_LAST перейти к последней записи в наборе записей.

- ID_RECORD_NEXT перейти к следующей записи в наборе записей.

- ID_RECORD_PREV перейти к предыдущей записи в наборе записей.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если перемещение прошло успешно; в противном случае — 0, если запрос на перемещение был отклонен.

### <a name="remarks"></a>Remarks

Реализация по умолчанию вызывает соответствующую функцию элемента Move в `CDaoRecordset` объекте, связанном с представлением записей.

По умолчанию `OnMove` обновляет текущую запись в источнике данных, если пользователь изменил его в представлении записей.

Мастер приложений создает ресурс меню с элементами меню первая запись, последняя запись, следующая запись и Предыдущая запись. Если выбрать параметр Начальная панель инструментов, то мастер приложений также создаст панель инструментов с кнопками, соответствующими этим командам.

Если переместиться за последнюю запись в наборе записей, то в представлении записей будет отображаться последняя запись. Если перейти назад после первой записи, то в представлении записей будет отображаться первая запись.

> [!CAUTION]
> Вызов `OnMove` создает исключение, если набор записей не содержит записей. Вызовите соответствующую функцию обработчика обновлений пользовательского интерфейса ( `OnUpdateRecordFirst` , `OnUpdateRecordLast` , `OnUpdateRecordNext` или `OnUpdateRecordPrev` ) перед соответствующей операцией перемещения, чтобы определить, содержит ли набор записей какие-либо записи.

## <a name="see-also"></a>См. также статью

[Класс CFormView](../../mfc/reference/cformview-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс Кдаотабледеф](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс Кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)<br/>
[Класс Кдаоворкспаце](../../mfc/reference/cdaoworkspace-class.md)<br/>
[Класс CFormView](../../mfc/reference/cformview-class.md)
