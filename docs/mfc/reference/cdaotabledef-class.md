---
title: Класс Кдаотабледеф
ms.date: 11/04/2016
f1_keywords:
- CDaoTableDef
- AFXDAO/CDaoTableDef
- AFXDAO/CDaoTableDef::CDaoTableDef
- AFXDAO/CDaoTableDef::Append
- AFXDAO/CDaoTableDef::CanUpdate
- AFXDAO/CDaoTableDef::Close
- AFXDAO/CDaoTableDef::Create
- AFXDAO/CDaoTableDef::CreateField
- AFXDAO/CDaoTableDef::CreateIndex
- AFXDAO/CDaoTableDef::DeleteField
- AFXDAO/CDaoTableDef::DeleteIndex
- AFXDAO/CDaoTableDef::GetAttributes
- AFXDAO/CDaoTableDef::GetConnect
- AFXDAO/CDaoTableDef::GetDateCreated
- AFXDAO/CDaoTableDef::GetDateLastUpdated
- AFXDAO/CDaoTableDef::GetFieldCount
- AFXDAO/CDaoTableDef::GetFieldInfo
- AFXDAO/CDaoTableDef::GetIndexCount
- AFXDAO/CDaoTableDef::GetIndexInfo
- AFXDAO/CDaoTableDef::GetName
- AFXDAO/CDaoTableDef::GetRecordCount
- AFXDAO/CDaoTableDef::GetSourceTableName
- AFXDAO/CDaoTableDef::GetValidationRule
- AFXDAO/CDaoTableDef::GetValidationText
- AFXDAO/CDaoTableDef::IsOpen
- AFXDAO/CDaoTableDef::Open
- AFXDAO/CDaoTableDef::RefreshLink
- AFXDAO/CDaoTableDef::SetAttributes
- AFXDAO/CDaoTableDef::SetConnect
- AFXDAO/CDaoTableDef::SetName
- AFXDAO/CDaoTableDef::SetSourceTableName
- AFXDAO/CDaoTableDef::SetValidationRule
- AFXDAO/CDaoTableDef::SetValidationText
- AFXDAO/CDaoTableDef::m_pDAOTableDef
- AFXDAO/CDaoTableDef::m_pDatabase
helpviewer_keywords:
- CDaoTableDef [MFC], CDaoTableDef
- CDaoTableDef [MFC], Append
- CDaoTableDef [MFC], CanUpdate
- CDaoTableDef [MFC], Close
- CDaoTableDef [MFC], Create
- CDaoTableDef [MFC], CreateField
- CDaoTableDef [MFC], CreateIndex
- CDaoTableDef [MFC], DeleteField
- CDaoTableDef [MFC], DeleteIndex
- CDaoTableDef [MFC], GetAttributes
- CDaoTableDef [MFC], GetConnect
- CDaoTableDef [MFC], GetDateCreated
- CDaoTableDef [MFC], GetDateLastUpdated
- CDaoTableDef [MFC], GetFieldCount
- CDaoTableDef [MFC], GetFieldInfo
- CDaoTableDef [MFC], GetIndexCount
- CDaoTableDef [MFC], GetIndexInfo
- CDaoTableDef [MFC], GetName
- CDaoTableDef [MFC], GetRecordCount
- CDaoTableDef [MFC], GetSourceTableName
- CDaoTableDef [MFC], GetValidationRule
- CDaoTableDef [MFC], GetValidationText
- CDaoTableDef [MFC], IsOpen
- CDaoTableDef [MFC], Open
- CDaoTableDef [MFC], RefreshLink
- CDaoTableDef [MFC], SetAttributes
- CDaoTableDef [MFC], SetConnect
- CDaoTableDef [MFC], SetName
- CDaoTableDef [MFC], SetSourceTableName
- CDaoTableDef [MFC], SetValidationRule
- CDaoTableDef [MFC], SetValidationText
- CDaoTableDef [MFC], m_pDAOTableDef
- CDaoTableDef [MFC], m_pDatabase
ms.assetid: 7c5d2254-8475-43c4-8a6c-2d32ead194c9
ms.openlocfilehash: 61e16ef2998f2b807e96368973711dfdb31dcc45
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87223126"
---
# <a name="cdaotabledef-class"></a>Класс Кдаотабледеф

Представляет хранимое определение базовой или подключенной таблицы.

## <a name="syntax"></a>Синтаксис

```
class CDaoTableDef : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание:|
|----------|-----------------|
|[Кдаотабледеф:: Кдаотабледеф](#cdaotabledef)|Формирует объект `CDaoTableDef`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание:|
|----------|-----------------|
|[Кдаотабледеф:: Append](#append)|Добавляет новую таблицу в базу данных.|
|[Кдаотабледеф:: Канупдате](#canupdate)|Возвращает ненулевое значение, если таблица может быть обновлена (можно изменить определение полей или свойства таблицы).|
|[Кдаотабледеф:: Close](#close)|Закрывает открытый объект tabledef.|
|[Кдаотабледеф:: Create](#create)|Создает таблицу, которую можно добавить в базу данных с помощью функции [append](#append).|
|[Кдаотабледеф:: Креатефиелд](#createfield)|Вызывается для создания поля для таблицы.|
|[Кдаотабледеф:: CreateIndex](#createindex)|Вызывается для создания индекса таблицы.|
|[Кдаотабледеф::D Елетефиелд](#deletefield)|Вызывается для удаления поля из таблицы.|
|[Кдаотабледеф::D Елетеиндекс](#deleteindex)|Вызывается для удаления индекса из таблицы.|
|[Кдаотабледеф:: OutAttribute](#getattributes)|Возвращает значение, указывающее одну или несколько характеристик `CDaoTableDef` объекта.|
|[Кдаотабледеф:: соединение](#getconnect)|Возвращает значение, которое предоставляет сведения об источнике таблицы.|
|[Кдаотабледеф:: Жетдатекреатед](#getdatecreated)|Возвращает дату и время создания базовой таблицы, лежащей в основе `CDaoTableDef` объекта.|
|[Кдаотабледеф:: Жетдателаступдатед](#getdatelastupdated)|Возвращает дату и время последнего изменения, внесенного в структуру базовой таблицы.|
|[Кдаотабледеф:: Жетфиелдкаунт](#getfieldcount)|Возвращает значение, представляющее количество полей в таблице.|
|[Кдаотабледеф:: Жетфиелдинфо](#getfieldinfo)|Возвращает определенные виды информации о полях в таблице.|
|[Кдаотабледеф:: Жетиндекскаунт](#getindexcount)|Возвращает количество индексов для таблицы.|
|[Кдаотабледеф:: Жетиндексинфо](#getindexinfo)|Возвращает определенные типы сведений о индексах для таблицы.|
|[Кдаотабледеф:: Name](#getname)|Возвращает определяемое пользователем имя таблицы.|
|[Кдаотабледеф:: Жетрекордкаунт](#getrecordcount)|Возвращает количество записей в таблице.|
|[Кдаотабледеф:: Жетсаурцетабленаме](#getsourcetablename)|Возвращает значение, указывающее имя присоединенной таблицы в базе данных-источнике.|
|[Кдаотабледеф:: Жетвалидатионруле](#getvalidationrule)|Возвращает значение, которое проверяет данные в поле при изменении или добавлении в таблицу.|
|[Кдаотабледеф:: Жетвалидатионтекст](#getvalidationtext)|Возвращает значение, указывающее текст сообщения, которое отображается в приложении, если значение объекта поля не удовлетворяет указанному правилу проверки.|
|[Кдаотабледеф:: OnOpen](#isopen)|Если таблица открыта, возвращает ненулевое значение.|
|[Кдаотабледеф:: Open](#open)|Открывает существующий объект tabledef, хранящийся в коллекции Табледеф'с базы данных.|
|[Кдаотабледеф:: Рефрешлинк](#refreshlink)|Обновляет сведения о соединении для присоединенной таблицы.|
|[Кдаотабледеф:: Сетаттрибутес](#setattributes)|Задает значение, которое указывает одну или несколько характеристик `CDaoTableDef` объекта.|
|[Кдаотабледеф:: Сетконнект](#setconnect)|Задает значение, которое предоставляет сведения об источнике таблицы.|
|[Кдаотабледеф:: SetName](#setname)|Задает имя таблицы.|
|[Кдаотабледеф:: Сетсаурцетабленаме](#setsourcetablename)|Задает значение, указывающее имя присоединенной таблицы в базе данных-источнике.|
|[Кдаотабледеф:: Сетвалидатионруле](#setvalidationrule)|Задает значение, которое проверяет данные в поле при изменении или добавлении в таблицу.|
|[Кдаотабледеф:: Сетвалидатионтекст](#setvalidationtext)|Задает значение, указывающее текст сообщения, которое отображается в приложении, если значение объекта поля не удовлетворяет указанному правилу проверки.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание:|
|----------|-----------------|
|[Кдаотабледеф:: m_pDAOTableDef](#m_pdaotabledef)|Указатель на интерфейс DAO, лежащий в основе объекта tabledef.|
|[Кдаотабледеф:: m_pDatabase](#m_pdatabase)|База данных источника для этой таблицы.|

## <a name="remarks"></a>Remarks

Каждый объект базы данных DAO поддерживает коллекцию, называемую TableDef, которая содержит все сохраненные объекты DAO tabledef.

Вы управляете определением таблицы с помощью `CDaoTableDef` объекта. Например, вы можете:

- Изучите структуру полей и индексов любой локальной, присоединенной или внешней таблицы в базе данных.

- Вызывайте `SetConnect` `SetSourceTableName` функции элементов и для присоединенных таблиц и используйте `RefreshLink` функцию члена для обновления соединений с присоединенными таблицами.

- Вызовите `CanUpdate` функцию члена, чтобы определить, можно ли изменять определения полей в таблице.

- Получение или установка условий проверки с помощью `GetValidationRule` функций и и `SetValidationRule` `GetValidationText` `SetValidationText` .

- Используйте `Open` функцию-член для создания объекта типа "Таблица — динамический набор" или "моментальный снимок" `CDaoRecordset` .

    > [!NOTE]
    >  Классы базы данных DAO отличаются от классов баз данных MFC, основанных на открытом подключении к базам данных (ODBC). Все имена классов баз данных DAO имеют префикс "Кдао". Вы по-прежнему можете обращаться к источникам данных ODBC с помощью классов DAO. классы DAO обычно предлагают превосходные возможности, поскольку они характерны для ядра СУБД Microsoft Jet.

### <a name="to-use-tabledef-objects-either-to-work-with-an-existing-table-or-to-create-a-new-table"></a>Использование объектов tabledef для работы с существующей таблицей или для создания новой таблицы

1. Во всех случаях сначала создайте `CDaoTableDef` объект, указав указатель на объект [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) , которому принадлежит таблица.

1. Затем выполните следующие действия в зависимости от того, что вам нужно:

   - Чтобы использовать существующую сохраненную таблицу, вызовите функцию [Open](#open) Member объекта tabledef, указав имя сохраненной таблицы.

   - Чтобы создать новую таблицу, вызовите функцию-член [CREATE](#create) объекта tabledef, указав имя таблицы. Вызовите [креатефиелд](#createfield) и [CreateIndex](#createindex) , чтобы добавить поля и индексы в таблицу.

   - Вызовите метод [append](#append) , чтобы сохранить таблицу, добавив ее в коллекцию tabledef базы данных. `Create`помещает объект tabledef в открытое состояние, поэтому после вызова метода `Create` не вызывается `Open` .

        > [!TIP]
        >  Самый простой способ создать сохраненные таблицы — создать их и сохранить в базе данных с помощью Microsoft Access. Затем их можно открыть и использовать в коде MFC.

Чтобы использовать открытый или созданный объект tabledef, создайте и откройте `CDaoRecordset` объект, указав имя объекта tabledef со `dbOpenTable` значением в параметре *нопентипе* .

Чтобы использовать объект tabledef для создания `CDaoRecordset` объекта, обычно создается или открывается объект tabledef, как описано выше, затем создается объект набора записей, передающий указатель на объект tabledef при вызове [CDaoRecordset:: Open](../../mfc/reference/cdaorecordset-class.md#open). Передаваемый объект tabledef должен находиться в открытом состоянии. Дополнительные сведения см. в разделе Class [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md).

По завершении использования объекта tabledef вызовите его функцию-член [Close](../../mfc/reference/cdaorecordset-class.md#close) . затем удалите объект tabledef.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoTableDef`

## <a name="requirements"></a>Требования

**Заголовок:** афксдао. h

## <a name="cdaotabledefappend"></a><a name="append"></a>Кдаотабледеф:: Append

Вызовите эту функцию-член после вызова метода [CREATE](#create) , чтобы создать новый объект tabledef для сохранения объекта tabledef в базе данных.

```
virtual void Append();
```

### <a name="remarks"></a>Remarks

Функция добавляет объект в коллекцию объектов TableDef базы данных. Объект tabledef можно использовать в качестве временного объекта при его определении, не добавляя его, но если вы хотите сохранить и использовать его, необходимо вызвать `Append` .

> [!NOTE]
> При попытке добавить неименованный объект tabledef (содержащий null или пустую строку) MFC создает исключение.

Связанные сведения см. в разделе "метод Append" справки DAO.

## <a name="cdaotabledefcanupdate"></a><a name="canupdate"></a>Кдаотабледеф:: Канупдате

Вызовите эту функцию-член, чтобы определить, `CDaoTableDef` может ли быть изменено определение базовой таблицы объекта.

```
BOOL CanUpdate();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если структура таблицы (схема) может быть изменена (Добавление или удаление полей и индексов); в противном случае — значение 0.

### <a name="remarks"></a>Remarks

По умолчанию вновь созданную таблицу, лежащую в основе `CDaoTableDef` объекта, можно обновить, а присоединяемую таблицу, лежащую в основе `CDaoTableDef` объекта, нельзя обновить. `CDaoTableDef`Объект может быть обновляемым, даже если результирующий набор записей невозможно обновить.

Связанные сведения см. в разделе "обновляемое свойство" справки DAO.

## <a name="cdaotabledefcdaotabledef"></a><a name="cdaotabledef"></a>Кдаотабледеф:: Кдаотабледеф

Формирует объект `CDaoTableDef`.

```
CDaoTableDef(CDaoDatabase* pDatabase);
```

### <a name="parameters"></a>Параметры

*пдатабасе*<br/>
Указатель на объект [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) .

### <a name="remarks"></a>Remarks

После создания объекта необходимо вызвать функцию члена [CREATE](#create) или [Open](#open) . После завершения работы с объектом необходимо вызвать его [закрытую](#close) функцию Member и уничтожить `CDaoTableDef` объект.

## <a name="cdaotabledefclose"></a><a name="close"></a>Кдаотабледеф:: Close

Вызовите эту функцию члена, чтобы закрыть и освободить объект tabledef.

```
virtual void Close();
```

### <a name="remarks"></a>Remarks

Обычно после вызова `Close` удаляется объект tabledef, если он был выделен с помощью **`new`** .

После вызова метод [Open](#open) можно вызвать снова `Close` . Это позволяет повторно использовать объект tabledef.

Дополнительные сведения см. в разделе «метод закрытия» справки DAO.

## <a name="cdaotabledefcreate"></a><a name="create"></a>Кдаотабледеф:: Create

Вызовите эту функцию-член, чтобы создать новую сохраненную таблицу.

```
virtual void Create(
    LPCTSTR lpszName,
    long lAttributes = 0,
    LPCTSTR lpszSrcTable = NULL,
    LPCTSTR lpszConnect = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строку, содержащую имя таблицы.

*латтрибутес*<br/>
Значение, соответствующее характеристикам таблицы, представленной объектом tabledef. Побитовое или можно использовать для объединения любой из следующих констант:

|Константа|Описание|
|--------------|-----------------|
|`dbAttachExclusive`|Для баз данных, использующих ядро СУБД Microsoft Jet, указывает, что таблица является присоединенной таблицей, открытой для монопольного использования.|
|`dbAttachSavePWD`|Для баз данных, использующих ядро СУБД Microsoft Jet, указывает, что идентификатор пользователя и пароль для присоединенной таблицы сохраняются вместе со сведениями о соединении.|
|`dbSystemObject`|Указывает, что таблица является системной таблицей, предоставляемой ядром СУБД Microsoft Jet.|
|`dbHiddenObject`|Указывает, что таблица является скрытой таблицей, предоставляемой ядром СУБД Microsoft Jet.|

*лпсзсрктабле*<br/>
Указатель на строку, содержащую имя исходной таблицы. По умолчанию это значение инициализируется как NULL.

*лпсзконнект*<br/>
Указатель на строку, содержащую строку подключения по умолчанию. По умолчанию это значение инициализируется как NULL.

### <a name="remarks"></a>Remarks

После именования объектов tabledef можно вызвать метод [append](#append) , чтобы сохранить объект tabledef в коллекции объектов tabledef базы данных. После вызова `Append` объект tabledef находится в открытом состоянии, и его можно использовать для создания объекта [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) .

Связанные сведения см. в разделе «метод Креатетабледеф» справки DAO.

## <a name="cdaotabledefcreatefield"></a><a name="createfield"></a>Кдаотабледеф:: Креатефиелд

Вызовите эту функцию-член, чтобы добавить поле в таблицу.

```cpp
void CreateField(
    LPCTSTR lpszName,
    short nType,
    long lSize,
    long lAttributes = 0);

void CreateField(CDaoFieldInfo& fieldinfo);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строковое выражение, задающее имя этого поля.

*nType*<br/>
Значение типа, указывающее тип данных поля. Параметр может принимать одно из следующих значений:

|Тип|Размер (в байтах)|Описание:|
|----------|--------------------|-----------------|
|`dbBoolean`|1 байт|BOOL|
|`dbByte`|BYTE|
|`dbInteger`|2|INT|
|`dbLong`|4|long|
|`dbCurrency`|8|Валюта ( [COleCurrency](../../mfc/reference/colecurrency-class.md))|
|`dbSingle`|4|FLOAT|
|`dbDouble`|8|double|
|`dbDate`|8|Дата и время ( [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md))|
|`dbText`|1 - 255|Text ( [CString](../../atl-mfc-shared/reference/cstringt-class.md))|
|`dbLongBinary`|0|Long Binary (объект OLE), [CLongBinary](../../mfc/reference/clongbinary-class.md) или [CByteArray](../../mfc/reference/cbytearray-class.md)|
|`dbMemo`|0|МЕМО ( [CString](../../atl-mfc-shared/reference/cstringt-class.md))|

*лсизе*<br/>
Значение, указывающее максимальный размер (в байтах) поля, содержащего текст, или фиксированного размера поля, содержащего текстовые или числовые значения. Параметр *лсизе* игнорируется для всех полей, Кроме текстовых.

*латтрибутес*<br/>
Значение, соответствующее характеристикам поля и которое можно комбинировать с помощью побитового или.

|Константа|Описание|
|--------------|-----------------|
|`dbFixedField`|Поле имеет фиксированный размер (по умолчанию для числовых полей).|
|`dbVariableField`|Размер поля — переменная (только текстовые поля).|
|`dbAutoIncrField`|Значение поля для новых записей автоматически увеличивается до уникального длинного целого числа, которое нельзя изменить. Поддерживается только для таблиц базы данных Microsoft Jet.|
|`dbUpdatableField`|Значение поля можно изменить.|
|`dbDescending`|Поле сортируется в порядке убывания (Z-A или 100-0) (применяется только к объекту Field в коллекции полей объекта index). Если опустить эту константу, поле будет отсортировано в порядке возрастания (A – Z или 0-100) (по умолчанию).|

*FieldInfo*<br/>
Ссылка на структуру [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) .

### <a name="remarks"></a>Remarks

`DAOField`Создается объект (OLE), который добавляется в коллекцию Fields `DAOTableDef` объекта (OLE). Помимо использования для проверки свойств объекта, можно также использовать `CDaoFieldInfo` для создания входного параметра для создания новых полей в объекте tabledef. Первая версия `CreateField` проще в использовании, но если требуется более точный контроль, можно использовать вторую версию `CreateField` , которая принимает `CDaoFieldInfo` параметр.

Если используется версия `CreateField` , которая принимает `CDaoFieldInfo` параметр, необходимо тщательно задать каждый из следующих элементов `CDaoFieldInfo` структуры:

- `m_strName`

- `m_nType`

- `m_lSize`

- `m_lAttributes`

- `m_bAllowZeroLength`

Остальные члены `CDaoFieldInfo` должны иметь значение **0**, false или пустую строку, в зависимости от элемента, или `CDaoException` может возникнуть ошибка.

Связанные сведения см. в разделе «метод Креатефиелд» справки DAO.

## <a name="cdaotabledefcreateindex"></a><a name="createindex"></a>Кдаотабледеф:: CreateIndex

Вызовите эту функцию, чтобы добавить индекс в таблицу.

```cpp
void CreateIndex(CDaoIndexInfo& indexinfo);
```

### <a name="parameters"></a>Параметры

*индексинфо*<br/>
Ссылка на структуру [кдаоиндексинфо](../../mfc/reference/cdaoindexinfo-structure.md) .

### <a name="remarks"></a>Remarks

Индексы определяют порядок записей, доступ к которым осуществляется из таблиц базы данных, а также указывает, принимаются ли дублирующие записи. Индексы также обеспечивают эффективный доступ к данным.

Нет необходимости создавать индексы для таблиц, но в больших неиндексированных таблицах доступ к определенной записи или создание набора записей может занять много времени. С другой стороны, создание слишком большого количества индексов замедляет операции обновления, добавления и удаления, так как все индексы обновляются автоматически. При выборе создаваемых индексов учитывайте эти факторы.

`CDaoIndexInfo`Необходимо задать следующие члены структуры:

- `m_strName`Необходимо указать имя.

- `m_pFieldInfos`Должен указывать на массив `CDaoIndexFieldInfo` структур.

- `m_nFields`Необходимо указать число полей в массиве `CDaoFieldInfo` структур.

Остальные элементы будут пропущены, если задано значение FALSE. Кроме того, `m_lDistinctCount` во время создания индекса элемент игнорируется.

## <a name="cdaotabledefdeletefield"></a><a name="deletefield"></a>Кдаотабледеф::D Елетефиелд

Вызовите эту функцию-член, чтобы удалить поле и сделать его недоступным.

```cpp
void DeleteField(LPCTSTR lpszName);
void DeleteField(int nIndex);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строковое выражение, которое является именем существующего поля.

*ниндекс*<br/>
Индекс поля в коллекции полей с отсчетом от нуля для поиска по индексу.

### <a name="remarks"></a>Remarks

Эту функцию-член можно использовать для нового объекта, который не был добавлен в базу данных, или когда [канупдате](#canupdate) возвращает ненулевое значение.

Связанные сведения см. в разделе «Удаление метода» справки DAO.

## <a name="cdaotabledefdeleteindex"></a><a name="deleteindex"></a>Кдаотабледеф::D Елетеиндекс

Вызовите эту функцию члена, чтобы удалить индекс в базовой таблице.

```cpp
void DeleteIndex(LPCTSTR lpszName);
void DeleteIndex(int nIndex);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строковое выражение, которое является именем существующего индекса.

*ниндекс*<br/>
Индекс массива объекта index в коллекции TableDef, начинающейся с нуля, для поиска по индексу.

### <a name="remarks"></a>Remarks

Эту функцию-член можно использовать для нового объекта, который не был добавлен в базу данных, или когда [канупдате](#canupdate) возвращает ненулевое значение.

Связанные сведения см. в разделе «Удаление метода» справки DAO.

## <a name="cdaotabledefgetattributes"></a><a name="getattributes"></a>Кдаотабледеф:: OutAttribute

Для `CDaoTableDef` объекта возвращаемое значение указывает характеристики таблицы, представленной `CDaoTableDef` объектом, и может быть суммой этих констант:

```
long GetAttributes();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение, указывающее одну или несколько характеристик `CDaoTableDef` объекта.

### <a name="remarks"></a>Remarks

|Константа|Описание|
|--------------|-----------------|
|`dbAttachExclusive`|Для баз данных, использующих ядро СУБД Microsoft Jet, указывает, что таблица является присоединенной таблицей, открытой для монопольного использования.|
|`dbAttachSavePWD`|Для баз данных, использующих ядро СУБД Microsoft Jet, указывает, что идентификатор пользователя и пароль для присоединенной таблицы сохраняются вместе со сведениями о соединении.|
|`dbSystemObject`|Указывает, что таблица является системной таблицей, предоставляемой ядром СУБД Microsoft Jet.|
|`dbHiddenObject`|Указывает, что таблица является скрытой таблицей, предоставляемой ядром СУБД Microsoft Jet.|
|`dbAttachedTable`|Указывает, что таблица является присоединенной таблицей из базы данных, отличной от ODBC, например базы данных Paradox.|
|`dbAttachedODBC`|Указывает, что таблица является присоединенной таблицей из базы данных ODBC, например Microsoft SQL Server.|

Системная таблица — это таблица, созданная ядром базы данных Microsoft Jet для хранения различных внутренних данных.

Скрытая таблица — это таблица, созданная для временного использования ядром базы данных Microsoft Jet.

Дополнительные сведения см. в разделе «свойство Attributes» справки DAO.

## <a name="cdaotabledefgetconnect"></a><a name="getconnect"></a>Кдаотабледеф:: соединение

Вызовите эту функцию-член, чтобы получить строку подключения для источника данных.

```
CString GetConnect();
```

### <a name="return-value"></a>Возвращаемое значение

`CString`Объект, содержащий путь и тип базы данных для таблицы.

### <a name="remarks"></a>Remarks

Для `CDaoTableDef` объекта, представляющего присоединенную таблицу, `CString` объект состоит из одной или двух частей (спецификатор типа базы данных и путь к базе данных).

Путь, как показано в таблице ниже, представляет собой полный путь к каталогу, содержащему файлы базы данных, которому должен предшествовать идентификатор "DATABASE =". В некоторых случаях (как и в случае с базами данных Microsoft Jet и Microsoft Excel) в аргументе пути к базе данных содержится определенное имя файла.

Таблица в [кдаотабледеф:: сетконнект](#setconnect) показывает возможные типы баз данных и соответствующие им описатели и пути к базам данных:

Для базовых таблиц базы данных Microsoft Jet описатель является пустой строкой ("").

Если пароль является обязательным, но не указан, драйвер ODBC отображает диалоговое окно входа при первом обращении к таблице и снова, если соединение закрыто и повторно открыто. Если присоединенная таблица имеет `dbAttachSavePWD` атрибут, то при повторном открытии таблицы запрос на вход не появляется.

Дополнительные сведения см. в разделе «свойство Connect» справки DAO.

## <a name="cdaotabledefgetdatecreated"></a><a name="getdatecreated"></a>Кдаотабледеф:: Жетдатекреатед

Вызовите эту функцию, чтобы определить дату и время создания таблицы, лежащей в основе `CDaoTableDef` объекта.

```
COleDateTime GetDateCreated();
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа, содержащее дату и время создания таблицы, лежащей в основе `CDaoTableDef` объекта.

### <a name="remarks"></a>Remarks

Параметры даты и времени производятся на основе компьютера, на котором была создана или обновлена базовая таблица. В многопользовательской среде пользователи должны получить эти параметры непосредственно с файлового сервера, чтобы избежать расхождений. то есть все клиенты должны использовать "Стандартный" источник времени (возможно, с одного сервера).

Связанные сведения см. в подразделе «DateCreated, свойства LastUpdated» справки DAO.

## <a name="cdaotabledefgetdatelastupdated"></a><a name="getdatelastupdated"></a>Кдаотабледеф:: Жетдателаступдатед

Вызовите эту функцию, чтобы определить дату и время последнего обновления таблицы, лежащей в основе `CDaoTableDef` объекта.

```
COleDateTime GetDateLastUpdated();
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа, содержащее дату и время последнего обновления таблицы, лежащей в основе `CDaoTableDef` объекта.

### <a name="remarks"></a>Remarks

Параметры даты и времени производятся на основе компьютера, на котором была создана или обновлена базовая таблица. В многопользовательской среде пользователи должны получить эти параметры непосредственно с файлового сервера, чтобы избежать расхождений. то есть все клиенты должны использовать "Стандартный" источник времени (возможно, с одного сервера).

Связанные сведения см. в подразделе «DateCreated, свойства LastUpdated» справки DAO.

## <a name="cdaotabledefgetfieldcount"></a><a name="getfieldcount"></a>Кдаотабледеф:: Жетфиелдкаунт

Вызовите эту функцию члена, чтобы получить количество полей, определенных в таблице.

```
short GetFieldCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число полей в таблице.

### <a name="remarks"></a>Remarks

Если его значение равно 0, в коллекции отсутствуют объекты.

Связанные сведения см. в разделе "свойство Count" справки DAO.

## <a name="cdaotabledefgetfieldinfo"></a><a name="getfieldinfo"></a>Кдаотабледеф:: Жетфиелдинфо

Вызовите эту функцию-член для получения различных видов информации о поле, определенном в tabledef.

```cpp
void GetFieldInfo(
    int nIndex,
    CDaoFieldInfo& fieldinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetFieldInfo(
    LPCTSTR lpszName,
    CDaoFieldInfo& fieldinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Индекс объекта поля в коллекции полей с отсчетом от нуля для поиска по индексу.

*FieldInfo*<br/>
Ссылка на структуру [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) .

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о поле следует извлечь. Ниже перечислены доступные параметры, а также то, что вызывает возврат функции.

- `AFX_DAO_PRIMARY_INFO`Параметры Имя, тип, размер, атрибуты. Используйте этот параметр для обеспечения максимальной производительности.

- `AFX_DAO_SECONDARY_INFO`Первичная информация, плюс: порядковый номер, обязательный параметр, разрешена нулевая длина, порядок сортировки, внешнее имя, исходное поле, исходная таблица

- `AFX_DAO_ALL_INFO`Первичная и дополнительная информация, плюс: правило проверки, текст проверки, значение по умолчанию

*лпсзнаме*<br/>
Указатель на имя объекта поля для поиска по имени. Имя представляет собой строку длиной до 64 символов, которая уникально именует поле.

### <a name="remarks"></a>Remarks

Одна версия функции позволяет искать поле по индексу. Другая версия позволяет искать поле по имени.

Описание возвращаемых сведений см. в разделе Структура [CDaoFieldInfo](../../mfc/reference/cdaofieldinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. При запросе информации на одном уровне вы также получаете сведения для всех предыдущих уровней.

Дополнительные сведения см. в разделе «свойство Attributes» справки DAO.

## <a name="cdaotabledefgetindexcount"></a><a name="getindexcount"></a>Кдаотабледеф:: Жетиндекскаунт

Вызовите эту функцию-член, чтобы получить количество индексов для таблицы.

```
short GetIndexCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число индексов для таблицы.

### <a name="remarks"></a>Remarks

Если его значение равно 0, в коллекции нет индексов.

Связанные сведения см. в разделе "свойство Count" справки DAO.

## <a name="cdaotabledefgetindexinfo"></a><a name="getindexinfo"></a>Кдаотабледеф:: Жетиндексинфо

Вызовите эту функцию члена, чтобы получить различные типы сведений о индексе, определенном в tabledef.

```cpp
void GetIndexInfo(
    int nIndex,
    CDaoIndexInfo& indexinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetIndexInfo(
    LPCTSTR lpszName,
    CDaoIndexInfo& indexinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Числовой индекс объекта index в коллекции индексов, начинающийся с нуля, для поиска по его позиции в коллекции.

*индексинфо*<br/>
Ссылка на структуру [кдаоиндексинфо](../../mfc/reference/cdaoindexinfo-structure.md) .

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о индексе следует извлечь. Ниже перечислены доступные параметры, а также то, что вызывает возврат функции.

- `AFX_DAO_PRIMARY_INFO`Имя, сведения о поле, поля. Используйте этот параметр для обеспечения максимальной производительности.

- `AFX_DAO_SECONDARY_INFO`Первичная информация, а также: первичный, уникальный, кластеризованный, пропуск значений NULL, обязательный, внешний

- `AFX_DAO_ALL_INFO`Первичная и дополнительная информация, а также: число различных объектов

*лпсзнаме*<br/>
Указатель на имя объекта индекса, для поиска по имени.

### <a name="remarks"></a>Remarks

Одна версия функции позволяет выполнять поиск индекса по его позиции в коллекции. Другая версия позволяет искать индекс по имени.

Описание возвращаемых сведений см. в разделе Структура [кдаоиндексинфо](../../mfc/reference/cdaoindexinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. При запросе информации на одном уровне вы также получаете сведения для всех предыдущих уровней.

Дополнительные сведения см. в разделе «свойство Attributes» справки DAO.

## <a name="cdaotabledefgetname"></a><a name="getname"></a>Кдаотабледеф:: Name

Вызовите эту функцию-член, чтобы получить определяемое пользователем имя базовой таблицы.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

Определяемое пользователем имя таблицы.

### <a name="remarks"></a>Remarks

Это имя начинается с буквы и может содержать не более 64 символов. Он может содержать цифры и символы подчеркивания, но не может содержать знаки препинания и пробелы.

Связанные сведения см. в разделе "свойство Name" справки DAO.

## <a name="cdaotabledefgetrecordcount"></a><a name="getrecordcount"></a>Кдаотабледеф:: Жетрекордкаунт

Вызовите эту функцию-член, чтобы узнать, сколько записей находится в `CDaoTableDef` объекте.

```
long GetRecordCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число записей, к которым осуществлялось обращение в объекте tabledef.

### <a name="remarks"></a>Remarks

Вызов `GetRecordCount` для объекта табличного типа `CDaoTableDef` отражает приблизительное количество записей в таблице и сразу же задействуется при добавлении и удалении записей таблицы. Откат транзакций будет отображаться как часть счетчика записей, пока не будет вызван метод [кдаоворкспаце:: компактдатабасе](../../mfc/reference/cdaoworkspace-class.md#compactdatabase). `CDaoTableDef`Объект без записей имеет значение свойства счетчик записей, равное 0. При работе с присоединенными таблицами или базами данных ODBC `GetRecordCount` всегда возвращает значение-1.

Связанные сведения см. в разделе «свойство RecordCount» справки DAO.

## <a name="cdaotabledefgetsourcetablename"></a><a name="getsourcetablename"></a>Кдаотабледеф:: Жетсаурцетабленаме

Вызовите эту функцию-член, чтобы получить имя присоединенной таблицы в базе данных-источнике.

```
CString GetSourceTableName();
```

### <a name="return-value"></a>Возвращаемое значение

`CString`Объект, указывающий имя источника присоединенной таблицы или пустую строку, если собственная таблица данных.

### <a name="remarks"></a>Remarks

Присоединенная таблица является таблицей в другой базе данных, связанной с базой данных Microsoft Jet. Данные для присоединенных таблиц остаются во внешней базе данных, где их можно манипулировать другими приложениями.

Связанные сведения см. в разделе «свойство SourceTableName» справки DAO.

## <a name="cdaotabledefgetvalidationrule"></a><a name="getvalidationrule"></a>Кдаотабледеф:: Жетвалидатионруле

Вызовите эту функцию-член, чтобы получить правило проверки для объектов tabledef.

```
CString GetValidationRule();
```

### <a name="return-value"></a>Возвращаемое значение

`CString`Объект, проверяющий данные в поле при изменении или добавлении в таблицу.

### <a name="remarks"></a>Remarks

Правила проверки используются в связи с операциями обновления. Если объект tabledef содержит правило проверки, обновления для этого tabledef должны соответствовать предварительно заданным условиям перед изменением данных. Если изменение не соответствует критериям, выдается исключение, содержащее значение [жетвалидатионтекст](#getvalidationtext) . Для `CDaoTableDef` объекта это `CString` значение доступно только для чтения для присоединенной таблицы, а для чтения и записи — для базовой таблицы.

Связанные сведения см. в разделе "свойство ValidationRule" справки DAO.

## <a name="cdaotabledefgetvalidationtext"></a><a name="getvalidationtext"></a>Кдаотабледеф:: Жетвалидатионтекст

Вызовите эту функцию, чтобы получить строку, которая будет отображаться, когда пользователь вводит данные, не соответствующие правилу проверки.

```
CString GetValidationText();
```

### <a name="return-value"></a>Возвращаемое значение

`CString`Объект, указывающий текст, отображаемый, если пользователь вводит данные, не соответствующие правилу проверки.

### <a name="remarks"></a>Remarks

Для `CDaoTableDef` объекта это `CString` значение доступно только для чтения для присоединенной таблицы, а для чтения и записи — для базовой таблицы.

Связанные сведения см. в разделе «свойство Валидатионтекст» справки DAO.

## <a name="cdaotabledefisopen"></a><a name="isopen"></a>Кдаотабледеф:: OnOpen

Вызовите эту функцию-член, чтобы определить `CDaoTableDef` , открыт ли объект в данный момент.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если `CDaoTableDef` объект открыт; в противном случае — 0.

### <a name="remarks"></a>Remarks

## <a name="cdaotabledefm_pdatabase"></a><a name="m_pdatabase"></a>Кдаотабледеф:: m_pDatabase

Содержит указатель на объект [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) для этой таблицы.

### <a name="remarks"></a>Remarks

## <a name="cdaotabledefm_pdaotabledef"></a><a name="m_pdaotabledef"></a>Кдаотабледеф:: m_pDAOTableDef

Содержит указатель на интерфейс OLE для объекта DAO tabledef, лежащего в основе `CDaoTableDef` объекта.

### <a name="remarks"></a>Remarks

Используйте этот указатель, если требуется прямой доступ к интерфейсу DAO.

## <a name="cdaotabledefopen"></a><a name="open"></a>Кдаотабледеф:: Open

Вызовите эту функцию-член, чтобы открыть объект tabledef, сохраненный ранее в коллекции Табледеф'с базы данных.

```
virtual void Open(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строку, указывающую имя таблицы.

### <a name="remarks"></a>Remarks

## <a name="cdaotabledefrefreshlink"></a><a name="refreshlink"></a>Кдаотабледеф:: Рефрешлинк

Вызовите эту функцию члена, чтобы обновить сведения о соединении для присоединенной таблицы.

```cpp
void RefreshLink();
```

### <a name="remarks"></a>Remarks

Сведения о соединении для присоединенной таблицы изменяются путем вызова [сетконнект](#setconnect) для соответствующего `CDaoTableDef` объекта и последующего использования `RefreshLink` функции члена для обновления информации. При вызове `RefreshLink` Свойства присоединенной таблицы не изменяются.

Чтобы принудительно применить измененные сведения о соединении, все открытые объекты [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) , основанные на этом tabledef, должны быть закрыты.

Связанные сведения см. в разделе «метод Рефрешлинк» справки DAO.

## <a name="cdaotabledefsetattributes"></a><a name="setattributes"></a>Кдаотабледеф:: Сетаттрибутес

Задает значение, которое указывает одну или несколько характеристик `CDaoTableDef` объекта.

```cpp
void SetAttributes(long lAttributes);
```

### <a name="parameters"></a>Параметры

*латтрибутес*<br/>
Характеристики таблицы, представленной `CDaoTableDef` объектом, и могут быть суммой этих констант:

|Константа|Описание|
|--------------|-----------------|
|`dbAttachExclusive`|Для баз данных, использующих ядро СУБД Microsoft Jet, указывает, что таблица является присоединенной таблицей, открытой для монопольного использования.|
|`dbAttachSavePWD`|Для баз данных, использующих ядро СУБД Microsoft Jet, указывает, что идентификатор пользователя и пароль для присоединенной таблицы сохраняются вместе со сведениями о соединении.|
|`dbSystemObject`|Указывает, что таблица является системной таблицей, предоставляемой ядром СУБД Microsoft Jet.|
|`dbHiddenObject`|Указывает, что таблица является скрытой таблицей, предоставляемой ядром СУБД Microsoft Jet.|

### <a name="remarks"></a>Remarks

При задании нескольких атрибутов их можно объединить, суммируя соответствующие константы с помощью оператора побитового или. `dbAttachExclusive`При настройке в неприсоединенной таблице создается исключение. Объединение следующих значений также приводит к возникновению исключения:

- **Дбаттачексклусиве &#124; Дбаттачедодбк**

- **Дбаттачсавепвд &#124; Дбаттачедтабле**

Дополнительные сведения см. в разделе «свойство Attributes» справки DAO.

## <a name="cdaotabledefsetconnect"></a><a name="setconnect"></a>Кдаотабледеф:: Сетконнект

Для `CDaoTableDef` объекта, представляющего присоединенную таблицу, объект строки состоит из одной или двух частей (спецификатора типа базы данных и пути к базе данных).

```cpp
void SetConnect(LPCTSTR lpszConnect);
```

### <a name="parameters"></a>Параметры

*лпсзконнект*<br/>
Указатель на строковое выражение, указывающий дополнительные параметры для передачи в ODBC или устанавливаемые драйверы ISAM.

### <a name="remarks"></a>Remarks

Путь, как показано в таблице ниже, представляет собой полный путь к каталогу, содержащему файлы базы данных, которому должен предшествовать идентификатор "DATABASE =". В некоторых случаях (как и в случае с базами данных Microsoft Jet и Microsoft Excel) в аргументе пути к базе данных содержится определенное имя файла.

> [!NOTE]
> Не включайте пробелы в инструкции Path равенства in в формате "DATABASE = Drive: \\ \пас". Это приведет к созданию исключения и сбою подключения.

В следующей таблице показаны возможные типы баз данных и соответствующие им описатели и пути.

|Тип базы данных|Описатель|путь|
|-------------------|---------------|----------|
|База данных с помощью ядра СУБД Jet|"[ `database`];"|" `drive` : \\ \  *путь* \\ \  *имя_файла*. ФОРМАТЕ|
|dBASE III|"dBASE III;"|" `drive` : \\ \  *путь*"|
|dBASE IV|"dBASE IV;"|" `drive` : \\ \  *путь*"|
|dBASE 5|"dBASE 5,0;"|" `drive` : \\ \  *путь*"|
|Paradox 3. x|"Paradox 3. x;"|" `drive` : \\ \  *путь*"|
|Paradox 4. x|"Paradox 4. x;"|" `drive` : \\ \  *путь*"|
|Paradox 5. x|"Paradox 5. x;"|" `drive` : \\ \  *путь*"|
|Excel 3,0|"Excel 3,0;"|" `drive` : \\ \  *путь* \\ \  *имя_файла*. XLS|
|Excel 4,0|"Excel 4,0;"|" `drive` : \\ \  *путь* \\ \  *имя_файла*. XLS|
|Excel 5,0 или Excel 95|"Excel 5,0;"|" `drive` : \\ \  *путь* \\ \  *имя_файла*. XLS|
|Excel 97|"Excel 8,0;"|" `drive` : \\ \  *путь* \  *имя_файла*. XLS|
|Импорт HTML|"Импорт HTML;"|" `drive` : \\ \  *путь* \  *имя_файла*"|
|Экспорт HTML|"Экспорт HTML;"|" `drive` : \\ \  *путь*"|
|Text|"Text;"|"диск: \\ \пас"|
|ODBC|СОЕДИНЕНИЯ БАЗА данных = `database` ; UID = *пользователь*; PWD = *пароль*; DSN = *источник данных;* LOGINTIMEOUT = *секунды;*" (Это может быть не полная строка подключения для всех серверов. это лишь пример. Очень важно, чтобы между параметрами не было пробелов.)|Нет|
|Exchange|Сообщения<br /><br /> МАПИЛЕВЕЛ = *FolderPath*;<br /><br /> [TABLETYPE = {0 &#124; 1};]<br /><br /> [Профиль = *профиль*;]<br /><br /> [PWD = *пароль*;]<br /><br /> [База данных = `database` ;] "|*"диск*: \\ \  *путь* \\ \  *имя_файла*. ФОРМАТЕ|

> [!NOTE]
> Таблица Btrieve больше не поддерживается в DAO 3,5.

\\В строках подключения необходимо использовать двойную обратную косую черту ( \\ ). Если вы изменили свойства существующего соединения с помощью `SetConnect` , необходимо затем вызвать [рефрешлинк](#refreshlink). Если вы инициализируют свойства соединения с помощью `SetConnect` , не нужно вызывать метод `RefreshLink` , но если вы решите сделать это, сначала добавьте объект tabledef.

Если пароль является обязательным, но не указан, драйвер ODBC отображает диалоговое окно входа при первом обращении к таблице и снова, если соединение закрыто и повторно открыто.

Вы можете задать строку соединения для `CDaoTableDef` объекта, указав исходный аргумент для `Create` функции-члена. Чтобы определить тип, путь, идентификатор пользователя, пароль или источник данных ODBC для базы данных, можно проверить параметр. Дополнительные сведения см. в документации по конкретному драйверу.

Дополнительные сведения см. в разделе «свойство Connect» справки DAO.

## <a name="cdaotabledefsetname"></a><a name="setname"></a>Кдаотабледеф:: SetName

Вызовите эту функцию-член, чтобы задать определяемое пользователем имя для таблицы.

```cpp
void SetName(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Указатель на строковое выражение, задающее имя таблицы.

### <a name="remarks"></a>Remarks

Имя должно начинаться с буквы и может содержать не более 64 символов. Он может содержать цифры и символы подчеркивания, но не может содержать знаки препинания и пробелы.

Связанные сведения см. в разделе "свойство Name" справки DAO.

## <a name="cdaotabledefsetsourcetablename"></a><a name="setsourcetablename"></a>Кдаотабледеф:: Сетсаурцетабленаме

Вызовите эту функцию-член, чтобы указать имя присоединенной таблицы или имя базовой таблицы, на которой `CDaoTableDef` основан объект, так как он существует в исходном источнике данных.

```cpp
void SetSourceTableName(LPCTSTR lpszSrcTableName);
```

### <a name="parameters"></a>Параметры

*лпсзсрктабленаме*<br/>
Указатель на строковое выражение, задающее имя таблицы во внешней базе данных. Для базовой таблицы параметр является пустой строкой ("").

### <a name="remarks"></a>Remarks

Затем необходимо вызвать [рефрешлинк](#refreshlink). Этот параметр свойства пуст для базовой таблицы, а чтение и запись для присоединенной таблицы или объекта, не присоединенного к коллекции.

Связанные сведения см. в разделе «свойство SourceTableName» справки DAO.

## <a name="cdaotabledefsetvalidationrule"></a><a name="setvalidationrule"></a>Кдаотабледеф:: Сетвалидатионруле

Вызовите эту функцию-член, чтобы задать правило проверки для объектов tabledef.

```cpp
void SetValidationRule(LPCTSTR lpszValidationRule);
```

### <a name="parameters"></a>Параметры

*лпсзвалидатионруле*<br/>
Указатель на строковое выражение, проверяющее операцию.

### <a name="remarks"></a>Remarks

Правила проверки используются в связи с операциями обновления. Если объект tabledef содержит правило проверки, обновления для этого tabledef должны соответствовать предварительно заданным условиям перед изменением данных. Если изменение не соответствует критериям, отображается исключение, содержащее текст [жетвалидатионтекст](#getvalidationtext) .

Проверка поддерживается только для баз данных, использующих ядро СУБД Microsoft Jet. Выражение не может ссылаться на определяемые пользователем функции, агрегатные функции в домене, агрегатные функции SQL или запросы. Правило проверки для `CDaoTableDef` объекта может ссылаться на несколько полей в этом объекте.

Например, для полей с именами *hire_date* и *termination_date*может быть правило проверки:

[!code-cpp[NVC_MFCDatabase#34](../../mfc/codesnippet/cpp/cdaotabledef-class_1.cpp)]

Связанные сведения см. в разделе "свойство ValidationRule" справки DAO.

## <a name="cdaotabledefsetvalidationtext"></a><a name="setvalidationtext"></a>Кдаотабледеф:: Сетвалидатионтекст

Вызовите эту функцию-член, чтобы задать текст исключения правила проверки для `CDaoTableDef` объекта с базовой таблицей, поддерживаемой ядром СУБД Microsoft Jet.

```cpp
void SetValidationText(LPCTSTR lpszValidationText);
```

### <a name="parameters"></a>Параметры

*лпсзвалидатионтекст*<br/>
Указатель на строковое выражение, указывающий текст, отображаемый, если входные данные недопустимы.

### <a name="remarks"></a>Remarks

Нельзя задать текст проверки присоединенной таблицы.

Связанные сведения см. в разделе «свойство Валидатионтекст» справки DAO.

## <a name="see-also"></a>См. также статью

[CObject, класс](../../mfc/reference/cobject-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)
