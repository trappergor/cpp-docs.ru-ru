---
title: Класс Кколордиалог
ms.date: 11/04/2016
f1_keywords:
- CColorDialog
- AFXDLGS/CColorDialog
- AFXDLGS/CColorDialog::CColorDialog
- AFXDLGS/CColorDialog::DoModal
- AFXDLGS/CColorDialog::GetColor
- AFXDLGS/CColorDialog::GetSavedCustomColors
- AFXDLGS/CColorDialog::SetCurrentColor
- AFXDLGS/CColorDialog::OnColorOK
- AFXDLGS/CColorDialog::m_cc
helpviewer_keywords:
- CColorDialog [MFC], CColorDialog
- CColorDialog [MFC], DoModal
- CColorDialog [MFC], GetColor
- CColorDialog [MFC], GetSavedCustomColors
- CColorDialog [MFC], SetCurrentColor
- CColorDialog [MFC], OnColorOK
- CColorDialog [MFC], m_cc
ms.assetid: d013dc25-9290-4b5d-a97e-95ad7208e13b
ms.openlocfilehash: 54fd987d683a9236531baee3afbb9ee61be623e2
ms.sourcegitcommit: 13f42c339fb7af935e3a93ac80e350d5e784c9f1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2020
ms.locfileid: "87470762"
---
# <a name="ccolordialog-class"></a>Класс Кколордиалог

Позволяет включить в приложение диалоговое окно выбора цвета.

## <a name="syntax"></a>Синтаксис

```
class CColorDialog : public CCommonDialog
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[Кколордиалог:: Кколордиалог](#ccolordialog)|Формирует объект `CColorDialog`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кколордиалог::D Омодал](#domodal)|Отображает диалоговое окно цвета, позволяющее пользователю сделать выбор.|
|[Кколордиалог:: "Color"](#getcolor)|Возвращает `COLORREF` структуру, содержащую значения выбранного цвета.|
|[Кколордиалог:: Жетсаведкустомколорс](#getsavedcustomcolors)|Получает пользовательские цвета, созданные пользователем.|
|[Кколордиалог:: Сеткуррентколор](#setcurrentcolor)|Принудительное выделение текущего цвета указанным цветом.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Описание|
|----------|-----------------|
|[Кколордиалог:: Онколорок](#oncolorok)|Переопределение для проверки цвета, вводимых в диалоговое окно.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[Кколордиалог:: m_cc](#m_cc)|Структура, используемая для настройки параметров диалогового окна.|

## <a name="remarks"></a>Комментарии

`CColorDialog`Объект — это диалоговое окно со списком цветов, определенных для системы вывода. Пользователь может выбрать или создать определенный цвет из списка, который затем возвращается в приложение при выходе из диалогового окна.

Для создания `CColorDialog` объекта используйте предоставленный конструктор или создайте производный от него новый класс и используйте собственный пользовательский конструктор.

После создания диалогового окна можно задать или изменить любые значения в структуре [m_cc](#m_cc) , чтобы инициализировать значения элементов управления диалогового окна. Структура *m_cc* имеет тип [чусеколор](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1).

После инициализации элементов управления диалогового окна вызовите `DoModal` функцию-член, чтобы отобразить диалоговое окно и позволить пользователю выбрать цвет. `DoModal`Возвращает выбор пользователя либо кнопки ОК (ИДОК), либо Cancel (ИДКАНЦЕЛ) диалогового окна.

Если `DoModal` функция ВОЗВРАЩАЕТ идок, `CColorDialog` для получения входных данных пользователем можно использовать одну из функций члена.

Вы можете использовать функцию Windows [коммдлжекстендедеррор](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , чтобы определить, произошла ли ошибка во время инициализации диалогового окна, и получить дополнительные сведения об ошибке.

`CColorDialog`зависит от файла COMMDLG.DLL, поставляемого с Windows версии 3,1 и более поздних версий.

Чтобы настроить диалоговое окно, создайте производный класс от `CColorDialog` , предоставьте пользовательский шаблон диалогового окна и добавьте карту сообщений для обработки сообщений уведомлений из расширенных элементов управления. Все необработанные сообщения должны передаваться в базовый класс.

Настройка функции-обработчика не является обязательной.

> [!NOTE]
> При некоторых установках `CColorDialog` объект не будет отображаться с серым фоном, если платформа использовалась для того, чтобы сделать другие `CDialog` объекты серыми.

Дополнительные сведения об использовании см. в `CColorDialog` разделе [Общие классы диалоговых окон](../../mfc/common-dialog-classes.md) .

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CColorDialog`

## <a name="requirements"></a>Требования

**Заголовок:** афксдлгс. h

## <a name="ccolordialogccolordialog"></a><a name="ccolordialog"></a>Кколордиалог:: Кколордиалог

Формирует объект `CColorDialog`.

```
CColorDialog(
    COLORREF clrInit = 0,
    DWORD dwFlags = 0,
    CWnd* pParentWnd = NULL);
```

### <a name="parameters"></a>Параметры

*клринит*<br/>
Выбор цвета по умолчанию. Если значение не указано, по умолчанию используется RGB (0, 0, 0) (черный).

*dwFlags*<br/>
Набор флагов, которые настраивают функцию и внешний вид диалогового окна. Дополнительные сведения см. в описании структуры [чусеколор](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) в Windows SDK.

*ппарентвнд*<br/>
Указатель на родительский узел или окно-владелец диалогового окна.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#49](../../mfc/codesnippet/cpp/ccolordialog-class_1.cpp)]

## <a name="ccolordialogdomodal"></a><a name="domodal"></a>Кколордиалог::D Омодал

Вызовите эту функцию, чтобы открыть диалоговое окно "общий цвет Windows" и позволить пользователю выбрать цвет.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Возвращаемое значение

ИДОК или ИДКАНЦЕЛ. Если возвращается ИДКАНЦЕЛ, вызовите функцию Windows [коммдлжекстендедеррор](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , чтобы определить, произошла ли ошибка.

ИДОК и ИДКАНЦЕЛ — это константы, которые указывают, выбрал ли пользователь кнопку ОК или Отмена.

### <a name="remarks"></a>Комментарии

Если вы хотите инициализировать различные параметры диалогового окна цвета, установив элементы структуры [m_cc](#m_cc) , это следует сделать до вызова, `DoModal` но после создания объекта диалогового окна.

После вызова `DoModal` можно вызвать другие функции члена для получения параметров или данных, вводимых пользователем, в диалоговое окно.

### <a name="example"></a>Пример

  См. пример для [кколордиалог:: кколордиалог](#ccolordialog).

## <a name="ccolordialoggetcolor"></a><a name="getcolor"></a>Кколордиалог:: "Color"

Вызовите эту функцию после вызова, `DoModal` чтобы получить сведения о выбранном пользователем цвете.

```
COLORREF GetColor() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение [COLORREF](/windows/win32/gdi/colorref) , содержащее сведения о RGB для цвета, выбранного в диалоговом окне "цвет".

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#50](../../mfc/codesnippet/cpp/ccolordialog-class_2.cpp)]

## <a name="ccolordialoggetsavedcustomcolors"></a><a name="getsavedcustomcolors"></a>Кколордиалог:: Жетсаведкустомколорс

`CColorDialog`объекты позволяют пользователю, помимо выбора цветов, определять до 16 пользовательских цветов.

```
static COLORREF* PASCAL GetSavedCustomColors();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на массив из 16 значений цвета RGB, в котором хранятся пользовательские цвета, созданные пользователем.

### <a name="remarks"></a>Комментарии

`GetSavedCustomColors`Функция члена предоставляет доступ к этим цветам. Эти цвета можно получить после того, как [DoModal](#domodal) возвращает идок.

Каждое из 16 значений RGB в возвращаемом массиве инициализируется значением RGB (255255255) (белый цвет). Пользовательские цвета, выбранные пользователем, сохраняются только между вызовами диалогового окна в приложении. Если вы хотите сохранить эти цвета между вызовами приложения, необходимо сохранить их каким-либо другим способом, например в инициализации (. INI-файл).

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#51](../../mfc/codesnippet/cpp/ccolordialog-class_3.cpp)]

## <a name="ccolordialogm_cc"></a><a name="m_cc"></a>Кколордиалог:: m_cc

Структура типа [чусеколор](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1), члены которой хранят характеристики и значения диалогового окна.

```
CHOOSECOLOR m_cc;
```

### <a name="remarks"></a>Комментарии

После создания `CColorDialog` объекта можно использовать *m_cc* , чтобы задать различные аспекты диалогового окна перед вызовом функции-члена [DoModal](#domodal) .

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#53](../../mfc/codesnippet/cpp/ccolordialog-class_4.cpp)]

## <a name="ccolordialogoncolorok"></a><a name="oncolorok"></a>Кколордиалог:: Онколорок

Переопределение для проверки цвета, вводимых в диалоговое окно.

```
virtual BOOL OnColorOK();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если диалоговое окно не должно быть закрыто; в противном случае — 0, чтобы принять указанный цвет.

### <a name="remarks"></a>Комментарии

Переопределяйте эту функцию только в том случае, если требуется обеспечить пользовательскую проверку цвета, выбираемого пользователем в диалоговом окне "цвет".

Пользователь может выбрать цвет одним из следующих двух методов:

- Выбор цвета в палитре цветов. Затем значения RGB выбранного цвета отражаются в соответствующих полях редактирования RGB.

- Ввод значений в поля ввода RGB

Переопределение `OnColorOK` позволяет отклонять цвет, вводимый пользователем в диалоговое окно общего цвета для любых причин, связанных с конкретным приложением.

Как правило, эта функция не требуется, поскольку платформа обеспечивает проверку цветов по умолчанию и отображает окно сообщения, если введен недопустимый цвет.

Можно вызвать [сеткуррентколор](#setcurrentcolor) из в `OnColorOK` , чтобы принудительно выбрать цвет. Когда будет `OnColorOK` запущено (то есть пользователь нажмет кнопку **ОК** , чтобы принять изменение цвета), можно вызвать метод «- [Color](#getcolor) », чтобы получить значение RGB нового цвета.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#52](../../mfc/codesnippet/cpp/ccolordialog-class_5.cpp)]

## <a name="ccolordialogsetcurrentcolor"></a><a name="setcurrentcolor"></a>Кколордиалог:: Сеткуррентколор

Вызывайте эту функцию после вызова `DoModal` для принудительного выбора текущего цвета в качестве значения цвета, указанного в *CLR*.

```cpp
void SetCurrentColor(COLORREF clr);
```

### <a name="parameters"></a>Параметры

*среду*<br/>
Значение цвета RGB.

### <a name="remarks"></a>Комментарии

Эта функция вызывается из обработчика сообщений или `OnColorOK` . Диалоговое окно будет автоматически обновлять выбор пользователя в зависимости от значения параметра *CLR* .

### <a name="example"></a>Пример

  См. пример для [кколордиалог:: онколорок](#oncolorok).

## <a name="see-also"></a>См. также статью

[Образец MDI-формы MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример DRAWCLI для MFC](../../overview/visual-cpp-samples.md)<br/>
[Класс Ккоммондиалог](../../mfc/reference/ccommondialog-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)
