---
title: Класс Кмену
ms.date: 11/04/2016
f1_keywords:
- CMenu
- AFXWIN/CMenu
- AFXWIN/CMenu::CMenu
- AFXWIN/CMenu::AppendMenu
- AFXWIN/CMenu::Attach
- AFXWIN/CMenu::CheckMenuItem
- AFXWIN/CMenu::CheckMenuRadioItem
- AFXWIN/CMenu::CreateMenu
- AFXWIN/CMenu::CreatePopupMenu
- AFXWIN/CMenu::DeleteMenu
- AFXWIN/CMenu::DeleteTempMap
- AFXWIN/CMenu::DestroyMenu
- AFXWIN/CMenu::Detach
- AFXWIN/CMenu::DrawItem
- AFXWIN/CMenu::EnableMenuItem
- AFXWIN/CMenu::FromHandle
- AFXWIN/CMenu::GetDefaultItem
- AFXWIN/CMenu::GetMenuContextHelpId
- AFXWIN/CMenu::GetMenuInfo
- AFXWIN/CMenu::GetMenuItemCount
- AFXWIN/CMenu::GetMenuItemID
- AFXWIN/CMenu::GetMenuItemInfo
- AFXWIN/CMenu::GetMenuState
- AFXWIN/CMenu::GetMenuString
- AFXWIN/CMenu::GetSafeHmenu
- AFXWIN/CMenu::GetSubMenu
- AFXWIN/CMenu::InsertMenu
- AFXWIN/CMenu::InsertMenuItem
- AFXWIN/CMenu::LoadMenu
- AFXWIN/CMenu::LoadMenuIndirect
- AFXWIN/CMenu::MeasureItem
- AFXWIN/CMenu::ModifyMenu
- AFXWIN/CMenu::RemoveMenu
- AFXWIN/CMenu::SetDefaultItem
- AFXWIN/CMenu::SetMenuContextHelpId
- AFXWIN/CMenu::SetMenuInfo
- AFXWIN/CMenu::SetMenuItemBitmaps
- AFXWIN/CMenu::SetMenuItemInfo
- AFXWIN/CMenu::TrackPopupMenu
- AFXWIN/CMenu::TrackPopupMenuEx
- AFXWIN/CMenu::m_hMenu
helpviewer_keywords:
- CMenu [MFC], CMenu
- CMenu [MFC], AppendMenu
- CMenu [MFC], Attach
- CMenu [MFC], CheckMenuItem
- CMenu [MFC], CheckMenuRadioItem
- CMenu [MFC], CreateMenu
- CMenu [MFC], CreatePopupMenu
- CMenu [MFC], DeleteMenu
- CMenu [MFC], DeleteTempMap
- CMenu [MFC], DestroyMenu
- CMenu [MFC], Detach
- CMenu [MFC], DrawItem
- CMenu [MFC], EnableMenuItem
- CMenu [MFC], FromHandle
- CMenu [MFC], GetDefaultItem
- CMenu [MFC], GetMenuContextHelpId
- CMenu [MFC], GetMenuInfo
- CMenu [MFC], GetMenuItemCount
- CMenu [MFC], GetMenuItemID
- CMenu [MFC], GetMenuItemInfo
- CMenu [MFC], GetMenuState
- CMenu [MFC], GetMenuString
- CMenu [MFC], GetSafeHmenu
- CMenu [MFC], GetSubMenu
- CMenu [MFC], InsertMenu
- CMenu [MFC], InsertMenuItem
- CMenu [MFC], LoadMenu
- CMenu [MFC], LoadMenuIndirect
- CMenu [MFC], MeasureItem
- CMenu [MFC], ModifyMenu
- CMenu [MFC], RemoveMenu
- CMenu [MFC], SetDefaultItem
- CMenu [MFC], SetMenuContextHelpId
- CMenu [MFC], SetMenuInfo
- CMenu [MFC], SetMenuItemBitmaps
- CMenu [MFC], SetMenuItemInfo
- CMenu [MFC], TrackPopupMenu
- CMenu [MFC], TrackPopupMenuEx
- CMenu [MFC], m_hMenu
ms.assetid: 40cacfdc-d45c-4ec7-bf28-991c72812499
ms.openlocfilehash: 1cd7be72dc6c9a38fae4f5ccc1a15c184a2d4466
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69505525"
---
# <a name="cmenu-class"></a>Класс Кмену

Инкапсуляция `HMENU`Windows.

## <a name="syntax"></a>Синтаксис

```
class CMenu : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кмену:: Кмену](#cmenu)|Создает объект `CMenu`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CMenu::AppendMenu](#appendmenu)|Добавляет новый элемент в конец этого меню.|
|[Кмену:: Attach](#attach)|Присоединяет к `CMenu` объекту маркер меню Windows.|
|[Кмену:: Чеккменуитем](#checkmenuitem)|Устанавливает галочку рядом с пунктом меню во всплывающем меню или удаляет галочку.|
|[Кмену:: Чеккменурадиоитем](#checkmenuradioitem)|Помещает переключатель рядом с пунктом меню и удаляет переключатель из всех других пунктов меню в группе.|
|[Кмену:: Креатемену](#createmenu)|Создает пустое меню и прикрепляет его к `CMenu` объекту.|
|[Кмену:: Креатепопупмену](#createpopupmenu)|Создает пустое всплывающее меню и прикрепляет его к `CMenu` объекту.|
|[Кмену::D Елетемену](#deletemenu)|Удаляет указанный элемент из меню. Если у пункта меню есть связанное всплывающее меню, уничтожает маркер во всплывающем меню и освобождает используемую им память.|
|[Кмену::D Елететемпмап](#deletetempmap)|Удаляет все временные `CMenu` объекты `FromHandle` , созданные функцией члена.|
|[Кмену::D Естроймену](#destroymenu)|Уничтожает меню, присоединенное к `CMenu` объекту, и освобождает память, занятую меню.|
|[Кмену::D етач](#detach)|Отсоединяет маркер меню Windows от `CMenu` объекта и возвращает маркер.|
|[Кмену::D Равитем](#drawitem)|Вызывается структурой при изменении визуального аспекта рисуемого владельцем меню.|
|[Кмену:: Енаблеменуитем](#enablemenuitem)|Включает, отключает или затемняет (серый цвет) пункт меню.|
|[Кмену:: FromHandle](#fromhandle)|Возвращает указатель на `CMenu` объект, заданный маркером меню Windows.|
|[Кмену:: Жетдефаултитем](#getdefaultitem)|Определяет пункт меню по умолчанию в указанном меню.|
|[Кмену:: Жетменуконтексселпид](#getmenucontexthelpid)|Извлекает идентификатор контекста справки, связанный с меню.|
|[Кмену:: Жетменуинфо](#getmenuinfo)|Извлекает сведения о конкретном меню.|
|[Кмену:: Жетменуитемкаунт](#getmenuitemcount)|Определяет количество элементов в меню всплывающего окна или верхнего уровня.|
|[Кмену:: Жетменуитемид](#getmenuitemid)|Получает идентификатор элемента меню для пункта меню, расположенного в указанной позиции.|
|[Кмену:: Жетменуитеминфо](#getmenuiteminfo)|Извлекает сведения об элементе меню.|
|[Кмену:: Жетменустате](#getmenustate)|Возвращает состояние указанного элемента меню или количество элементов во всплывающем меню.|
|[Кмену:: Жетменустринг](#getmenustring)|Извлекает метку указанного пункта меню.|
|[Кмену:: Жетсафехмену](#getsafehmenu)|Возвращает объект, `CMenu` упакованный этим объектом. `m_hMenu`|
|[Подменю Кмену:: "](#getsubmenu)|Извлекает указатель на всплывающее меню.|
|[CMenu::InsertMenu](#insertmenu)|Вставляет новый элемент меню в указанную позицию, перемещая другие элементы вниз по меню.|
|[Кмену:: Инсертменуитем](#insertmenuitem)|Вставляет новый элемент меню в указанную позицию в меню.|
|[Кмену:: Лоадмену](#loadmenu)|Загружает ресурс меню из исполняемого файла и прикрепляет его к `CMenu` объекту.|
|[Кмену:: Лоадменуиндирект](#loadmenuindirect)|Загружает меню из шаблона меню в память и прикрепляет его к `CMenu` объекту.|
|[Кмену:: Меасуреитем](#measureitem)|Вызывается платформой для определения размеров меню при создании меню, рисуемого владельцем.|
|[CMenu::ModifyMenu](#modifymenu)|Изменяет существующий элемент меню в указанной позиции.|
|[Кмену:: Ремовемену](#removemenu)|Удаляет из указанного меню пункт меню со связанным всплывающим меню.|
|[Кмену:: Сетдефаултитем](#setdefaultitem)|Задает элемент меню по умолчанию для указанного меню.|
|[Кмену:: Сетменуконтексселпид](#setmenucontexthelpid)|Задает идентификатор контекста справки, который должен быть связан с меню.|
|[Кмену:: Сетменуинфо](#setmenuinfo)|Задает сведения о конкретном меню.|
|[Кмену:: Сетменуитембитмапс](#setmenuitembitmaps)|Связывает указанные точечные рисунки галочки с пунктом меню.|
|[Кмену:: Сетменуитеминфо](#setmenuiteminfo)|Изменяет сведения об элементе меню.|
|[Кмену:: метод TrackPopupMenu](#trackpopupmenu)|Отображает плавающее всплывающее меню в указанном расположении и отслеживает выбор элементов во всплывающем меню.|
|[Кмену:: Траккпопупменуекс](#trackpopupmenuex)|Отображает плавающее всплывающее меню в указанном расположении и отслеживает выбор элементов во всплывающем меню.|

### <a name="public-operators"></a>Открытые операторы

|name|Описание|
|----------|-----------------|
|[Кмену:: operator HMENU](#operator_hmenu)|Получает маркер объекта меню.|
|[Кмену:: operator! =](#operator_neq)|Определяет, являются ли два объекта меню неравными.|
|[Кмену:: operator = =](#operator_eq_eq)|Определяет, равны ли два объекта меню.|

### <a name="public-data-members"></a>Открытые члены данных

|name|Описание|
|----------|-----------------|
|[Кмену:: m_hMenu](#m_hmenu)|Задает маркер меню окон, присоединенного к `CMenu` объекту.|

## <a name="remarks"></a>Примечания

Он предоставляет функции-члены для создания, отслеживания, обновления и уничтожения меню.

Создайте объект в кадре стека в качестве локального, а затем `CMenu`функции-члены вызова для управления новым меню по мере необходимости. `CMenu` Затем вызовите [CWnd:: сетмену](../../mfc/reference/cwnd-class.md#setmenu) , чтобы задать для меню окно, а затем сразу же вызвав `CMenu` функцию-член [отсоединения](#detach) объекта. Функция `CWnd::SetMenu` – член устанавливает меню окна в новое меню, вызывает перерисовку окна, чтобы отразить изменение меню, а также передается право на владение окном. Вызов `Detach` отсоединяет HMENU `CMenu` от объекта, поэтому, когда локальная `CMenu` переменная выходит за пределы области видимости, деструктор `CMenu` объекта не пытается уничтожить меню, которое больше не принадлежит. Само меню автоматически уничтожается при уничтожении окна.

Функцию-член [лоадменуиндирект](#loadmenuindirect) можно использовать для создания меню из шаблона в памяти, но меню, созданное из ресурса с помощью вызова [лоадмену](#loadmenu) , проще поддерживать, а сам ресурс меню может быть создан и изменен редактором меню. .

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CMenu`

## <a name="requirements"></a>Требования

**Заголовок:** afxwin.h

##  <a name="appendmenu"></a>Кмену:: Аппендмену

Добавляет новый элемент в конец меню.

```
BOOL AppendMenu(
    UINT nFlags,
    UINT_PTR nIDNewItem = 0,
    LPCTSTR lpszNewItem = NULL);

BOOL AppendMenu(
    UINT nFlags,
    UINT_PTR nIDNewItem,
    const CBitmap* pBmp);
```

### <a name="parameters"></a>Параметры

*нфлагс*<br/>
Указывает сведения о состоянии нового пункта меню при его добавлении в меню. Он состоит из одного или нескольких значений, перечисленных в разделе "Примечания".

*нидневитем*<br/>
Указывает либо идентификатор команды нового пункта меню, либо, если *нфлагс* имеет значение MF_POPUP, маркер меню ( `HMENU`) всплывающего меню. Параметр *нидневитем* игнорируется (не требуется), если для *нфлагс* задано значение MF_SEPARATOR.

*лпсзневитем*<br/>
Задает содержимое нового пункта меню. Параметр *нфлагс* используется для интерпретации *лпсзневитем* следующим образом:

|нфлагс|Интерпретация Лпсзневитем|
|------------|-----------------------------------|
|MF_OWNERDRAW|Содержит предоставляемое приложением 32-разрядное значение, которое приложение может использовать для обслуживания дополнительных данных, связанных с элементом меню. Это 32-разрядное значение доступно приложению при обработке сообщений WM_MEASUREITEM и WM_DRAWITEM. Значение хранится в `itemData` элементе структуры, предоставляемой этими сообщениями.|
|MF_STRING|Содержит указатель на строку, завершающуюся нулем. Это интерпретация по умолчанию.|
|MF_SEPARATOR|Параметр *лпсзневитем* игнорируется (не требуется).|

*pBmp*<br/>
Указывает на `CBitmap` объект, который будет использоваться в качестве пункта меню.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Приложение может указать состояние пункта меню, задав значения в *нфлагс*. Если *нидневитем* указывает всплывающее меню, оно становится частью меню, к которому он добавляется. Если это меню уничтожается, добавленное меню также будет уничтожено. Добавленное меню должно быть отсоединено от `CMenu` объекта, чтобы избежать конфликта. Обратите внимание, что MF_STRING и MF_OWNERDRAW недопустимы для битовой `AppendMenu`версии.

В следующем списке перечислены флаги, которые можно задать в *нфлагс*:

- MF_CHECKED выступает в качестве переключателя с MF_UNCHECKED, чтобы установить флажок по умолчанию рядом с элементом. Когда приложение предоставляет растровые изображения флажков (см. функцию-член [сетменуитембитмапс](#setmenuitembitmaps) ), отображается точечный рисунок галочки вкл.

- MF_UNCHECKED выступает в качестве переключателя с MF_CHECKED, чтобы снять флажок рядом с элементом. Когда приложение предоставляет точечные рисунки галочки (см `SetMenuItemBitmaps` . функцию-член), отображается точечный рисунок галочки.

- MF_DISABLED отключает пункт меню, чтобы его нельзя было выбрать, но не затемнять.

- MF_ENABLED включает пункт меню, чтобы его можно было выбрать, и восстановить его из состояния затемнения.

- MF_GRAYED отключает пункт меню, чтобы его нельзя было выбрать и сделать неактивным.

- MF_MENUBARBREAK помещает элемент на новую строку в статических меню или в новый столбец во всплывающих меню. Новый столбец всплывающего меню будет отделен от старого в вертикальной разделительной линией.

- MF_MENUBREAK помещает элемент на новую строку в статических меню или в новый столбец во всплывающих меню. Между столбцами не размещается разделительная линия.

- MF_OWNERDRAW указывает, что элемент является элементом, рисуемым владельцем. Когда меню отображается в первый раз, окно, которому принадлежит меню, получает сообщение WM_MEASUREITEM, которое получает высоту и ширину пункта меню. Сообщение WM_DRAWITEM отправляется каждый раз, когда владелец должен обновить визуальный вид пункта меню. Этот параметр не является допустимым для пункта меню верхнего уровня.

- MF_POPUP Указывает, что с пунктом меню связано всплывающее меню. Параметр ID задает маркер всплывающего меню, которое должно быть связано с элементом. Используется для добавления всплывающего меню верхнего уровня или иерархического всплывающего меню к пункту всплывающего меню.

- MF_SEPARATOR рисует горизонтальную разделительную линию. Может использоваться только во всплывающем меню. Эта строка не может быть недоступной, отключенной или выделенной. Другие параметры игнорируются.

- MF_STRING указывает, что пункт меню является символьной строкой.

Каждая из следующих групп содержит список флагов, которые являются взаимоисключающими и не могут использоваться вместе.

- MF_DISABLED, MF_ENABLED и MF_GRAYED

- MF_STRING, MF_OWNERDRAW, MF_SEPARATOR и битовая версия

- MF_MENUBARBREAK и MF_MENUBREAK

- MF_CHECKED и MF_UNCHECKED

При изменении меню, находящегося в окне (независимо от того, отображается ли окно), приложение должно вызывать [CWnd::D равменубар](../../mfc/reference/cwnd-class.md#drawmenubar).

### <a name="example"></a>Пример

  См. пример для [кмену:: креатемену](#createmenu).

##  <a name="attach"></a>Кмену:: Attach

Присоединяет существующее меню Windows к `CMenu` объекту.

```
BOOL Attach(HMENU hMenu);
```

### <a name="parameters"></a>Параметры

*hMenu*<br/>
Задает маркер для меню Windows.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если операция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Эта функция не должна вызываться, `CMenu` Если меню уже присоединено к объекту. Маркер меню хранится в `m_hMenu` элементе данных.

Если меню, которым требуется управлять, уже связано с окном, можно использовать функцию [CWnd:: Menu](../../mfc/reference/cwnd-class.md#getmenu) для получения маркера меню.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#21](../../mfc/reference/codesnippet/cpp/cmenu-class_1.cpp)]

##  <a name="checkmenuitem"></a>Кмену:: Чеккменуитем

Добавляет или удаляет флажки в пунктах меню во всплывающем меню.

```
UINT CheckMenuItem(
    UINT nIDCheckItem,
    UINT nCheck);
```

### <a name="parameters"></a>Параметры

*нидчеккитем*<br/>
Указывает элемент меню, который необходимо проверить, как определено параметром *nДополнительные*.

*nДополнительные*<br/>
Указывает, как проверить пункт меню и определить позицию элемента в меню. Параметр *nДополнительные* может быть сочетанием MF_CHECKED или MF_UNCHECKED с флагами MF_BYPOSITION или MF_BYCOMMAND. Эти флаги можно сочетать с помощью побитового оператора или. Они имеют следующие значения:

- MF_BYCOMMAND указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию.

- MF_BYPOSITION указывает, что параметр задает позицию существующего пункта меню. Первый элемент находится в позиции 0.

- MF_CHECKED выступает в качестве переключателя с MF_UNCHECKED, чтобы установить флажок по умолчанию рядом с элементом.

- MF_UNCHECKED выступает в качестве переключателя с MF_CHECKED, чтобы снять флажок рядом с элементом.

### <a name="return-value"></a>Возвращаемое значение

Предыдущее состояние элемента: MF_CHECKED или MF_UNCHECKED или 0xFFFFFFFF, если пункт меню не существовал.

### <a name="remarks"></a>Примечания

Параметр *нидчеккитем* указывает изменяемый элемент.

Параметр *нидчеккитем* может обозначать всплывающий пункт меню, а также пункт меню. Для проверки всплывающего пункта меню не требуется никаких специальных действий. Не удается проверить пункты меню верхнего уровня. Элемент всплывающего меню должен быть проверен по положению, так как с ним не связан идентификатор элемента меню.

### <a name="example"></a>Пример

  См. пример для [кмену:: жетменустате](#getmenustate).

##  <a name="checkmenuradioitem"></a>Кмену:: Чеккменурадиоитем

Проверяет указанный пункт меню и делает его элементом радио.

```
BOOL CheckMenuRadioItem(
    UINT nIDFirst,
    UINT nIDLast,
    UINT nIDItem,
    UINT nFlags);
```

### <a name="parameters"></a>Параметры

*nIDFirst*<br/>
Указывает (в качестве идентификатора или смещения, в зависимости от значения *нфлагс*) первого пункта меню в группе переключателей.

*нидласт*<br/>
Задает (в качестве идентификатора или смещения, в зависимости от значения *нфлагс*) последний пункт меню в группе переключателей.

*нидитем*<br/>
Указывает (в качестве идентификатора или смещения, в зависимости от значения *нфлагс*) элемент в группе, который будет проверяться с помощью переключателя.

*нфлагс*<br/>
Задает интерпретацию *нидфирст*, *нидласт*и *нидитем* следующим образом:

|нфлагс|Интерпретация|
|------------|--------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0.|

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае 0

### <a name="remarks"></a>Примечания

В то же время функция снимает все остальные пункты меню в связанной группе и снимает для этих элементов флаг типа "Радио-элемент". Отмеченный элемент отображается с помощью переключателя (или маркера), а не точечного рисунка галочки.

### <a name="example"></a>Пример

  См. пример для [ON_COMMAND_RANGE](message-map-macros-mfc.md#on_command_range).

##  <a name="cmenu"></a>Кмену:: Кмену

Создает пустое меню и прикрепляет его к `CMenu` объекту.

```
CMenu();
```

### <a name="remarks"></a>Примечания

Меню не создается до тех пор, пока не будет вызвана одна из функций-членов "создать" или "Загрузить"`CMenu:`

- [креатемену](#createmenu)

- [креатепопупмену](#createpopupmenu)

- [лоадмену](#loadmenu)

- [лоадменуиндирект](#loadmenuindirect)

- [Attach](#attach)

##  <a name="createmenu"></a>Кмену:: Креатемену

Создает меню и прикрепляет его к `CMenu` объекту.

```
BOOL CreateMenu();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если меню было успешно создано; в противном случае — 0.

### <a name="remarks"></a>Примечания

Меню изначально пусто. Элементы меню можно добавить с помощью `AppendMenu` функции члена или. `InsertMenu`

Если меню назначено окну, оно автоматически уничтожается при уничтожении окна.

Перед выходом приложение должно освободить системные ресурсы, связанные с меню, если меню не назначено окну. Приложение освобождает меню путем вызова функции-члена [дестроймену](#destroymenu) .

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#22](../../mfc/reference/codesnippet/cpp/cmenu-class_2.cpp)]

##  <a name="createpopupmenu"></a>Кмену:: Креатепопупмену

Создает всплывающее меню и прикрепляет его к `CMenu` объекту.

```
BOOL CreatePopupMenu();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если всплывающее меню было успешно создано; в противном случае — 0.

### <a name="remarks"></a>Примечания

Меню изначально пусто. Элементы меню можно добавить с помощью `AppendMenu` функции члена или. `InsertMenu` Приложение может добавить всплывающее меню в существующее меню или во всплывающее меню. Функцию `TrackPopupMenu` -член можно использовать для отображения этого меню в виде плавающего всплывающего меню и для наблюдения за выбором во всплывающем меню.

Если меню назначено окну, оно автоматически уничтожается при уничтожении окна. Если меню Добавлено в существующее меню, оно автоматически уничтожается при уничтожении этого меню.

Перед выходом приложение должно освободить системные ресурсы, связанные с всплывающим меню, если меню не назначено окну. Приложение освобождает меню путем вызова функции-члена [дестроймену](#destroymenu) .

### <a name="example"></a>Пример

  См. пример для [кмену:: креатемену](#createmenu).

##  <a name="deletemenu"></a>Кмену::D Елетемену

Удаляет элемент из меню.

```
BOOL DeleteMenu(
    UINT nPosition,
    UINT nFlags);
```

### <a name="parameters"></a>Параметры

*Nпозиции*<br/>
Указывает удаляемый элемент меню, определенный параметром *нфлагс*.

*нфлагс*<br/>
Используется для интерпретации *nпозиции* следующим образом:

|нфлагс|Интерпретация Nпозиции|
|------------|---------------------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0.|

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Если у пункта меню есть связанное всплывающее меню, `DeleteMenu` уничтожает маркер во всплывающем меню и освобождает память, используемую во всплывающем меню.

При изменении меню, находящегося в окне (независимо от того, отображается ли окно), приложение должно вызывать [CWnd::D равменубар](../../mfc/reference/cwnd-class.md#drawmenubar).

### <a name="example"></a>Пример

  См. пример для [CWnd:: Menu](../../mfc/reference/cwnd-class.md#getmenu).

##  <a name="deletetempmap"></a>Кмену::D Елететемпмап

Вызывается автоматически `CWinApp` обработчиком времени простоя, удаляет все временные `CMenu` объекты, созданные функцией-членом [FromHandle](#fromhandle) .

```
static void PASCAL DeleteTempMap();
```

### <a name="remarks"></a>Примечания

`DeleteTempMap`Отсоединяет объект меню Windows, присоединенный к временному `CMenu` объекту, перед `CMenu` удалением объекта.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#23](../../mfc/reference/codesnippet/cpp/cmenu-class_3.cpp)]

##  <a name="destroymenu"></a>Кмену::D Естроймену

Уничтожает меню и все используемые ресурсы Windows.

```
BOOL DestroyMenu();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если меню удалено; в противном случае — 0.

### <a name="remarks"></a>Примечания

Меню отсоединяется от `CMenu` объекта перед его уничтожением. Функция Windows `DestroyMenu` автоматически вызывается `CMenu` в деструкторе.

### <a name="example"></a>Пример

  См. пример для [кмену:: креатемену](#createmenu).

##  <a name="detach"></a>Кмену::D етач

Отсоединяет меню Windows от `CMenu` объекта и возвращает маркер.

```
HMENU Detach();
```

### <a name="return-value"></a>Возвращаемое значение

При успешном выполнении маркера типа HMENU в меню Windows. в противном случае — NULL.

### <a name="remarks"></a>Примечания

Элемент `m_hMenu` данных имеет значение null.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#21](../../mfc/reference/codesnippet/cpp/cmenu-class_1.cpp)]

##  <a name="drawitem"></a>Кмену::D Равитем

Вызывается структурой при изменении визуального аспекта рисуемого владельцем меню.

```
virtual void DrawItem(LPDRAWITEMSTRUCT lpDrawItemStruct);
```

### <a name="parameters"></a>Параметры

*лпдравитемструкт*<br/>
Указатель на структуру [дравитемструкт](/windows/win32/api/winuser/ns-winuser-drawitemstruct) , содержащую сведения о типе требуемой прорисовки.

### <a name="remarks"></a>Примечания

`itemAction` Элемент`DRAWITEMSTRUCT` структуры определяет выполняемое действие рисования. Переопределите эту функцию-член, чтобы реализовать Рисование для объекта `CMenu` , рисуемого владельцем. Приложение должно восстановить все объекты интерфейса графических устройств (GDI), выбранные для контекста вывода, указанного в *лпдравитемструкт* перед завершением этой функции-члена.

Описание`DRAWITEMSTRUCT` структуры см. в разделе [CWnd:: ондравитем](../../mfc/reference/cwnd-class.md#ondrawitem) .

### <a name="example"></a>Пример

Следующий код представлен в образце MFC [CTRLTEST](../../overview/visual-cpp-samples.md) :

[!code-cpp[NVC_MFCWindowing#24](../../mfc/reference/codesnippet/cpp/cmenu-class_4.cpp)]

##  <a name="enablemenuitem"></a>Кмену:: Енаблеменуитем

Включает, отключает или затемняет пункт меню.

```
UINT EnableMenuItem(
    UINT nIDEnableItem,
    UINT nEnable);
```

### <a name="parameters"></a>Параметры

*ниденаблеитем*<br/>
Указывает включаемый элемент меню, определенный параметром *ненабле*. Этот параметр может указывать элементы всплывающего меню, а также стандартные элементы меню.

*ненабле*<br/>
Указывает действие, которое необходимо выполнить. Это может быть сочетание MF_DISABLED, MF_ENABLED или MF_GRAYED с MF_BYCOMMAND или MF_BYPOSITION. Эти значения можно комбинировать с помощью оператора побитового или. Эти значения имеют следующее значение:

- MF_BYCOMMAND указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию.

- MF_BYPOSITION указывает, что параметр задает позицию существующего пункта меню. Первый элемент находится в позиции 0.

- MF_DISABLED отключает пункт меню, чтобы его нельзя было выбрать, но не затемнять.

- MF_ENABLED включает пункт меню, чтобы его можно было выбрать, и восстановить его из состояния затемнения.

- MF_GRAYED отключает пункт меню, чтобы его нельзя было выбрать и сделать неактивным.

### <a name="return-value"></a>Возвращаемое значение

Предыдущее состояние (MF_DISABLED, MF_ENABLED или MF_GRAYED) или-1, если оно недопустимо.

### <a name="remarks"></a>Примечания

Функции-члены [креатемену](#createmenu), [инсертмену](#insertmenu), [модифимену](#modifymenu)и [лоадменуиндирект](#loadmenuindirect) также могут устанавливать состояние (включено, отключено или затенено) пункта меню.

Использование значения MF_BYPOSITION требует, чтобы приложение использовало правильное `CMenu`значение. `CMenu` Если используется строка меню, то изменяется пункт меню верхнего уровня (элемент в строке меню). Чтобы задать состояние элемента во всплывающем или вложенном всплывающем меню по положению, приложение должно указать значение `CMenu` из всплывающего меню.

Если в приложении указан флаг MF_BYCOMMAND, Windows проверяет все элементы всплывающего меню, которые являются подчиненными по `CMenu` `CMenu` отношению к, поэтому, если не существует повторяющихся пунктов меню, использование строки меню достаточно.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#25](../../mfc/reference/codesnippet/cpp/cmenu-class_5.cpp)]

##  <a name="fromhandle"></a>Кмену:: FromHandle

Возвращает указатель на `CMenu` объект, заданный в меню маркером Windows.

```
static CMenu* PASCAL FromHandle(HMENU hMenu);
```

### <a name="parameters"></a>Параметры

*hMenu*<br/>
Обработчик Windows для меню.

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект `CMenu` , который может быть временным или постоянным.

### <a name="remarks"></a>Примечания

Если объект еще не присоединен к объекту меню Windows, создается и прикрепляется `CMenu` временный объект. `CMenu`

Этот временный `CMenu` объект действителен до тех пор, пока приложение не найдет время простоя в цикле событий, во время которого все временные объекты будут удалены.

### <a name="example"></a>Пример

  См. пример для [кмену:: креатемену](#createmenu).

##  <a name="getdefaultitem"></a>Кмену:: Жетдефаултитем

Определяет пункт меню по умолчанию в указанном меню.

```
UINT GetDefaultItem(
    UINT gmdiFlags,
    BOOL fByPos = FALSE);
```

### <a name="parameters"></a>Параметры

*гмдифлагс*<br/>
Значение, указывающее, как функция выполняет поиск пунктов меню. Этот параметр может иметь значение None, One или сочетание следующих значений:

|Значение|Значение|
|-----------|-------------|
|GMDI_GOINTOPOPUPS|Указывает, что, если элемент по умолчанию открывает подменю, функция выполняет рекурсивный поиск в соответствующем подменю. Если в подменю нет элемента по умолчанию, возвращаемое значение определяет элемент, открывающий подменю.<br /><br /> По умолчанию функция возвращает первый элемент по умолчанию в указанном меню, независимо от того, является ли он элементом, открывающим подменю.|
|GMDI_USEDISABLED|Указывает, что функция должна возвращать элемент по умолчанию, даже если она отключена.<br /><br /> По умолчанию функция пропускает отключенные или серые элементы.|

*фбипос*<br/>
Значение, указывающее, следует ли извлекать идентификатор элемента меню или его позицию. Если этот параметр имеет значение FALSE, возвращается идентификатор. В противном случае возвращается значение.

### <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение является идентификатором или позицией пункта меню. Если функция завершается ошибкой, возвращается значение-1.

### <a name="remarks"></a>Примечания

Эта функция члена реализует поведение функции Win32 [жетменудефаултитем](/windows/win32/api/winuser/nf-winuser-getmenudefaultitem), как описано в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="getmenucontexthelpid"></a>Кмену:: Жетменуконтексселпид

Извлекает идентификатор контекстной справки, связанный `CMenu`с.

```
DWORD GetMenuContextHelpId() const;
```

### <a name="return-value"></a>Возвращаемое значение

Идентификатор справки контекста, который в настоящее `CMenu` время связан с, если он есть; в противном случае — ноль.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="getmenuinfo"></a>Кмену:: Жетменуинфо

Извлекает сведения о меню.

```
BOOL GetMenuInfo(LPMENUINFO lpcmi) const;
```

### <a name="parameters"></a>Параметры

*лпкми*<br/>
Указатель на структуру [менуинфо](/windows/win32/api/winuser/ns-winuser-menuinfo) , содержащую сведения о меню.

### <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение не равно нулю; в противном случае возвращаемое значение равно нулю.

### <a name="remarks"></a>Примечания

Вызовите эту функцию, чтобы получить сведения о меню.

##  <a name="getmenuitemcount"></a>Кмену:: Жетменуитемкаунт

Определяет количество элементов в меню всплывающего окна или верхнего уровня.

```
UINT GetMenuItemCount() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число элементов в меню, если функция выполнена успешно; в противном случае — 1.

### <a name="example"></a>Пример

  См. пример для [CWnd:: Menu](../../mfc/reference/cwnd-class.md#getmenu).

##  <a name="getmenuitemid"></a>Кмену:: Жетменуитемид

Получает идентификатор элемента меню для пункта меню, расположенного в позиции, определенной параметром *npos*.

```
UINT GetMenuItemID(int nPos) const;
```

### <a name="parameters"></a>Параметры

*nPos*<br/>
Задает позицию (от нуля) элемента меню, идентификатор которого извлекается.

### <a name="return-value"></a>Возвращаемое значение

Идентификатор элемента для указанного элемента во всплывающем меню, если функция выполнена успешно. Если указанный элемент является всплывающим меню (в отличие от элемента во всплывающем меню), возвращается значение-1. Если *npos* соответствует элементу меню разделителя, возвращается значение 0.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="getmenuiteminfo"></a>Кмену:: Жетменуитеминфо

Извлекает сведения об элементе меню.

```
BOOL GetMenuItemInfo(
    UINT uItem,
    LPMENUITEMINFO lpMenuItemInfo,
    BOOL fByPos = FALSE);
```

### <a name="parameters"></a>Параметры

*уитем*<br/>
Идентификатор или позиция пункта меню, сведения о котором нужно получить. Значение этого параметра зависит от значения `ByPos`.

*лпменуитеминфо*<br/>
Указатель на [объектами menuiteminfo](/windows/win32/api/winuser/ns-winuser-menuiteminfow), как описано в Windows SDK, который содержит сведения о меню.

*фбипос*<br/>
Значение, определяющее `nIDItem`значение. По умолчанию `ByPos` имеет значение false, что означает, что уитем является идентификатором пункта меню. Если `ByPos` значение не равно false, то указывает позицию пункта меню.

### <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение не равно нулю. Если функция выполняется неудачно, возвращается нулевое значение. Чтобы получить расширенные сведения об ошибке, используйте [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)функции Win32, как описано в Windows SDK.

### <a name="remarks"></a>Примечания

Эта функция члена реализует поведение функции Win32 [жетменуитеминфо](/windows/win32/api/winuser/nf-winuser-getmenuiteminfow), как описано в Windows SDK. Обратите внимание, что в реализации `GetMenuItemInfo`MFC не используется маркер для меню.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#26](../../mfc/reference/codesnippet/cpp/cmenu-class_6.cpp)]

##  <a name="getmenustate"></a>Кмену:: Жетменустате

Возвращает состояние указанного элемента меню или количество элементов во всплывающем меню.

```
UINT GetMenuState(
    UINT nID,
    UINT nFlags) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Указывает идентификатор пункта меню, как определено параметром *нфлагс*.

*нфлагс*<br/>
Указывает природу *NID*. Может принимать одно из следующих значений:

- MF_BYCOMMAND указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию.

- MF_BYPOSITION указывает, что параметр задает позицию существующего пункта меню. Первый элемент находится в позиции 0.

### <a name="return-value"></a>Возвращаемое значение

Значение 0xFFFFFFFF, если указанный элемент не существует. Если *NID* определяет всплывающее меню, байт высокого порядка содержит количество элементов во всплывающем меню, а младший байт содержит флаги меню, связанные с всплывающим меню. В противном случае возвращаемое значение является маской (Boolean или) значений из следующего списка (Эта маска описывает состояние пункта меню, который *NID* идентифицирует):

- MF_CHECKED выступает в качестве переключателя с MF_UNCHECKED, чтобы установить флажок по умолчанию рядом с элементом. Когда приложение предоставляет точечные рисунки галочки (см `SetMenuItemBitmaps` . функцию-член), отображается точечный рисунок галочки вкл.

- MF_DISABLED отключает пункт меню, чтобы его нельзя было выбрать, но не затемнять.

- MF_ENABLED включает пункт меню, чтобы его можно было выбрать, и восстановить его из состояния затемнения. Обратите внимание, что значение этой константы равно 0; При использовании этого значения приложение не должно проверять значение 0 для сбоя.

- MF_GRAYED отключает пункт меню, чтобы его нельзя было выбрать и сделать неактивным.

- MF_MENUBARBREAK помещает элемент на новую строку в статических меню или в новый столбец во всплывающих меню. Новый столбец всплывающего меню будет отделен от старого в вертикальной разделительной линией.

- MF_MENUBREAK помещает элемент на новую строку в статических меню или в новый столбец во всплывающих меню. Между столбцами не размещается разделительная линия.

- MF_SEPARATOR рисует горизонтальную разделительную линию. Может использоваться только во всплывающем меню. Эта строка не может быть недоступной, отключенной или выделенной. Другие параметры игнорируются.

- MF_UNCHECKED выступает в качестве переключателя с MF_CHECKED, чтобы снять флажок рядом с элементом. Когда приложение предоставляет точечные рисунки галочки (см `SetMenuItemBitmaps` . функцию-член), отображается точечный рисунок галочки. Обратите внимание, что значение этой константы равно 0; При использовании этого значения приложение не должно проверять значение 0 для сбоя.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#27](../../mfc/reference/codesnippet/cpp/cmenu-class_7.cpp)]

##  <a name="getmenustring"></a>Кмену:: Жетменустринг

Копирует метку указанного пункта меню в указанный буфер.

```
int GetMenuString(
    UINT nIDItem,
    LPTSTR lpString,
    int nMaxCount,
    UINT nFlags) const;

int GetMenuString(
    UINT nIDItem,
    CString& rString,
    UINT nFlags) const;
```

### <a name="parameters"></a>Параметры

*нидитем*<br/>
Задает целочисленный идентификатор пункта меню или смещение пункта меню в меню в зависимости от значения *нфлагс*.

*лпстринг*<br/>
Указывает на буфер, который должен получить метку.

*rStr*<br/>
Ссылка на `CString` объект, который получает скопированную строку меню.

*нмакскаунт*<br/>
Задает максимальную длину копируемой метки (в символах). Если длина метки превышает максимальное значение, указанное в *нмакскаунт*, лишние символы усекаются.

*нфлагс*<br/>
Задает интерпретацию параметра *нидитем* . Может принимать одно из следующих значений:

|нфлагс|Интерпретация Нидитем|
|------------|-------------------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0.|

### <a name="return-value"></a>Возвращаемое значение

Задает фактическое число символов, копируемых в буфер, не включая знак завершения null.

### <a name="remarks"></a>Примечания

Параметр *нмакскаунт* должен быть на единицу больше, чем число символов в метке, чтобы разместить символ null, который завершает строку.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="getsafehmenu"></a>Кмену:: Жетсафехмену

Возвращает HMENU, упакованный этим `CMenu` объектом, или указатель null`CMenu` .

```
HMENU GetSafeHmenu() const;
```

### <a name="example"></a>Пример

  См. пример для [кмену:: лоадмену](#loadmenu).

##  <a name="getsubmenu"></a>Подменю Кмену:: "

`CMenu` Извлекает объект всплывающего меню.

```
CMenu* GetSubMenu(int nPos) const;
```

### <a name="parameters"></a>Параметры

*nPos*<br/>
Задает расположение всплывающего меню, содержащегося в меню. Значения позиции начинаются с 0 для первого пункта меню. В этой функции нельзя использовать идентификатор всплывающего меню.

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CMenu` объект, член которого `m_hMenu` содержит маркер для всплывающего меню, если в данной позиции имеется всплывающее меню; в противном случае — null. `CMenu` Если объект не существует, создается временный. Возвращаемый `CMenu` указатель не должен храниться.

### <a name="example"></a>Пример

  См. пример для [кмену:: метод TrackPopupMenu](#trackpopupmenu).

##  <a name="insertmenu"></a>Кмену:: Инсертмену

Вставляет новый элемент меню в позицию, указанную параметром *nпозиции* , и перемещает другие элементы вниз по меню.

```
BOOL InsertMenu(
    UINT nPosition,
    UINT nFlags,
    UINT_PTR nIDNewItem = 0,
    LPCTSTR lpszNewItem = NULL);

BOOL InsertMenu(
    UINT nPosition,
    UINT nFlags,
    UINT_PTR nIDNewItem,
    const CBitmap* pBmp);
```

### <a name="parameters"></a>Параметры

*Nпозиции*<br/>
Указывает пункт меню, перед которым будет вставлен новый элемент меню. Параметр *нфлагс* можно использовать для интерпретации *nпозиции* следующими способами.

|нфлагс|Интерпретация Nпозиции|
|------------|---------------------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0. Если *nпозиции* имеет значение-1, то новый элемент меню добавляется в конец меню.|

*нфлагс*<br/>
Указывает, как *nпозиции* интерпретируется, и указывает сведения о состоянии нового пункта меню при его добавлении в меню. Список флагов, которые можно задать, см. в описании функции-члена [аппендмену](#appendmenu) . Чтобы указать более одного значения, используйте оператор побитового или, чтобы объединить их с флагом MF_BYCOMMAND или MF_BYPOSITION.

*нидневитем*<br/>
Указывает либо идентификатор команды нового пункта меню, либо, если *нфлагс* имеет значение MF_POPUP, маркер меню (HMENU) всплывающего меню. Параметр *нидневитем* игнорируется (не требуется), если для *нфлагс* задано значение MF_SEPARATOR.

*лпсзневитем*<br/>
Задает содержимое нового пункта меню. *нфлагс* можно использовать для интерпретации *лпсзневитем* следующими способами.

|нфлагс|Интерпретация Лпсзневитем|
|------------|-----------------------------------|
|MF_OWNERDRAW|Содержит предоставляемое приложением 32-разрядное значение, которое приложение может использовать для обслуживания дополнительных данных, связанных с элементом меню. Это 32-разрядное значение доступно для приложения в `itemData` члене структуры, предоставляемой сообщениями [WM_MEASUREITEM](/windows/win32/Controls/wm-measureitem) и [WM_DRAWITEM](/windows/win32/Controls/wm-drawitem) . Эти сообщения отправляются при первоначальном отображении или изменении пункта меню.|
|MF_STRING|Содержит длинный указатель на строку, завершающуюся нулем. Это интерпретация по умолчанию.|
|MF_SEPARATOR|Параметр *лпсзневитем* игнорируется (не требуется).|

*pBmp*<br/>
Указывает на `CBitmap` объект, который будет использоваться в качестве пункта меню.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Приложение может указать состояние пункта меню, задав значения в *нфлагс*.

При каждом изменении меню, находящегося в окне (независимо от того, отображается ли окно), приложение должно вызвать `CWnd::DrawMenuBar`.

Если *нидневитем* указывает всплывающее меню, оно становится частью меню, в которое он вставлен. Если это меню уничтожается, вставленное меню также будет уничтожено. Вставленное меню должно быть отсоединено от `CMenu` объекта, чтобы избежать конфликта.

Если дочернее окно активного многодокументного интерфейса (MDI) развернуто, а приложение вставляет всплывающее меню в меню приложения MDI путем вызова этой функции и указания флага MF_BYPOSITION, меню вставляется на одну точку левее, чем требовал. Это происходит потому, что меню элемента управления активного дочернего окна MDI вставляется в первую часть строки меню окна фрейма MDI. Чтобы правильно разместить меню, приложение должно добавить 1 к значению, которое в противном случае было бы использовано. Приложение может использовать сообщение WM_MDIGETACTIVE, чтобы определить, является ли текущее активное дочернее окно развернутым.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#28](../../mfc/reference/codesnippet/cpp/cmenu-class_8.cpp)]

##  <a name="insertmenuitem"></a>Кмену:: Инсертменуитем

Вставляет новый элемент меню в указанную позицию в меню.

```
BOOL InsertMenuItem(
    UINT uItem,
    LPMENUITEMINFO lpMenuItemInfo,
    BOOL fByPos = FALSE);
```

### <a name="parameters"></a>Параметры

*уитем*<br/>
См. Описание *уитем* в [инсертменуитем](/windows/win32/api/winuser/nf-winuser-insertmenuitemw) в Windows SDK.

*лпменуитеминфо*<br/>
См. Описание *лпмии* в `InsertMenuItem` в Windows SDK.

*фбипос*<br/>
См. Описание *фбипоситион* в `InsertMenuItem` в Windows SDK.

### <a name="remarks"></a>Примечания

Эта функция заключает в оболочку [инсертменуитем](/windows/win32/api/winuser/nf-winuser-insertmenuitemw), описанную в Windows SDK.

##  <a name="loadmenu"></a>Кмену:: Лоадмену

Загружает ресурс меню из исполняемого файла приложения и прикрепляет его к `CMenu` объекту.

```
BOOL LoadMenu(LPCTSTR lpszResourceName);
BOOL LoadMenu(UINT nIDResource);
```

### <a name="parameters"></a>Параметры

*лпсзресаурценаме*<br/>
Указывает на строку, завершающуюся нулем, которая содержит имя загружаемого ресурса меню.

*нидресаурце*<br/>
Указывает идентификатор меню загружаемого ресурса меню.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если ресурс меню был успешно загружен; в противном случае — 0.

### <a name="remarks"></a>Примечания

Перед выходом приложение должно освободить системные ресурсы, связанные с меню, если меню не назначено окну. Приложение освобождает меню путем вызова функции-члена [дестроймену](#destroymenu) .

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#29](../../mfc/reference/codesnippet/cpp/cmenu-class_9.cpp)]

##  <a name="loadmenuindirect"></a>Кмену:: Лоадменуиндирект

Загружает ресурс из шаблона меню в память и прикрепляет его к `CMenu` объекту.

```
BOOL LoadMenuIndirect(const void* lpMenuTemplate);
```

### <a name="parameters"></a>Параметры

*лпменутемплате*<br/>
Указывает на шаблон меню (который представляет собой одну [менуитемтемплатехеадер](/windows/win32/api/winuser/ns-winuser-menuitemtemplateheader) структуру и коллекцию из одной или нескольких структур [менуитемтемплате](/windows/win32/api/winuser/ns-winuser-menuitemtemplate) ). Дополнительные сведения об этих двух структурах см. в Windows SDK.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если ресурс меню был успешно загружен; в противном случае — 0.

### <a name="remarks"></a>Примечания

Шаблон меню — это заголовок, за которым следует коллекция из одной или нескольких структур [менуитемтемплате](/windows/win32/api/winuser/ns-winuser-menuitemtemplate) , каждая из которых может содержать один или несколько пунктов меню и всплывающих меню.

Номер версии должен быть равен 0.

`mtOption` Флаги должны включать MF_END для последнего элемента во всплывающем списке и для последнего элемента в главном списке. Дополнительные флаги см. в `AppendMenu` функции члена. Элемент должен быть опущен из структуры менуитемтемплате, если MF_POPUP указан в `mtOption`. `mtId`

Пространство, выделенное для структуры менуитемтемплате, должно быть достаточно `mtString` большим, чтобы оно содержало имя элемента меню в виде строки, завершающейся нулем.

Перед выходом приложение должно освободить системные ресурсы, связанные с меню, если меню не назначено окну. Приложение освобождает меню путем вызова функции-члена [дестроймену](#destroymenu) .

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#30](../../mfc/reference/codesnippet/cpp/cmenu-class_10.cpp)]

##  <a name="m_hmenu"></a>Кмену:: m_hMenu

Задает маркер HMENU меню окон, присоединенного к `CMenu` объекту.

```
HMENU m_hMenu;
```

### <a name="example"></a>Пример

  См. пример для [кмену:: лоадмену](#loadmenu).

##  <a name="measureitem"></a>Кмену:: Меасуреитем

Вызывается структурой при создании меню с стилем рисования владельцем.

```
virtual void MeasureItem(LPMEASUREITEMSTRUCT lpMeasureItemStruct);
```

### <a name="parameters"></a>Параметры

*лпмеасуреитемструкт*<br/>
Указатель на `MEASUREITEMSTRUCT` структуру.

### <a name="remarks"></a>Примечания

По умолчанию эта функция члена не выполняет никаких действий. Переопределите эту функцию члена и заполните `MEASUREITEMSTRUCT` структуру, чтобы информировать окна измерений меню.

Описание`MEASUREITEMSTRUCT` структуры см. в разделе [CWnd:: онмеасуреитем](../../mfc/reference/cwnd-class.md#onmeasureitem) .

### <a name="example"></a>Пример

Следующий код представлен в образце MFC [CTRLTEST](../../overview/visual-cpp-samples.md) :

[!code-cpp[NVC_MFCWindowing#31](../../mfc/reference/codesnippet/cpp/cmenu-class_11.cpp)]

##  <a name="modifymenu"></a>Кмену:: Модифимену

Изменяет существующий элемент меню в позиции, указанной параметром *nпозиции*.

```
BOOL ModifyMenu(
    UINT nPosition,
    UINT nFlags,
    UINT_PTR nIDNewItem = 0,
    LPCTSTR lpszNewItem = NULL);

BOOL ModifyMenu(
    UINT nPosition,
    UINT nFlags,
    UINT_PTR nIDNewItem,
    const CBitmap* pBmp);
```

### <a name="parameters"></a>Параметры

*Nпозиции*<br/>
Указывает изменяемый элемент меню. Параметр *нфлагс* можно использовать для интерпретации *nпозиции* следующими способами.

|нфлагс|Интерпретация Nпозиции|
|------------|---------------------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0.|

*нфлагс*<br/>
Указывает, как *nпозиции* интерпретируется и предоставляет сведения об изменениях, внесенных в пункт меню. Список флагов, которые можно задать, см. в описании функции-члена [аппендмену](#appendmenu) .

*нидневитем*<br/>
Указывает либо идентификатор команды измененного пункта меню, либо, если *нфлагс* имеет значение MF_POPUP, маркер меню (HMENU) всплывающего меню. Параметр *нидневитем* игнорируется (не требуется), если для *нфлагс* задано значение MF_SEPARATOR.

*лпсзневитем*<br/>
Задает содержимое нового пункта меню. Параметр *нфлагс* можно использовать для интерпретации *лпсзневитем* следующими способами.

|нфлагс|Интерпретация Лпсзневитем|
|------------|-----------------------------------|
|MF_OWNERDRAW|Содержит предоставляемое приложением 32-разрядное значение, которое приложение может использовать для обслуживания дополнительных данных, связанных с элементом меню. Это 32-разрядное значение доступно приложению при обработке MF_MEASUREITEM и MF_DRAWITEM.|
|MF_STRING|Содержит длинный указатель на строку, завершающуюся нулем, или на `CString`.|
|MF_SEPARATOR|Параметр *лпсзневитем* игнорируется (не требуется).|

*pBmp*<br/>
Указывает на `CBitmap` объект, который будет использоваться в качестве пункта меню.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Приложение задает новое состояние пункта меню, задавая значения в *нфлагс*. Если эта функция заменяет всплывающее меню, связанное с пунктом меню, оно уничтожает старое всплывающее меню и освобождает память, используемую во всплывающем меню.

Если *нидневитем* указывает всплывающее меню, оно становится частью меню, в которое он вставлен. Если это меню уничтожается, вставленное меню также будет уничтожено. Вставленное меню должно быть отсоединено от `CMenu` объекта, чтобы избежать конфликта.

При каждом изменении меню, находящегося в окне (независимо от того, отображается ли окно), приложение должно вызвать `CWnd::DrawMenuBar`. Чтобы изменить атрибуты существующих элементов меню, гораздо быстрее использовать `CheckMenuItem` функции-члены и. `EnableMenuItem`

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="operator_hmenu"></a>Кмену:: operator HMENU

Используйте этот оператор для получения маркера `CMenu` объекта.

```
operator HMENU() const;
```

### <a name="return-value"></a>Возвращаемое значение

В случае успеха — маркер `CMenu` объекта; в противном случае — значение null.

### <a name="remarks"></a>Примечания

Вы можете использовать этот обработчик для непосредственного вызова интерфейсов API Windows.

##  <a name="operator_neq"></a>Кмену:: operator! =

Определяет, логически не равны два меню.

```
BOOL operator!=(const CMenu& menu) const;
```

### <a name="parameters"></a>Параметры

*меню*<br/>
`CMenu` Объект для сравнения.

### <a name="remarks"></a>Примечания

Проверяет, не равен ли объект меню в левой части объекта меню в правой части.

##  <a name="operator_eq_eq"></a>Кмену:: operator = =

Определяет логическое равенство двух меню.

```
BOOL operator==(const CMenu& menu) const;
```

### <a name="parameters"></a>Параметры

*меню*<br/>
`CMenu` Объект для сравнения.

### <a name="remarks"></a>Примечания

Проверяет, равен ли объект меню в левой части (с точки зрения значения HMENU) объекту меню в правой части.

##  <a name="removemenu"></a>Кмену:: Ремовемену

Удаляет из меню пункт меню со связанным всплывающим меню.

```
BOOL RemoveMenu(
    UINT nPosition,
    UINT nFlags);
```

### <a name="parameters"></a>Параметры

*Nпозиции*<br/>
Указывает удаляемый элемент меню. Параметр *нфлагс* можно использовать для интерпретации *nпозиции* следующими способами.

|нфлагс|Интерпретация Nпозиции|
|------------|---------------------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0.|

*нфлагс*<br/>
Указывает, как интерпретируется *nпозиции* .

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Он не уничтожает маркер всплывающего меню, поэтому меню можно использовать повторно. Перед вызовом этой функции приложение может вызвать `GetSubMenu` функцию-член, чтобы получить всплывающий `CMenu` объект для повторного использования.

При каждом изменении меню, находящегося в окне (независимо от того, отображается ли окно), приложение должно вызвать `CWnd::DrawMenuBar`.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="setdefaultitem"></a>Кмену:: Сетдефаултитем

Задает элемент меню по умолчанию для указанного меню.

```
BOOL SetDefaultItem(
    UINT uItem,
    BOOL fByPos = FALSE);
```

### <a name="parameters"></a>Параметры

*уитем*<br/>
Идентификатор или позиция нового элемента меню по умолчанию или значение-1 для элемента по умолчанию. Значение этого параметра зависит от значения *фбипос*.

*фбипос*<br/>
Значение, определяющее значение *уитем*. Если этот параметр имеет значение FALSE, *уитем* является идентификатором пункта меню. В противном случае это позиция пункта меню.

### <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение не равно нулю. Если функция выполняется неудачно, возвращается нулевое значение. Чтобы получить расширенные сведения об ошибке, используйте [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)функции Win32, как описано в Windows SDK.

### <a name="remarks"></a>Примечания

Эта функция члена реализует поведение функции Win32 [сетменудефаултитем](/windows/win32/api/winuser/nf-winuser-setmenudefaultitem), как описано в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="setmenucontexthelpid"></a>Кмену:: Сетменуконтексселпид

Связывает контекст справки контекста с `CMenu`.

```
BOOL SetMenuContextHelpId(DWORD dwContextHelpId);
```

### <a name="parameters"></a>Параметры

*двконтексселпид*<br/>
ИДЕНТИФИКАТОР контекстной справки, связываемый с `CMenu`.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае 0

### <a name="remarks"></a>Примечания

Все элементы в меню совместно используют этот идентификатор — невозможно прикрепить идентификатор контекста справки к отдельным пунктам меню.

### <a name="example"></a>Пример

  См. пример для [кмену:: инсертмену](#insertmenu).

##  <a name="setmenuinfo"></a>Кмену:: Сетменуинфо

Задает сведения для меню.

```
BOOL SetMenuInfo(LPCMENUINFO lpcmi);
```

### <a name="parameters"></a>Параметры

*лпкми*<br/>
Указатель на структуру [менуинфо](/windows/win32/api/winuser/ns-winuser-menuinfo) , содержащую сведения о меню.

### <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение не равно нулю; в противном случае возвращаемое значение равно нулю.

### <a name="remarks"></a>Примечания

Вызовите эту функцию, чтобы задать конкретные сведения о меню.

##  <a name="setmenuitembitmaps"></a>Кмену:: Сетменуитембитмапс

Связывает указанные растровые изображения с пунктом меню.

```
BOOL SetMenuItemBitmaps(
    UINT nPosition,
    UINT nFlags,
    const CBitmap* pBmpUnchecked,
    const CBitmap* pBmpChecked);
```

### <a name="parameters"></a>Параметры

*Nпозиции*<br/>
Указывает изменяемый элемент меню. Параметр *нфлагс* можно использовать для интерпретации *nпозиции* следующими способами.

|нфлагс|Интерпретация Nпозиции|
|------------|---------------------------------|
|MF_BYCOMMAND|Указывает, что параметр предоставляет идентификатор команды для существующего пункта меню. Это значение по умолчанию, если не задан ни MF_BYCOMMAND, ни MF_BYPOSITION.|
|MF_BYPOSITION|Указывает, что параметр задает позицию существующего элемента меню. Первый элемент находится в позиции 0.|

*нфлагс*<br/>
Указывает, как интерпретируется *nпозиции* .

*пбмпунчеккед*<br/>
Задает точечный рисунок, используемый для элементов меню, которые не отмечены флажком.

*пбмпчеккед*<br/>
Задает растровое изображение, используемое для выбранных элементов меню.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Если элемент меню установлен или снят, Windows отображает соответствующий точечный рисунок рядом с пунктом меню.

Если значение *пбмпунчеккед* или *пбмпчеккед* равно null, то Windows не отображает ничего рядом с пунктом меню для соответствующего атрибута. Если оба параметра имеют значение NULL, Windows использует флажок по умолчанию, если элемент установлен, и снимает флажок, если элемент не отмечен.

При уничтожении меню эти растровые изображения не уничтожаются. приложение должно уничтожить их.

Функция Windows `GetMenuCheckMarkDimensions` извлекает размеры флажка по умолчанию, используемого для пунктов меню. Приложение использует эти значения для определения подходящего размера для точечных рисунков, предоставляемых этой функцией. Получите размер, создайте растровые изображения и задайте их.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#32](../../mfc/reference/codesnippet/cpp/cmenu-class_12.cpp)]

[!code-cpp[NVC_MFCWindowing#33](../../mfc/reference/codesnippet/cpp/cmenu-class_13.cpp)]

##  <a name="setmenuiteminfo"></a>Кмену:: Сетменуитеминфо

Изменяет сведения об элементе меню.

```
BOOL SetMenuItemInfo(
    UINT uItem,
    LPMENUITEMINFO lpMenuItemInfo,
    BOOL fByPos = FALSE);
```

### <a name="parameters"></a>Параметры

*уитем*<br/>
См. Описание *уитем* в [сетменуитеминфо](/windows/win32/api/winuser/nf-winuser-setmenuiteminfow) в Windows SDK.

*лпменуитеминфо*<br/>
См. Описание *лпмии* в `SetMenuItemInfo` в Windows SDK.

*фбипос*<br/>
См. Описание *фбипоситион* в `SetMenuItemInfo` в Windows SDK.

### <a name="remarks"></a>Примечания

Эта функция заключает в оболочку [сетменуитеминфо](/windows/win32/api/winuser/nf-winuser-setmenuiteminfow), описанную в Windows SDK.

##  <a name="trackpopupmenu"></a>Кмену:: метод TrackPopupMenu

Отображает плавающее всплывающее меню в указанном расположении и отслеживает выбор элементов во всплывающем меню.

```
BOOL TrackPopupMenu(
    UINT nFlags,
    int x,
    int y,
    CWnd* pWnd,
    LPCRECT lpRect = 0);
```

### <a name="parameters"></a>Параметры

*нфлагс*<br/>
Задает флаги расположения экрана и мыши. Список доступных флагов см. в разделе [метод TrackPopupMenu](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) .

*x*<br/>
Задает горизонтальное расположение в экранных координатах всплывающего меню. В зависимости от значения параметра *нфлагс* меню можно выровнять по левому краю, по правому краю или по центру относительно этой должности.

*y*<br/>
Задает вертикальное расположение в экранных координатах верхнего края меню на экране.

*Приводится*<br/>
Определяет окно, которому принадлежит всплывающее меню. Этот параметр не может иметь значение NULL, даже если указан флаг TPM_NONOTIFY. Это окно получает все сообщения WM_COMMAND из меню. В версиях Windows 3,1 и более поздних, окно не получает сообщения WM_COMMAND до `TrackPopupMenu` тех пор, пока не вернет. В Windows 3,0 окно получает сообщения WM_COMMAND перед `TrackPopupMenu` возвратом.

*лпрект*<br/>
Не обрабатывается.

### <a name="return-value"></a>Возвращаемое значение

Этот метод возвращает результат вызова [метод TrackPopupMenu](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) в Windows SDK.

### <a name="remarks"></a>Примечания

Плавающее всплывающее меню может находиться в любом месте экрана.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCWindowing#34](../../mfc/reference/codesnippet/cpp/cmenu-class_14.cpp)]

##  <a name="trackpopupmenuex"></a>Кмену:: Траккпопупменуекс

Отображает плавающее всплывающее меню в указанном расположении и отслеживает выбор элементов во всплывающем меню.

```
BOOL TrackPopupMenuEx(
    UINT fuFlags,
    int x,
    int y,
    CWnd* pWnd,
    LPTPMPARAMS lptpm);
```

### <a name="parameters"></a>Параметры

*фуфлагс*<br/>
Задает различные функции для расширенного меню. Список всех значений и их значения см. в разделе [траккпопупменуекс](/windows/win32/api/winuser/nf-winuser-trackpopupmenuex).

*x*<br/>
Задает горизонтальное расположение в экранных координатах всплывающего меню.

*y*<br/>
Задает вертикальное расположение в экранных координатах верхнего края меню на экране.

*Приводится*<br/>
Указатель на окно, которому принадлежит всплывающее меню, и получение сообщений из созданного меню. Это окно может быть любым окном из текущего приложения, но не может иметь значение NULL. Если указать TPM_NONOTIFY в параметре *фуфлагс* , функция не будет передавать сообщения в *приводится*. Функция должна вернуться для окна, на которое указывает *приводится* , для получения сообщения WM_COMMAND.

*лптпм*<br/>
Указатель на структуру [тпмпарамс](/windows/win32/api/winuser/ns-winuser-tpmparams) , указывающую область экрана, которую меню не должно перекрывать. Этот параметр может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Если в параметре *фуфлагс* указано значение TPM_RETURNCMD, то возвращаемым значением будет идентификатор элемента меню элемента, выбранного пользователем. Если пользователь отменяет меню, не выполняя выбор, или если возникает ошибка, возвращается значение 0.

Если не указать TPM_RETURNCMD в параметре *фуфлагс* , то возвращаемое значение будет ненулевым, если функция завершается успешно, и 0 в случае сбоя. Чтобы получить расширенные сведения об ошибке, вызовите [GetLastError](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror).

### <a name="remarks"></a>Примечания

Плавающее всплывающее меню может находиться в любом месте экрана. Дополнительные сведения об обработке ошибок при создании всплывающего меню см. в разделе [траккпопупменуекс](/windows/win32/api/winuser/nf-winuser-trackpopupmenuex).

## <a name="see-also"></a>См. также

[Образец CTRLTEST библиотеки MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример DYNAMENU для MFC](../../overview/visual-cpp-samples.md)<br/>
[Класс CObject](../../mfc/reference/cobject-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CObject](../../mfc/reference/cobject-class.md)
