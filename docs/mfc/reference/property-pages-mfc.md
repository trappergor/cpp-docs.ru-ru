---
title: Страницы свойств (MFC)
ms.date: 11/04/2016
helpviewer_keywords:
- property page data transfer functions in MFC
- property pages [MFC], global MFC functions
ms.assetid: 734f88bc-c776-4136-9b0e-f45c761a45c1
ms.openlocfilehash: 9689d511760752903b83b34199fb035c0e7a8d37
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87214052"
---
# <a name="property-pages-mfc"></a>Страницы свойств (MFC)

Страницы свойств отображают текущие значения свойств элементов управления OLE в настраиваемом графическом интерфейсе для просмотра и редактирования посредством поддержки механизма сопоставления данных на основе обмена данными в диалоговом окне (DDX).

Этот механизм сопоставления данных сопоставляет элементы управления страницы свойств с отдельными свойствами элемента управления OLE. Значение свойства Control отражает состояние или содержимое элемента управления страницы свойств. Сопоставление элементов управления и свойств страницы свойств задается **DDP_ными** вызовами функций в `DoDataExchange` функции-члене страницы свойств. Ниже приведен список функций **DDP_** , которые обмениваются данными, вводимых с помощью страницы свойств элемента управления.

### <a name="property-page-data-transfer"></a>Страница свойств Передача данных

|||
|-|-|
|[DDP_CBIndex](#ddp_cbindex)|Связывает индекс выбранной строки в поле со списком со свойством элемента управления.|
|[DDP_CBString](#ddp_cbstring)|Связывает выбранную строку в поле со списком со свойством элемента управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью совпадать с ней.|
|[DDP_CBStringExact](#ddp_cbstringexact)|Связывает выбранную строку в поле со списком со свойством элемента управления. Выбранная строка и строковое значение свойства должны точно совпадать.|
|[DDP_Check](#ddp_check)|Связывает флажок на странице свойств элемента управления со свойством элемента управления.|
|[DDP_LBIndex](#ddp_lbindex)|Связывает индекс выбранной строки в поле со списком со свойством элемента управления.|
|[DDP_LBString](#ddp_lbstring)|Связывает выбранную строку в поле со списком со свойством элемента управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью совпадать с ней.|
|[DDP_LBStringExact](#ddp_lbstringexact)|Связывает выбранную строку в поле со списком со свойством элемента управления. Выбранная строка и строковое значение свойства должны точно совпадать.|
|[DDP_PostProcessing](#ddp_postprocessing)|Завершает перенос значений свойств из элемента управления.|
|[DDP_Radio](#ddp_radio)|Связывает группу переключателей на странице свойств элемента управления со свойством элемента управления.|
|[DDP_Text](#ddp_text)|Связывает элемент управления на странице свойств элемента управления с свойством элемента управления. Эта функция обрабатывает несколько различных типов свойств, таких как **`double`** , **`short`** , BSTR и **`long`** .|

Дополнительные сведения о `DoDataExchange` функциях и страницах свойств см. в статье [элементы управления ActiveX: страницы свойств](../../mfc/mfc-activex-controls-property-pages.md).

Ниже приведен список макросов, используемых для создания и управления страницами свойств элемента управления OLE.

### <a name="property-pages"></a>Страницы свойств

|||
|-|-|
|[BEGIN_PROPPAGEIDS](#begin_proppageids)|Начинает список идентификаторов страниц свойств.|
|[END_PROPPAGEIDS](#end_proppageids)|Завершает список идентификаторов страниц свойств.|
|[PROPPAGEID](#proppageid)|Объявляет страницу свойств класса Control.|

## <a name="ddp_cbindex"></a><a name="ddp_cbindex"></a>DDP_CBIndex

Вызовите эту функцию в функции страницы свойств, `DoDataExchange` чтобы синхронизировать значение целочисленного свойства с индексом текущего выделения в поле со списком на странице свойств.

```cpp
void AFXAPI DDP_CBIndex(
    CDataExchange* pDX,
    int id,
    int& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "поле со списком", связанный со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства элемента управления, которое должно быть заменено элементом управления "поле со списком", заданным по *идентификатору*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_CBIndex` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_cbstring"></a><a name="ddp_cbstring"></a>DDP_CBString

Вызовите эту функцию в функции страницы свойств, `DoDataExchange` чтобы синхронизировать значение строкового свойства с текущим выделением в поле со списком на странице свойств.

```cpp
void AFXAPI DDP_CBString(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "поле со списком", связанный со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое должно быть заменено строкой поля со списком, заданным по *идентификатору*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_CBString` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_cbstringexact"></a><a name="ddp_cbstringexact"></a>DDP_CBStringExact

Вызовите эту функцию в функции страницы свойств `DoDataExchange` , чтобы синхронизировать значение строкового свойства, которое точно соответствует текущему выделенному фрагменту в поле со списком на странице свойств.

```cpp
void AFXAPI DDP_CBStringExact(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "поле со списком", связанный со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое должно быть заменено строкой поля со списком, заданным по *идентификатору*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_CBStringExact` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_check"></a><a name="ddp_check"></a>DDP_Check

Вызовите эту функцию на странице свойств, `DoDataExchange` чтобы синхронизировать значение свойства со связанным элементом управления флажка страницы свойств.

```cpp
void AFXAPI DDP_Check(
    CDataExchange* pDX,
    int id,
    int & member,
    LPCSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "флажок", связанного со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства элемента управления, которое должно быть заменено элементом управления флажком, заданным по *идентификатору*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_Check` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_lbindex"></a><a name="ddp_lbindex"></a>DDP_LBIndex

Вызовите эту функцию на странице свойств, `DoDataExchange` чтобы синхронизировать значение целочисленного свойства с индексом текущего выделения в поле со списком на странице свойств.

```cpp
void AFXAPI DDP_LBIndex(
    CDataExchange* pDX,
    int id,
    int& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "список", связанного со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое должно быть заменено строкой списка, заданной *идентификатором*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_LBIndex` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_lbstring"></a><a name="ddp_lbstring"></a>DDP_LBString

Вызовите эту функцию на странице свойств, `DoDataExchange` чтобы синхронизировать значение строкового свойства с текущим выделением в поле со списком на странице свойств.

```cpp
void AFXAPI DDP_LBString(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "список", связанного со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое должно быть заменено строкой списка, заданной *идентификатором*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_LBString` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_lbstringexact"></a><a name="ddp_lbstringexact"></a>DDP_LBStringExact

Вызовите эту функцию на странице свойств, `DoDataExchange` чтобы синхронизировать значение строкового свойства, которое точно соответствует текущему выделенному фрагменту в поле со списком на странице свойств.

```cpp
void AFXAPI DDP_LBStringExact(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "список", связанного со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое должно быть заменено строкой списка, заданной *идентификатором*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_LBStringExact` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_postprocessing"></a><a name="ddp_postprocessing"></a>DDP_PostProcessing

Вызовите эту функцию в функции страницы свойств `DoDataExchange` , чтобы завершить перенос значений свойств со страницы свойств в элемент управления при сохранении значений свойств.

```cpp
void AFXAPI DDP_PostProcessing(CDataExchange * pDX);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться после завершения всех функций обмена данными. Пример:

[!code-cpp[NVC_MFCAxCtl#15](../../mfc/reference/codesnippet/cpp/property-pages-mfc_1.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_radio"></a><a name="ddp_radio"></a>DDP_Radio

Вызовите эту функцию в функции элемента управления, `DoPropExchange` чтобы синхронизировать значение свойства со связанным элементом управления "переключатель" страницы свойств.

```cpp
void AFXAPI DDP_Radio(
    CDataExchange* pDX,
    int id,
    int & member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления "переключатель", связанного со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое должно быть заменено переключателем, заданным по *идентификатору*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_Radio` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="ddp_text"></a><a name="ddp_text"></a>DDP_Text

Вызовите эту функцию в функции элемента управления, `DoDataExchange` чтобы синхронизировать значение свойства со связанным элементом управления страницы свойств.

```cpp
void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    BYTE & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    int & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    UINT & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    long & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    DWORD & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    float & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    double & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    CString & member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*pDX*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления, связанного со свойством элемента управления, указанным параметром *псзпропнаме*.

*участниками*<br/>
Переменная-член, связанная с элементом управления страницы свойств, заданным *идентификатором* , и свойством, заданным параметром *псзпропнаме*.

*псзпропнаме*<br/>
Имя свойства свойства элемента управления, которое будет передаваться элементу управления, заданному *идентификатором*.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться перед `DDX_Text` вызовом соответствующей функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="begin_proppageids"></a><a name="begin_proppageids"></a>BEGIN_PROPPAGEIDS

Начинает определение списка идентификаторов страниц свойств элемента управления.

```
BEGIN_PROPPAGEIDS(class_name,  count)
```

### <a name="parameters"></a>Параметры

*class_name*<br/>
Имя класса элемента управления, для которого задаются страницы свойств.

*count*<br/>
Количество страниц свойств, используемых классом элемента управления.

### <a name="remarks"></a>Remarks

В файле реализации (. cpp), который определяет функции-члены для класса, откройте список страниц свойств с помощью макроса BEGIN_PROPPAGEIDS, добавьте записи макросов для каждой страницы свойств и заполните список страниц свойств с помощью макроса END_PROPPAGEIDS.

Дополнительные сведения о страницах свойств см. в статье [элементы управления ActiveX: страницы свойств](../../mfc/mfc-activex-controls-property-pages.md).

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="end_proppageids"></a><a name="end_proppageids"></a>END_PROPPAGEIDS

Завершает определение списка ИДЕНТИФИКАТОРов страниц свойств.

```
END_PROPPAGEIDS(class_name)
```

### <a name="parameters"></a>Параметры

*class_name*<br/>
Имя класса элемента управления, которому принадлежит страница свойств.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="proppageid"></a><a name="proppageid"></a>проппажеид

Добавляет страницу свойств для использования элементом управления OLE.

```
PROPPAGEID(clsid)
```

### <a name="parameters"></a>Параметры

*этому*<br/>
Уникальный идентификатор класса страницы свойств.

### <a name="remarks"></a>Remarks

Все макросы ПРОППАЖЕИД должны располагаться между BEGIN_PROPPAGEIDS и END_PROPPAGEIDS макросами в файле реализации элемента управления.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl. h

## <a name="see-also"></a>См. также раздел

[Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
