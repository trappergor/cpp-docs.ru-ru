---
title: Класс CMetaFileDC | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMetaFileDC
- AFXEXT/CMetaFileDC
- AFXEXT/CMetaFileDC::CMetaFileDC
- AFXEXT/CMetaFileDC::Close
- AFXEXT/CMetaFileDC::CloseEnhanced
- AFXEXT/CMetaFileDC::Create
- AFXEXT/CMetaFileDC::CreateEnhanced
dev_langs:
- C++
helpviewer_keywords:
- CMetaFileDC [MFC], CMetaFileDC
- CMetaFileDC [MFC], Close
- CMetaFileDC [MFC], CloseEnhanced
- CMetaFileDC [MFC], Create
- CMetaFileDC [MFC], CreateEnhanced
ms.assetid: ffce60fa-4181-4d46-9832-25e46fad4db4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: aa9cc938d3738cd789dc648c87eb8bf9b84a6b14
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46414476"
---
# <a name="cmetafiledc-class"></a>Cmetafiledc-класс

Реализует метафайл Windows, который содержит последовательность команд интерфейса графических устройств (GDI), которые можно воспроизвести для создания нужного изображения или текста.

## <a name="syntax"></a>Синтаксис

```
class CMetaFileDC : public CDC
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CMetaFileDC::CMetaFileDC](#cmetafiledc)|Создает объект `CMetaFileDC`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[CMetaFileDC::Close](#close)|Закрывает контекст устройства и создает дескриптор метафайла.|
|[CMetaFileDC::CloseEnhanced](#closeenhanced)|Закрывает контекст устройства расширенного метафайла и создает дескриптор расширенного метафайла.|
|[CMetaFileDC::Create](#create)|Создает контекст устройства метафайла Windows и присоединяет его к `CMetaFileDC` объекта.|
|[CMetaFileDC::CreateEnhanced](#createenhanced)|Создает контекст устройства метафайла для расширенный формат метафайла.|

## <a name="remarks"></a>Примечания

Чтобы реализовать метафайл Windows, сначала создайте `CMetaFileDC` объекта. Вызвать `CMetaFileDC` конструктора, затем вызвать [создать](#create) функцией-членом, которая создает контекст устройства метафайла Windows и присоединяет его к `CMetaFileDC` объекта.

Затем отправьте `CMetaFileDC` объекта последовательность команд CDC GDI, предназначенные для того, чтобы воспроизвести. Только тех команд GDI, которые создают выходные данные, такие как `MoveTo` и `LineTo`, можно использовать.

После отправки нужных команд в метафайл, вызовите `Close` функцией-членом, которая закрывает контексты устройств метафайла и возвращает дескриптор метафайла. Затем `CMetaFileDC` объекта.

[CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#playmetafile) можно затем использовать дескриптор метафайла для воспроизведения метафайла многократно. Метафайл можно также управлять функциями Windows например [CopyMetaFile](/windows/desktop/api/wingdi/nf-wingdi-copymetafilea), метафайл копирование на диск.

Когда метафайла не нужны, удалите его из памяти с [DeleteMetaFile](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile) функции Windows.

Вы также можете реализовать `CMetaFileDC` объект так, чтобы он может обрабатывать оба выходных данных вызовов и атрибут GDI вызовы, например `GetTextExtent`. Такие метафайл является более гибким и можно больше многократно использовать общие GDI-код, который часто состоит из набора выходных данных и атрибута вызовов. `CMetaFileDC` Класс наследует двух контекстах устройств `m_hDC` и `m_hAttribDC`, из CDC. `m_hDC` Контекста устройства отвечает за выполнение всех [CDC](../../mfc/reference/cdc-class.md) GDI вывода вызовы и `m_hAttribDC` контекста устройства обрабатывает все вызовы атрибут CDC GDI. Как правило эти два устройства контекстах см. на то же устройство. В случае использования `CMetaFileDC`, атрибут контроллер домена имеет значение NULL по умолчанию.

Создайте второй контекста устройства, точки экрана, на принтер или устройства, отличного от метафайл, затем вызвать `SetAttribDC` функцию-член для связать новый контекст устройства с `m_hAttribDC`. Вызовы GDI сведения теперь будет направлен к новому `m_hAttribDC`. Вызовов GDI обращается к `m_hDC`, который представляет метафайла.

Дополнительные сведения о `CMetaFileDC`, см. в разделе [контексты устройств](../../mfc/device-contexts.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CDC](../../mfc/reference/cdc-class.md)

`CMetaFileDC`

## <a name="requirements"></a>Требования

**Заголовок:** afxext.h

##  <a name="close"></a>  CMetaFileDC::Close

Закрывает контекст устройства метафайла и создает дескриптор метафайла Windows, который можно использовать для воспроизведения с помощью метафайла [CDC::PlayMetaFile](../../mfc/reference/cdc-class.md#playmetafile) функция-член.

```
HMETAFILE Close();
```

### <a name="return-value"></a>Возвращаемое значение

Допустимые HMETAFILE, если функция выполнена успешно; в противном случае имеет значение NULL.

### <a name="remarks"></a>Примечания

Дескриптор метафайла Windows также может использоваться для управления метафайла с функциями Windows, таких как [CopyMetaFile](/windows/desktop/api/wingdi/nf-wingdi-copymetafilea).

Удалить метафайла после использования, вызвав Windows [DeleteMetaFile](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile) функции.

##  <a name="closeenhanced"></a>  CMetaFileDC::CloseEnhanced

Закрывает контекст устройства расширенного метафайла и возвращает дескриптор, который определяет расширенный формат метафайла.

```
HENHMETAFILE CloseEnhanced();
```

### <a name="return-value"></a>Возвращаемое значение

Дескриптор расширенного метафайла, если выполнение прошло успешно; в противном случае имеет значение NULL.

### <a name="remarks"></a>Примечания

Приложение может использовать дескриптор расширенного метафайла, возвращенной этой функцией для выполнения следующих задач:

- Отображать изображение хранится в расширенный метафайл

- Создание копии расширенный метафайл

- Перечисление, изменить или скопировать отдельных записей в расширенный метафайл

- Извлечь из заголовка расширенного метафайла необязательное описание содержимого метафайл

- Сохраните копию расширенного метафайла заголовка

- Сохраните копию двоичных расширенный метафайл

- Перечислить цвета в палитре необязательно

- Преобразовать расширенный формат метафайла в метафайл Windows формат

Если приложение больше не нужна дескриптор расширенного метафайла, он должен освободить дескриптор, вызвав Win32 `DeleteEnhMetaFile` функции.

##  <a name="cmetafiledc"></a>  CMetaFileDC::CMetaFileDC

Создать `CMetaFileDC` объекта в два этапа.

```
CMetaFileDC();
```

### <a name="remarks"></a>Примечания

Во-первых, вызовите `CMetaFileDC`, затем вызвать `Create`, который создает контексте устройства метафайла Windows и присоединяет его к `CMetaFileDC` объекта.

##  <a name="create"></a>  CMetaFileDC::Create

Создать `CMetaFileDC` объекта в два этапа.

```
BOOL Create(LPCTSTR lpszFilename = NULL);
```

### <a name="parameters"></a>Параметры

*lpszFilename*<br/>
Указывает строку символов с завершающим нулем. Указывает имя файла для создания метафайла. Если *lpszFilename* имеет значение NULL, создается новый метафайла в памяти.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Во-первых, вызовите конструктор `CMetaFileDC`, затем вызвать `Create`, который создает контексте устройства метафайла Windows и присоединяет его к `CMetaFileDC` объекта.

##  <a name="createenhanced"></a>  CMetaFileDC::CreateEnhanced

Создает контекст устройства для расширенный формат метафайла.

```
BOOL CreateEnhanced(
    CDC* pDCRef,
    LPCTSTR lpszFileName,
    LPCRECT lpBounds,
    LPCTSTR lpszDescription);
```

### <a name="parameters"></a>Параметры

*pDCRef*<br/>
Идентифицирует устройство ссылку для расширенного метафайла.

*lpszFileName*<br/>
Указывает строку символов с завершающим нулем. Указывает имя файла для расширенного метафайла должен быть создан. Если этот параметр имеет значение NULL, расширенный метафайл является память базе и его содержимое потеряны при уничтожении объекта или Win32 `DeleteEnhMetaFile` функция вызывается.

*lpBounds*<br/>
Указывает на [RECT](../../mfc/reference/rect-structure1.md) структуру данных или [CRect](../../atl-mfc-shared/reference/crect-class.md) объект, который задает размеры в единицах HIMETRIC (шагом.01 миллиметр) изображения для сохранения в расширенный метафайл.

*lpszDescription*<br/>
Указывает нулем строка, указывающая имя приложения, создавшего рисунок, а также изображения заголовка.

### <a name="return-value"></a>Возвращаемое значение

Дескриптор контекста устройства для расширенного метафайла, если выполнение прошло успешно; в противном случае имеет значение NULL.

### <a name="remarks"></a>Примечания

Этот контроллер домена можно хранить фотографии зависящих от устройства.

Windows использует устройства ссылки, идентифицируемый *pDCRef* параметр для записи разрешения и единицы устройства, на котором находятся изображения. Если *pDCRef* параметра равно NULL, используется для ссылки на текущее устройство отображения.

Члены левом и верхнем `RECT` структуру данных, на которые указывают *lpBounds* параметр должен быть меньше, чем члены справа и снизу, соответственно. На рисунке включаются точки вдоль края прямоугольника. Если *lpBounds* имеет значение NULL, интерфейс графических устройств (GDI) вычисляет размеры наименьший прямоугольник, можно заключить рисунка, нарисованными приложения. *LpBounds* параметр должен быть предоставлен, где это возможно.

Строка, указанная с *lpszDescription* параметр должен содержать символ null между имя приложения и аватар, имя и должно оканчиваться двумя символами null — например, «XYZ графики Editor\0Bald Eagle\0\0, «где \0 представляет символ null. Если *lpszDescription* имеет значение NULL, нет соответствующей записи в заголовке расширенного метафайла.

Приложения используют DC, созданные этой функцией хранить фотографии графики в расширенный метафайл. Дескриптор, идентифицирующий этот контроллер домена может передаваться любой функции GDI.

После приложение сохраняет изображение в расширенный метафайл, то его можно отобразить изображение на любом устройстве выходных данных, путем вызова `CDC::PlayMetaFile` функции. При отображении на рисунке, Windows использует прямоугольника, на которые указывают *lpBounds* параметров и данных разрешения из устройства ссылки для размещения и масштабирования изображения. Контекст устройства, возвращенной этой функцией содержит те же атрибуты по умолчанию, связанные с любого нового контроллера домена.

Приложения должны использовать Win32 `GetWinMetaFileBits` функцию для преобразования расширенный метафайл в старом формате метафайла Windows.

Следует использовать имя файла для расширенного метафайла. Расширение EMF.

## <a name="see-also"></a>См. также

[Класс CDC](../../mfc/reference/cdc-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)



