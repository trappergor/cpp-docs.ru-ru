---
title: Создание безмодальной вкладки свойства | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- modeless property sheets
- property sheets, modeless
- Create method [MFC], property sheets
ms.assetid: eafd8a92-cc67-4a69-a5fb-742c920d1ae8
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 16b0a558dcae7d2bf35cf530abfea15ef6f8138a
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46378102"
---
# <a name="creating-a-modeless-property-sheet"></a>Создание безмодальной вкладки свойства

Как правило страницы свойств, созданные будет модальным. При использовании модальную страницу свойств, пользователь должен закрыть окно свойств, прежде чем использовать любой другой части приложения. В этой статье описаны методы, которые можно использовать для создания немодальный лист свойств, позволяющий пользователю не закрывайте окно свойств при использовании других частей приложения.

Для отображения свойств как немодальное диалоговое окно, а не как модальное диалоговое окно, вызовите [CPropertySheet::Create](../mfc/reference/cpropertysheet-class.md#create) вместо [DoModal](../mfc/reference/cpropertysheet-class.md#domodal). Необходимо также реализовать некоторые дополнительные задачи, для поддержки немодальный лист свойств.

Одной из дополнительных задач обмен данными между окно свойств и внешний объект, который он изменяется, когда открыто окно свойств. Обычно это ту же задачу, что и для стандартных немодальных диалоговых окон. Часть этой задачи реализуется канал связи между немодальный лист свойств и внешний объект, к которому применяются параметры. Эта реализация гораздо проще, если вы наследуете от класса [CPropertySheet](../mfc/reference/cpropertysheet-class.md) для вашей страницы немодального свойств. В этой статье предполагается, что это сделано.

Один из методов для обеспечения связи между немодальный лист свойств и внешнего объекта (текущего выделения в представлении, например) — определить указатель на внешний объект из таблицы свойств. Определить функцию (вызывается примерно `SetMyExternalObject`) в `CPropertySheet`-производного класса, чтобы изменить указатель при каждом изменении фокуса от одного внешнего объекта в другой. `SetMyExternalObject` Функция должна сбросить параметры для каждой страницы свойств в соответствии с вновь выделенный внешний объект. Чтобы выполнить это, `SetMyExternalObject` функция должна быть возможность доступа к [CPropertyPage](../mfc/reference/cpropertypage-class.md) объекты, принадлежащие `CPropertySheet` класса.

Наиболее удобным способом для предоставления доступа к страницы свойств в окне свойств является внедрение `CPropertyPage` объекты в `CPropertySheet`-объект, производный от. Внедрение `CPropertyPage` объекты в `CPropertySheet`-производного объекта отличается от типичный макет для модальные диалоговые окна, где владелец свойств создает `CPropertyPage` объектов и передает их в окно свойств с помощью [ CPropertySheet::AddPage](../mfc/reference/cpropertysheet-class.md#addpage).

Есть много альтернатив пользовательского интерфейса для определения, когда следует применить параметры страницы немодального свойств к внешнему объекту. Альтернативой будет применить параметры текущей страницы свойств, каждый раз, когда пользователь изменяет любое значение. Другой вариант — предоставить кнопки "Применить", на которой пользователь может накапливаться изменения на страницах свойств перед их внесением внешний объект. Сведения о том, как обрабатывать кнопки "Применить", см. в статье [обработка кнопки "Применить"](../mfc/handling-the-apply-button.md).

## <a name="see-also"></a>См. также

[Страницы свойств](../mfc/property-sheets-mfc.md)<br/>
[Обмен данными](../mfc/exchanging-data.md)<br/>
[Жизненный цикл диалогового окна](../mfc/life-cycle-of-a-dialog-box.md)

