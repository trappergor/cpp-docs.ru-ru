---
title: Элементы управления ActiveX в MFC. Доступ к свойствам окружения
ms.date: 11/04/2016
helpviewer_keywords:
- MFC ActiveX controls [MFC], accessing ambient properties
- properties [MFC], accessing ambient
ms.assetid: fdc9db29-e6b0-45d2-a879-8bd60e2058a7
ms.openlocfilehash: e5c78c9943f8baeadcc1198ee8c96f2023ac0215
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84625436"
---
# <a name="mfc-activex-controls-accessing-ambient-properties"></a>Элементы управления ActiveX в MFC. Доступ к свойствам окружения

В этой статье описывается, как элемент управления ActiveX может получить доступ к внешним свойствам контейнера элемента управления.

Элемент управления может получать сведения о своем контейнере путем доступа к внешним свойствам контейнера. Эти свойства предоставляют визуальные характеристики, такие как цвет фона контейнера, текущий шрифт, используемый контейнером, и эксплуатационные характеристики, например доступность контейнера в пользовательском режиме или режиме конструктора. Элемент управления может использовать внешние свойства, чтобы настроить внешний вид и поведение для конкретного контейнера, в котором он внедрен. Тем не менее, элемент управления не должен считать, что его контейнер будет поддерживать любое конкретное внешнее свойство. Фактически, некоторые контейнеры могут не поддерживать все свойства окружения вообще. В отсутствие внешнего свойства элемент управления должен принимать разумное значение по умолчанию.

Чтобы получить доступ к внешнему свойству, выполните вызов [COleControl:: жетамбиентпроперти](reference/colecontrol-class.md#getambientproperty). Эта функция ожидает идентификатор диспетчеризации для внешнего свойства в качестве первого параметра (файл ОЛЕКТЛ. H определяет идентификаторы диспетчеризации для стандартного набора свойств окружения.

Параметры `GetAmbientProperty` функции — это идентификатор диспетчеризации, тег типа Variant, указывающий ожидаемый тип свойства, и указатель на память, где должно возвращаться значение. Тип данных, на который ссылается этот указатель, зависит от тега варианта. Функция возвращает **значение true** , если контейнер поддерживает свойство; в противном случае возвращается **значение false**.

В следующем примере кода получается значение внешнего свойства с именем "пользовательского режима". Если свойство не поддерживается контейнером, предполагается значение по умолчанию **true** :

[!code-cpp[NVC_MFC_AxUI#30](codesnippet/cpp/mfc-activex-controls-accessing-ambient-properties_1.cpp)]

Для вашего удобства `COleControl` предоставляет вспомогательные функции, которые обращаются ко многим часто используемым внешним свойствам и возвращают соответствующие значения по умолчанию, если свойства недоступны. Эти вспомогательные функции выглядят следующим образом.

- [COleControl::AmbientBackColor](reference/colecontrol-class.md#ambientbackcolor)

- [амбиентдисплайнаме](reference/colecontrol-class.md#ambientdisplayname)

- [амбиентфонт](reference/colecontrol-class.md#ambientfont)

    > [!NOTE]
    >  Вызывающий объект должен вызвать `Release( )` для возвращенного шрифта.

- [амбиентфореколор](reference/colecontrol-class.md#ambientforecolor)

- [амбиентлокалеид](reference/colecontrol-class.md#ambientlocaleid)

- [амбиентскалеунитс](reference/colecontrol-class.md#ambientscaleunits)

- [амбиенттексталигн](reference/colecontrol-class.md#ambienttextalign)

- [амбиентусермоде](reference/colecontrol-class.md#ambientusermode)

- [амбиентуидеад](reference/colecontrol-class.md#ambientuidead)

- [амбиентшовхатчинг](reference/colecontrol-class.md#ambientshowhatching)

- [амбиентшовграбхандлес](reference/colecontrol-class.md#ambientshowgrabhandles)

Если значение внешнего свойства изменяется (с помощью какого-либо действия контейнера), `OnAmbientPropertyChanged` вызывается функция-член элемента управления. Переопределите эту функцию-член для обработки такого уведомления. Параметр для `OnAmbientPropertyChanged` — это идентификатор диспетчеризации затронутого внешнего свойства. Значение этого идентификатора диспетчеризации может быть DISPID_UNKNOWN, что означает, что одно или несколько свойств окружения изменились, но сведения о том, какие свойства были затронуты, недоступны.

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](mfc-activex-controls.md)
