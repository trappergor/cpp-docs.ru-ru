---
title: Элементы управления ActiveX в MFC. Оптимизация
ms.date: 09/12/2018
helpviewer_keywords:
- MFC ActiveX controls [MFC], windowless
- flicker-free ActiveX controls
- MFC ActiveX controls [MFC], mouse interaction
- device contexts, unclipped for MFC ActiveX controls
- MFC ActiveX controls [MFC], optimizing
- performance, ActiveX controls
- optimization, ActiveX controls
- MFC ActiveX controls [MFC], flicker-free
- windowless MFC ActiveX controls
- MFC ActiveX controls [MFC], active/inactive state
- optimizing performance, ActiveX controls
ms.assetid: 8b11f26a-190d-469b-b594-5336094a0109
ms.openlocfilehash: b4e12889ca1bb5f4bb423a1f1ede1c396f8d60b5
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84615403"
---
# <a name="mfc-activex-controls-optimization"></a>Элементы управления ActiveX в MFC. Оптимизация

В этой статье описываются методы, с помощью которых можно оптимизировать элементы управления ActiveX для повышения производительности.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которую не следует использовать для новой разработки. Дополнительные сведения о современных технологиях, которые заменяют ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

В этих разделах [отключен параметр активировать при отображении](turning-off-the-activate-when-visible-option.md) и [обеспечивается взаимодействие с мышью во время неактивного](providing-mouse-interaction-while-inactive.md) обсуждения элементов управления, которые не создают окно до момента активации. В разделе, посвященном [активации без окон](providing-windowless-activation.md) , рассматриваются элементы управления, которые никогда не создают окно, даже если они активированы.

У Windows есть два серьезных недостатка для объектов OLE: они предотвращают прозрачность и непрямоугольность объектов, когда они активны, и добавляют большие издержки на создание экземпляров и отображение элементов управления. Как правило, создание окна занимает 60% времени создания элемента управления. При использовании одного общего окна (обычно контейнера) и некоторого кода диспетчеризации элемент управления получает одни и те же службы окон, как правило, без потери производительности. Наличие окна в основном не требует дополнительных затрат на объект.

Некоторые оптимизации не обязательно улучшают производительность, если элемент управления используется в определенных контейнерах. Например, контейнеры, выпущенные до 1996, не поддерживали активацию без окон, поэтому реализация этой функции не обеспечит преимуществ в старых контейнерах. Однако практически каждый контейнер поддерживает сохраняемость, поэтому оптимизация кода сохраняемости элемента управления, скорее всего, повысит его производительность в любом контейнере. Если элемент управления предназначен для использования с одним контейнером определенного типа, может потребоваться исследовать, какие из этих оптимизаций поддерживаются этим контейнером. Однако в общем случае следует попытаться реализовать столько из этих методов, сколько применимо к конкретному элементу управления, чтобы обеспечить выполнение элемента управления, так как он может находиться в широком массиве контейнеров.

Многие из этих оптимизаций можно реализовать с помощью [мастера элементов управления MFC ActiveX](reference/mfc-activex-control-wizard.md)на странице [Параметры управления](reference/control-settings-mfc-activex-control-wizard.md) .

### <a name="mfc-activex-control-wizard-ole-optimization-options"></a>Параметры оптимизации OLE мастера элементов ActiveX в MFC

|Параметр элемента управления в мастере элементов управления ActiveX MFC|Действие|Дополнительные сведения|
|-------------------------------------------------------|------------|----------------------|
|Флажок " **активировать при видимости** "|Clear|[Отключение параметра активировать при отображении](turning-off-the-activate-when-visible-option.md)|
|Флажок **Безоконная активация**|Выберите пункт|[Предоставление безоконной активации](providing-windowless-activation.md)|
|Флажок " **необрезанное устройство** "|Выберите пункт|[Использование необрезанного контекста устройства](using-an-unclipped-device-context.md)|
|Флажок **активации без мерцания**|Выберите пункт|[Обеспечение активации без мерцания](providing-flicker-free-activation.md)|
|Флажок **уведомления указателя мыши при неактивном** флажке|Выберите пункт|[Обеспечение взаимодействия с мышью в неактивном режиме](providing-mouse-interaction-while-inactive.md)|
|Флажок " **оптимизированный код рисунка** "|Выберите пункт|[Оптимизация рисования элемента управления](optimizing-control-drawing.md)|

Подробные сведения о функциях элементов, которые реализуют эти оптимизации, см. в разделе [COleControl](reference/colecontrol-class.md).

Дополнительные сведения можно найти в разделе

- [Оптимизация сохранения и инициализации](optimizing-persistence-and-initialization.md)

- [Предоставление безоконной активации](providing-windowless-activation.md)

- [Отключение параметра активировать при отображении](turning-off-the-activate-when-visible-option.md)

- [Обеспечение взаимодействия с мышью в неактивном режиме](providing-mouse-interaction-while-inactive.md)

- [Обеспечение активации без мерцания](providing-flicker-free-activation.md)

- [Использование необрезанного контекста устройства](using-an-unclipped-device-context.md)

- [Оптимизация рисования элемента управления](optimizing-control-drawing.md)

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](mfc-activex-controls.md)
