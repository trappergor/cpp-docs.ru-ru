---
title: Предупреждение средств компоновщика LNK4049
ms.date: 04/15/2019
f1_keywords:
- LNK4049
helpviewer_keywords:
- LNK4049
ms.assetid: 5fd5fb24-c860-4149-a557-0ac26a65d97c
ms.openlocfilehash: a8e4416eafd47f584de4ab1c83aa7303cab0440a
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80194139"
---
# <a name="linker-tools-warning-lnk4049"></a>Предупреждение средств компоновщика LNK4049

> символ "*symbol*", определенный в файле "*filename. obj*", импортирован

для *symbol* был указан [__declspec (dllimport)](../../cpp/dllexport-dllimport.md) , хотя символ определен в объектном файле *filename. obj* в том же образе. Удалите модификатор `__declspec(dllimport)`, чтобы устранить это предупреждение.

## <a name="remarks"></a>Remarks

Это предупреждение создается компоновщиком при определении символа в одном объектном файле и сослаться на него с помощью модификатора объявления `__declspec(dllimport)` в другом.

Предупреждение LNK4049 — это более общая версия [средств компоновщика, LNK4217 предупреждение](linker-tools-warning-lnk4217.md). Компоновщик создает предупреждение LNK4049, если не удается определить, какая функция или объектный файл ссылается на импортированный символ.

Типичные случаи создания LNK4049 вместо LNK4217:

- При использовании параметра [/incremental](../../build/reference/incremental-link-incrementally.md) .

- При использовании параметра [/LTCG](../../build/reference/ltcg-link-time-code-generation.md) .

Для устранения ошибки LNK4049 выполните одну из следующих процедур.

- Удалите модификатор `__declspec(dllimport)` из прямого объявления символа, вызвавшего LNK4049. Можно выполнять поиск символов в двоичном образе с помощью служебной программы **dumpbin** . Параметр **dumpbin/Symbols** отображает таблицу символов COFF изображения. Дополнительные сведения о служебной программе **dumpbin** см. в разделе [Справочник по DUMPBIN](../../build/reference/dumpbin-reference.md).

- Временно отключите инкрементную компоновку и полную оптимизацию программы. При повторной компиляции приложение создает предупреждение LNK4217, которое содержит имя функции, ссылающейся на импортированный символ. Удалите модификатор объявления `__declspec(dllimport)` из импортированного символа и повторно включите инкрементную компоновку или оптимизацию всей программы по мере необходимости.

Хотя окончательный созданный код работает правильно, код, созданный для вызова импортированной функции, менее эффективен, чем вызов функции напрямую. Это предупреждение не появляется при компиляции с параметром [/CLR](../../build/reference/clr-common-language-runtime-compilation.md) .

Дополнительные сведения об объявлениях импорта и экспорта данных см. в разделе [dllexport, dllimport](../../cpp/dllexport-dllimport.md).

## <a name="example"></a>Пример

Связывание следующих двух модулей приведет к созданию LNK4049. Первый модуль создает объектный файл, содержащий одну экспортированную функцию.

```cpp
// LNK4049a.cpp
// compile with: /c

__declspec(dllexport) int func()
{
   return 3;
}
```

Второй модуль создает объектный файл, содержащий прямую декларацию для функции, экспортированной в первый модуль, а также вызов этой функции внутри функции `main`. Связывание этого модуля с первым модулем приведет к созданию LNK4049. Удалите модификатор `__declspec(dllimport)` из объявления, чтобы устранить это предупреждение.

```cpp
// LNK4049b.cpp
// compile with: /link /WX /LTCG LNK4049a.obj
// LNK4049 expected

__declspec(dllimport) int func();
// try the following line instead
// int func();

int main()
{
   return func();
}
```

## <a name="see-also"></a>См. также раздел

[Предупреждение средств компоновщика LNK4217](linker-tools-warning-lnk4217.md) \
[Предупреждение средств компоновщика LNK4286](linker-tools-warning-lnk4286.md) \
[dllexport, dllimport](../../cpp/dllexport-dllimport.md)
