---
title: Хранение и выравнивание структур | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-language
ms.topic: language-reference
dev_langs:
- C++
helpviewer_keywords:
- alignment of structures
- structure storage
- storing structures
- packing structures
ms.assetid: 60ff292f-2595-4f37-ae00-4c4b4f047196
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 867b549575847a59f7d1e8a61792c8b097383a10
ms.sourcegitcommit: 913c3bf23937b64b90ac05181fdff3df947d9f1c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2018
ms.locfileid: "46092834"
---
# <a name="storage-and-alignment-of-structures"></a>Хранение и выравнивание структур

**Блок, относящийся только к системам Microsoft**

Структурные элементы сохраняются последовательно, в порядке объявления: первый элемент имеет самый низкий адрес памяти, а последний — наивысший.

У каждого объекта есть элемент *alignment-requirement*. Для структур таким требованием является крупнейший из элементов таких структур. Каждому объекту задается элемент *offset*, чтобы было верно следующее выражение:

*offset* `%` *alignment-requirement* `==` 0

Смежные битовые поля упакованы в тот же одно-, двух- или четырехбайтовый модуль распределения, если целочисленные типы имеют тот же размер и если следующее битовое поле помещается в текущий блок распределения, не пересекая границ, установленных общими требованиями выравнивания битовых полей.

Для экономии места или соответствия существующим структурам данных может потребоваться сохранить структуры более или менее компактно. Параметр компилятора [/Zp](../build/reference/zp-struct-member-alignment.md)[*n*] и [#pragma pack](../preprocessor/pack.md) управляют упаковкой данных структуры в память. При использовании параметра /Zp[*n*], где *n* — 1, 2, 4, 8 или 16, каждый элемент структуры после первого хранится в байтовом диапазоне, который представляет собой требование к выравниванию поля или размер пакета (*n*) в зависимости от того, что меньше. В виде формулы байтовые границы можно выразить следующим образом:

```
min( n, sizeof( item ) )
```

где *n* — это размер пакета, выраженный с параметром /Zp[*n*], а *item* — это элемент структуры. Размер пакета по умолчанию — /Zp8.

Чтобы использовать директиву pragma `pack` для указания упаковки, отличной от заданной в командной строке для определенной структуры, разместите директиву pragma `pack`, где размер пакета — 1, 2, 4, 8 или 16, перед структурой. Для возобновления компоновки в соответствии с инструкциями с командной строки задайте директиву pragma `pack` без аргументов.

Битовые поля по умолчанию имеют размер **long** для компилятора Microsoft C. Элементы структуры выравниваются по размеру типа или размеру /Zp [*n*] в зависимости от того что меньше. Размер по умолчанию — 4.

**Завершение блока, относящегося только к системам Майкрософт**

## <a name="see-also"></a>См. также

[Объявления структур](../c-language/structure-declarations.md)