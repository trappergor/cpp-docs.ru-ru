---
title: __asm
ms.date: 10/09/2018
f1_keywords:
- __asm
- _asm
- __asm_cpp
helpviewer_keywords:
- __asm keyword [C++], vs. asm blocks
- __asm keyword [C++]
ms.assetid: 77ff3bc9-a492-4b5e-85e1-fa4e414e79cd
ms.openlocfilehash: 14a40bef5b2edba76fc130604414c45eee589bcd
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87193007"
---
# `__asm`

**Блок, относящийся только к системам Microsoft**

**`__asm`** Ключевое слово вызывает встроенный ассемблер и может отображаться везде, где оператор C или C++ является допустимым. Он не может отображаться самостоятельно. За ним должна следовать инструкция по сборке, группа инструкций, заключенная в круглые скобки, либо, в крайнем случае, пустая пара круглых скобок. Термин « **`__asm`** блок» здесь означает любую инструкцию или группу инструкций, будь то скобки или нет.

> [!NOTE]
> Visual C++ поддержка стандартного **`asm`** ключевого слова C++ ограничена тем, что компилятор не выдаст ошибку для ключевого слова. Однако **`asm`** блок не создаст осмысленный код. Используйте **`__asm`** вместо **`asm`** .

## <a name="grammar"></a>Грамматика

*ASM-Block*:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;**`__asm`***Инструкция сборки* **`;`** <sub>неявное согласие</sub><br/>
&nbsp;&nbsp;&nbsp;&nbsp;**`__asm {`***список* **`}`** инструкций сборки **`;`** <sub>неявное согласие</sub>

*список инструкций сборки*:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;*Инструкция сборки* **`;`** <sub>неявное согласие</sub><br/>
&nbsp;&nbsp;&nbsp;&nbsp;*Инструкция сборки* **`;`** *список* **`;`** инструкций сборки <sub>неявное согласие</sub>

## <a name="remarks"></a>Remarks

При использовании без скобок **`__asm`** ключевое слово означает, что остальная часть строки является оператором языка ассемблера. При использовании с фигурными скобками оно означает, что каждая строка между скобками — это оператор на языке сборки. Для совместимости с предыдущими версиями **`_asm`** является синонимом для **`__asm`** .

Поскольку **`__asm`** ключевое слово является разделителем операторов, инструкции ассемблера можно разместить в той же строке.

Перед тем как Visual Studio 2005, инструкция

```cpp
__asm int 3
```

не вызывал создание машинного кода при компиляции с **параметром/CLR**; компилятор преобразует инструкцию в инструкцию о разрыве среды CLR.

`__asm int 3` теперь приводит к созданию машинного кода для функции. Если требуется, чтобы функция вызывала точку останова в коде и если необходима компиляция функции в MSIL, используйте [__debugbreak](../../intrinsics/debugbreak.md).

Для совместимости с предыдущими версиями аргумент **`_asm`** является синонимом, **`__asm`** если только параметр компилятора [/Za не \( отключил расширения языка)](../../build/reference/za-ze-disable-language-extensions.md) .

## <a name="example"></a>Пример

Следующий фрагмент кода является простым **`__asm`** блоком, заключенным в фигурные скобки:

```cpp
__asm {
   mov al, 2
   mov dx, 0xD007
   out dx, al
}
```

Кроме того, можно разместить **`__asm`** перед каждой инструкцией сборки:

```cpp
__asm mov al, 2
__asm mov dx, 0xD007
__asm out dx, al
```

Поскольку **`__asm`** ключевое слово является разделителем операторов, инструкции ассемблера также можно разместить в той же строке:

```cpp
__asm mov al, 2   __asm mov dx, 0xD007   __asm out dx, al
```

Все три примера создают один и тот же код, но первый стиль (охватывающий **`__asm`** блок в фигурных скобках) имеет некоторые преимущества. Фигурные скобки четко разделяют код сборки из кода C или C++ и не требуют повторного повторения **`__asm`** ключевого слова. Скобки также помогают избежать неоднозначности. Если вы хотите поместить оператор C или C++ в ту же строку, что и **`__asm`** блок, необходимо заключить блок в фигурные скобки. Без фигурных скобок компилятор не может определить, где прекращается код сборки и начинаются операторы C или C++. Наконец, поскольку текст в фигурных скобках имеет тот же формат, что и обычный текст MASM, можно легко вырезать и вставить текст из существующих исходных файлов MASM.

В отличие от фигурных скобок в C и C++, фигурные скобки, охватывающие **`__asm`** блок, не влияют на область действия переменной. Также можно вкладывать **`__asm`** блоки, а вложение не влияет на область действия переменной.

**Завершение блока, относящегося только к системам Майкрософт**

## <a name="see-also"></a>См. также

[Ключевые слова](../../cpp/keywords-cpp.md)<br/>
[Встроенный ассемблер](../../assembler/inline/inline-assembler.md)<br/>
