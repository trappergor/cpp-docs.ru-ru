---
title: 2.3 конструкция parallel | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-parallel
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: 190eacdf-2c16-4c06-8cb7-ac60eb211425
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 4be5bdc40f69cfa0a326ffa6a7f8465e401cfd33
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2018
ms.locfileid: "46448237"
---
# <a name="23-parallel-construct"></a>2.3 Конструкция parallel

Следующая директива определяет параллельной области, являющийся областью программы, которая будет выполняться сразу несколько потоков параллельно. Это является фундаментальной конструкцией, которая запускает параллельного выполнения.

```
#pragma omp parallel [clause[ [, ]clause] ...] new-line   structured-block
```

*Предложение* является одним из следующих:

**Если (** *скалярное выражение* **)**

**закрытый (** *списка переменной* **)**

**firstprivate (** *списка переменной* **)**

**по умолчанию (общий &#124; none)**

**Общие (** *списка переменной* **)**

**copyin (** *списка переменной* **)**

**сокращение (** *оператор* **:***списка переменной* **)** 

**num_threads(** *integer-expression* **)**

Когда поток обнаруживает параллельные конструкции, группу потоков создается в том случае, если выполняется одно из следующих случаев:

- Не **Если** присутствует предложение.

- **Если** выражение принимает значение ненулевое значение.

Этот поток становится главного потока рабочей группы, с количеством потоков 0, и все потоки в группе, включая главный поток выполнения области в параллельном режиме. Если значение **Если** выражение равно нулю, сериализуется области.

Чтобы определить количество потоков, которые запрашиваются, в порядке будет считаться следующие правила. Применяется первое правило, условия:

1. Если **num_threads** присутствует предложение, а затем значение целочисленного выражения число потоков, в запросе.

1. Если **omp_set_num_threads** вызова функции библиотеки, то значение аргумента в вызове самого последнего выполненного является количество потоков, в запросе.

1. Если переменная среды **OMP_NUM_THREADS** задан, то значение этой переменной среды является количество потоков, в запросе.

1. Если ни один из описанных выше методов, число потоков, в запросе, определяемого реализацией.

Если **num_threads** присутствует предложение, а затем она заменяет собой число потоков, запрашиваемых **omp_set_num_threads** функции библиотеки или **OMP_NUM_THREADS** в переменной среды только область параллельной обработки, к которому он применяется. В нем не затрагиваются последующих параллельных регионов.

Количество потоков, выполняющих параллельной области также зависит от того, включена ли динамическую настройку количество потоков. Если динамическую настройку отключена, запрашиваемое количество потоков, которые будет выполняться область параллельной обработки. Если включено динамическое выравнивание запрошенное число потоков, то максимальное число потоков, которые могут выполняться область параллельной обработки.

Если область параллельной обработки встречается отключена динамическую настройку количество потоков, и число потоков, запрошенный для параллельной области превышает значение, можно предоставить системе времени выполнения, поведение программы не определяемого реализацией. Реализация может например, прервать выполнение программы, или он может сериализовать область параллельной обработки.

**Omp_set_dynamic** функция библиотеки и **OMP_DYNAMIC** переменной среды можно использовать для включения и отключения динамическую настройку количество потоков.

Число физических процессоров, потоки, кем фактически размещена в любой момент времени, определяемого реализацией. После создания, число потоков в группе остается неизменным в течение этой параллельной области. Его можно изменить явно пользователем или автоматически системой времени выполнения из одной параллельной области в другую.

Инструкции, содержащиеся в динамических степень параллельной области будут выполняться каждым потоком, и каждый поток может выполняться контура инструкций, который отличается от других потоков. Директивы обнаружил за пределами лексическую область параллельной области, называются потерянные директивы.

Нет подразумеваемых барьера, в конце параллельной области. Только главный поток команда продолжает выполнение в конце параллельной области.

Если поток в команде выполнения параллельной области обнаруживает другие параллельные конструкции, он создает новую группу, и становится главным этой новой команды. Вложенные области параллельной сериализуются по умолчанию. Таким образом по умолчанию, вложенный параллельной области выполняется командой, состоящий из одного потока. Поведение по умолчанию может быть изменен с помощью функции библиотеки среды выполнения **omp_set_nested** или переменную среды **OMP_NESTED**. Однако количество потоков в группе, выполняющих параллельной вложенной области определяется реализацией.

Ограничения для **параллельных** директива таковы:

- Не более одного **Если** предложение может использоваться в директиве.

- Не указано ли любые побочные эффекты внутри if выражение или **num_threads** происходят выражение.

- Объект **throw** внутри параллельной области могут вызвать для возобновления в динамических экстент же структурированном блоке выполнения, и он должен перехватывать же потока, вызвавшего исключение.

- Только один **num_threads** предложение может использоваться в директиве. **Num_threads** выражение вычисляется вне контекста область параллельной обработки и должен иметь положительное целое значение.

- Порядок вычисления **Если** и **num_threads** предложения не указано.

## <a name="cross-references"></a>Перекрестные ссылки:

- **закрытый**, **firstprivate**, **по умолчанию**, **общего**, **copyin**, и **сокращения**предложений, см. в разделе [разделе 2.7.2](../../parallel/openmp/2-7-2-data-sharing-attribute-clauses.md) на стр. 25.

- **OMP_NUM_THREADS** переменной среды [разделе 4.2](../../parallel/openmp/4-2-omp-num-threads.md) на стр. 48.

- **omp_set_dynamic** функции библиотеки, см. в разделе [разделе 3.1.7](../../parallel/openmp/3-1-7-omp-set-dynamic-function.md) на стр. 39.

- **OMP_DYNAMIC** переменной, см. в разделе среды [разделе 4.3](../../parallel/openmp/4-3-omp-dynamic.md) на стр.

- **omp_set_nested** функции, см. в разделе [разделе 3.1.9](../../parallel/openmp/3-1-9-omp-set-nested-function.md) на странице 40.

- **OMP_NESTED** переменной, см. в разделе среды [раздел 4.4](../../parallel/openmp/4-4-omp-nested.md) на стр.

- **omp_set_num_threads** функции библиотеки, см. в разделе [разделе 3.1.1](../../parallel/openmp/3-1-1-omp-set-num-threads-function.md) на странице 36.