---
title: Проекты CMake в Visual C++
ms.date: 10/18/2018
helpviewer_keywords:
- CMake in Visual C++
ms.assetid: 444d50df-215e-4d31-933a-b41841f186f8
ms.openlocfilehash: 07c32e30aa36d6e59122340da0b1026e7025780d
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50612502"
---
# <a name="cmake-projects-in-visual-c"></a>Проекты CMake в Visual C++

В этой статье предполагается, что вы знакомы с CMake — кроссплатформенным средством с открытым исходным кодом для определения процессов сборки, выполняемых на нескольких платформах.

В Visual Studio 2015 пользователи Visual Studio могут использовать [генератор CMake](https://cmake.org/cmake/help/v3.9/manual/cmake-generators.7.html) для создания файлов проекта MSBuild, которые интегрированная среда разработки использует для IntelliSense, просмотра и компиляции.

Начиная с Visual Studio 2017 компонент **Инструменты Visual C++ для CMake** использует функцию **Открыть папку**, чтобы позволить интегрированной среде разработки использовать файлы проекта CMake (например, CMakeLists.txt) для IntelliSense и просмотра. Если вы используете генератор Visual Studio, создается временный файл проекта, который передается в msbuild.exe, но никогда не загружается для IntelliSense или просмотра.

**Visual Studio 2017 версии 15.3**: обеспечена поддержка для генераторов Ninja и Visual Studio.

**Visual Studio 2017 версии 15.4**: добавлена поддержка CMake на Linux. Дополнительные сведения см. в разделе [Настройка проекта Linux CMake](../linux/cmake-linux-project.md).

**Visual Studio 2017 версии 15.5**: добавлена поддержка для импорта существующего кэша CMake. Visual Studio автоматически извлекает настраиваемые переменные и создает предварительно заполненный файл CMakeSettings.json.

**Visual Studio 2017 версии 15.7**. Добавлена поддержка отключения автоматического создания кэша, представления целевых объектов в **обозревателе решений** и компиляции одного файла.

## <a name="installation"></a>Установка

Компонент **Инструменты Visual C++ для CMake** устанавливается по умолчанию в составе рабочей нагрузки **Разработка классических приложений на C++**.

![Компонент CMake в рабочей нагрузке классических приложений на C++](media/cmake-install.png)

## <a name="ide-integration"></a>Интеграция с IDE

Если выбрать **Файл | Открыть | Папка**, чтобы открыть папку, содержащую файл CMakeLists.txt, происходит следующее.

- Visual Studio добавляет пункт **CMake** в главное меню с командами для просмотра и редактирования сценариев CMake.
- **Обозреватель решений** отображает структуру папок и файлы.
- Visual Studio запускает CMake.exe и создает кэш CMake для *конфигурации* по умолчанию, которой является отладка x86. В **окне вывода** отображается командная строка CMake, а также дополнительные выходные данные CMake.  **Visual Studio 2017 версии 15.7 и более поздних версий**. Автоматическое создание кэша можно отключить в диалоговом окне **Сервис | Параметры | CMake | Общие**.
- В фоновом режиме Visual Studio индексирует исходные файлы для поддержки функций IntelliSense, просмотра информации, рефакторинга и т. д. По мере работы Visual Studio отслеживает изменения в редакторе, а также на диске, чтобы синхронизировать индекс с источниками.

Вы можете открыть папки, содержащие любое количество проектов CMake. Visual Studio обнаруживает и настраивает все "корневые" файлы CMakeLists.txt в рабочей области. Операции CMake (настройка, сборка, отладка), а также C++ IntelliSense и просмотр доступны для всех проектов CMake в вашей рабочей области.

![Проект CMake с несколькими корнями](media/cmake-multiple-roots.png)

**Visual Studio 2017 версии 15.7 и более поздних версий**. Вы также можете просмотреть проекты, логически упорядоченные по целевым объектам. Выберите **Представление целевых объектов** из раскрывающегося списка на панели инструментов в **обозревателе решений**:

![Кнопка "Представление целевых объектов CMake"](media/cmake-targets-view.png)

## <a name="import-an-existing-cache"></a>Импорт существующего кэша

Когда вы импортируете существующий файл CMakeCache.txt, Visual Studio автоматически извлекает настраиваемые переменные и создает на их основе предварительно заполненный файл [CMakeSettings.json](#cmake_settings). Исходный кэш никак не изменяется и по-прежнему может использоваться из командной строки либо с помощью любого средства или любой интегрированной среды разработки, использованных для его создания. Новый файл CMakeSettings.json помещается рядом с корневым файлом CMakeLists.txt проекта. Visual Studio создает кэш на основе файла параметров.

**Visual Studio 2017 версии 15.7 и более поздних версий**. Вы можете переопределить автоматическое создание кэша в диалоговом окне **Сервис | Параметры | CMake | Общие**.

Импортируется не все содержимое кэша.  Такие свойства, как генератор и расположение компиляторов, заменяются значениями по умолчанию, хорошо совместимыми с данной интегрированной средой разработки.

### <a name="to-import-an-existing-cache"></a>Импорт существующего кэша

1. В главном меню выберите **Файл | Открыть | CMake**:

   ![Открытие CMake](media/cmake-file-open.png "Файл, Открыть, CMake")

   Отображается мастер **импорта CMake из кэша**.

2. Перейдите к файлу CMakeCache.txt, который хотите импортировать, и нажмите кнопку **ОК**. Отображается мастер **импорта CMake из кэша**:

   ![Импорт кэша CMake](media/cmake-import-wizard.png "Открытие мастера импорта кэша CMake")

   По завершении работы мастера вы увидите новый файл CMakeCache.txt в **обозревателе решений** рядом с корневым файлом CMakeLists.txt в проекте.

## <a name="building-cmake-projects"></a>Создание проектов CMake

Для создания проекта CMake доступны следующие варианты:

1. Выберите целевой объект в раскрывающемся списке **Отладка** и нажмите клавишу **F5** или нажмите кнопку **Выполнить** (с зеленым треугольником). Сначала автоматически выполняется сборка проекта как решения Visual Studio.
1. Щелкните CMakeLists.txt правой кнопкой мыши и выберите пункт **Сборка**. Если в структуре папок имеется несколько целевых объектов, можно выбрать сборку их всех или только одного из них.
1. В главном меню выберите **Сборка | Собрать решение** (нажмите клавишу **F7** или клавиши **CTRL+SHIFT+B**). Убедитесь, что целевой объект CMake уже выбран в раскрывающемся списке **Автозапускаемый элемент** на панели инструментов **Общие**.

![Команда меню сборки CMake](media/cmake-build-menu.png "Команда меню сборки CMake")

Когда для активной конфигурации выбран генератор Visual Studio, вызывается MSBuild.exe с аргументами `-m -v:minimal`. Чтобы настроить сборку, в файле CMakeSettings.json можно указать дополнительные аргументы командной строки для передачи в систему сборки через свойство `buildCommandArgs`:

```json
"buildCommandArgs": "-m:8 -v:minimal -p:PreferredToolArchitecture=x64"
```

Как и следовало ожидать, результаты сборки отображаются в **окне вывода** и **списке ошибок**.

![Ошибки сборки CMake](media/cmake-build-errors.png "Ошибки сборки CMake")

В папке с несколькими целевыми объектами сборки можно выбрать элемент **Сборка** в меню **CMake** или контекстном меню **CMakeLists.txt**, чтобы указать целевой объект CMake для сборки. Нажав клавиши **CTRL+SHIFT+B** в проекте CMake, можно выполнить сборку текущего активного документа.

## <a name="debug-the-project"></a>Отладка проекта

Для отладки проекта CMake выберите требуемую конфигурацию и нажмите клавишу **F5** или кнопку **Выполнить** на панели инструментов. Если для кнопки **Выполнить** отображается сообщение "Выбрать элемент запуска", выберите стрелку раскрывающегося списка и выберите целевой объект, который требуется запустить. (В проекте CMake параметр "Текущий документ" допустим только для файлов CPP.)

![Кнопка запуска CMake](media/cmake-run-button.png "Кнопка запуска CMake")

Команды **Выполнить** или **F5** сначала выполняют сборку проекта, если с момента предыдущей сборки были внесены изменения.

## <a name="configure-cmake-debugging-sessions"></a>Настройка сеансов отладки CMake

Все исполняемые целевые объекты CMake отображаются в раскрывающемся списке **Автозапускаемый элемент** на панели инструментов **Общие**. Чтобы запустить сеанс отладки, выберите один из них и запустите отладчик.

![Раскрывающийся список элементов запуска CMake](media/cmake-startup-item-dropdown.png "Раскрывающийся список элементов запуска CMake")

Можно также запустить сеанс отладки из меню CMake.

Чтобы настроить параметры отладчика для любого исполняемого целевого объекта CMake в проекте, щелкните правой кнопкой мыши конкретный файл CMakeLists.txt и выберите **Параметры отладки и запуска**. При выборе целевого объекта CMake в подменю создается файл launch.vs.json. Он предварительно заполнен сведениями о выбранном целевом объекте CMake и позволяет указать дополнительные параметры, например аргументы программы или тип отладчика. Чтобы сослаться на любой ключ в файле CMakeSettings.json, поставьте перед ним "CMake". в launch.vs.json. В следующем примере показан простой файл launch.vs.json, получающий значение ключа "remoteCopySources" в файле CMakeSettings.json для текущей конфигурации:

```json
{
  "version": "0.2.1",
  "defaults": {},
  "configurations": [
    {
      "type": "default",
      "project": "CMakeLists.txt",
      "projectTarget": "CMakeHelloWorld.exe (Debug\\CMakeHelloWorld.exe)",
      "name": "CMakeHelloWorld.exe (Debug\\CMakeHelloWorld.exe)",
      "args": ["${cmake.remoteCopySources}"]
    }
  ]
}
```

Сразу после сохранения файла launch.vs.json в раскрывающемся списке **Автозапускаемый элемент** создается запись с новым именем. Изменяя файл launch.vs.json, можно создать сколько угодно конфигураций отладки для любого числа целевых объектов CMake.

**Visual Studio 2017 версии 15.4**: Launch.vs.json поддерживает переменные, объявляемые в CMakeSettings.json (см. ниже) и применяемые к выбранной конфигурации. Он также содержит ключ currentDir, задающий текущий каталог запускаемого приложения:

```json
{
  "type": "default",
  "project": "CMakeLists.txt",
  "projectTarget": "CMakeHelloWorld1.exe (C:\\Users\\satyan\\CMakeBuilds\\Test\\Debug\\CMakeHelloWorld1.exe)",
  "name": "CMakeHelloWorld1.exe (C:\\Users\\satyan\\CMakeBuilds\\Test\\Debug\\CMakeHelloWorld1.exe)",
  "currentDir": "${env.USERPROFILE}\\CMakeBuilds\\${workspaceHash}"
}
```

При запуске приложения значение `currentDir` имеет примерно следующий вид:

```cmd
C:\Users\satyan\7f14809a-2626-873e-952e-cdf038211175\
```

## <a name="editing-cmakeliststxt-files"></a>Изменение файлов CMakeLists.txt

Чтобы изменить файл CMakeLists.txt, щелкните его правой кнопкой мыши в **обозревателе решений** и выберите пункт **Открыть**. Если вы вносите изменения в файл, отображается желтая строка состояния, которая сообщает о предстоящем обновлении IntelliSense, а также позволяет отменить эту операцию обновления. Сведения о CMakeLists.txt см. в [документации по CMake](https://cmake.org/documentation/).

   ![Изменение файла CMakeLists.txt](media/cmake-cmakelists.png "Изменение файла CMakeLists.txt")

Сразу после сохранения файла автоматически перезапускается этап настройки, отображающий информацию в окне **вывода**. Ошибки и предупреждения отображаются в **списке ошибок** или окне **вывода**. Дважды щелкните ошибку в окне **Список ошибок**, чтобы перейти к строке с ошибкой в CMakeLists.txt.

   ![Ошибки в файле CMakeLists.txt](media/cmake-cmakelists-error.png "Ошибки в файле CMakeLists.txt")

## <a name="cmake_settings"></a> Параметры и настраиваемые конфигурации CMake

По умолчанию Visual Studio предоставляет шесть конфигураций CMake (x86-Debug, x86-Release, x64-Debug, x64-Release, Linux-Debug и Linux-Release). Они определяют, как вызывается CMake.exe для создания кэша CMake для данного проекта. Чтобы изменить эти конфигурации или создать новую, выберите **CMake | Изменить параметры CMake**, а затем — файл CMakeLists.txt, к которому применяются параметры. Команда **Изменить параметры CMake** также доступна в контекстном меню для файла в **обозревателе решений**. Эта команда создает файл CMakeSettings.json в папке проекта. Этот файл используется для повторного создания файла кэша CMake, например после операции **Очистить**.

   ![Команда главного меню CMake для изменения параметров](media/cmake-change-settings.png)

JSON IntelliSense помогает изменить файл CMakeSettings.json:

   ![JSON IntelliSense CMake](media/cmake-json-intellisense.png "JSON IntelliSense CMake")

Ниже приведен пример конфигурации, который можно использовать в качестве отправной точки для создания собственного файла CMakeSettings.json.

```json
    {
      "name": "x86-Debug",
      "generator": "Ninja",
      "configurationType": "Debug",
      "inheritEnvironments": [ "msvc_x86" ],
      "buildRoot": "${env.USERPROFILE}\\CMakeBuilds\\${workspaceHash}\\build\\${name}",
      "installRoot": "${env.USERPROFILE}\\CMakeBuilds\\${workspaceHash}\\install\\${name}",
      "cmakeCommandArgs": "",
      "buildCommandArgs": "-v",
      "ctestCommandArgs": ""
    },

```

1. **name**: имя, которое отображается в раскрывающемся списке конфигурации C++. Это значение свойства можно также использовать как макрос `${name}`, чтобы задать другие значения свойств. Пример см. в определении **buildRoot** в CMakeSettings.json.

1. **generator**: сопоставляется с параметром **-G** и задает используемый генератор. Это свойство можно также использовать как макрос `${generator}`, чтобы задать другие значения свойств. Сейчас Visual Studio поддерживает следующие генераторы CMake:

    - Ninja
    - Visual Studio 14 2015
    - Visual Studio 14 2015 ARM
    - Visual Studio 14 2015 Win64
    - Visual Studio 15 2017
    - Visual Studio 15 2017 ARM
    - Visual Studio 15 2017 Win64

Так как генератор Ninja предназначен для ускорения сборки в ущерб гибкости и функциональности, он используется по умолчанию. Однако некоторые проекты CMake могут быть неспособны использовать Ninja правильно. В этом случае можно велеть CMake создать проект Visual Studio.

Чтобы указать генератор Visual Studio, откройте CMakeSettings.json в главном меню, выбрав **CMake | Изменить параметры CMake**. Удалите слово Ninja и введите букву V. Это активирует IntelliSense, позволяя выбрать нужный генератор.

1. **buildRoot**: сопоставляется с параметром **-DCMAKE_BINARY_DIR** и указывает, где будет создан кэш CMake. Если папка не существует, она будет создана.

1. **variables**: содержит пару имя-значение для переменных CMake, которая передается в CMake в виде **-D** *_имя_=_значение_*. Если инструкции сборки проекта CMake указывают добавление каких-либо переменных непосредственно в файл кэша CMake, рекомендуется вместо этого добавить их сюда. В следующем примере показано, как задать пары "имя-значение".

```json
"variables": [
    {
      "name": "CMAKE_CXX_COMPILER",
      "value": "C:/Program Files (x86)/Microsoft Visual Studio/157/Enterprise/VC/Tools/MSVC/14.14.26428/bin/HostX86/x86/cl.exe"
    },
    {
      "name": "CMAKE_C_COMPILER",
      "value": "C:/Program Files (x86)/Microsoft Visual Studio/157/Enterprise/VC/Tools/MSVC/14.14.26428/bin/HostX86/x86/cl.exe"
    }
  ]
```

1. **cmakeCommandArgs**: указывает любые дополнительные параметры, которые нужно передать в CMake.exe.

2. **configurationType**: определяет тип конфигурации сборки для выбранного генератора. Сейчас поддерживаются значения Debug, MinSizeRel, Release и RelWithDebInfo.

3. **ctestCommandArgs**: указывает дополнительные параметры, передаваемые в CTest при выполнении тестов.

4. **buildCommandArgs**: указывает дополнительные параметры, передаваемые базовой системе сборки. Например, передача -v при использовании генератора Ninja приводит к тому, что Ninja выдает командные строки.

### <a name="environment-variables"></a>Переменные среды

CMakeSettings.json также поддерживает использование переменных среды в любом из указанных выше свойств. Для расширения переменной среды %FOO% используется синтаксис `${env.FOO}`.
Вы также можете обращаться ко встроенным макросам внутри этого файла:

- `${workspaceRoot}` — предоставляет полный путь для папки рабочей области.
- `${workspaceHash}` — хэш расположения рабочей области; удобен для создания уникального идентификатора для текущей рабочей области (например, для использования в путях папок).
- `${projectFile}` — полный путь к корневому файлу CMakeLists.txt.
- `${projectDir}` — полный путь к папке корневого файла CMakeLists.txt.
- `${thisFile}` — полный путь к файлу CMakeSettings.json.
- `${name}` — имя конфигурации.
- `${generator}` — имя генератора CMake, используемого в этой конфигурации.

### <a name="ninja-command-line-arguments"></a>Аргументы командной строки Ninja

Если целевые объекты не заданы, создает целевой объект default (см. руководство).

```cmd
C:\Program Files (x86)\Microsoft Visual Studio\Preview\Enterprise>ninja -?
ninja: invalid option -- `-?'
usage: ninja [options] [targets...]
```

|Параметр|Описание:|
|--------------|------------|
| --version  | Вывод версии Ninja ("1.7.1")|
|   -C DIR   | Переход в каталог DIR перед выполнением других действий|
|   -f FILE  | Указание файла входных данных для сборки (по умолчанию используется build.ninja)|
|   -j N     | Параллельное выполнение N заданий (по умолчанию 14, в зависимости от доступных ЦП)|
|   -k N     | Продолжение выполнения для сбоя N заданий (по умолчанию 1)|
|   -l N     | Запрет на запуск новых заданий, если средняя нагрузка выше N|
|   -n       | Пробный запуск (команды не выполняются, но считаются успешно выполненными)|
|   -v       | Отображение всех командных строк во время сборки|
|   -d MODE  | Включение отладки (используйте список -d для указания режимов)|
|   -t TOOL  | Запуск подчиненного инструмента (используйте список -t для указания подчиненных инструментов); завершает действие параметров верхнего уровня; в средство передаются дополнительные флаги|
|   -w FLAG  | Настройка предупреждений (используйте список -w для указания предупреждений)|

### <a name="inherited-environments-visual-studio-2017-version-155"></a>Наследуемые среды (Visual Studio 2017 версии 15.5)

CMakeSettings.json теперь поддерживает наследуемые среды. Эта функция позволяет: (1) наследовать среды по умолчанию; и (2) создавать пользовательские переменные среды, которые передаются CMake.exe при запуске.

```json
  "inheritEnvironments": [ "msvc_x64_x64" ]
```

Приведенный выше пример аналогичен запуску **Командной строки разработчика для VS 2017** с аргументами **-arch=amd64 -host_arch=amd64**.

В следующей таблице показаны значения по умолчанию:

|Имя контекста|Описание:|
|-----------|-----------------|
|vsdev|Среда Visual Studio по умолчанию|
|msvc_x86|Компиляция для x86 с помощью средств x86|
|msvc_arm| Компиляция для ARM с помощью средств x86|
|msvc_arm64|Компиляция для ARM64 с помощью средств x86|
|msvc_x86_x64|Компиляция для AMD64 с помощью средств x86|
|msvc_x64_x64|Компиляция для AMD64 с помощью 64-разрядных средств|
|msvc_arm_x64|Компиляция для ARM с помощью 64-разрядных средств|
|msvc_arm64_x64|Компиляция для ARM64 с помощью 64-разрядных средств|

### <a name="custom-environment-variables"></a>Пользовательские переменные среды

В CMakeSettings.json можно определить пользовательские переменные среды на глобальном уровне или для отдельных конфигураций в свойстве **environments**. Следующий пример определяет одну глобальную переменную **BuildDir**, которая наследуется в конфигурациях x86-Debug и x64-Debug. Каждая конфигурация использует эту переменную, чтобы задать значение свойства **buildRoot** для этой конфигурации. Обратите внимание, как каждая конфигурация использует свойство **inheritEnvironments**, чтобы указать переменную, применяемую только к этой конфигурации.

```json
{
  // The "environments" property is an array of key value pairs of the form
  // { "EnvVar1": "Value1", "EnvVar2": "Value2" }
  "environments": [
    {
      "BuildDir": "${env.USERPROFILE}\\CMakeBuilds\\${workspaceHash}\\build",
    }
  ],

  "configurations": [
    {
      "name": "x86-Debug",
      "generator": "Ninja",
      "configurationType": "Debug",
      // Inherit the defaults for using the MSVC x86 compiler.
      "inheritEnvironments": [ "msvc_x86" ],
      "buildRoot": "${env.BuildDir}\\${name}"    },
    {
      "name": "x64-Debug",
      "generator": "Ninja",
      "configurationType": "Debug",
      // Inherit the defaults for using the MSVC x64 compiler.
      "inheritEnvironments": [ "msvc_x64" ],
      "buildRoot": "${env.BuildDir}\\${name}"
    }
  ]
}
```

В следующем примере конфигурация x86-Debug определяет собственное значение для свойства **BuildDir**, и это значение переопределяет значение, заданное в глобальном свойстве **BuildDir**, чтобы вычисление  **BuildRoot** давало `D:\custom-builddir\x86-Debug`.

```json
{
  "environments": [
    {
      "BuildDir": "${env.USERPROFILE}\\CMakeBuilds\\${workspaceHash}",
    }
  ],

  "configurations": [
    {
      "name": "x86-Debug",

      // The syntax for this property is the same as the global one above.
      "environments": [
        {
          // Replace the global property entirely.
          "BuildDir": "D:\\custom-builddir",
        }
      ],

      "generator": "Ninja",
      "configurationType": "Debug",
      "inheritEnvironments": [ "msvc_x86" ],
      // Evaluates to "D:\custom-builddir\x86-Debug"
      "buildRoot": "${env.BuildDir}\\${name}"
    },
    {
      "name": "x64-Debug",

      "generator": "Ninja",
      "configurationType": "Debug",
      "inheritEnvironments": [ "msvc_x64" ],
      // Since this configuration doesn’t modify BuildDir, it inherits
      // from the one defined globally.
      "buildRoot": "${env.BuildDir}\\${name}"
    }
  ]
}
```

## <a name="cmake-configure-step"></a>Шаг настройки CMake

При внесении существенных изменений в файл CMakeSettings.json или CMakeLists.txt Visual Studio автоматически перезапускает шаг настройки CMake. Если шаг настройки завершается без ошибок, собранные данные становятся доступны в C++ IntelliSense и языковых службах, а также в операциях сборки и отладки.

Если несколько проектов CMake используют одно имя конфигурации CMake (например, x86-Debug), все они настраиваются и собираются (в собственной корневой папке сборки) при выборе этой конфигурации. Вы можете отлаживать целевые объекты изо всех проектов CMake, участвующих в этой конфигурации CMake.

   ![Элемент меню "Только сборка" CMake](media/cmake-build-only.png "Элемент меню \"Только сборка\" CMake")

Чтобы ограничить сеансы сборки и отладки подмножеством проектов в рабочей области, создайте конфигурацию с уникальным именем в файле CMakeSettings.json и примените ее только к этим проектам. При выборе этой конфигурации IntelliSense, а также команды сборки и отладки активируются только для этих указанных проектов.

## <a name="troubleshooting-cmake-cache-errors"></a>Устранение ошибок кэша CMake

Если вам нужны дополнительные сведения о состоянии кэша CMake для диагностики проблемы, откройте главное меню **CMake** или контекстное меню **CMakeLists.txt** в **обозревателе решений**, чтобы выполнить одну из следующих команд:

- **Просмотреть кэш** открывает файл CMakeCache.txt из корневой папки сборки в редакторе. (Любые внесенные здесь изменения в CMakeCache.txt удаляются при очистке кэша. Чтобы обеспечить сохранение изменений после очистки кэша, см. раздел [Параметры и настраиваемые конфигурации CMake](#cmake_settings) выше.)

- **Открыть папку кэша** открывает окно проводника с корневой папкой сборки.

- **Очистить кэш** удаляет корневую папку сборки, чтобы следующий шаг настройки CMake начинался с очистки кэша.

- **Создать кэш** принудительно создает шаг для выполнения, даже если Visual Studio считает среду актуальной.

**Visual Studio 2017 версии 15.7 и более поздних версий**. Автоматическое создание кэша можно отключить в диалоговом окне **Сервис | Параметры | CMake | Общие**.

## <a name="single-file-compilation"></a>Компиляция одного файла

**Visual Studio 2017 версии 15.7 и более поздних версий**. Для сборки отдельного файла в проекте CMake щелкните правой кнопкой мыши файл в **обозревателе решений** и нажмите **Компилировать**. Вы также можете скомпилировать открытый в редакторе файл через главное меню CMake:

![Компиляция одного файла в CMake](media/cmake-single-file-compile.png)

## <a name="run-cmake-from-the-command-line"></a>Запуск CMake из командной строки
Если вы установили CMake из Visual Studio Installer, можете запустить это средство из командной строки, сделав следующее:

1. Запустите соответствующий файл vsdevcmd.bat (x86 или x64). Дополнительные сведения см. в статье [Build C/C++ code on the command line](../build/building-on-the-command-line.md) (Создание кода C или C++ в командной строке).
1. Перейдите в папку выходных данных.
1. Запустите CMake для создания или настройки приложения.

