---
title: Распространение элементов ActiveX Visual C++ | Документы Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-ide
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- controls [C++], redistributing
- controls [C++], distributing
ms.assetid: eefbb7e4-d28c-4c35-98bf-d9540cfaae83
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: 2b770bbacca06c6edfb3b9b4eda53fc7be8a7ae0
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33331023"
---
# <a name="redistributing-visual-c-activex-controls"></a>Распространение элементов управления ActiveX в Visual C++
В Visual C++ 6.0 представлены элементы управления ActiveX, которые можно использовать в распространяемых приложениях. Эти элементы управления больше не входят в Visual C++. Согласно лицензионным соглашениям для Visual C++ 6.0, вы можете распространять эти элементы управления с приложениями, разработанными на Visual C++.  
  
> [!NOTE]
>  Visual C++ 6.0 больше не поддерживается корпорацией Майкрософт.  
  
 Список распространяемых элементов управления ActiveX в Visual C++ 6.0 см. в файле Common\Redist\Redist.txt на диске 1 продукта Visual C++ 6.0.  
  
 При распространении приложений нужно установить и зарегистрировать файл OCX для элемента управления ActiveX (с помощью Regsvr32.exe). Кроме того, следует убедиться, что на конечном компьютере присутствуют текущие версии следующих системных файлов (звездочка означает, что файл нужно зарегистрировать):  
  
-   Asycfilt.dll  
  
-   Comcat.dll *  
  
-   Oleaut32.dll *  
  
-   Olepro32.dll *  
  
-   Stdole2.tlb  
  
 Если эти библиотеки DLL отсутствуют в конечной системе, нужно обновить их с помощью установленного механизма для обновления соответствующей операционной системы. Актуальные пакеты обновления для операционных систем Windows можно скачать по адресу [http://windowsupdate.microsoft.com](http://windowsupdate.microsoft.com).  
  
 Если приложение использует один из элементов управления ActiveX, подключающийся к базе данных, нужно установить на целевой системе компоненты доступа к данным MDAC. Дополнительные сведения см. в разделе [Распространение файлов поддержки базы данных](../ide/redistributing-database-support-files.md).  
  
 При использовании элемента управления ActiveX, подключающегося к базе данных, также нужно реплицировать имя источника данных на конечном компьютере. Это можно сделать программно с помощью таких функций, как `ConfigDSN`.  
  
 Некоторые распространяемые элементы управления ActiveX имеют дополнительные зависимости. Для каждого файла OCX в папке Os\System на компакт-диске продукта Visual C++ 6.0 также присутствует файл DEP. Для каждого файла OCX, который вы хотите распространять, найдите одну или несколько записей USES в соответствующем файле DEP. Если файл указан в списке, убедитесь, что он доступен на конечном компьютере. Все библиотеки DLL, напрямую поддерживающие файл OCX, должны быть зарегистрированы. (Для успешного выполнения Regsvr32.exe конечный компьютер должен содержать все библиотеки DLL, статически загружаемые элементом управления.) Кроме того, если библиотека DLL, указанная в качестве зависимости, также имеет файл DEP в папке Os\System на компакт-диске Visual C++ 6.0, нужно проверить этот файл DEP на наличие записей USES.  
  
## <a name="see-also"></a>См. также  
 [Распространение файлов Visual C++](../ide/redistributing-visual-cpp-files.md)