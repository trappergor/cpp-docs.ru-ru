---
title: Добавление класса из элемента управления ActiveX
ms.date: 11/08/2018
f1_keywords:
- vc.codewiz.class.axcontrol
helpviewer_keywords:
- ActiveX controls [C++], adding classes
- classes [C++], creating
- ActiveX Control Wizard
- add class from ActiveX control wizard [C++]
ms.assetid: 729fcb37-54b8-44d5-9b4e-50bb16e0eea4
ms.openlocfilehash: d63f73e17e47f2cabb8f1a55c71325ec7068a2c8
ms.sourcegitcommit: a1676bf6caae05ecd698f26ed80c08828722b237
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91500368"
---
# <a name="add-a-class-from-an-activex-control"></a>Добавление класса из элемента управления ActiveX

Этот мастер используется для создания класса MFC из интерфейса в доступном элементе управления ActiveX. Вы можете добавить класс MFC для [приложения MFC](../mfc/reference/creating-an-mfc-application.md), [библиотеки DLL MFC](../mfc/reference/creating-an-mfc-dll-project.md) или [элемента управления ActiveX MFC](../mfc/reference/creating-an-mfc-activex-control.md).

> [!WARNING]
> В Visual Studio 2017 версии 15.9 корпорация Майкрософт не рекомендует использовать этот мастер кода, и он будет удален из будущей версии Visual Studio. Этот мастер используется редко. Удаление этого мастера не влияет на общую поддержку для ATL и MFC. Если вы хотите поделиться своим мнением об устаревании этого мастера, пройдите [этот опрос](https://www.surveymonkey.com/r/QDWKKCN). Ваше мнение важно для нас.
<!-- Blank comment here to separate the warning and note. -->
> [!NOTE]
> Чтобы добавить класс из элемента управления ActiveX, вам не нужно создавать проект MFC с включенной автоматизацией.

Элемент управления ActiveX — это многоразовый программный компонент, основанный на модели COM, который поддерживает широкий набор функциональных возможностей OLE. Его можно настроить под различные потребности программного обеспечения. Элементы управления ActiveX можно использовать в обычных контейнерах элементов управления ActiveX, а также на веб-страницах в Интернете.

**Добавление класса MFC из элемента управления ActiveX**

1. В **обозревателе решений** или [представлении классов](/visualstudio/ide/viewing-the-structure-of-code) щелкните правой кнопкой мыши имя проекта, куда вы хотите добавить класс элемента управления ActiveX.

1. В контекстном меню выберите команду **Добавить**, а затем нажмите **Добавить класс**.

1. В области **Шаблоны** диалогового окна [Добавление класса](./adding-a-class-visual-cpp.md#add-class-dialog-box) выберите **Класс MFC из элемента управления ActiveX**, а затем нажмите **Открыть**, чтобы отобразить [Мастер добавления классов из элемента ActiveX](#add-class-from-activex-control-wizard).

В этом мастере можно добавить несколько интерфейсов в элементе управления ActiveX. Можно также создать классы из более чем одного элемента управления ActiveX в одном сеансе мастера.

Вы можете добавлять классы из элементов управления ActiveX, зарегистрированных в системе, а также расположенных в файлах библиотеки типов (TLB, OLB, DLL, OCX или EXE) без их предварительной регистрации в системе. Дополнительные сведения о регистрации элементов управления ActiveX см. в разделе [Регистрация элементов управления OLE](../mfc/reference/registering-ole-controls.md).

Мастер создает класс MFC, производный от [CWnd](../mfc/reference/cwnd-class.md) или [COleDispatchDriver](../mfc/reference/coledispatchdriver-class.md), для каждого интерфейса, добавляемого из выбранного элемента управления ActiveX.

## <a name="in-this-section"></a>Содержание раздела

- [Мастер добавления классов из элемента ActiveX](#add-class-from-activex-control-wizard)

## <a name="add-class-from-activex-control-wizard"></a>Мастер добавления классов из элемента ActiveX

Этот мастер используется для добавления класса MFC из доступного элемента управления ActiveX. Мастер создает класс для каждого интерфейса, добавляемого из выбранного элемента управления ActiveX.

- **Добавить класс из**

  Указывает расположение библиотеки типов, из которой создается класс.

  |Параметр|Описание|
  |------------|-----------------|
  |**Реестр**|Библиотека типов зарегистрирована в системе. Зарегистрированные библиотеки типов перечислены в разделе **Доступные элементы управления ActiveX**.|
  |**Файл**|Библиотека типов не обязательно зарегистрирована в системе, но она сохраняется в файле. Нужно указать расположение файла в поле **Расположение**.|

- **Доступные элементы управления ActiveX**

  Указывает элементы управления ActiveX, зарегистрированные в системе в данный момент. Выберите элемент управления ActiveX в этом списке, чтобы отобразить его интерфейсы в списке **Интерфейсы**. Дополнительные сведения о регистрации элементов управления ActiveX см. в статье [Элементы управления ActiveX в MFC. Распространение элементов ActiveX](../mfc/mfc-activex-controls-distributing-activex-controls.md).

  Если выбрать элемент **Файл** в области **Добавить класс из**, это поле будет недоступно для изменения.

- **Расположение**

  Указывает расположение элемента управления ActiveX. Если выбрать элемент **Файл** в области **Добавить класс из**, можно указать расположение файла, содержащего библиотеку типов. Чтобы перейти к расположению файла, нажмите кнопку с многоточием.

  Если выбрать элемент **Реестр** в области **Добавить класс из**, это поле будет недоступно для изменения.

- **Интерфейсы**

  Задает интерфейсы элемента управления ActiveX. Мастер использует интерфейсы, выделенные в поле **Доступные элементы управления ActiveX**, или интерфейсы из файла библиотеки типов, указанного в поле **Расположение**.

  |Кнопка "Перенести"|Описание|
  |---------------------|-----------------|
  |**>**|Добавляет интерфейс, выбранный в списке **Интерфейсы**. Недоступно, если нет выбранных интерфейсов.|
  |**>>**|Добавляет все интерфейсы элемента управления ActiveX. Мастер использует интерфейсы, выделенные в поле **Доступные элементы управления ActiveX**, или интерфейсы из файла библиотеки типов, указанного в поле **Расположение**.|
  |**\<**|Удаляет класс, выбранный в списке **Созданные классы**. Недоступно, если в списке **Созданные классы** нет выбранных классов.|
  |**\<\<**|Удаляет все классы в списке **Созданные классы**. Недоступно, если список **Созданные классы** пуст.|

- **Созданные классы**

  Указывает имена классов, создаваемые из интерфейсов, добавленных с помощью кнопки **>** или **>>** . Для выбора класса можно нажать на это поле и использовать стрелки вверх и вниз для перемещения по списку. После нажатия на кнопку **Готово** можно просмотреть имя каждого созданного класса в поле **Класс** и имя каждого созданного файла в поле **H-файл**. В этом поле можно выбрать только один класс за раз.

  Класс можно удалить, выбрав его в списке и нажав элемент **<** . Чтобы удалить все классы, не нужно выбирать их в поле **Созданные классы**. Нажатие на элемент **<<** удалит все классы в поле **Созданные классы**.

- **Class**

   Задает имя класса, выбранного в поле **Созданные классы**, который мастер добавляет при нажатии кнопки **Готово**. Можно изменить имя в поле **Класс**.

- **H-файл**

  Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Созданные классы**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. При выборе существующего файла мастер не сохраняет его в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

  Мастер не перезаписывает файл. Если выбрать имя существующего файла и затем нажать кнопку **Готово**, мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **CPP-файл**

  Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Созданные классы**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

  Мастер не перезаписывает файл. Если выбрать имя существующего файла и затем нажать кнопку **Готово**, мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.
